import{c as commonjsGlobal}from"./_commonjsHelpers.87174ba5.mjs";function _mergeNamespaces(g,E){for(var y=0;y<E.length;y++){const b=E[y];if(typeof b!="string"&&!Array.isArray(b)){for(const m in b)if(m!=="default"&&!(m in g)){const l=Object.getOwnPropertyDescriptor(b,m);l&&Object.defineProperty(g,m,l.get?l:{enumerable:!0,get:()=>b[m]})}}}return Object.freeze(Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}))}var jsxgraphcoreExports={},jsxgraphcore$2={get exports(){return jsxgraphcoreExports},set exports(g){jsxgraphcoreExports=g}};(function(module,exports){(function(g,E){module.exports?module.exports=E():g.returnExports=E()})(typeof self<"u"?self:commonjsGlobal,function(){var requirejs,require,define;return function(g){var E,y,b,m,l={},c={},a={},e={},o=Object.prototype.hasOwnProperty,s=[].slice,t=/\.js$/;function h(_,P){return o.call(_,P)}function u(_,P){var x,S,O,w,T,M,N,A,R,L,D,k=P&&P.split("/"),B=a.map,j=B&&B["*"]||{};if(_){for(T=(_=_.split("/")).length-1,a.nodeIdCompat&&t.test(_[T])&&(_[T]=_[T].replace(t,"")),_[0].charAt(0)==="."&&k&&(_=k.slice(0,k.length-1).concat(_)),R=0;R<_.length;R++)if((D=_[R])===".")_.splice(R,1),R-=1;else if(D===".."){if(R===0||R===1&&_[2]===".."||_[R-1]==="..")continue;R>0&&(_.splice(R-1,2),R-=2)}_=_.join("/")}if((k||j)&&B){for(R=(x=_.split("/")).length;R>0;R-=1){if(S=x.slice(0,R).join("/"),k){for(L=k.length;L>0;L-=1)if((O=B[k.slice(0,L).join("/")])&&(O=O[S])){w=O,M=R;break}}if(w)break;!N&&j&&j[S]&&(N=j[S],A=R)}!w&&N&&(w=N,M=A),w&&(x.splice(0,M,w),_=x.join("/"))}return _}function d(_,P){return function(){var x=s.call(arguments,0);return typeof x[0]!="string"&&x.length===1&&x.push(null),y.apply(g,x.concat([_,P]))}}function n(_){return function(P){l[_]=P}}function p(_){if(h(c,_)){var P=c[_];delete c[_],e[_]=!0,E.apply(g,P)}if(!h(l,_)&&!h(e,_))throw new Error("No "+_);return l[_]}function f(_){var P,x=_?_.indexOf("!"):-1;return x>-1&&(P=_.substring(0,x),_=_.substring(x+1,_.length)),[P,_]}function v(_){return _?f(_):[]}function C(_){return function(){return a&&a.config&&a.config[_]||{}}}b=function(_,P){var x,S,O=f(_),w=O[0],T=P[1];return _=O[1],w&&(x=p(w=u(w,T))),w?_=x&&x.normalize?x.normalize(_,(S=T,function(M){return u(M,S)})):u(_,T):(w=(O=f(_=u(_,T)))[0],_=O[1],w&&(x=p(w))),{f:w?w+"!"+_:_,n:_,pr:w,p:x}},m={require:function(_){return d(_)},exports:function(_){var P=l[_];return P!==void 0?P:l[_]={}},module:function(_){return{id:_,uri:"",exports:l[_],config:C(_)}}},E=function(_,P,x,S){var O,w,T,M,N,A,R,L=[],D=typeof x;if(A=v(S=S||_),D==="undefined"||D==="function"){for(P=!P.length&&x.length?["require","exports","module"]:P,N=0;N<P.length;N+=1)if((w=(M=b(P[N],A)).f)==="require")L[N]=m.require(_);else if(w==="exports")L[N]=m.exports(_),R=!0;else if(w==="module")O=L[N]=m.module(_);else if(h(l,w)||h(c,w)||h(e,w))L[N]=p(w);else{if(!M.p)throw new Error(_+" missing "+w);M.p.load(M.n,d(S,!0),n(w),{}),L[N]=l[w]}T=x?x.apply(l[_],L):void 0,_&&(O&&O.exports!==g&&O.exports!==l[_]?l[_]=O.exports:T===g&&R||(l[_]=T))}else _&&(l[_]=x)},requirejs=require=y=function(_,P,x,S,O){if(typeof _=="string")return m[_]?m[_](P):p(b(_,v(P)).f);if(!_.splice){if((a=_).deps&&y(a.deps,a.callback),!P)return;P.splice?(_=P,P=x,x=null):_=g}return P=P||function(){},typeof x=="function"&&(x=S,S=O),S?E(g,_,P,x):setTimeout(function(){E(g,_,P,x)},4),y},y.config=function(_){return y(_)},requirejs._defined=l,(define=function(_,P,x){if(typeof _!="string")throw new Error("See almond README: incorrect module build, no module name");P.splice||(x=P,P=[]),h(l,_)||h(c,_)||(c[_]=[_,P,x])}).amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){var g={};return typeof JXG!="object"||JXG.extend||(g=JXG),g.extend=function(E,y,b,m){var l;for(l in b=b||!1,m=m||!1,y)(!b||b&&y.hasOwnProperty(l))&&(E[m?l.toLowerCase():l]=y[l])},g.defineConstant=function(E,y,b,m){(m=m||!1)&&g.exists(E[y])||Object.defineProperty(E,y,{value:b,writable:!1,enumerable:!0,configurable:!1})},g.extendConstants=function(E,y,b,m){var l,c;for(l in b=b||!1,m=m||!1,y)(!b||b&&y.hasOwnProperty(l))&&(c=m?l.toUpperCase():l,this.defineConstant(E,c,y[l]))},g.extend(g,{boards:{},readers:{},elements:{},registerElement:function(E,y){E=E.toLowerCase(),this.elements[E]=y},registerReader:function(E,y){var b,m;for(b=0;b<y.length;b++)m=y[b].toLowerCase(),typeof this.readers[m]!="function"&&(this.readers[m]=E)},shortcut:function(E,y){return function(){return E[y].apply(this,arguments)}},getRef:function(E,y){return g.deprecated("JXG.getRef()","Board.select()"),E.select(y)},getReference:function(E,y){return g.deprecated("JXG.getReference()","Board.select()"),E.select(y)},getBoardByContainerId:function(E){var y;for(y in JXG.boards)if(JXG.boards.hasOwnProperty(y)&&JXG.boards[y].container===E)return JXG.boards[y];return null},deprecated:function(E,y){var b=E+" is deprecated.";y&&(b+=" Please use "+y+" instead."),g.warn(b)},warn:function(E){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",E):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+E+"<br />")},debugInt:function(E){var y,b;for(y=0;y<arguments.length;y++)b=arguments[y],typeof window=="object"&&window.console&&console.log?console.log(b):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=b+"<br/>")},debugWST:function(E){var y=new Error;g.debugInt.apply(this,arguments),y&&y.stack&&(g.debugInt("stacktrace"),g.debugInt(y.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(E){var y=new Error;g.debugInt.apply(this,arguments),y&&y.stack&&g.debugInt("Called from",y.stack.split(`
`).slice(2,3).join(`
`))},debug:function(E){g.debugInt.apply(this,arguments)}}),g}),define("base/constants",["jxg"],function(g){var E,y="1.4.6";return E={version:y,licenseText:"JSXGraph v1.4.6 Copyright (C) see https://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_TYPE_FOREIGNOBJECT:31,OBJECT_TYPE_VIEW3D:32,OBJECT_TYPE_POINT3D:33,OBJECT_TYPE_LINE3D:34,OBJECT_TYPE_PLANE3D:35,OBJECT_TYPE_CURVE3D:36,OBJECT_TYPE_SURFACE3D:37,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,OBJECT_CLASS_3D:8,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_REFLECTION_ON_LINE:4,GENTYPE_REFLECTION_ON_POINT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_POLYGONCOPY:48,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},g.extendConstants(g,E),E}),define("utils/type",["jxg","base/constants"],function(g,E){return g.extend(g,{isId:function(y,b){return typeof b=="string"&&!!y.objects[b]},isName:function(y,b){return typeof b=="string"&&!!y.elementsByName[b]},isGroup:function(y,b){return typeof b=="string"&&!!y.groups[b]},isString:function(y){return typeof y=="string"},isNumber:function(y){return typeof y=="number"||Object.prototype.toString.call(y)==="[Object Number]"},isFunction:function(y){return typeof y=="function"},isArray:function(y){return Array.isArray?Array.isArray(y):y!==null&&typeof y=="object"&&typeof y.splice=="function"&&typeof y.join=="function"},isObject:function(y){return typeof y=="object"&&!this.isArray(y)},isPoint:function(y){return!(y===null||typeof y!="object"||!this.exists(y.elementClass))&&y.elementClass===E.OBJECT_CLASS_POINT},isPoint3D:function(y){return!(y===null||typeof y!="object"||!this.exists(y.elType))&&y.elType==="point3d"},isPointType:function(y,b){var m,l;return!!this.isArray(b)||!!(this.isFunction(b)&&(m=b(),this.isArray(m)&&m.length>1))||(l=y.select(b),this.isPoint(l))},isTransformationOrArray:function(y){if(y!==null){if(this.isArray(y)&&y.length>0)return this.isTransformationOrArray(y[0]);if(typeof y=="object")return y.type===E.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(y,b){var m=!(y==null||y===null);return(b=b||!1)?m&&y!=="":m},isEmpty:function(y){return Object.keys(y).length===0},def:function(y,b){return this.exists(y)?y:b},str2Bool:function(y){return!this.exists(y)||(typeof y=="boolean"?y:!!this.isString(y)&&y.toLowerCase()==="true")},createEvalFunction:function(y,b,m){var l,c=[];for(l=0;l<m;l++)c[l]=g.createFunction(b[l],y,"",!0);return function(a){return c[a]()}},createFunction:function(y,b,m,l){var c=null;return this.exists(l)&&!l||!this.isString(y)?this.isFunction(y)?c=y:(this.isNumber(y)||this.isString(y))&&(c=function(){return y}):c=b.jc.snippet(y,!0,m,!0),c!==null&&(c.origin=y),c},providePoints:function(y,b,m,l,c){var a,e,o,s,t,h=0,u=[];for(this.isArray(b)||(b=[b]),o=b.length,this.exists(c)&&(h=c.length),h===0&&(s=this.copyAttributes(m,y.options,l)),a=0;a<o;++a)if(h>0&&(e=Math.min(a,h-1),s=this.copyAttributes(m,y.options,l,c[e])),this.isArray(b[a])&&b[a].length>1?(u.push(y.create("point",b[a],s)),u[u.length-1]._is_new=!0):this.isFunction(b[a])?(t=b[a](),this.isArray(t)&&t.length>1&&(u.push(y.create("point",[b[a]],s)),u[u.length-1]._is_new=!0)):u.push(y.select(b[a])),!this.isPoint(u[a]))return!1;return u},providePoints3D:function(y,b,m,l,c){var a,e,o,s,t,h=0,u=[];for(this.isArray(b)||(b=[b]),o=b.length,this.exists(c)&&(h=c.length),h===0&&(s=this.copyAttributes(m,y.board.options,l)),a=0;a<o;++a)if(h>0&&(e=Math.min(a,h-1),s=this.copyAttributes(m,y.board.options,l,c[e])),this.isArray(b[a])&&b[a].length>1?(u.push(y.create("point3d",b[a],s)),u[u.length-1]._is_new=!0):this.isFunction(b[a])?(t=b[a](),this.isArray(t)&&t.length>1&&(u.push(y.create("point3d",[b[a]],s)),u[u.length-1]._is_new=!0)):u.push(y.select(b[a])),!this.isPoint3D(u[a]))return!1;return u},bind:function(y,b){return function(){return y.apply(b,arguments)}},evaluate:function(y){return this.isFunction(y)?y():y},indexOf:function(y,b,m){var l,c=this.exists(m);if(Array.indexOf&&!c)return y.indexOf(b);for(l=0;l<y.length;l++)if(c&&y[l][m]===b||!c&&y[l]===b)return l;return-1},eliminateDuplicates:function(y){var b,m=y.length,l=[],c={};for(b=0;b<m;b++)c[y[b]]=0;for(b in c)c.hasOwnProperty(b)&&l.push(b);return l},swap:function(y,b,m){var l;return l=y[b],y[b]=y[m],y[m]=l,y},uniqueArray:function(y){var b,m,l,c=[];if(y.length===0)return[];for(b=0;b<y.length;b++)if(l=this.isArray(y[b]),this.exists(y[b]))for(m=b+1;m<y.length;m++)l&&g.cmpArrays(y[b],y[m])?y[b]=[]:l||y[b]!==y[m]||(y[b]="");else y[b]="";for(m=0,b=0;b<y.length;b++)(l=this.isArray(y[b]))||y[b]===""?l&&y[b].length!==0&&(c[m]=y[b].slice(0),m++):(c[m]=y[b],m++);return y=c,c},isInArray:function(y,b){return g.indexOf(y,b)>-1},coordsArrayToMatrix:function(y,b){var m,l=[],c=[];for(m=0;m<y.length;m++)b?(l.push(y[m].usrCoords[1]),c.push(y[m].usrCoords[2])):c.push([y[m].usrCoords[1],y[m].usrCoords[2]]);return b&&(c=[l,c]),c},cmpArrays:function(y,b){var m;if(y===b)return!0;if(y.length!==b.length)return!1;for(m=0;m<y.length;m++)if(this.isArray(y[m])&&this.isArray(b[m])){if(!this.cmpArrays(y[m],b[m]))return!1}else if(y[m]!==b[m])return!1;return!0},removeElementFromArray:function(y,b){var m;for(m=0;m<y.length;m++)if(y[m]===b)return y.splice(m,1),y;return y},trunc:function(y,b){return b=g.def(b,0),this.toFixed(y,b)},_decimalAdjust:function(y,b,m){return m===void 0||+m==0?Math[y](b):(b=+b,m=+m,isNaN(b)||typeof m!="number"||m%1!=0?NaN:(b=b.toString().split("e"),+((b=(b=Math[y](+(b[0]+"e"+(b[1]?+b[1]-m:-m)))).toString().split("e"))[0]+"e"+(b[1]?+b[1]+m:m))))},_round10:function(y,b){return this._decimalAdjust("round",y,b)},_floor10:function(y,b){return this._decimalAdjust("floor",y,b)},_ceil10:function(y,b){return this._decimalAdjust("ceil",y,b)},toFixed:function(y,b){return this._round10(y,-b).toFixed(b)},autoDigits:function(y){var b=Math.abs(y);return b>=.1?this.toFixed(y,2):b>=.01?this.toFixed(y,4):b>=1e-4?this.toFixed(y,6):y},keys:function(y,b){var m,l=[];for(m in y)b?y.hasOwnProperty(m)&&l.push(m):l.push(m);return l},clone:function(y){var b={};return b.prototype=y,b},cloneAndCopy:function(y,b){var m,l=function(){};for(m in l.prototype=y,b)l[m]=b[m];return l},merge:function(y,b){var m,l;for(m in b)if(b.hasOwnProperty(m))if(this.isArray(b[m]))for(y[m]||(y[m]=[]),l=0;l<b[m].length;l++)typeof b[m][l]=="object"?y[m][l]=this.merge(y[m][l],b[m][l]):y[m][l]=b[m][l];else typeof b[m]=="object"?(y[m]||(y[m]={}),y[m]=this.merge(y[m],b[m])):y[m]=b[m];return y},deepCopy:function(y,b,m){var l,c,a,e;if(m=m||!1,typeof y!="object"||y===null)return y;if(this.isArray(y))for(l=[],c=0;c<y.length;c++)typeof(a=y[c])=="object"?this.exists(a.board)?l[c]=a.id:l[c]=this.deepCopy(a):l[c]=a;else{for(c in l={},y)y.hasOwnProperty(c)&&(e=m?c.toLowerCase():c,(a=y[c])!==null&&typeof a=="object"?this.exists(a.board)?l[e]=a.id:l[e]=this.deepCopy(a):l[e]=a);for(c in b)b.hasOwnProperty(c)&&(e=m?c.toLowerCase():c,typeof(a=b[c])=="object"?this.isArray(a)||!this.exists(l[e])?l[e]=this.deepCopy(a):l[e]=this.deepCopy(l[e],a,m):l[e]=a)}return l},copyAttributes:function(y,b,m){var l,c,a,e,o,s={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(l=(a=arguments.length)<3||s[m]?g.deepCopy(b.elements,null,!0):{},a<4&&this.exists(m)&&this.exists(b.layer[m])&&(l.layer=b.layer[m]),e=b,o=!0,c=2;c<a;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}for(o&&(l=g.deepCopy(l,e,!0)),e=typeof y=="object"?y:{},o=!0,c=3;c<a;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}if(o&&this.extend(l,e,null,!0),arguments[2]==="board")return l;for(e=b,o=!0,c=2;c<a;c++){if(!this.exists(e[arguments[c]])){o=!1;break}e=e[arguments[c]]}return o&&this.exists(e.label)&&(l.label=g.deepCopy(e.label,l.label)),l.label=g.deepCopy(b.label,l.label),l},copyPrototypeMethods:function(y,b,m){var l;for(l in y.prototype[m]=b.prototype.constructor,b.prototype)b.prototype.hasOwnProperty(l)&&(y.prototype[l]=b.prototype[l])},toJSON:function(y,b){var m,l,c,a;if(b=g.def(b,!1),JSON.stringify&&!b)try{return JSON.stringify(y)}catch{}switch(typeof y){case"object":if(y){if(m=[],this.isArray(y)){for(c=0;c<y.length;c++)m.push(g.toJSON(y[c],b));return"["+m.join(",")+"]"}for(l in y)if(y.hasOwnProperty(l)){try{a=g.toJSON(y[l],b)}catch{a=""}b?m.push(l+":"+a):m.push('"'+l+'":'+a)}return"{"+m.join(",")+"} "}return"null";case"string":return"'"+y.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return y.toString()}return"0"},clearVisPropOld:function(y){return y.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",tabindex:-1e5,transitionduration:0,top:-1e5,visible:null},y},isInObject:function(y,b){var m;for(m in y)if(y.hasOwnProperty(m)&&y[m]===b)return!0;return!1},escapeHTML:function(y){return y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(y){return y.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(y){return y.charAt(0).toUpperCase()+y.substring(1).toLowerCase()},trimNumber:function(y){return(y=(y=y.replace(/^0+/,"")).replace(/0+$/,""))[y.length-1]!=="."&&y[y.length-1]!==","||(y=y.slice(0,-1)),y[0]!=="."&&y[0]!==","||(y="0"+y),y},filterElements:function(y,b){var m,l,c,a,e,o,s,t=y.length,h=[];if(typeof b!="function"&&typeof b!="object")return h;for(m=0;m<t;m++){if(s=!0,c=y[m],typeof b=="object"){for(l in b)if(b.hasOwnProperty(l)&&(a=l.toLowerCase(),e=typeof c[l]=="function"?c[l]():c[l],o=c.visProp&&typeof c.visProp[a]=="function"?c.visProp[a]():c.visProp&&c.visProp[a],!(s=typeof b[l]=="function"?b[l](e)||b[l](o):e===b[l]||o===b[l])))break}else typeof b=="function"&&(s=b(c));s&&h.push(c)}return h},trim:function(y){return y.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(y,b){return typeof html_sanitize=="function"&&b?html_sanitize(y,function(){},function(m){return m}):(y&&typeof y=="string"&&(y=y.replace(/</g,"&lt;").replace(/>/g,"&gt;")),y)},evalSlider:function(y){return y&&y.type===E.OBJECT_TYPE_GLIDER&&typeof y.Value=="function"?y.Value():y}}),g}),define("utils/env",["jxg","utils/type"],function(g,E){return g.extendConstants(g,{touchProperty:"touches"}),g.extend(g,{isTouchEvent:function(y){return g.exists(y[g.touchProperty])},isPointerEvent:function(y){return g.exists(y.pointerId)},isMouseEvent:function(y){return!g.isTouchEvent(y)&&!g.isPointerEvent(y)},getNumberOfTouchPoints:function(y){var b=-1;return g.isTouchEvent(y)&&(b=y[g.touchProperty].length),b},isFirstTouch:function(y){var b=g.getNumberOfTouchPoints(y);return g.isPointerEvent(y)?y.isPrimary:b===1},isBrowser:typeof window=="object"&&typeof document=="object",supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch{return!1}},supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var y=!1;if(this.isNode())try{y=!!module.require("canvas")}catch{}return y||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&(!!module.exports||typeof commonjsGlobal=="object"&&commonjsGlobal.requirejsVars&&!commonjsGlobal.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return E.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return E.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return E.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return E.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var y,b,m=3;if(typeof document!="object")return 0;b=(y=document.createElement("div")).getElementsByTagName("i");do y.innerHTML="<!--[if gt IE "+ ++m+"]><i></i><![endif]-->";while(b[0]);return m>4?m:void 0}(),getDimensions:function(y,b){var m,l,c,a,e,o,s,t,h,u=/\d+(\.\d*)?px/;if(!this.isBrowser||y===null)return{width:500,height:500};if(m=(b=b||document).getElementById(y),!E.exists(m))throw new Error(`
JSXGraph: HTML container element '`+y+"' not found.");return(l=m.style.display)!=="none"&&l!==null?m.clientWidth>0&&m.clientHeight>0?{width:m.clientWidth,height:m.clientHeight}:(h=window.getComputedStyle?window.getComputedStyle(m):m.style,{width:u.test(h.width)?parseFloat(h.width):0,height:u.test(h.height)?parseFloat(h.height):0}):(a=(c=m.style).visibility,e=c.position,o=c.display,c.visibility="hidden",c.position="absolute",c.display="block",s=m.clientWidth,t=m.clientHeight,c.display=o,c.position=e,c.visibility=a,{width:s,height:t})},addEvent:function(y,b,m,l){var c=function(){return m.apply(l,arguments)};c.origin=m,l["x_internal"+b]=l["x_internal"+b]||[],l["x_internal"+b].push(c),E.exists(y)&&E.exists(y.addEventListener)&&y.addEventListener(b,c,!1),E.exists(y)&&E.exists(y.attachEvent)&&y.attachEvent("on"+b,c)},removeEvent:function(y,b,m,l){var c;if(E.exists(l))if(E.exists(l["x_internal"+b]))if(E.isArray(l["x_internal"+b]))if((c=E.indexOf(l["x_internal"+b],m,"origin"))!==-1){try{E.exists(y)&&E.exists(y.removeEventListener)&&y.removeEventListener(b,l["x_internal"+b][c],!1),E.exists(y)&&E.exists(y.detachEvent)&&y.detachEvent("on"+b,l["x_internal"+b][c])}catch{g.debug("event not registered in browser: ("+b+" -- "+m+")")}l["x_internal"+b].splice(c,1)}else g.debug("removeEvent: no such event function in internal list: "+m);else g.debug("owner[x_internal + "+b+"] is not an array");else g.debug("no such type: "+b);else g.debug("no such owner")},removeAllEvents:function(y,b,m){var l;if(m["x_internal"+b]){for(l=m["x_internal"+b].length-1;l>=0;l--)g.removeEvent(y,b,m["x_internal"+b][l].origin,m);m["x_internal"+b].length>0&&g.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(y,b,m){var l,c,a,e=0,o=0;if(y||(y=window.event),a=y[g.touchProperty],E.exists(a)&&a.length===0&&(a=y.changedTouches),E.exists(b)&&E.exists(a))if(b===-1){for(c=a.length,l=0;l<c;l++)if(a[l]){y=a[l];break}}else y=a[b];return y.clientX&&(e=y.clientX,o=y.clientY),[e,o]},getOffset:function(y){var b,m=y,l=y,c=m.offsetLeft-m.scrollLeft,a=m.offsetTop-m.scrollTop;for(c=(b=this.getCSSTransform([c,a],m))[0],a=b[1],m=m.offsetParent;m;){for(c+=m.offsetLeft,a+=m.offsetTop,m.offsetParent&&(c+=m.clientLeft-m.scrollLeft,a+=m.clientTop-m.scrollTop),c=(b=this.getCSSTransform([c,a],m))[0],a=b[1],l=l.parentNode;l!==m;)c+=l.clientLeft-l.scrollLeft,a+=l.clientTop-l.scrollTop,c=(b=this.getCSSTransform([c,a],l))[0],a=b[1],l=l.parentNode;m=m.offsetParent}return[c,a]},getStyle:function(y,b){var m,l=y.ownerDocument;return l.defaultView&&l.defaultView.getComputedStyle?m=l.defaultView.getComputedStyle(y,null).getPropertyValue(b):y.currentStyle&&g.ieVersion>=9?m=y.currentStyle[b]:y.style&&(b=b.replace(/-([a-z]|[0-9])/gi,function(c,a){return a.toUpperCase()}),m=y.style[b]),m},getProp:function(y,b){var m=parseInt(this.getStyle(y,b),10);return isNaN(m)?0:m},getCSSTransform:function(y,b){var m,l,c,a,e,o,s,t=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(e=t.length,m=0,c="";m<e;m++)if(E.exists(b.style[t[m]])){c=b.style[t[m]];break}if(c!==""&&(a=c.indexOf("("))>0){for(e=c.length,l=0,o=(s=c.substring(a+1,e-1).split(",")).length;l<o;l++)s[l]=parseFloat(s[l]);c.indexOf("matrix")===0?(y[0]+=s[4],y[1]+=s[5]):c.indexOf("translateX")===0?y[0]+=s[0]:c.indexOf("translateY")===0?y[1]+=s[0]:c.indexOf("translate")===0&&(y[0]+=s[0],y[1]+=s[1])}return E.exists(b.style.zoom)&&(c=b.style.zoom)!==""&&(y[0]*=parseFloat(c),y[1]*=parseFloat(c)),y},getCSSTransformMatrix:function(y){var b,m,l,c,a,e,o,s,t=y.ownerDocument,h=["transform","webkitTransform","MozTransform","msTransform","oTransform"],u=[[1,0,0],[0,1,0],[0,0,1]];if(t.defaultView&&t.defaultView.getComputedStyle)l=(s=t.defaultView.getComputedStyle(y,null)).getPropertyValue("-webkit-transform")||s.getPropertyValue("-moz-transform")||s.getPropertyValue("-ms-transform")||s.getPropertyValue("-o-transform")||s.getPropertyValue("transform");else for(a=h.length,b=0,l="";b<a;b++)if(E.exists(y.style[h[b]])){l=y.style[h[b]];break}if(l!==""&&(c=l.indexOf("("))>0){for(a=l.length,m=0,e=(o=l.substring(c+1,a-1).split(",")).length;m<e;m++)o[m]=parseFloat(o[m]);l.indexOf("matrix")===0?u=[[1,0,0],[0,o[0],o[1]],[0,o[2],o[3]]]:l.indexOf("scaleX")===0?u[1][1]=o[0]:l.indexOf("scaleY")===0?u[2][2]=o[0]:l.indexOf("scale")===0&&(u[1][1]=o[0],u[2][2]=o[1])}return E.exists(y.style.zoom)&&(l=y.style.zoom)!==""&&(u[1][1]*=parseFloat(l),u[2][2]*=parseFloat(l)),u},timedChunk:function(y,b,m,l){var c=y.concat(),a=function(){var e=+new Date;do b.call(m,c.shift());while(c.length>0&&+new Date-e<300);c.length>0?window.setTimeout(a,1):l(y)};window.setTimeout(a,1)},scaleJSXGraphDiv:function(y,b,m){var l,c,a,e,o,s,t,h,u,d,n,p=m.styleSheets.length,f=[":fullscreen",":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"],v=f.length,C=new RegExp(".*#"+y+":.*full.*screen.*#"+b+".*auto;.*transform:.*matrix");for(e=(o=m.getElementById(y).getBoundingClientRect()).height,a=o.width,t=(h=m.getElementById(b).getBoundingClientRect()).height,d="{margin:0 auto;transform:matrix("+(u=(s=h.width)/t>=a/e?.85*a/s:.85*e/t)+",0,0,"+u+",0,"+.5*(e-t)+");}",p===0&&((l=document.createElement("style")).appendChild(document.createTextNode("")),m.appendChild(l),p=m.styleSheets.length),m.styleSheets[p-1].cssRules.length>0&&C.test(m.styleSheets[p-1].cssRules[0].cssText)&&m.styleSheets[p-1].deleteRule&&m.styleSheets[p-1].deleteRule(0),n=0;n<v;n++)try{c="#"+y+f[n]+" #"+b+d,m.styleSheets[p-1].insertRule(c,0);break}catch{}n===v&&(console.log("JXG.scaleJSXGraphDiv: Could not add any CSS rule."),console.log("One possible reason could be that the id of the JSXGraph container does not start with a letter."))}}),g}),define("utils/xml",["jxg","utils/type"],function(g,E){return g.XML={cleanWhitespace:function(y){for(var b=y.firstChild;E.exists(b);)b.nodeType!==3||/\S/.test(b.nodeValue)?b.nodeType===1&&this.cleanWhitespace(b):y.removeChild(b),b=b.nextSibling},parse:function(y){var b,m;return m=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(l){var c;return typeof ActiveXObject=="function"&&(c=new ActiveXObject("MSXML.DomDocument")).loadXML(l),c}},b=new m().parseFromString(y,"text/xml"),this.cleanWhitespace(b),b}},g.XML}),define("utils/event",["jxg","utils/type"],function(g,E){return g.EventEmitter={eventHandlers:{},suspended:{},trigger:function(y,b){var m,l,c,a,e,o;for(e=y.length,l=0;l<e;l++)if(a=this.eventHandlers[y[l]],!this.suspended[y[l]]){if(this.suspended[y[l]]=!0,a)for(o=a.length,m=0;m<o;m++)(c=a[m]).handler.apply(c.context,b);this.suspended[y[l]]=!1}return this},on:function(y,b,m){return E.isArray(this.eventHandlers[y])||(this.eventHandlers[y]=[]),m=E.def(m,this),this.eventHandlers[y].push({handler:b,context:m}),this},off:function(y,b){var m;return y&&E.isArray(this.eventHandlers[y])?(b?((m=E.indexOf(this.eventHandlers[y],b,"handler"))>-1&&this.eventHandlers[y].splice(m,1),this.eventHandlers[y].length===0&&delete this.eventHandlers[y]):delete this.eventHandlers[y],this):this},eventify:function(y){y.eventHandlers={},y.on=this.on,y.off=this.off,y.triggerEventHandlers=this.trigger,y.trigger=this.trigger,y.suspended={}}},g.EventEmitter}),define("math/math",["jxg","utils/type"],function(g,E){var y,b=function(m){var l,c;return m.memo||(l={},c=Array.prototype.join,m.memo=function(){var a=c.call(arguments);return l[a]!==y?l[a]:l[a]=m.apply(this,arguments)}),m.memo};return g.Math={eps:1e-6,relDif:function(m,l){var c=Math.abs(m),a=Math.abs(l);return(a=Math.max(c,a))===0?0:Math.abs(m-l)/a},mod:function(m,l){return m-Math.floor(m/l)*l},vector:function(m,l){var c,a;for(l=l||0,c=[],a=0;a<m;a++)c[a]=l;return c},matrix:function(m,l,c){var a,e,o;for(c=c||0,l=l||m,a=[],e=0;e<m;e++)for(a[e]=[],o=0;o<l;o++)a[e][o]=c;return a},identity:function(m,l){var c,a;for(l===y&&typeof l!="number"&&(l=m),c=this.matrix(m,l),a=0;a<Math.min(m,l);a++)c[a][a]=1;return c},frustum:function(m,l,c,a,e,o){var s=this.matrix(4,4);return s[0][0]=2*e/(l-m),s[0][1]=0,s[0][2]=(l+m)/(l-m),s[0][3]=0,s[1][0]=0,s[1][1]=2*e/(a-c),s[1][2]=(a+c)/(a-c),s[1][3]=0,s[2][0]=0,s[2][1]=0,s[2][2]=-(o+e)/(o-e),s[2][3]=-o*e*2/(o-e),s[3][0]=0,s[3][1]=0,s[3][2]=-1,s[3][3]=0,s},projection:function(m,l,c,a){var e=c*Math.tan(m/2),o=e*l;return this.frustum(-o,o,-e,e,c,a)},matVecMult:function(m,l){var c,a,e,o=m.length,s=l.length,t=[];if(s===3)for(c=0;c<o;c++)t[c]=m[c][0]*l[0]+m[c][1]*l[1]+m[c][2]*l[2];else for(c=0;c<o;c++){for(a=0,e=0;e<s;e++)a+=m[c][e]*l[e];t[c]=a}return t},matMatMult:function(m,l){var c,a,e,o,s=m.length,t=s>0?l[0].length:0,h=l.length,u=this.matrix(s,t);for(c=0;c<s;c++)for(a=0;a<t;a++){for(e=0,o=0;o<h;o++)e+=m[c][o]*l[o][a];u[c][a]=e}return u},transpose:function(m){var l,c,a,e,o;for(e=m.length,o=m.length>0?m[0].length:0,l=this.matrix(o,e),c=0;c<o;c++)for(a=0;a<e;a++)l[c][a]=m[a][c];return l},inverse:function(m){var l,c,a,e,o,s,t,h=m.length,u=[],d=[],n=[];for(l=0;l<h;l++){for(u[l]=[],c=0;c<h;c++)u[l][c]=m[l][c];d[l]=l}for(c=0;c<h;c++){for(o=Math.abs(u[c][c]),s=c,l=c+1;l<h;l++)Math.abs(u[l][c])>o&&(o=Math.abs(u[l][c]),s=l);if(o<=this.eps)return[];if(s>c){for(a=0;a<h;a++)t=u[c][a],u[c][a]=u[s][a],u[s][a]=t;t=d[c],d[c]=d[s],d[s]=t}for(e=1/u[c][c],l=0;l<h;l++)u[l][c]*=e;for(u[c][c]=e,a=0;a<h;a++)if(a!==c){for(l=0;l<h;l++)l!==c&&(u[l][a]-=u[l][c]*u[c][a]);u[c][a]=-e*u[c][a]}}for(l=0;l<h;l++){for(a=0;a<h;a++)n[d[a]]=u[l][a];for(a=0;a<h;a++)u[l][a]=n[a]}return u},innerProduct:function(m,l,c){var a,e=0;for(c!==y&&E.isNumber(c)||(c=m.length),a=0;a<c;a++)e+=m[a]*l[a];return e},crossProduct:function(m,l){return[m[1]*l[2]-m[2]*l[1],m[2]*l[0]-m[0]*l[2],m[0]*l[1]-m[1]*l[0]]},norm:function(m,l){var c,a=0;for(l!==y&&E.isNumber(l)||(l=m.length),c=0;c<l;c++)a+=m[c]*m[c];return Math.sqrt(a)},axpy:function(m,l,c){var a,e=l.length,o=[];for(a=0;a<e;a++)o[a]=m*l[a]+c[a];return o},factorial:b(function(m){return m<0?NaN:(m=Math.floor(m))===0||m===1?1:m*this.factorial(m-1)}),binomial:b(function(m,l){var c,a;if(l>m||l<0)return NaN;if(l=Math.round(l),m=Math.round(m),l===0||l===m)return 1;for(c=1,a=0;a<l;a++)c*=m-a,c/=a+1;return c}),cosh:Math.cosh||function(m){return .5*(Math.exp(m)+Math.exp(-m))},sinh:Math.sinh||function(m){return .5*(Math.exp(m)-Math.exp(-m))},acosh:Math.acosh||function(m){return Math.log(m+Math.sqrt(m*m-1))},asinh:Math.asinh||function(m){return m===-1/0?m:Math.log(m+Math.sqrt(m*m+1))},cot:function(m){return 1/Math.tan(m)},acot:function(m){return(m>=0?.5:-.5)*Math.PI-Math.atan(m)},nthroot:function(m,l){var c=1/l;return l<=0||Math.floor(l)!==l?NaN:m===0?0:m>0?Math.exp(c*Math.log(m)):l%2==1?-Math.exp(c*Math.log(-m)):NaN},cbrt:Math.cbrt||function(m){return this.nthroot(m,3)},pow:function(m,l){return m===0?l===0?1:0:Math.floor(l)===l?Math.pow(m,l):m>0?Math.exp(l*Math.log(m)):NaN},ratpow:function(m,l,c){var a;return l===0?1:c===0?NaN:(a=this.gcd(l,c),this.nthroot(this.pow(m,l/a),c/a))},log10:function(m){return Math.log(m)/Math.log(10)},log2:function(m){return Math.log(m)/Math.log(2)},log:function(m,l){return l!==void 0&&E.isNumber(l)?Math.log(m)/Math.log(l):Math.log(m)},sign:Math.sign||function(m){return(m=+m)==0||isNaN(m)?m:m>0?1:-1},squampow:function(m,l){var c;if(Math.floor(l)===l){for(c=1,l<0&&(m=1/m,l*=-1);l!==0;)1&l&&(c*=m),l>>=1,m*=m;return c}return this.pow(m,l)},gcd:function(m,l){if(m=Math.abs(m),l=Math.abs(l),!E.isNumber(m)||!E.isNumber(l))return NaN;if(l>m){var c=m;m=l,l=c}for(;;){if((m%=l)===0)return l;if((l%=m)===0)return m}},lcm:function(m,l){var c;return E.isNumber(m)&&E.isNumber(l)?(c=m*l)!==0?c/this.gcd(m,l):0:NaN},erf:function(m){return this.ProbFuncs.erf(m)},erfc:function(m){return this.ProbFuncs.erfc(m)},erfi:function(m){return this.ProbFuncs.erfi(m)},ndtr:function(m){return this.ProbFuncs.ndtr(m)},ndtri:function(m){return this.ProbFuncs.ndtri(m)},lt:function(m,l){return m<l},leq:function(m,l){return m<=l},gt:function(m,l){return m>l},geq:function(m,l){return m>=l},eq:function(m,l){return m===l},neq:function(m,l){return m!==l},and:function(m,l){return m&&l},not:function(m){return!m},or:function(m,l){return m||l},xor:function(m,l){return(m||l)&&!(m&&l)},normalize:function(m){var l,c,a=2*m[3],e=m[4]/a;return m[5]=e,m[6]=-m[1]/a,m[7]=-m[2]/a,isFinite(e)?Math.abs(e)>=1?(m[0]=(m[6]*m[6]+m[7]*m[7]-e*e)/(2*e),m[1]=-m[6]/e,m[2]=-m[7]/e,m[3]=1/(2*e),m[4]=1):(c=e<=0?-1:1,m[0]=c*(m[6]*m[6]+m[7]*m[7]-e*e)*.5,m[1]=-c*m[6],m[2]=-c*m[7],m[3]=c/2,m[4]=c*e):(l=Math.sqrt(m[1]*m[1]+m[2]*m[2]),m[0]/=l,m[1]/=l,m[2]/=l,m[3]=0,m[4]=1),m},toGL:function(m){var l,c,a;if(l=typeof Float32Array=="function"?new Float32Array(16):new Array(16),m.length!==4&&m[0].length!==4)return l;for(c=0;c<4;c++)for(a=0;a<4;a++)l[c+4*a]=m[c][a];return l},Vieta:function(m){var l,c,a,e=m.length,o=[];for(o=m.slice(),l=1;l<e;++l){for(a=o[l],o[l]*=o[l-1],c=l-1;c>=1;--c)o[c]+=o[c-1]*a;o[0]+=a}return o}},g.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(g,E,y,b,m){return g.Coords=function(l,c,a,e){this.board=a,this.usrCoords=[],this.scrCoords=[],this.emitter=!b.exists(e)||e,this.emitter&&y.eventify(this),this.setCoordinates(l,c,!1,!0)},g.extend(g.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>m.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(l){var c=Math.round,a=this.board,e=this.usrCoords,o=a.origin.scrCoords;l===!0?(this.scrCoords[0]=c(e[0]),this.scrCoords[1]=c(e[0]*o[1]+e[1]*a.unitX),this.scrCoords[2]=c(e[0]*o[2]-e[2]*a.unitY)):(this.scrCoords[0]=e[0],this.scrCoords[1]=e[0]*o[1]+e[1]*a.unitX,this.scrCoords[2]=e[0]*o[2]-e[2]*a.unitY)},screen2usr:function(){var l=this.board.origin.scrCoords,c=this.scrCoords,a=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(c[1]-l[1])/a.unitX,this.usrCoords[2]=(l[2]-c[2])/a.unitY},distance:function(l,c){var a,e,o=0,s=this.usrCoords,t=this.scrCoords;if(l===E.COORDS_BY_USER){if(a=c.usrCoords,(o=(e=s[0]-a[0])*e)>m.eps*m.eps)return Number.POSITIVE_INFINITY;o+=(e=s[1]-a[1])*e,o+=(e=s[2]-a[2])*e}else a=c.scrCoords,o+=(e=t[1]-a[1])*e,o+=(e=t[2]-a[2])*e;return Math.sqrt(o)},setCoordinates:function(l,c,a,e){var o=this.usrCoords,s=this.scrCoords,t=[o[0],o[1],o[2]],h=[s[0],s[1],s[2]];return l===E.COORDS_BY_USER?(c.length===2?(o[0]=1,o[1]=c[0],o[2]=c[1]):(o[0]=c[0],o[1]=c[1],o[2]=c[2],this.normalizeUsrCoords()),this.usr2screen(a)):(c.length===2?(s[1]=c[0],s[2]=c[1]):(s[1]=c[1],s[2]=c[2]),this.screen2usr()),!this.emitter||e||h[1]===s[1]&&h[2]===s[2]||this.triggerEventHandlers(["update"],[t,h]),this},copy:function(l,c){return c===void 0&&(c=0),this[l].slice(c)},isReal:function(){return!isNaN(this.usrCoords[1]+this.usrCoords[2])&&Math.abs(this.usrCoords[0])>m.eps},__evt__update:function(l,c){},__evt:function(){}}),g.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(g,E,y,b){var m={each:function(l,c,a){var e,o,s=[];if(E.exists(l.length))for(o=l.length,e=0;e<o;e++)s.push(c.call(this,l[e],a));return s},coords:function(l,c){var a=l;return l&&l.elementClass===y.OBJECT_CLASS_POINT?a=l.coords:l.usrCoords&&l.scrCoords&&l.usr2screen&&(a=l),c&&(a=new b(y.COORDS_BY_USER,a.usrCoords,a.board)),a},coordsArray:function(l,c){var a;return(a=E.isArray(l)?l:this.coords(l).usrCoords).length<3&&a.unshift(1),c&&(a=[a[0],a[1],a[2]]),a}};return g.Expect=m,m}),define("math/probfuncs",["math/math","utils/type"],function(g,E){return g.ProbFuncs={MAXNUM:17014118346046923e22,SQRTH:.7071067811865476,SQRT2:1.4142135623730951,MAXLOG:708.3964185322641,P:[2461969814735305e-25,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],Q:[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],R:[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],S:[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],T:[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],U:[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],M:128,MINV:.0078125,expx2:function(y,b){var m,l,c,a;return y=Math.abs(y),b<0&&(y=-y),m=(c=this.MINV*Math.floor(this.M*y+.5))*c,l=2*c*(a=y-c)+a*a,b<0&&(m=-m,l=-l),m+l>this.MAXLOG?1/0:m=Math.exp(m)*Math.exp(l)},polevl:function(y,b,m){var l,c;if(E.exists(b.reduce))return b.reduce(function(a,e){return a*y+e},0);for(c=0,l=0;c<=m;c++)l=l*y+b[c];return l},p1evl:function(y,b,m){var l,c;if(E.exists(b.reduce))return b.reduce(function(a,e){return a*y+e},1);for(c=0,l=1;c<m;c++)l=l*y+b[c];return l},ndtr:function(y){var b,m,l;return b=y*this.SQRTH,(l=Math.abs(b))<1?m=.5+.5*this.erf(b):(m=.5*this.erfce(l),l=this.expx2(y,-1),m*=Math.sqrt(l),b>0&&(m=1-m)),m},_underflow:function(y){return console.log("erfc","UNDERFLOW"),y<0?2:0},erfc:function(y){var b,m,l,c,a;return(l=y<0?-y:y)<1?1-this.erf(y):(a=-y*y)<-this.MAXLOG?this._underflow(y):(a=this.expx2(y,-1),l<8?(b=this.polevl(l,this.P,8),m=this.p1evl(l,this.Q,8)):(b=this.polevl(l,this.R,5),m=this.p1evl(l,this.S,6)),c=a*b/m,y<0&&(c=2-c),c===0?this._underflow(y):c)},erfce:function(y){var b,m;return y<8?(b=this.polevl(y,this.P,8),m=this.p1evl(y,this.Q,8)):(b=this.polevl(y,this.R,5),m=this.p1evl(y,this.S,6)),b/m},erf:function(y){var b;return Math.abs(y)>1?1-this.erfc(y):(b=y*y,y*this.polevl(b,this.T,4)/this.p1evl(b,this.U,5))},s2pi:2.5066282746310007,P0:[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],Q0:[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],P1:[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],Q1:[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],P2:[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6239745391849833e-24],Q2:[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6790194080099813e-24],ndtri:function(y){var b,m,l,c,a;return y<=0?-1/0:y>=1?1/0:(a=1,(m=y)>.8646647167633873&&(m=1-m,a=0),m>.1353352832366127?(b=(m-=.5)+m*((c=m*m)*this.polevl(c,this.P0,4)/this.p1evl(c,this.Q0,8)),b*=this.s2pi):(l=1/(b=Math.sqrt(-2*Math.log(m))),b=b-Math.log(b)/b-(b<8?l*this.polevl(l,this.P1,8)/this.p1evl(l,this.Q1,8):l*this.polevl(l,this.P2,8)/this.p1evl(l,this.Q2,8)),a!==0&&(b=-b),b))},erfi:function(y){return this.ndtri(.5*(y+1))*this.SQRTH}},g.ProbFuncs}),define("math/ia",["jxg","math/math","utils/type"],function(g,E,y){g.Math.DoubleBits=function(){var l,c,a,e,o,s,t,h,u=new Float64Array(1),d=new Uint32Array(u.buffer);Float64Array!==void 0&&(u[0]=1,d[1]===1072693248?(l=function(n){return u[0]=n,[d[0],d[1]]},c=function(n,p){return d[0]=n,d[1]=p,u[0]},a=function(n){return u[0]=n,d[0]},e=function(n){return u[0]=n,d[1]},this.doubleBits=l,this.pack=c,this.lo=a,this.hi=e):d[0]===1072693248&&(o=function(n){return u[0]=n,[d[1],d[0]]},s=function(n,p){return d[1]=n,d[0]=p,u[0]},t=function(n){return u[0]=n,d[1]},h=function(n){return u[0]=n,d[0]},this.doubleBits=o,this.pack=s,this.lo=t,this.hi=h))},g.extend(g.Math.DoubleBits.prototype,{sign:function(l){return this.hi(l)>>>31},exponent:function(l){return(this.hi(l)<<1>>>21)-1023},fraction:function(l){var c=this.lo(l),a=this.hi(l),e=1048575&a;return 2146435072&a&&(e+=1<<20),[c,e]},denormalized:function(l){return!(2146435072&this.hi(l))}});var b=new g.Math.DoubleBits,m=function(l,c){if(l!==void 0&&c!==void 0){if(E.IntervalArithmetic.isInterval(l)){if(!E.IntervalArithmetic.isSingleton(l))throw new TypeError("JXG.Math.IntervalArithmetic: interval `lo` must be a singleton");this.lo=l.lo}else this.lo=l;if(E.IntervalArithmetic.isInterval(c)){if(!E.IntervalArithmetic.isSingleton(c))throw new TypeError("JXG.Math.IntervalArithmetic: interval `hi` must be a singleton");this.hi=c.hi}else this.hi=c}else{if(l!==void 0)return Array.isArray(l)?new m(l[0],l[1]):new m(l,l);this.lo=this.hi=0}};return g.extend(m.prototype,{print:function(){console.log("[",this.lo,this.hi,"]")},set:function(l,c){return this.lo=l,this.hi=c,this},bounded:function(l,c){return this.set(E.IntervalArithmetic.prev(l),E.IntervalArithmetic.next(c))},boundedSingleton:function(l){return this.bounded(l,l)},assign:function(l,c){if(typeof l!="number"||typeof c!="number")throw new TypeError("JXG.Math.Interval#assign: arguments must be numbers");return isNaN(l)||isNaN(c)||l>c?this.setEmpty():this.set(l,c)},setEmpty:function(){return this.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},setWhole:function(){return this.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)},open:function(l,c){return this.assign(E.IntervalArithmetic.next(l),E.IntervalArithmetic.prev(c))},halfOpenLeft:function(l,c){return this.assign(E.IntervalArithmetic.next(l),c)},halfOpenRight:function(l,c){return this.assign(l,E.IntervalArithmetic.prev(c))},toArray:function(){return[this.lo,this.hi]},clone:function(){return new m().set(this.lo,this.hi)}}),g.Math.IntervalArithmetic={Interval:function(l,c){return new m(l,c)},isInterval:function(l){return l!==null&&typeof l=="object"&&typeof l.lo=="number"&&typeof l.hi=="number"},isSingleton:function(l){return l.lo===l.hi},add:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),new m(this.addLo(l.lo,c.lo),this.addHi(l.hi,c.hi))},sub:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),new m(this.subLo(l.lo,c.hi),this.subHi(l.hi,c.lo))},mul:function(l,c){var a,e,o,s,t;return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(a=l.lo,e=l.hi,o=c.lo,s=c.hi,t=new m,a<0?e>0?o<0?s>0?(t.lo=Math.min(this.mulLo(a,s),this.mulLo(e,o)),t.hi=Math.max(this.mulHi(a,o),this.mulHi(e,s))):(t.lo=this.mulLo(e,o),t.hi=this.mulHi(a,o)):s>0?(t.lo=this.mulLo(a,s),t.hi=this.mulHi(e,s)):(t.lo=0,t.hi=0):o<0?s>0?(t.lo=this.mulLo(a,s),t.hi=this.mulHi(a,o)):(t.lo=this.mulLo(e,s),t.hi=this.mulHi(a,o)):s>0?(t.lo=this.mulLo(a,s),t.hi=this.mulHi(e,o)):(t.lo=0,t.hi=0):e>0?o<0?s>0?(t.lo=this.mulLo(e,o),t.hi=this.mulHi(e,s)):(t.lo=this.mulLo(e,o),t.hi=this.mulHi(a,s)):s>0?(t.lo=this.mulLo(a,o),t.hi=this.mulHi(e,s)):(t.lo=0,t.hi=0):(t.lo=0,t.hi=0),t)},div:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():this.zeroIn(c)?c.lo!==0?c.hi!==0?this.divZero(l):this.divNegative(l,c.lo):c.hi!==0?this.divPositive(l,c.hi):this.EMPTY.clone():this.divNonZero(l,c)},positive:function(l){return new m(l.lo,l.hi)},negative:function(l){return y.isNumber(l)?new m(-l):new m(-l.hi,-l.lo)},isEmpty:function(l){return l.lo>l.hi},isWhole:function(l){return l.lo===-1/0&&l.hi===1/0},zeroIn:function(l){return this.hasValue(l,0)},hasValue:function(l,c){return!this.isEmpty(l)&&l.lo<=c&&c<=l.hi},hasInterval:function(l,c){return!!this.isEmpty(l)||!this.isEmpty(c)&&c.lo<=l.lo&&l.hi<=c.hi},intervalsOverlap:function(l,c){return!this.isEmpty(l)&&!this.isEmpty(c)&&(l.lo<=c.lo&&c.lo<=l.hi||c.lo<=l.lo&&l.lo<=c.hi)},divNonZero:function(l,c){var a=l.lo,e=l.hi,o=c.lo,s=c.hi,t=new m;return e<0?s<0?(t.lo=this.divLo(e,o),t.hi=this.divHi(a,s)):(t.lo=this.divLo(a,o),t.hi=this.divHi(e,s)):a<0?s<0?(t.lo=this.divLo(e,s),t.hi=this.divHi(a,s)):(t.lo=this.divLo(a,o),t.hi=this.divHi(e,o)):s<0?(t.lo=this.divLo(e,s),t.hi=this.divHi(a,o)):(t.lo=this.divLo(a,s),t.hi=this.divHi(e,o)),t},divPositive:function(l,c){return l.lo===0&&l.hi===0?l:this.zeroIn(l)?this.WHOLE:l.hi<0?new m(Number.NEGATIVE_INFINITY,this.divHi(l.hi,c)):new m(this.divLo(l.lo,c),Number.POSITIVE_INFINITY)},divNegative:function(l,c){return l.lo===0&&l.hi===0?l:this.zeroIn(l)?this.WHOLE:l.hi<0?new m(this.divLo(l.hi,c),Number.POSITIVE_INFINITY):new m(Number.NEGATIVE_INFINITY,this.divHi(l.lo,c))},divZero:function(l){return l.lo===0&&l.hi===0?l:this.WHOLE},fmod:function(l,c){var a,e;return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(a=l.lo<0?c.lo:c.hi,e=(e=l.lo/a)<0?Math.ceil(e):Math.floor(e),this.sub(l,this.mul(c,new m(e))))},multiplicativeInverse:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():this.zeroIn(l)?l.lo!==0?l.hi!==0?this.WHOLE:new m(Number.NEGATIVE_INFINITY,this.divHi(1,l.lo)):l.hi!==0?new m(this.divLo(1,l.hi),Number.POSITIVE_INFINITY):this.EMPTY.clone():new m(this.divLo(1,l.hi),this.divHi(1,l.lo))},pow:function(l,c){var a,e;if(y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l))return this.EMPTY.clone();if(this.isInterval(c)){if(!this.isSingleton(c))return this.EMPTY.clone();c=c.lo}return c===0?l.lo===0&&l.hi===0?this.EMPTY.clone():this.ONE.clone():c<0?this.pow(this.multiplicativeInverse(l),-c):c%1==0?l.hi<0?(a=this.powLo(-l.hi,c),e=this.powHi(-l.lo,c),(1&c)==1?new m(-e,-a):new m(a,e)):l.lo<0?(1&c)==1?new m(-this.powLo(-l.lo,c),this.powHi(l.hi,c)):new m(0,this.powHi(Math.max(-l.lo,l.hi),c)):new m(this.powLo(l.lo,c),this.powHi(l.hi,c)):(console.warn("power is not an integer, you should use nth-root instead, returning an empty interval"),this.EMPTY.clone())},sqrt:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.nthRoot(l,2)},nthRoot:function(l,c){var a,e,o,s,t;if(y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)||c<0)return this.EMPTY.clone();if(this.isInterval(c)){if(!this.isSingleton(c))return this.EMPTY.clone();c=c.lo}return a=1/c,l.hi<0?c%1==0&&(1&c)==1?(e=this.powHi(-l.lo,a),o=this.powLo(-l.hi,a),new m(-e,-o)):this.EMPTY.clone():l.lo<0?(s=this.powHi(l.hi,a),c%1==0&&(1&c)==1?(t=-this.powHi(-l.lo,a),new m(t,s)):new m(0,s)):new m(this.powLo(l.lo,a),this.powHi(l.hi,a))},exp:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():new m(this.expLo(l.lo),this.expHi(l.hi))},log:function(l){var c;return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():(c=l.lo<=0?Number.NEGATIVE_INFINITY:this.logLo(l.lo),new m(c,this.logHi(l.hi)))},ln:function(l){return this.log(l)},log10:function(l){return this.isEmpty(l)?this.EMPTY.clone():this.div(this.log(l),this.log(new m(10,10)))},log2:function(l){return this.isEmpty(l)?this.EMPTY.clone():this.div(this.log(l),this.log(new m(2,2)))},hull:function(l,c){var a=this.isEmpty(l),e=this.isEmpty(c);return a&&e?this.EMPTY.clone():a?c.clone():e?l.clone():new m(Math.min(l.lo,c.lo),Math.max(l.hi,c.hi))},intersection:function(l,c){var a,e;return this.isEmpty(l)||this.isEmpty(c)?this.EMPTY.clone():(a=Math.max(l.lo,c.lo))<=(e=Math.min(l.hi,c.hi))?new m(a,e):this.EMPTY.clone()},union:function(l,c){if(!this.intervalsOverlap(l,c))throw new Error("Interval#unions do not overlap");return new m(Math.min(l.lo,c.lo),Math.max(l.hi,c.hi))},difference:function(l,c){if(this.isEmpty(l)||this.isWhole(c))return this.EMPTY.clone();if(this.intervalsOverlap(l,c)){if(l.lo<c.lo&&c.hi<l.hi)throw new Error("Interval.difference: difference creates multiple intervals");return c.lo<=l.lo&&c.hi===1/0||c.hi>=l.hi&&c.lo===-1/0?this.EMPTY.clone():c.lo<=l.lo?new m().halfOpenLeft(c.hi,l.hi):new m().halfOpenRight(l.lo,c.lo)}return l.clone()},width:function(l){return this.isEmpty(l)?0:this.subHi(l.hi,l.lo)},abs:function(l){return y.isNumber(l)&&(l=this.Interval(l)),this.isEmpty(l)?this.EMPTY.clone():l.lo>=0?l.clone():l.hi<=0?this.negative(l):new m(0,Math.max(-l.lo,l.hi))},max:function(l,c){var a=this.isEmpty(l),e=this.isEmpty(c);return a&&e?this.EMPTY.clone():a?c.clone():e?l.clone():new m(Math.max(l.lo,c.lo),Math.max(l.hi,c.hi))},min:function(l,c){var a=this.isEmpty(l),e=this.isEmpty(c);return a&&e?this.EMPTY.clone():a?c.clone():e?l.clone():new m(Math.min(l.lo,c.lo),Math.min(l.hi,c.hi))},onlyInfinity:function(l){return!isFinite(l.lo)&&l.lo===l.hi},_handleNegative:function(l){var c;return l.lo<0&&(l.lo===-1/0?(l.lo=0,l.hi=1/0):(c=Math.ceil(-l.lo/this.piTwiceLow),l.lo+=this.piTwiceLow*c,l.hi+=this.piTwiceLow*c)),l},cos:function(l){var c,a,e,o,s,t,h,u;return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():(c=new m().set(l.lo,l.hi),this._handleNegative(c),a=this.PI_TWICE,e=this.fmod(c,a),this.width(e)>=a.lo?new m(-1,1):e.lo>=this.piHigh?(o=this.cos(this.sub(e,this.PI)),this.negative(o)):(s=e.lo,t=e.hi,h=this.cosLo(t),u=this.cosHi(s),t<=this.piLow?new m(h,u):t<=a.lo?new m(-1,Math.max(h,u)):new m(-1,1)))},sin:function(l){return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():this.cos(this.sub(l,this.PI_HALF))},tan:function(l){var c,a,e;return this.isEmpty(l)||this.onlyInfinity(l)?this.EMPTY.clone():(c=new m().set(l.lo,l.hi),this._handleNegative(c),e=this.PI,(a=this.fmod(c,e)).lo>=this.piHalfLow&&(a=this.sub(a,e)),a.lo<=-this.piHalfLow||a.hi>=this.piHalfLow?this.WHOLE.clone():new m(this.tanLo(a.lo),this.tanHi(a.hi)))},asin:function(l){var c,a;return this.isEmpty(l)||l.hi<-1||l.lo>1?this.EMPTY.clone():(c=l.lo<=-1?-this.piHalfHigh:this.asinLo(l.lo),a=l.hi>=1?this.piHalfHigh:this.asinHi(l.hi),new m(c,a))},acos:function(l){var c,a;return this.isEmpty(l)||l.hi<-1||l.lo>1?this.EMPTY.clone():(c=l.hi>=1?0:this.acosLo(l.hi),a=l.lo<=-1?this.piHigh:this.acosHi(l.lo),new m(c,a))},atan:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.atanLo(l.lo),this.atanHi(l.hi))},sinh:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.sinhLo(l.lo),this.sinhHi(l.hi))},cosh:function(l){return this.isEmpty(l)?this.EMPTY.clone():l.hi<0?new m(this.coshLo(l.hi),this.coshHi(l.lo)):l.lo>=0?new m(this.coshLo(l.lo),this.coshHi(l.hi)):new m(1,this.coshHi(-l.lo>l.hi?l.lo:l.hi))},tanh:function(l){return this.isEmpty(l)?this.EMPTY.clone():new m(this.tanhLo(l.lo),this.tanhHi(l.hi))},equal:function(l,c){return this.isEmpty(l)?this.isEmpty(c):!this.isEmpty(c)&&l.lo===c.lo&&l.hi===c.hi},notEqual:function(l,c){return this.isEmpty(l)?!this.isEmpty(c):this.isEmpty(c)||l.hi<c.lo||l.lo>c.hi},lt:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.hi<c.lo},gt:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.lo>c.hi},leq:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.hi<=c.lo},geq:function(l,c){return y.isNumber(l)&&(l=this.Interval(l)),y.isNumber(c)&&(c=this.Interval(c)),!this.isEmpty(l)&&!this.isEmpty(c)&&l.lo>=c.hi},piLow:3.141592653589793,piHigh:3.1415926535897936,piHalfLow:1.5707963267948966,piHalfHigh:1.5707963267948968,piTwiceLow:6.283185307179586,piTwiceHigh:6.283185307179587,identity:function(l){return l},_prev:function(l){return l===1/0?l:this.nextafter(l,-1/0)},_next:function(l){return l===-1/0?l:this.nextafter(l,1/0)},prev:function(l){return this._prev(l)},next:function(l){return this._next(l)},toInteger:function(l){return l<0?Math.ceil(l):Math.floor(l)},addLo:function(l,c){return this.prev(l+c)},addHi:function(l,c){return this.next(l+c)},subLo:function(l,c){return this.prev(l-c)},subHi:function(l,c){return this.next(l-c)},mulLo:function(l,c){return this.prev(l*c)},mulHi:function(l,c){return this.next(l*c)},divLo:function(l,c){return this.prev(l/c)},divHi:function(l,c){return this.next(l/c)},intLo:function(l){return this.toInteger(this.prev(l))},intHi:function(l){return this.toInteger(this.next(l))},logLo:function(l){return this.prev(Math.log(l))},logHi:function(l){return this.next(Math.log(l))},expLo:function(l){return this.prev(Math.exp(l))},expHi:function(l){return this.next(Math.exp(l))},sinLo:function(l){return this.prev(Math.sin(l))},sinHi:function(l){return this.next(Math.sin(l))},cosLo:function(l){return this.prev(Math.cos(l))},cosHi:function(l){return this.next(Math.cos(l))},tanLo:function(l){return this.prev(Math.tan(l))},tanHi:function(l){return this.next(Math.tan(l))},asinLo:function(l){return this.prev(Math.asin(l))},asinHi:function(l){return this.next(Math.asin(l))},acosLo:function(l){return this.prev(Math.acos(l))},acosHi:function(l){return this.next(Math.acos(l))},atanLo:function(l){return this.prev(Math.atan(l))},atanHi:function(l){return this.next(Math.atan(l))},sinhLo:function(l){return this.prev(E.sinh(l))},sinhHi:function(l){return this.next(E.sinh(l))},coshLo:function(l){return this.prev(E.cosh(l))},coshHi:function(l){return this.next(E.cosh(l))},tanhLo:function(l){return this.prev(E.tanh(l))},tanhHi:function(l){return this.next(E.tanh(l))},sqrtLo:function(l){return this.prev(Math.sqrt(l))},sqrtHi:function(l){return this.next(Math.sqrt(l))},powLo:function(l,c){var a;if(c%1!=0)return this.prev(Math.pow(l,c));for(a=(1&c)==1?l:1,c>>=1;c>0;)l=this.mulLo(l,l),(1&c)==1&&(a=this.mulLo(l,a)),c>>=1;return a},powHi:function(l,c){var a;if(c%1!=0)return this.next(Math.pow(l,c));for(a=(1&c)==1?l:1,c>>=1;c>0;)l=this.mulHi(l,l),(1&c)==1&&(a=this.mulHi(l,a)),c>>=1;return a},disable:function(){this.next=this.prev=this.identity},enable:function(){this.prev=function(l){return this._prev(l)},this.next=function(l){return this._next(l)}},SMALLEST_DENORM:Math.pow(2,-1074),UINT_MAX:-1>>>0,nextafter:function(l,c){var a,e;return isNaN(l)||isNaN(c)?NaN:l===c?l:l===0?c<0?-this.SMALLEST_DENORM:this.SMALLEST_DENORM:(e=b.hi(l),a=b.lo(l),c>l==l>0?a===this.UINT_MAX?(e+=1,a=0):a+=1:a===0?(a=this.UINT_MAX,e-=1):a-=1,b.pack(a,e))}},g.Math.IntervalArithmetic.PI=new m(E.IntervalArithmetic.piLow,E.IntervalArithmetic.piHigh),g.Math.IntervalArithmetic.PI_HALF=new m(E.IntervalArithmetic.piHalfLow,E.IntervalArithmetic.piHalfHigh),g.Math.IntervalArithmetic.PI_TWICE=new m(E.IntervalArithmetic.piTwiceLow,E.IntervalArithmetic.piTwiceHigh),g.Math.IntervalArithmetic.ZERO=new m(0),g.Math.IntervalArithmetic.ONE=new m(1),g.Math.IntervalArithmetic.WHOLE=new m().setWhole(),g.Math.IntervalArithmetic.EMPTY=new m().setEmpty(),g.Math.IntervalArithmetic}),define("math/extrapolate",["math/math"],function(g){return g.Extrapolate={upper:15,infty:1e4,wynnEps:function(E,y,b){var m,l,c,a,e;if(b[y]=E,y===0)e=E;else{for(c=0,m=y;m>0;m--)l=c,c=b[m-1],a=b[m]-c,Math.abs(a)<=1e-15?b[m-1]=1e20:b[m-1]=1*l+1/a;e=b[y%2]}return e},aitken:function(E,y,b){var m,l,c,a,e,o;if(b[y]=E,y<2)m=E;else{for(a=y/2,e=1;e<=a;e++)l=b[(o=y-2*e)+2]-2*b[o+1]+b[o],Math.abs(l)<1e-15?b[o]=1e20:(c=b[o]-b[o+1],b[o]-=c*c/l);m=b[y%2]}return m},brezinski:function(E,y,b){var m,l,c,a,e,o,s,t;if(b[y]=E,y<3)m=E;else{for(o=y/3,t=y,s=1;s<=o;s++)c=b[(t-=3)+1]-b[t],a=b[t+2]-b[t+1],l=(e=b[t+3]-b[t+2])*(a-c)-c*(e-a),Math.abs(l)<1e-15?b[t]=1e20:b[t]=b[t+1]-c*a*(e-a)/l;m=b[y%3]}return m},iteration:function(E,y,b,m,l){var c,a,e,o,s=NaN,t=[],h="finite",u=y;for(l=l||0,c=1;c<=this.upper;c++){if(a=b(E+(u=l===0?y/(c+1):.5*u),!0),e=this[m](a,c-1,t),isNaN(e)){h="NaN";break}if(a!==0&&e/a>this.infty){s=e,h="infinite";break}if(o=e-s,Math.abs(o)<1e-7)break;s=e}return[s,h,1-(c-1)/this.upper]},levin:function(E,y,b,m,l,c){var a,e,o,s;if(s=1/(m+y),l[y]=E/b,c[y]=1/b,y>0&&(l[y-1]=l[y]-l[y-1],c[y-1]=c[y]-c[y-1],y>1))for(o=(m+y-1)*s,a=2;a<=y;a++)e=(m+y-a)*Math.pow(o,a-2)*s,l[y-a]=l[y-a+1]-e*l[y-a],c[y-a]=c[y-a+1]-e*c[y-a],s*=o;return Math.abs(c[0])<1e-15?1e20:l[0]/c[0]},iteration_levin:function(E,y,b,m){var l,c,a,e,o,s,t,h=NaN,u=[],d=[],n="finite",p=y;for(m=m||0,e=b(E+y,!0),l=1;l<=this.upper;l++){if(o=(c=b(E+(p=m===0?y/(l+1):.5*p),!0))-e,t=(Math.abs(o)<1?"u":"t")=="u"?(1+l)*o:o,e=c,s=(a=this.levin(c,l-1,t,1,u,d))-h,isNaN(a)){n="NaN";break}if(c!==0&&a/c>this.infty){h=a,n="infinite";break}if(Math.abs(s)<1e-7)break;h=a}return[h,n,1-(l-1)/this.upper]},limit:function(E,y,b){return this.iteration_levin(E,y,b,0)}},g.Extrapolate}),define("math/qdt",["math/math","utils/type"],function(g,E){return g.Quadtree=function(y){this.capacity=10,this.points=[],this.xlb=y[0],this.xub=y[2],this.ylb=y[3],this.yub=y[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null},E.extend(g.Quadtree.prototype,{contains:function(y,b){return this.xlb<y&&y<=this.xub&&this.ylb<b&&b<=this.yub},insert:function(y){return!!this.contains(y.usrCoords[1],y.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(y),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(y)||!!this.northEast.insert(y)||!!this.southEast.insert(y)||!!this.southWest.insert(y)))},subdivide:function(){var y,b=this.points.length,m=this.xlb+(this.xub-this.xlb)/2,l=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new g.Quadtree([this.xlb,this.yub,m,l]),this.northEast=new g.Quadtree([m,this.yub,this.xub,l]),this.southEast=new g.Quadtree([this.xlb,l,m,this.ylb]),this.southWest=new g.Quadtree([m,l,this.xub,this.ylb]),y=0;y<b;y+=1)this.northWest.insert(this.points[y]),this.northEast.insert(this.points[y]),this.southEast.insert(this.points[y]),this.southWest.insert(this.points[y])},_query:function(y,b){var m;if(this.contains(y,b)){if(this.northWest===null)return this;if((m=this.northWest._query(y,b))||(m=this.northEast._query(y,b))||(m=this.southEast._query(y,b))||(m=this.southWest._query(y,b)))return m}return!1},query:function(y,b){var m,l;return E.exists(b)?(m=y,l=b):(m=y.usrCoords[1],l=y.usrCoords[2]),this._query(m,l)}}),g.Quadtree}),define("math/numerics",["jxg","utils/type","utils/env","math/math"],function(g,E,y,b){var m={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[.16666666666666666,.3333333333333333,.3333333333333333,.16666666666666666],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return b.Numerics={Gauss:function(l,c){var a,e,o,s,t,h=b.eps,u=l.length>0?l[0].length:0;if(u!==c.length||u!==l.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(s=[],t=c.slice(0,u),a=0;a<u;a++)s[a]=l[a].slice(0,u);for(e=0;e<u;e++){for(a=u-1;a>e;a--)if(Math.abs(s[a][e])>h)if(Math.abs(s[e][e])<h)E.swap(s,a,e),E.swap(t,a,e);else for(s[a][e]/=s[e][e],t[a]-=s[a][e]*t[e],o=e+1;o<u;o++)s[a][o]-=s[a][e]*s[e][o];if(Math.abs(s[e][e])<h)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(s,t,!0),t},backwardSolve:function(l,c,a){var e,o,s,t,h;for(e=a?c:c.slice(0,c.length),o=l.length,s=l.length>0?l[0].length:0,t=o-1;t>=0;t--){for(h=s-1;h>t;h--)e[t]-=l[t][h]*e[h];e[t]/=l[t][t]}return e},gaussBareiss:function(l){var c,a,e,o,s,t,h,u,d,n=b.eps;if((h=l.length)<=0)return 0;for(l[0].length<h&&(h=l[0].length),u=[],o=0;o<h;o++)u[o]=l[o].slice(0,h);for(a=1,e=1,c=0;c<h-1;c++){if(t=u[c][c],Math.abs(t)<n){for(o=c+1;o<h&&!(Math.abs(u[o][c])>=n);o++);if(o===h)return 0;for(s=c;s<h;s++)d=u[o][s],u[o][s]=u[c][s],u[c][s]=d;e=-e,t=u[c][c]}for(o=c+1;o<h;o++)for(s=c+1;s<h;s++)d=t*u[o][s]-u[o][c]*u[c][s],u[o][s]=d/a;a=t}return e*u[h-1][h-1]},det:function(l){return l.length===2&&l[0].length===2?l[0][0]*l[1][1]-l[1][0]*l[0][1]:this.gaussBareiss(l)},Jacobi:function(l){var c,a,e,o,s,t,h,u,d,n=b.eps*b.eps,p=0,f=l.length,v=[[0,0,0],[0,0,0],[0,0,0]],C=[[0,0,0],[0,0,0],[0,0,0]],_=0;for(c=0;c<f;c++){for(a=0;a<f;a++)v[c][a]=0,C[c][a]=l[c][a],p+=Math.abs(C[c][a]);v[c][c]=1}if(f===1)return[C,v];if(p<=0)return[C,v];p/=f*f;do{for(u=0,d=0,a=1;a<f;a++)for(c=0;c<a;c++)if((o=Math.abs(C[c][a]))>d&&(d=o),u+=o,o>=n){for(o=.5*Math.atan2(2*C[c][a],C[c][c]-C[a][a]),s=Math.sin(o),t=Math.cos(o),e=0;e<f;e++)h=C[e][c],C[e][c]=t*h+s*C[e][a],C[e][a]=-s*h+t*C[e][a],h=v[e][c],v[e][c]=t*h+s*v[e][a],v[e][a]=-s*h+t*v[e][a];for(C[c][c]=t*C[c][c]+s*C[a][c],C[a][a]=-s*C[c][a]+t*C[a][a],C[c][a]=0,e=0;e<f;e++)C[c][e]=C[e][c],C[a][e]=C[e][a]}_+=1}while(Math.abs(u)/p>n&&_<2e3);return[C,v]},NewtonCotes:function(l,c,a){var e,o,s,t=0,h=a&&E.isNumber(a.number_of_nodes)?a.number_of_nodes:28,u={trapez:!0,simpson:!0,milne:!0},d=a&&a.integration_type&&u.hasOwnProperty(a.integration_type)&&u[a.integration_type]?a.integration_type:"milne",n=(l[1]-l[0])/h;switch(d){case"trapez":for(t=.5*(c(l[0])+c(l[1])),e=l[0],o=0;o<h-1;o++)t+=c(e+=n);t*=n;break;case"simpson":if(h%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(s=h/2,t=c(l[0])+c(l[1]),e=l[0],o=0;o<s-1;o++)t+=2*c(e+=2*n);for(e=l[0]-n,o=0;o<s;o++)t+=4*c(e+=2*n);t*=n/3;break;default:if(h%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(s=.25*h,t=7*(c(l[0])+c(l[1])),e=l[0],o=0;o<s-1;o++)t+=14*c(e+=4*n);for(e=l[0]-3*n,o=0;o<s;o++)t+=32*(c(e+=4*n)+c(e+2*n));for(e=l[0]-2*n,o=0;o<s;o++)t+=12*c(e+=4*n);t*=2*n/45}return t},Romberg:function(l,c,a){var e,o,s,t,h,u,d,n,p=[],f=0,v=1/0,C=a&&E.isNumber(a.max_iterations)?a.max_iterations:20,_=a&&E.isNumber(a.eps)?a.eps:a.eps||1e-7;for(e=l[0],s=(o=l[1])-e,h=1,p[0]=.5*s*(c(e)+c(o)),u=0;u<C;++u){for(t=0,s*=.5,h*=2,n=1,d=1;d<h;d+=2)t+=c(e+d*s);for(p[u+1]=.5*p[u]+t*s,f=p[u+1],d=u-1;d>=0;--d)n*=4,p[d]=p[d+1]+(p[d+1]-p[d])/(n-1),f=p[d];if(Math.abs(f-v)<_*Math.abs(f))break;v=f}return f},GaussLegendre:function(l,c,a){var e,o,s,t,h,u,d,n,p=0,f=[],v=[],C=a&&E.isNumber(a.n)?a.n:12;if(C>18&&(C=18),f[2]=[.5773502691896257],v[2]=[1],f[4]=[.33998104358485626,.8611363115940526],v[4]=[.6521451548625461,.34785484513745385],f[6]=[.2386191860831969,.6612093864662645,.932469514203152],v[6]=[.46791393457269104,.3607615730481386,.17132449237917036],f[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],v[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],f[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],v[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],f[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],v[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],f[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],v[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],f[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],v[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],f[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],v[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],f[3]=[0,.7745966692414834],v[3]=[.8888888888888888,.5555555555555556],f[5]=[0,.5384693101056831,.906179845938664],v[5]=[.5688888888888889,.47862867049936647,.23692688505618908],f[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],v[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],f[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],v[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],f[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],v[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],f[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],v[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],f[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],v[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],f[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],v[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],e=l[0],o=l[1],t=C+1>>1,d=f[C],n=v[C],u=.5*(o-e),h=.5*(o+e),!0&C)for(p=n[0]*c(h),s=1;s<t;++s)p+=n[s]*(c(h+u*d[s])+c(h-u*d[s]));else for(p=0,s=0;s<t;++s)p+=n[s]*(c(h+u*d[s])+c(h-u*d[s]));return u*p},_rescale_error:function(l,c,a){var e,o,s=2220446049250313e-31;return l=Math.abs(l),a!==0&&l!==0&&(l=(e=Math.pow(200*l/a,1.5))<1?a*e:a),c>20041683600089728e-310&&(o=50*s*c)>l&&(l=o),l},_gaussKronrod:function(l,c,a,e,o,s,t){var h,u,d,n,p,f,v,C,_,P,x,S=l[0],O=l[1],w=.5*(S+O),T=.5*(O-S),M=Math.abs(T),N=c(w),A=0,R=N*s[a-1],L=Math.abs(R),D=0,k=[],B=[];for(a%2==0&&(A=N*o[a/2-1]),h=Math.floor((a-1)/2),p=0;p<h;p++)P=(C=c(w-(v=T*e[f=2*p+1])))+(_=c(w+v)),k[f]=C,B[f]=_,A+=o[p]*P,R+=s[f]*P,L+=s[f]*(Math.abs(C)+Math.abs(_));for(h=Math.floor(a/2),p=0;p<h;p++)C=c(w-(v=T*e[x=2*p])),_=c(w+v),k[x]=C,B[x]=_,R+=s[x]*(C+_),L+=s[x]*(Math.abs(C)+Math.abs(_));for(d=.5*R,D=s[a-1]*Math.abs(N-d),p=0;p<a-1;p++)D+=s[p]*(Math.abs(k[p]-d)+Math.abs(B[p]-d));return n=(R-A)*T,L*=M,D*=M,u=R*=T,t.abserr=this._rescale_error(n,L,D),t.resabs=L,t.resasc=D,u},GaussKronrod15:function(l,c,a){return this._gaussKronrod(l,c,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],a)},GaussKronrod21:function(l,c,a){return this._gaussKronrod(l,c,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],a)},GaussKronrod31:function(l,c,a){return this._gaussKronrod(l,c,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],a)},_workspace:function(l,c){return{limit:c,size:0,nrmax:0,i:0,alist:[l[0]],blist:[l[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var a,e,o,s,t,h=this.size-1,u=this.limit,d=this.nrmax,n=this.order[d];if(h<2)return this.order[0]=0,this.order[1]=1,void(this.i=n);for(a=this.elist[n];d>0&&a>this.elist[this.order[d-1]];)this.order[d]=this.order[d-1],d--;for(t=h<u/2+2?h:u-h+1,o=d+1;o<t&&a<this.elist[this.order[o]];)this.order[o-1]=this.order[o],o++;for(this.order[o-1]=n,e=this.elist[h],s=t-1;s>o-2&&e>=this.elist[this.order[s]];)this.order[s+1]=this.order[s],s--;this.order[s+1]=h,n=this.order[d],this.i=n,this.nrmax=d},set_initial_result:function(a,e){this.size=1,this.rlist[0]=a,this.elist[0]=e},update:function(a,e,o,s,t,h,u,d){var n=this.i,p=this.size,f=this.level[this.i]+1;d>s?(this.alist[n]=t,this.rlist[n]=u,this.elist[n]=d,this.level[n]=f,this.alist[p]=a,this.blist[p]=e,this.rlist[p]=o,this.elist[p]=s,this.level[p]=f):(this.blist[n]=e,this.rlist[n]=o,this.elist[n]=s,this.level[n]=f,this.alist[p]=t,this.blist[p]=h,this.rlist[p]=u,this.elist[p]=d,this.level[p]=f),this.size++,f>this.maximum_level&&(this.maximum_level=f),this.qpsrt()},retrieve:function(){var a=this.i;return{a:this.alist[a],b:this.blist[a],r:this.rlist[a],e:this.elist[a]}},sum_results:function(){var a,e=this.size,o=0;for(a=0;a<e;a++)o+=this.rlist[a];return o},subinterval_too_small:function(a,e,o){var s=1.0000000000000222*(Math.abs(e)+22250738585072014e-321);return Math.abs(a)<=s&&Math.abs(o)<=s}}},Qag:function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T=this._workspace(l,1e3),M=a&&E.isNumber(a.limit)?a.limit:15,N=a&&E.isNumber(a.epsrel)?a.epsrel:1e-7,A=a&&E.isNumber(a.epsabs)?a.epsabs:1e-7,R=a&&E.isFunction(a.q)?a.q:this.GaussKronrod15,L={},D=0,k=0,B=0,j=0,I=0,q=0,$=0,Z=0,V=0,U=0;if(M>T.limit&&g.warn("iteration limit exceeds available workspace"),A<=0&&(N<50*b.eps||N<5e-29)&&g.warn("tolerance cannot be acheived with given epsabs and epsrel"),s=R.apply(this,[l,c,L]),t=L.abserr,h=L.resabs,u=L.resasc,T.set_initial_result(s,t),d=Math.max(A,N*Math.abs(s)),t<=11102230246251565e-30*h&&t>d)return g.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(t<=d&&t!==u||t===0)return s;if(M===1)return g.warn("a maximum of one iteration was insufficient"),-1/0;e=s,o=t,D=1;do I=0,q=0,$=0,Z=0,V=0,U=0,C=(O=T.retrieve()).a,_=O.b,P=O.r,x=O.e,n=C,f=p=.5*(C+_),v=_,I=R.apply(this,[[n,p],c,L]),Z=L.abserr,S=L.resasc,q=R.apply(this,[[f,v],c,L]),o+=(U=Z+(V=L.abserr))-x,e+=($=I+q)-P,S!==Z&&L.resasc!==V&&(w=P-$,Math.abs(w)<=1e-5*Math.abs($)&&U>=.99*x&&k++,D>=10&&U>x&&B++),o>(d=Math.max(A,N*Math.abs(e)))&&((k>=6||B>=20)&&(j=2),T.subinterval_too_small(n,f,v)&&(j=3)),T.update(n,p,I,Z,f,v,q,V),C=(O=T.retrieve()).a_i,_=O.b_i,P=O.r_i,x=O.e_i,D++;while(D<M&&!j&&o>d);return T.sum_results()},I:function(l,c){return this.Qag(l,c,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(l,c,a){var e,o=0,s=b.eps,t=l.apply(a,[c]);for(E.isArray(c)&&(c=c[0]);o<50&&Math.abs(t)>s;)e=this.D(l,a)(c),Math.abs(e)>s?c-=t/e:c+=.2*Math.random()-1,t=l.apply(a,[c]),o+=1;return c},root:function(l,c,a){return this.chandrupatla(l,c,a)},generalizedNewton:function(l,c,a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P,x,S=0;for(this.generalizedNewton.t1memo?(o=this.generalizedNewton.t1memo,s=this.generalizedNewton.t2memo):(o=a,s=e),v=(p=l.X(o)-c.X(s))*p+(f=l.Y(o)-c.Y(s))*f,C=this.D(l.X,l),_=this.D(c.X,c),P=this.D(l.Y,l),x=this.D(c.Y,c);v>b.eps&&S<10;)t=C(o),h=-_(s),u=P(o),o-=((d=-x(s))*p-h*f)/(n=t*d-h*u),s-=(t*f-u*p)/n,v=(p=l.X(o)-c.X(s))*p+(f=l.Y(o)-c.Y(s))*f,S+=1;return this.generalizedNewton.t1memo=o,this.generalizedNewton.t2memo=s,Math.abs(o)<Math.abs(s)?[l.X(o),l.Y(o)]:[c.X(s),c.Y(s)]},Neville:function(l){var c=[],a=function(e){return function(o,s){var t,h,u,d=b.binomial,n=l.length,p=n-1,f=0,v=0;if(!s)for(u=1,t=0;t<n;t++)c[t]=d(p,t)*u,u*=-1;for(h=o,t=0;t<n;t++){if(h===0)return l[t][e]();u=c[t]/h,h-=1,f+=l[t][e]()*u,v+=u}return f/v}};return[a("X"),a("Y"),0,function(){return l.length-1}]},splineDef:function(l,c){var a,e,o,s=Math.min(l.length,c.length),t=[],h=[],u=[],d=[],n=[],p=[];if(s===2)return[0,0];for(e=0;e<s;e++)a={X:l[e],Y:c[e]},u.push(a);for(u.sort(function(f,v){return f.X-v.X}),e=0;e<s;e++)l[e]=u[e].X,c[e]=u[e].Y;for(e=0;e<s-1;e++)d.push(l[e+1]-l[e]);for(e=0;e<s-2;e++)n.push(6*(c[e+2]-c[e+1])/d[e+1]-6*(c[e+1]-c[e])/d[e]);for(t.push(2*(d[0]+d[1])),h.push(n[0]),e=0;e<s-3;e++)o=d[e+1]/t[e],t.push(2*(d[e+1]+d[e+2])-o*d[e+1]),h.push(n[e+1]-o*h[e]);for(p[s-3]=h[s-3]/t[s-3],e=s-4;e>=0;e--)p[e]=(h[e]-d[e+1]*p[e+1])/t[e];for(e=s-3;e>=0;e--)p[e+1]=p[e];return p[0]=0,p[s-1]=0,p},splineEval:function(l,c,a,e){var o,s,t,h,u,d,n,p=Math.min(c.length,a.length),f=1,v=!1,C=[];for(E.isArray(l)?(f=l.length,v=!0):l=[l],o=0;o<f;o++){if(l[o]<c[0]||c[o]>c[p-1])return NaN;for(s=1;s<p&&!(l[o]<=c[s]);s++);t=a[s-=1],h=(a[s+1]-a[s])/(c[s+1]-c[s])-(c[s+1]-c[s])/6*(e[s+1]+2*e[s]),u=e[s]/2,d=(e[s+1]-e[s])/(6*(c[s+1]-c[s])),n=l[o]-c[s],C.push(t+(h+(u+d*n)*n)*n)}return v?C:C[0]},generatePolynomialTerm:function(l,c,a,e){var o,s=[];for(o=c;o>=0;o--)s=s.concat(["(",l[o].toPrecision(e),")"]),o>1?s=s.concat(["*",a,"<sup>",o,"<","/sup> + "]):o===1&&(s=s.concat(["*",a," + "]));return s.join("")},lagrangePolynomial:function(l){var c=[],a=this,e=function(o,s){var t,h,u,d,n=l.length,p=0,f=0;if(!s)for(t=0;t<n;t++){for(c[t]=1,u=l[t].X(),h=0;h<n;h++)h!==t&&(c[t]*=u-l[h].X());c[t]=1/c[t]}for(t=0;t<n;t++){if(o===(u=l[t].X()))return l[t].Y();f+=d=c[t]/(o-u),p+=d*l[t].Y()}return p/f};return e.getTerm=function(o,s,t){return a.lagrangePolynomialTerm(l,o,s,t)()},e},lagrangePolynomialTerm:function(l,c,a,e){return function(){var o,s,t,h,u,d,n=l.length,p=[],f=[],v=[],C=!0;for(a=a||"x",e===void 0&&(e=" * "),o=n-1,h=0;h<n;h++)v[h]=0;for(t=0;t<n;t++){for(u=l[t].Y(),d=l[t].X(),p=[],h=0;h<n;h++)h!==t&&(u/=d-l[h].X(),p.push(l[h].X()));for(f=[1].concat(b.Vieta(p)),h=0;h<f.length;h++)v[h]+=(h%2==1?-1:1)*f[h]*u}for(s="",h=0;h<v.length;h++)u=v[h],Math.abs(u)<b.eps||(g.exists(c)&&(u=y._round10(u,-c)),C?(s+=u>0?u:"-"+-u,C=!1):s+=u>0?" + "+u:" - "+-u,o-h>1?s+=e+a+"^"+(o-h):o-h==1&&(s+=e+a));return s}},_initCubicPoly:function(l,c,a,e){return[l,a,-3*l+3*c-2*a-e,2*l-2*c+a+e]},CardinalSpline:function(l,c,a){var e,o,s,t,h=[],u=this;return t=E.isFunction(c)?c:function(){return c},a===void 0&&(a="uniform"),o=function(d){return function(n,p){var f,v,C,_,P,x,S,O,w,T;if(l.length<2)return NaN;if(!p)for(s=t(),C={X:function(){return 2*l[0].X()-l[1].X()},Y:function(){return 2*l[0].Y()-l[1].Y()},Dist:function(M){var N=this.X()-M.X(),A=this.Y()-M.Y();return Math.sqrt(N*N+A*A)}},_={X:function(){return 2*l[l.length-1].X()-l[l.length-2].X()},Y:function(){return 2*l[l.length-1].Y()-l[l.length-2].Y()},Dist:function(M){var N=this.X()-M.X(),A=this.Y()-M.Y();return Math.sqrt(N*N+A*A)}},T=(e=[C].concat(l,[_])).length,h[d]=[],f=0;f<T-3;f++)a==="centripetal"?(S=e[f].Dist(e[f+1]),O=e[f+2].Dist(e[f+1]),w=e[f+3].Dist(e[f+2]),S=Math.sqrt(S),O=Math.sqrt(O),w=Math.sqrt(w),O<b.eps&&(O=1),S<b.eps&&(S=O),w<b.eps&&(w=O),P=(e[f+1][d]()-e[f][d]())/S-(e[f+2][d]()-e[f][d]())/(O+S)+(e[f+2][d]()-e[f+1][d]())/O,x=(e[f+2][d]()-e[f+1][d]())/O-(e[f+3][d]()-e[f+1][d]())/(w+O)+(e[f+3][d]()-e[f+2][d]())/w,P*=O,x*=O,h[d][f]=u._initCubicPoly(e[f+1][d](),e[f+2][d](),s*P,s*x)):h[d][f]=u._initCubicPoly(e[f+1][d](),e[f+2][d](),s*(e[f+2][d]()-e[f][d]()),s*(e[f+3][d]()-e[f+1][d]()));return isNaN(n)?NaN:(T=l.length,n<=0?l[0][d]():n>=T?l[T-1][d]():(f=Math.floor(n))===n?l[f][d]():(n-=f,(v=h[d][f])===void 0?NaN:((v[3]*n+v[2])*n+v[1])*n+v[0]))}},[o("X"),o("Y"),0,function(){return l.length-1}]},CatmullRomSpline:function(l,c){return this.CardinalSpline(l,.5,c)},regressionPolynomial:function(l,c,a){var e,o,s,t,h,u,d="";if(E.isPoint(l)&&E.isFunction(l.Value))o=function(){return l.Value()};else if(E.isFunction(l))o=l;else{if(!E.isNumber(l))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof l+"'.");o=function(){return l}}if(arguments.length===3&&E.isArray(c)&&E.isArray(a))h=0;else if(arguments.length===2&&E.isArray(c)&&c.length>0&&E.isPoint(c[0]))h=1;else{if(!(arguments.length===2&&E.isArray(c)&&c.length>0&&c[0].usrCoords&&c[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");h=2}return(u=function(n,p){var f,v,C,_,P,x,S,O,w,T=c.length;if(w=Math.floor(o()),!p){if(h===1)for(s=[],t=[],f=0;f<T;f++)s[f]=c[f].X(),t[f]=c[f].Y();if(h===2)for(s=[],t=[],f=0;f<T;f++)s[f]=c[f].usrCoords[1],t[f]=c[f].usrCoords[2];if(h===0)for(s=[],t=[],f=0;f<T;f++)E.isFunction(c[f])?s.push(c[f]()):s.push(c[f]),E.isFunction(a[f])?t.push(a[f]()):t.push(a[f]);for(C=[],v=0;v<T;v++)C.push([1]);for(f=1;f<=w;f++)for(v=0;v<T;v++)C[v][f]=C[v][f-1]*s[v];P=t,_=b.transpose(C),x=b.matMatMult(_,C),S=b.matVecMult(_,P),e=b.Numerics.Gauss(x,S),d=b.Numerics.generatePolynomialTerm(e,w,"x",3)}for(O=e[w],f=w-1;f>=0;f--)O=O*n+e[f];return O}).getTerm=function(){return d},u},bezier:function(l){var c,a,e=function(o){return function(s,t){var h=3*Math.floor(s),u=s%1,d=1-u;return t||(a=3*Math.floor((l.length-1)/3),c=Math.floor(a/3)),s<0?l[0][o]():s>=c?l[a][o]():isNaN(s)?NaN:d*d*(d*l[h][o]()+3*u*l[h+1][o]())+(3*d*l[h+2][o]()+u*l[h+3][o]())*u*u}};return[e("X"),e("Y"),0,function(){return Math.floor(l.length/3)}]},bspline:function(l,c){var a,e=function(o){return function(s,t){var h,u,d,n,p=l.length,f=p-1,v=c;if(f<=0)return NaN;if(f+2<=v&&(v=f+1),s<=0)return l[0][o]();if(s>=f-v+2)return l[f][o]();for(d=Math.floor(s)+v-1,a=function(C,_){var P,x=[];for(P=0;P<C+_+1;P++)x[P]=P<_?0:P<=C?P-_+1:C-_+2;return x}(f,v),n=function(C,_,P,x){var S,O,w,T,M,N=[];for(_[x]<=C&&C<_[x+1]?N[x]=1:N[x]=0,S=2;S<=P;S++)for(O=x-S+1;O<=x;O++)w=O<=x-S+1||O<0?0:N[O],T=O>=x?0:N[O+1],M=_[O+S-1]-_[O],N[O]=M===0?0:(C-_[O])/M*w,(M=_[O+S]-_[O+1])!=0&&(N[O]+=(_[O+S]-C)/M*T);return N}(s,a,v,d),h=0,u=d-v+1;u<=d;u++)u<p&&u>=0&&(h+=l[u][o]()*n[u]);return h}};return[e("X"),e("Y"),0,function(){return l.length-1}]},D:function(l,c){return E.exists(c)?function(a,e){var o=1e-5;return(l.apply(c,[a+o,e])-l.apply(c,[a-o,e]))/2e-5}:function(a,e){var o=1e-5;return(l(a+o,e)-l(a-o,e))/2e-5}},_riemannValue:function(l,c,a,e){var o,s,t,h;if(e<0&&(a!=="trapezoidal"&&(l+=e),e*=-1,a==="lower"?a="upper":a==="upper"&&(a="lower")),h=.01*e,a==="right")o=c(l+e);else if(a==="middle")o=c(l+.5*e);else if(a==="left"||a==="trapezoidal")o=c(l);else if(a==="lower"){for(o=c(l),t=l+h;t<=l+e;t+=h)(s=c(t))<o&&(o=s);(s=c(l+e))<o&&(o=s)}else if(a==="upper"){for(o=c(l),t=l+h;t<=l+e;t+=h)(s=c(t))>o&&(o=s);(s=c(l+e))>o&&(o=s)}else o=a==="random"?c(l+e*Math.random()):a==="simpson"?(c(l)+4*c(l+.5*e)+c(l+e))/6:c(l);return o},riemann:function(l,c,a,e,o){var s,t,h,u,d,n,p,f=[],v=[],C=0,_=e,P=0;if(E.isArray(l)?(d=l[0],u=l[1]):u=l,(c=Math.floor(c))<=0)return[f,v,P];for(t=(o-e)/c,s=0;s<c;s++)h=this._riemannValue(_,u,a,t),f[C]=_,v[C]=h,C+=1,_+=t,a==="trapezoidal"&&(h=u(_)),f[C]=_,v[C]=h,C+=1;for(s=0;s<c;s++)h=d?this._riemannValue(_,d,a,-t):0,f[C]=_,v[C]=h,C+=1,_-=t,a==="trapezoidal"&&d&&(h=d(_)),f[C]=_,v[C]=h,a!=="trapezoidal"?(n=h,p=v[2*(c-1)-2*s]):(p=.5*(u(_+t)+u(_)),n=d?.5*(d(_+t)+d(_)):0),P+=(p-n)*t,f[C+=1]=_,v[C]=v[2*(c-1)-2*s],C+=1;return[f,v,P]},riemannsum:function(l,c,a,e,o){return g.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(l,c,a,e,o)[2]},rungeKutta:function(l,c,a,e,o){var s,t,h,u,d,n,p=[],f=[],v=(a[1]-a[0])/e,C=a[0],_=c.length,P=[],x=0;for(E.isString(l)&&(l=m[l]||m.euler),n=l.s,s=0;s<_;s++)p[s]=c[s];for(t=0;t<e;t++){for(P[x]=[],s=0;s<_;s++)P[x][s]=p[s];for(x+=1,u=[],h=0;h<n;h++){for(s=0;s<_;s++)f[s]=0;for(d=0;d<h;d++)for(s=0;s<_;s++)f[s]+=l.A[h][d]*v*u[d][s];for(s=0;s<_;s++)f[s]+=p[s];u.push(o(C+l.c[h]*v,f))}for(s=0;s<_;s++)f[s]=0;for(d=0;d<n;d++)for(s=0;s<_;s++)f[s]+=l.b[d]*u[d][s];for(s=0;s<_;s++)p[s]=p[s]+v*f[s];C+=v}return P},maxIterationsRoot:80,maxIterationsMinimize:500,findBracket:function(l,c,a){var e,o,s,t,h,u,d,n,p,f;if(E.isArray(c))return c;for(e=c,s=l.call(a,e),f=(t=[e-.1*(o=e===0?1:e),e+.1*o,e-1,e+1,e-.5*o,e+.5*o,e-.6*o,e+.6*o,e-1*o,e+1*o,e-2*o,e+2*o,e-5*o,e+5*o,e-10*o,e+10*o,e-50*o,e+50*o,e-100*o,e+100*o]).length,p=0;p<f&&(h=t[p],!(s*(u=l.call(a,h))<=0));p++);return h<e&&(d=e,e=h,h=d,n=s,s=u,u=n),[e,s,h,u]},fzero:function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S=b.eps,O=this.maxIterationsRoot,w=0;if(E.isArray(c)){if(c.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");e=c[0],t=l.call(a,e),o=c[1],h=l.call(a,o)}else e=(d=this.findBracket(l,c,a))[0],t=d[1],o=d[2],h=d[3];if(Math.abs(t)<=S)return e;if(Math.abs(h)<=S)return o;if(t*h>0)return E.isArray(c)?this.fminbr(l,[e,o],a):this.Newton(l,e,a);for(s=e,u=t;w<O;){if(n=o-e,Math.abs(u)<Math.abs(h)&&(e=o,o=s,s=e,t=h,h=u,u=t),C=2*S*Math.abs(o)+.5*S,x=.5*(s-o),Math.abs(x)<=C||Math.abs(h)<=S)return o;Math.abs(n)>=C&&Math.abs(t)>Math.abs(h)&&(f=s-o,e===s?(_=f*(p=h/t),P=1-p):(_=(v=h/t)*(f*(P=t/u)*(P-(p=h/u))-(o-e)*(p-1)),P=(P-1)*(p-1)*(v-1)),_>0?P=-P:_=-_,_<.75*f*P-.5*Math.abs(C*P)&&_<Math.abs(n*P*.5)&&(x=_/P)),Math.abs(x)<C&&(x=x>0?C:-C),e=o,t=h,o+=x,((h=l.call(a,o))>0&&u>0||h<0&&u<0)&&(s=e,u=t),w++}return o},chandrupatla:function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N=0,A=this.maxIterationsRoot,R=1+.001*Math.random(),L=.5*R,D=b.eps;if(E.isArray(c)){if(c.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");e=c[0],o=l.call(a,e),s=c[1],t=l.call(a,s)}else e=(h=this.findBracket(l,c,a))[0],o=h[1],s=h[2],t=h[3];if(o*t>0)return E.isArray(c)?this.fminbr(l,[e,s],a):this.Newton(l,e,a);u=e,d=s,f=o,v=t;do{if(p=u+L*(d-u),_=l.call(a,p),Math.sign(_)===Math.sign(f)?(n=u,u=p,C=f,f=_):(n=d,d=u,C=v,v=f),P=u=p,x=f=_,Math.abs(v)<Math.abs(f)&&(P=d,x=v),(S=(2*D*Math.abs(P)+5e-6)/Math.abs(d-u))>.5||x===0)break;O=(u-d)/(n-d),w=(f-v)/(C-v),T=1-Math.sqrt(1-O),M=Math.sqrt(O),(L=T<w&&w<M?f/(v-f)*(C/(v-C))+f/(C-f)*(v/(C-v))*((n-u)/(d-u)):.5*R)<S&&(L=S),L>1-S&&(L=1-S),N++}while(N<=A);return P},fminbr:function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O=.5*(3-Math.sqrt(5)),w=b.eps,T=b.eps,M=this.maxIterationsMinimize,N=0;if(!E.isArray(c)||c.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(s=t=(e=c[0])+O*((o=c[1])-e),h=t,u=d=l.call(a,t),n=d;N<M;){if(p=o-e,f=.5*(e+o),v=T*Math.abs(s)+w/3,Math.abs(s-f)+.5*p<=2*v)return s;C=O*(s<f?o-s:e-s),Math.abs(s-h)>=v&&(_=(s-t)*(P=(s-t)*(u-n))-(s-h)*(x=(s-h)*(u-d)),(P=2*(P-x))>0?_=-_:P=-P,Math.abs(_)<Math.abs(C*P)&&_>P*(e-s+2*v)&&_<P*(o-s-2*v)&&(C=_/P)),Math.abs(C)<v&&(C=C>0?v:-v),x=s+C,(S=l.call(a,x))<=u?(x<s?o=s:e=s,t=h,h=s,s=x,d=n,n=u,u=S):(x<s?e=x:o=x,S<=n||h===s?(t=h,h=x,d=n,n=S):(S<=d||t===s||t===h)&&(t=x,d=S)),N+=1}return s},RamerDouglasPeucker:function(l,c){var a,e,o,s=[],t=[],h=function(u,d,n,p,f){var v=function(_,P,x){var S,O,w,T,M,N,A,R,L,D,k,B=1e4,j=0,I=P;if(x-P<2)return[-1,0];if(w=_[P].scrCoords,T=_[x].scrCoords,isNaN(w[1])||isNaN(w[2]))return[NaN,P];if(isNaN(T[1])||isNaN(T[2]))return[NaN,x];for(O=P+1;O<x;O++){if(M=_[O].scrCoords,isNaN(M[1])||isNaN(M[2]))return[NaN,O];N=(N=(N=M[1]-w[1])==1/0?B:N)===-1/0?-B:N,A=(A=(A=M[2]-w[2])==1/0?B:A)===-1/0?-B:A,(D=(R=(R=(R=T[1]-w[1])==1/0?B:R)===-1/0?-B:R)*R+(L=(L=(L=T[2]-w[2])==1/0?B:L)===-1/0?-B:L)*L)>=b.eps?((k=(N*R+A*L)/D)<0?k=0:k>1&&(k=1),S=(N-=k*R)*N+(A-=k*L)*A):(k=0,S=N*N+A*A),S>j&&(j=S,I=O)}return[Math.sqrt(j),I]}(u,d,n),C=v[1];if(isNaN(v[0])){h(u,d,C-1,p,f),f.push(u[C]);do++C;while(C<=n&&isNaN(u[C].scrCoords[1]+u[C].scrCoords[2]));C<=n&&f.push(u[C]),h(u,C+1,n,p,f)}else v[0]>p?(h(u,d,C,p,f),h(u,C,n,p,f)):f.push(u[n])};for(o=l.length,a=0;;){for(;a<o&&isNaN(l[a].scrCoords[1]+l[a].scrCoords[2]);)a+=1;for(e=a+1;e<o&&!isNaN(l[e].scrCoords[1]+l[e].scrCoords[2]);)e+=1;if(e--,a<o&&e>a&&((t=[])[0]=l[a],h(l,a,e,c,t),s=s.concat(t)),a>=o)break;e<o-1&&s.push(l[e+1]),a=e+1}return s},RamerDouglasPeuker:function(l,c){return g.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(l,c)},Visvalingam:function(l,c){var a,e,o,s,t,h,u,d,n,p=[],f=[],v=[];if((e=l.length)<=2)return l;for(p[0]={used:!0,lft:null,node:null},t=0,a=1;a<e-1;a++)o=Math.abs(g.Math.Numerics.det([l[a-1].usrCoords,l[a].usrCoords,l[a+1].usrCoords])),isNaN(o)||(n={v:o,idx:a},f.push(n),p[a]={used:!0,lft:t,node:n},p[t].rt=a,t=a);for(p[e-1]={used:!0,rt:null,lft:t,node:null},p[t].rt=e-1,s=-1/0;f.length>c;)f.sort(function(C,_){return _.v-C.v}),p[a=f.pop().idx].used=!1,s=p[a].node.v,t=p[a].lft,h=p[a].rt,p[t].rt=h,p[h].lft=t,(u=p[t].lft)!==null&&(o=Math.abs(g.Math.Numerics.det([l[u].usrCoords,l[t].usrCoords,l[h].usrCoords])),p[t].node.v=o>=s?o:s),(d=p[h].rt)!==null&&(o=Math.abs(g.Math.Numerics.det([l[t].usrCoords,l[h].usrCoords,l[d].usrCoords])),p[h].node.v=o>=s?o:s);v=[l[a=0]];do a=p[a].rt,v.push(l[a]);while(p[a].rt!==null);return v}},b.Numerics}),define("math/nlp",["jxg","utils/type"],function(g,E){return g.Math.Nlp={arr:function(y){return new Float64Array(y)},arr2:function(y,b){for(var m=0,l=new Array(y);m<y;)l[m]=this.arr(b),m++;return l},arraycopy:function(y,b,m,l,c){for(var a=0;a<c;)m[a+l]=y[a+b],a++},Normal:0,MaxIterationsReached:1,DivergingRoundingErrors:2,FindMinimum:function(y,b,m,l,c,a,e,o){var s,t,h=m+2,u=this.arr(b+1),d=this;return u[0]=0,this.arraycopy(l,0,u,1,b),t=function(n,p,f,v){var C,_,P=d.arr(n);return d.arraycopy(f,1,P,0,n),C=d.arr(p),_=y(n,p,P,C),d.arraycopy(C,0,v,1,p),_},s=this.cobylb(t,b,m,h,u,c,a,e,o),this.arraycopy(u,1,l,0,b),s},cobylb:function(y,b,m,l,c,a,e,o,s){var t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A,R,L,D,k,B,j,I,q,$,Z=-1,V=0,U=0,J=b+1,z=m+1,X=a,G=0,Q=!1,ie=!1,ce=0,he=0,ae=0,oe=this.arr(1+l),H=this.arr2(1+b,1+J),de=this.arr2(1+b,1+b),ne=this.arr2(1+l,1+J),ge=this.arr2(1+b,1+z),fe=this.arr(1+b),ye=this.arr(1+b),Ce=this.arr(1+b),ue=this.arr(1+b),Pe=this.arr(1+b);for(o>=2&&console.log("The initial value of RHO is "+X+" and PARMU is set to zero."),v=0,p=1/X,h=1;h<=b;++h)H[h][J]=c[h],H[h][h]=X,de[h][h]=p;C=J,_=!1;e:for(;;){if(v>=s&&v>0){Z=this.MaxIterationsReached;break e}for(++v,V=y(b,m,c,oe),U=0,d=1;d<=m;++d)U=Math.max(U,-oe[d]);if(v!==o-1&&o!==3||this.PrintIterationResult(v,V,U,c,b,o),oe[z]=V,oe[l]=U,P=!0,!_){for(P=!1,h=1;h<=l;++h)ne[h][C]=oe[h];if(v<=J){if(C<=b)if(ne[z][J]<=V)c[C]=H[C][J];else{for(H[C][J]=c[C],d=1;d<=l;++d)ne[d][C]=ne[d][J],ne[d][J]=oe[d];for(d=1;d<=C;++d){for(H[C][d]=-X,p=0,h=d;h<=C;++h)p-=de[h][d];de[C][d]=p}}if(v<=b){c[C=v]+=X;continue e}}_=!0}t:for(;;){i:do{if(!P){for(x=ne[z][J]+G*ne[l][J],S=J,u=1;u<=b;++u)(p=ne[z][u]+G*ne[l][u])<x?(S=u,x=p):p===x&&G===0&&ne[l][u]<ne[l][S]&&(S=u);if(S<=b){for(h=1;h<=l;++h)p=ne[h][J],ne[h][J]=ne[h][S],ne[h][S]=p;for(h=1;h<=b;++h){for(p=H[h][S],H[h][S]=0,H[h][J]+=p,f=0,d=1;d<=b;++d)H[h][d]-=p,f-=de[d][h];de[S][h]=f}}for(d=1;d<=z;++d){for(oe[d]=-ne[d][J],u=1;u<=b;++u)Pe[u]=ne[d][u]+oe[d];for(h=1;h<=b;++h)ge[h][d]=(d===z?-1:1)*this.DOT_PRODUCT_ROW_COL(Pe,-1,de,h,1,b)}for(Q=!0,ce=.25*X,O=2.1*X,u=1;u<=b;++u){for(w=0,T=0,d=1;d<=b;++d)w+=de[u][d]*de[u][d],T+=H[d][u]*H[d][u];fe[u]=1/Math.sqrt(w),ye[u]=Math.sqrt(T),(fe[u]<ce||ye[u]>O)&&(Q=!1)}if(!_&&!Q){for(C=0,p=O,u=1;u<=b;++u)ye[u]>p&&(C=u,p=ye[u]);if(C===0)for(u=1;u<=b;++u)fe[u]<p&&(C=u,p=fe[u]);for(p=.5*X*fe[C],d=1;d<=b;++d)ue[d]=p*de[C][d];for(M=0,N=0,t=0,d=1;d<=z;++d)t=this.DOT_PRODUCT_ROW_COL(ue,-1,ge,d,1,b),d<z&&(p=ne[d][J],M=Math.max(M,-t-p),N=Math.max(N,t-p));for(A=G*(M-N)>2*t?-1:1,p=0,h=1;h<=b;++h)ue[h]=A*ue[h],H[h][C]=ue[h],p+=de[C][h]*ue[h];for(d=1;d<=b;++d)de[C][d]/=p;for(u=1;u<=b;++u){if(u!==C)for(p=this.DOT_PRODUCT_ROW_COL(de,u,ue,-1,1,b),d=1;d<=b;++d)de[u][d]-=p*de[C][d];c[u]=H[u][J]+ue[u]}continue e}if(!(ie=this.trstlp(b,m,ge,oe,X,ue))){for(p=0,d=1;d<=b;++d)p+=ue[d]*ue[d];if(p<.25*X*X){_=!0;break i}}for(t=0,R=0,oe[z]=0,d=1;d<=z;++d)t=oe[d]-this.DOT_PRODUCT_ROW_COL(ue,-1,ge,d,1,b),d<z&&(R=Math.max(R,t));if(G<1.5*(L=(he=ne[l][J]-R)>0?t/he:0)){for(G=2*L,o>=2&&console.log("Increase in PARMU to "+G),D=ne[z][J]+G*ne[l][J],u=1;u<=b;++u)if((p=ne[z][u]+G*ne[l][u])<D||p===D&&G===0&&ne[l][u]<ne[l][J])continue t}for(ae=G*he-t,d=1;d<=b;++d)c[d]=H[d][J]+ue[d];_=!0;continue e}for(P=!1,k=ne[z][J]+G*ne[l][J]-(V+G*U),G===0&&V===ne[z][J]&&(ae=he,k=ne[l][J]-U),B=k<=0?1:0,C=0,u=1;u<=b;++u)(p=Math.abs(this.DOT_PRODUCT_ROW_COL(de,u,ue,-1,1,b)))>B&&(C=u,B=p),Ce[u]=p*fe[u];for(j=1.1*X,n=0,u=1;u<=b;++u)if(Ce[u]>=ce||Ce[u]>=fe[u]){if(p=ye[u],k>0){for(p=0,d=1;d<=b;++d)p+=Math.pow(ue[d]-H[d][u],2);p=Math.sqrt(p)}p>j&&(n=u,j=p)}if(n>0&&(C=n),C!==0){for(p=0,h=1;h<=b;++h)H[h][C]=ue[h],p+=de[C][h]*ue[h];for(d=1;d<=b;++d)de[C][d]/=p;for(u=1;u<=b;++u)if(u!==C)for(p=this.DOT_PRODUCT_ROW_COL(de,u,ue,-1,1,b),d=1;d<=b;++d)de[u][d]-=p*de[C][d];for(d=1;d<=l;++d)ne[d][C]=oe[d];if(k>0&&k>=.1*ae)continue t}}while(0);if(Q){if(X<=e){Z=this.Normal;break e}if(I=0,q=0,(X*=.5)<=1.5*e&&(X=e),G>0){for($=0,d=1;d<=z;++d){for(q=I=ne[d][J],h=1;h<=b;++h)I=Math.min(I,ne[d][h]),q=Math.max(q,ne[d][h]);d<=m&&I<.5*q&&(p=Math.max(q,0)-I,$=$<=0?p:Math.min($,p))}$===0?G=0:q-I<G*$&&(G=(q-I)/$)}o>=2&&console.log("Reduction in RHO to "+X+"  and PARMU = "+G),o===2&&this.PrintIterationResult(v,ne[z][J],ne[l][J],this.COL(H,J),b,o)}else _=!1}}switch(Z){case this.Normal:if(o>=1&&console.log("%nNormal return from subroutine COBYLA%n"),ie)return o>=1&&this.PrintIterationResult(v,V,U,c,b,o),Z;break;case this.MaxIterationsReached:o>=1&&console.log("%nReturn from subroutine COBYLA because the MAXFUN limit has been reached.%n");break;case this.DivergingRoundingErrors:o>=1&&console.log("%nReturn from subroutine COBYLA because rounding errors are becoming damaging.%n")}for(d=1;d<=b;++d)c[d]=H[d][J];return V=ne[z][J],U=ne[l][J],o>=1&&this.PrintIterationResult(v,V,U,c,b,o),Z},trstlp:function(y,b,m,l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A,R,L,D,k,B,j,I,q,$,Z,V,U=0,J=0,z=0,X=this.arr2(1+y,1+y),G=this.arr(2+b),Q=this.arr(2+b),ie=this.arr(1+y),ce=this.arr(1+y),he=this.arr(2+b),ae=this.arr(2+b),oe=b,H=0;for(s=1;s<=y;++s)X[s][s]=1,a[s]=0;if(e=0,o=0,b>=1){for(t=1;t<=b;++t)l[t]>o&&(o=l[t],e=t);for(t=1;t<=b;++t)ae[t]=t,Q[t]=o-l[t]}h=!0;do{e:for(;;){(!h||h&&o===0)&&(e=oe=b+1,ae[oe]=oe,Q[oe]=0),h=!1,u=0,d=0,n=0,p=0;t:do{if(f=oe===b?o:-this.DOT_PRODUCT_ROW_COL(a,-1,m,oe,1,y),d===0||f<u?(u=f,J=H,d=3):H>J?(J=H,d=3):--d,d===0)break e;if(v=0,e<=H){if(e<H){C=ae[e],_=Q[e],t=e;do{for(S=ae[x=t+1],O=this.DOT_PRODUCT(this.PART(this.COL(X,t),1,y),this.PART(this.COL(m,S),1,y)),U=Math.sqrt(O*O+G[x]*G[x]),w=G[x]/U,T=O/U,G[x]=w*G[t],G[t]=U,s=1;s<=y;++s)U=w*X[s][x]+T*X[s][t],X[s][x]=w*X[s][t]-T*X[s][x],X[s][t]=U;ae[t]=S,Q[t]=Q[x],t=x}while(t<H);ae[t]=C,Q[t]=_}if(--H,oe>b)for(U=1/G[H],t=1;t<=y;++t)ie[t]=U*X[t][H];else for(U=this.DOT_PRODUCT_ROW_COL(ie,-1,X,H+1,1,y),t=1;t<=y;++t)ie[t]-=U*X[t][H+1]}else{for(S=ae[e],t=1;t<=y;++t)ce[t]=m[t][S];for(M=0,t=y;t>H;){for(O=0,N=0,s=1;s<=y;++s)O+=U=X[s][t]*ce[s],N+=Math.abs(U);if(A=N+.1*Math.abs(O),R=N+.2*Math.abs(O),(N>=A||A>=R)&&(O=0),M===0)M=O;else for(x=t+1,w=O/(U=Math.sqrt(O*O+M*M)),T=M/U,M=U,s=1;s<=y;++s)U=w*X[s][t]+T*X[s][x],X[s][x]=w*X[s][x]-T*X[s][t],X[s][t]=U;--t}if(M===0){v=-1,t=H;do{for(L=0,D=0,s=1;s<=y;++s)L+=U=X[s][t]*ce[s],D+=Math.abs(U);if(A=D+.1*Math.abs(L),R=D+.2*Math.abs(L),D<A&&A<R){if((U=L/G[t])>0&&ae[t]<=b&&(V=Q[t]/U,(v<0||V<v)&&(v=V)),t>=2)for(k=ae[t],s=1;s<=y;++s)ce[s]-=U*m[s][k];he[t]=U}else he[t]=0}while(--t>0);if(v<0)break e;for(t=1;t<=H;++t)Q[t]=Math.max(0,Q[t]-v*he[t]);if(e<H){C=ae[e],_=Q[e],t=e;do{for(k=ae[x=t+1],O=this.DOT_PRODUCT(this.PART(this.COL(X,t),1,y),this.PART(this.COL(m,k),1,y)),U=Math.sqrt(O*O+G[x]*G[x]),w=G[x]/U,T=O/U,G[x]=w*G[t],G[t]=U,s=1;s<=y;++s)U=w*X[s][x]+T*X[s][t],X[s][x]=w*X[s][t]-T*X[s][x],X[s][t]=U;ae[t]=k,Q[t]=Q[x],t=x}while(t<H);ae[t]=C,Q[t]=_}if((U=this.DOT_PRODUCT(this.PART(this.COL(X,H),1,y),this.PART(this.COL(m,S),1,y)))===0)break e;G[H]=U,Q[e]=0,Q[H]=v}else G[++H]=M,Q[e]=Q[H],Q[H]=0;if(ae[e]=ae[H],ae[H]=S,oe>b&&S!==oe){for(t=H-1,O=this.DOT_PRODUCT(this.PART(this.COL(X,t),1,y),this.PART(this.COL(m,S),1,y)),U=Math.sqrt(O*O+G[H]*G[H]),w=G[H]/U,T=O/U,G[H]=w*G[t],G[t]=U,s=1;s<=y;++s)U=w*X[s][H]+T*X[s][t],X[s][H]=w*X[s][t]-T*X[s][H],X[s][t]=U;ae[H]=ae[t],ae[t]=S,U=Q[t],Q[t]=Q[H],Q[H]=U}if(oe>b)for(U=1/G[H],t=1;t<=y;++t)ie[t]=U*X[t][H];else for(S=ae[H],U=(this.DOT_PRODUCT_ROW_COL(ie,-1,m,S,1,y)-1)/G[H],t=1;t<=y;++t)ie[t]-=U*X[t][H]}for(B=c*c,I=0,j=0,s=1;s<=y;++s)Math.abs(a[s])>=1e-6*c&&(B-=a[s]*a[s]),I+=a[s]*ie[s],j+=ie[s]*ie[s];if(B<=0)break e;if(U=Math.sqrt(j*B),Math.abs(I)>=1e-6*U&&(U=Math.sqrt(j*B+I*I)),n=p=B/(U+I),oe===b){if(R=n+.2*o,n>=(A=n+.1*o)||A>=R)break t;n=Math.min(n,o)}for(t=1;t<=y;++t)ce[t]=a[t]+n*ie[t];if(oe===b)for(z=o,o=0,t=1;t<=H;++t)U=l[S=ae[t]]-this.DOT_PRODUCT_ROW_COL(ce,-1,m,S,1,y),o=Math.max(o,U);t=H;do{for(q=0,$=0,s=1;s<=y;++s)q+=U=X[s][t]*ce[s],$+=Math.abs(U);if(A=$+.1*Math.abs(q),R=$+.2*Math.abs(q),($>=A||A>=R)&&(q=0),he[t]=q/G[t],t>=2)for(S=ae[t],s=1;s<=y;++s)ce[s]-=he[t]*m[s][S]}while(t-->=2);for(oe>b&&(he[H]=Math.max(0,he[H])),t=1;t<=y;++t)ce[t]=a[t]+n*ie[t];if(oe>H)for(t=H+1;t<=oe;++t){for(P=o-l[S=ae[t]],Z=o+Math.abs(l[S]),s=1;s<=y;++s)P+=U=m[s][S]*ce[s],Z+=Math.abs(U);A=Z+.1*Math.abs(P),R=Z+.2*Math.abs(P),(Z>=A||A>=R)&&(P=0),he[t]=P}for(v=1,e=0,t=1;t<=oe;++t)he[t]<0&&(U=Q[t]/(Q[t]-he[t]))<v&&(v=U,e=t);for(U=1-v,t=1;t<=y;++t)a[t]=U*a[t]+v*ce[t];for(t=1;t<=oe;++t)Q[t]=Math.max(0,U*Q[t]+v*he[t]);oe===b&&(o=z+v*(o-z))}while(e>0);if(n===p)return!0}}while(oe===b);return!1},PrintIterationResult:function(y,b,m,l,c,a){a>1&&console.log("NFVALS = "+y+"  F = "+b+"  MAXCV = "+m),a>1&&console.log("X = "+this.PART(l,1,c))},ROW:function(y,b){return y[b].slice()},COL:function(y,b){var m,l=y.length,c=[];for(m=0;m<l;++m)c[m]=y[m][b];return c},PART:function(y,b,m){return y.slice(b,m+1)},FORMAT:function(y){return y.join(",")},DOT_PRODUCT:function(y,b){var m,l=0,c=y.length;for(m=0;m<c;++m)l+=y[m]*b[m];return l},DOT_PRODUCT_ROW_COL:function(y,b,m,l,c,a){var e,o=0;if(b===-1)for(e=c;e<=a;++e)o+=y[e]*m[e][l];else if(l===-1)for(e=c;e<=a;++e)o+=y[b][e]*m[e];else for(e=c;e<=a;++e)o+=y[b][e]*m[e][l];return o}},g.Math.Nlp}),define("math/statistics",["jxg","math/math","utils/type"],function(g,E,y){return E.Statistics={sum:function(b){var m,l=b.length,c=0;for(m=0;m<l;m++)c+=b[m];return c},prod:function(b){var m,l=b.length,c=1;for(m=0;m<l;m++)c*=b[m];return c},mean:function(b){return b.length>0?this.sum(b)/b.length:0},median:function(b){var m,l;return b.length>0?(ArrayBuffer.isView(b)?(m=new Float64Array(b)).sort():(m=b.slice(0)).sort(function(c,a){return c-a}),1&(l=m.length)?m[parseInt(.5*l,10)]:.5*(m[.5*l-1]+m[.5*l])):0},percentile:function(b,m){var l,c,a,e,o,s=[];if(b.length>0){for(ArrayBuffer.isView(b)?(l=new Float64Array(b)).sort():(l=b.slice(0)).sort(function(t,h){return t-h}),c=l.length,e=y.isArray(m)?m:[m],a=0;a<e.length;a++)o=c*e[a]*.01,parseInt(o,10)===o?s.push(.5*(l[o-1]+l[o])):s.push(l[parseInt(o,10)]);return y.isArray(m)?s:s[0]}return 0},variance:function(b){var m,l,c,a=b.length;if(a>1){for(m=this.mean(b),l=0,c=0;c<a;c++)l+=(b[c]-m)*(b[c]-m);return l/(b.length-1)}return 0},sd:function(b){return Math.sqrt(this.variance(b))},weightedMean:function(b,m){if(b.length!==m.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return b.length>0?this.mean(this.multiply(b,m)):0},max:function(b){return Math.max.apply(this,b)},min:function(b){return Math.min.apply(this,b)},range:function(b){return[this.min(b),this.max(b)]},abs:function(b){var m,l,c;if(y.isArray(b))if(b.map)c=b.map(Math.abs);else for(l=b.length,c=[],m=0;m<l;m++)c[m]=Math.abs(b[m]);else c=ArrayBuffer.isView(b)?b.map(Math.abs):Math.abs(b);return c},add:function(b,m){var l,c,a=[];if(b=y.evalSlider(b),m=y.evalSlider(m),y.isArray(b)&&y.isNumber(m))for(c=b.length,l=0;l<c;l++)a[l]=b[l]+m;else if(y.isNumber(b)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)a[l]=b+m[l];else if(y.isArray(b)&&y.isArray(m))for(c=Math.min(b.length,m.length),l=0;l<c;l++)a[l]=b[l]+m[l];else a=b+m;return a},div:function(b,m){var l,c,a=[];if(b=y.evalSlider(b),m=y.evalSlider(m),y.isArray(b)&&y.isNumber(m))for(c=b.length,l=0;l<c;l++)a[l]=b[l]/m;else if(y.isNumber(b)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)a[l]=b/m[l];else if(y.isArray(b)&&y.isArray(m))for(c=Math.min(b.length,m.length),l=0;l<c;l++)a[l]=b[l]/m[l];else a=b/m;return a},divide:function(){g.deprecated("Statistics.divide()","Statistics.div()"),E.Statistics.div.apply(E.Statistics,arguments)},mod:function(b,m,l){var c,a,e=[],o=function(s,t){return s%t};if((l=y.def(l,!1))&&(o=E.mod),b=y.evalSlider(b),m=y.evalSlider(m),y.isArray(b)&&y.isNumber(m))for(a=b.length,c=0;c<a;c++)e[c]=o(b[c],m);else if(y.isNumber(b)&&y.isArray(m))for(a=m.length,c=0;c<a;c++)e[c]=o(b,m[c]);else if(y.isArray(b)&&y.isArray(m))for(a=Math.min(b.length,m.length),c=0;c<a;c++)e[c]=o(b[c],m[c]);else e=o(b,m);return e},multiply:function(b,m){var l,c,a=[];if(b=y.evalSlider(b),m=y.evalSlider(m),y.isArray(b)&&y.isNumber(m))for(c=b.length,l=0;l<c;l++)a[l]=b[l]*m;else if(y.isNumber(b)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)a[l]=b*m[l];else if(y.isArray(b)&&y.isArray(m))for(c=Math.min(b.length,m.length),l=0;l<c;l++)a[l]=b[l]*m[l];else a=b*m;return a},subtract:function(b,m){var l,c,a=[];if(b=y.evalSlider(b),m=y.evalSlider(m),y.isArray(b)&&y.isNumber(m))for(c=b.length,l=0;l<c;l++)a[l]=b[l]-m;else if(y.isNumber(b)&&y.isArray(m))for(c=m.length,l=0;l<c;l++)a[l]=b-m[l];else if(y.isArray(b)&&y.isArray(m))for(c=Math.min(b.length,m.length),l=0;l<c;l++)a[l]=b[l]-m[l];else a=b-m;return a},TheilSenRegression:function(b){var m,l,c=[],a=[],e=[];for(m=0;m<b.length;m++){for(a.length=0,l=0;l<b.length;l++)Math.abs(b[l].usrCoords[1]-b[m].usrCoords[1])>E.eps&&(a[l]=(b[l].usrCoords[2]-b[m].usrCoords[2])/(b[l].usrCoords[1]-b[m].usrCoords[1]));c[m]=this.median(a),e.push(b[m].usrCoords[2]-c[m]*b[m].usrCoords[1])}return[this.median(e),this.median(c),-1]},generateGaussian:function(b,m){var l,c,a;if(this.hasSpare)return this.hasSpare=!1,this.spare*m+b;do a=(l=2*Math.random()-1)*l+(c=2*Math.random()-1)*c;while(a>=1||a===0);return a=Math.sqrt(-2*Math.log(a)/a),this.spare=c*a,this.hasSpare=!0,b+m*l*a}},E.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(g,E,y,b,m,l,c){return b.Geometry={},g.extend(b.Geometry,{angle:function(a,e,o){var s,t,h,u,d=[],n=[],p=[];return g.deprecated("Geometry.angle()","Geometry.rad()"),a.coords?(d[0]=a.coords.usrCoords[1],d[1]=a.coords.usrCoords[2]):(d[0]=a[0],d[1]=a[1]),e.coords?(n[0]=e.coords.usrCoords[1],n[1]=e.coords.usrCoords[2]):(n[0]=e[0],n[1]=e[1]),o.coords?(p[0]=o.coords.usrCoords[1],p[1]=o.coords.usrCoords[2]):(p[0]=o[0],p[1]=o[1]),s=d[0]-n[0],t=d[1]-n[1],h=p[0]-n[0],u=p[1]-n[1],Math.atan2(s*u-t*h,s*h+t*u)},trueAngle:function(a,e,o){return 57.29577951308232*this.rad(a,e,o)},rad:function(a,e,o){var s,t,h,u,d,n,p;return a.coords?(s=a.coords.usrCoords[1],t=a.coords.usrCoords[2]):(s=a[0],t=a[1]),e.coords?(h=e.coords.usrCoords[1],u=e.coords.usrCoords[2]):(h=e[0],u=e[1]),o.coords?(d=o.coords.usrCoords[1],n=o.coords.usrCoords[2]):(d=o[0],n=o[1]),(p=Math.atan2(n-u,d-h)-Math.atan2(t-u,s-h))<0&&(p+=6.283185307179586),p},angleBisector:function(a,e,o,s){var t,h,u,d,n,p=a.coords.usrCoords,f=e.coords.usrCoords,v=o.coords.usrCoords;return l.exists(s)||(s=a.board),f[0]===0?new y(E.COORDS_BY_USER,[1,.5*(p[1]+v[1]),.5*(p[2]+v[2])],s):(d=p[1]-f[1],n=p[2]-f[2],t=Math.atan2(n,d),d=v[1]-f[1],n=v[2]-f[2],u=.5*(t+(h=Math.atan2(n,d))),t>h&&(u+=Math.PI),d=Math.cos(u)+f[1],n=Math.sin(u)+f[2],new y(E.COORDS_BY_USER,[1,d,n],s))},reflection:function(a,e,o){var s,t,h,u,d,n,p=e.coords.usrCoords,f=a.point1.coords.usrCoords,v=a.point2.coords.usrCoords;return l.exists(o)||(o=e.board),u=v[1]-f[1],d=v[2]-f[2],s=p[1]-f[1],n=(u*(p[2]-f[2])-d*s)/(u*u+d*d),t=p[1]+2*n*d,h=p[2]-2*n*u,new y(E.COORDS_BY_USER,[t,h],o)},rotation:function(a,e,o,s){var t,h,u,d,n,p,f=e.coords.usrCoords,v=a.coords.usrCoords;return l.exists(s)||(s=e.board),t=f[1]-v[1],h=f[2]-v[2],n=t*(u=Math.cos(o))-h*(d=Math.sin(o))+v[1],p=t*d+h*u+v[2],new y(E.COORDS_BY_USER,[n,p],s)},perpendicular:function(a,e,o){var s,t,h,u,d,n=a.point1.coords.usrCoords,p=a.point2.coords.usrCoords,f=e.coords.usrCoords;return l.exists(o)||(o=e.board),e===a.point1?(s=n[1]+p[2]-n[2],t=n[2]-p[1]+n[1],d=n[0]*p[0],Math.abs(d)<b.eps&&(s=p[2],t=-p[1]),u=[d,s,t],h=!0):e===a.point2?(s=p[1]+n[2]-p[2],t=p[2]-n[1]+p[1],d=n[0]*p[0],Math.abs(d)<b.eps&&(s=n[2],t=-n[1]),u=[d,s,t],h=!1):Math.abs(b.innerProduct(f,a.stdform,3))<b.eps?(s=f[1]+p[2]-f[2],t=f[2]-p[1]+f[1],d=p[0],Math.abs(d)<b.eps&&(s=p[2],t=-p[1]),h=!0,Math.abs(d)>b.eps&&Math.abs(s-f[1])<b.eps&&Math.abs(t-f[2])<b.eps&&(s=f[1]+n[2]-f[2],t=f[2]-n[1]+f[1],h=!1),u=[d,s,t]):(u=[0,a.stdform[1],a.stdform[2]],u=b.crossProduct(u,f),u=b.crossProduct(u,a.stdform),h=!0),[new y(E.COORDS_BY_USER,u,o),h]},circumcenterMidpoint:function(){g.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(a,e,o,s){var t,h,u,d,n=a.coords.usrCoords,p=e.coords.usrCoords,f=o.coords.usrCoords;return l.exists(s)||(s=a.board),t=[p[0]-n[0],-p[2]+n[2],p[1]-n[1]],h=[.5*(n[0]+p[0]),.5*(n[1]+p[1]),.5*(n[2]+p[2])],u=b.crossProduct(t,h),t=[f[0]-p[0],-f[2]+p[2],f[1]-p[1]],h=[.5*(p[0]+f[0]),.5*(p[1]+f[1]),.5*(p[2]+f[2])],d=b.crossProduct(t,h),new y(E.COORDS_BY_USER,b.crossProduct(u,d),s)},distance:function(a,e,o){var s,t=0;for(o||(o=Math.min(a.length,e.length)),s=0;s<o;s++)t+=(a[s]-e[s])*(a[s]-e[s]);return Math.sqrt(t)},affineDistance:function(a,e,o){var s;return(s=this.distance(a,e,o))>b.eps&&(Math.abs(a[0])<b.eps||Math.abs(e[0])<b.eps)?1/0:s},affineRatio:function(a,e,o){var s;return l.exists(a.usrCoords)&&(a=a.usrCoords),l.exists(e.usrCoords)&&(e=e.usrCoords),l.exists(o.usrCoords)&&(o=o.usrCoords),s=e[1]-a[1],Math.abs(s)>b.eps?(o[1]-a[1])/s:(o[2]-a[2])/(e[2]-a[2])},sortVertices:function(a){for(var e,o=c.each(a,c.coordsArray),s=o.length,t=null;o[0][0]===o[s-1][0]&&o[0][1]===o[s-1][1]&&o[0][2]===o[s-1][2];)t=o.pop(),s--;return e=o[0],o.sort(function(h,u){return(h[2]===e[2]&&h[1]===e[1]?-1/0:Math.atan2(h[2]-e[2],h[1]-e[1]))-(u[2]===e[2]&&u[1]===e[1]?-1/0:Math.atan2(u[2]-e[2],u[1]-e[1]))}),t!==null&&o.push(t),o},signedTriangle:function(a,e,o){var s=c.coordsArray(a),t=c.coordsArray(e),h=c.coordsArray(o);return .5*((t[1]-s[1])*(h[2]-s[2])-(t[2]-s[2])*(h[1]-s[1]))},signedPolygon:function(a,e){var o,s,t=0,h=c.each(a,c.coordsArray);for(e===void 0&&(e=!0),e?h.unshift(h[h.length-1]):h=this.sortVertices(h),s=h.length,o=1;o<s;o++)t+=h[o-1][1]*h[o][2]-h[o][1]*h[o-1][2];return .5*t},GrahamScan:function(a){var e,o=1,s=c.each(a,c.coordsArray),t=s.length;for(t=(s=this.sortVertices(s)).length,e=2;e<t;e++){for(;this.signedTriangle(s[o-1],s[o],s[e])<=0;){if(o>1)o-=1;else if(e===t-1)break;e+=1}o+=1,s=l.swap(s,o,e)}return s.slice(0,o)},calcStraight:function(a,e,o,s){var t,h,u,d,n,p,f,v,C,_;if(l.exists(s)||(s=10),p=l.evaluate(a.visProp.straightfirst),f=l.evaluate(a.visProp.straightlast),Math.abs(e.scrCoords[0])<b.eps&&(p=!0),Math.abs(o.scrCoords[0])<b.eps&&(f=!0),(p||f)&&((v=[])[0]=a.stdform[0]-a.stdform[1]*a.board.origin.scrCoords[1]/a.board.unitX+a.stdform[2]*a.board.origin.scrCoords[2]/a.board.unitY,v[1]=a.stdform[1]/a.board.unitX,v[2]=-a.stdform[2]/a.board.unitY,!isNaN(v[0]+v[1]+v[2]))){if(t=!p&&Math.abs(e.usrCoords[0])>=b.eps&&e.scrCoords[1]>=0&&e.scrCoords[1]<=a.board.canvasWidth&&e.scrCoords[2]>=0&&e.scrCoords[2]<=a.board.canvasHeight,h=!f&&Math.abs(o.usrCoords[0])>=b.eps&&o.scrCoords[1]>=0&&o.scrCoords[1]<=a.board.canvasWidth&&o.scrCoords[2]>=0&&o.scrCoords[2]<=a.board.canvasHeight,d=(u=this.meetLineBoard(v,a.board,s))[0],n=u[1],!t&&!h&&(!p&&f&&!this.isSameDirection(e,o,d)&&!this.isSameDirection(e,o,n)||p&&!f&&!this.isSameDirection(o,e,d)&&!this.isSameDirection(o,e,n)))return;t?h||(_=this.isSameDir(e,o,d,n)?n:d):h?C=this.isSameDir(e,o,d,n)?d:n:this.isSameDir(e,o,d,n)?(C=d,_=n):(_=d,C=n),C&&e.setCoordinates(E.COORDS_BY_USER,C.usrCoords),_&&o.setCoordinates(E.COORDS_BY_USER,_.usrCoords)}},calcLineDelimitingPoints:function(a,e,o){var s,t,h,u,d,n,p,f,v,C,_;if(d=l.evaluate(a.visProp.straightfirst),n=l.evaluate(a.visProp.straightlast),Math.abs(e.scrCoords[0])<b.eps&&(d=!0),Math.abs(o.scrCoords[0])<b.eps&&(n=!0),(p=[])[0]=a.stdform[0]-a.stdform[1]*a.board.origin.scrCoords[1]/a.board.unitX+a.stdform[2]*a.board.origin.scrCoords[2]/a.board.unitY,p[1]=a.stdform[1]/a.board.unitX,p[2]=-a.stdform[2]/a.board.unitY,!isNaN(p[0]+p[1]+p[2])){if(C=!d,_=!n,t=a.board.getBoundingBox(),a.getSlope()>=0?(h=this.projectPointToLine({coords:{usrCoords:[1,t[2],t[1]]}},a,a.board),u=this.projectPointToLine({coords:{usrCoords:[1,t[0],t[3]]}},a,a.board)):(h=this.projectPointToLine({coords:{usrCoords:[1,t[0],t[1]]}},a,a.board),u=this.projectPointToLine({coords:{usrCoords:[1,t[2],t[3]]}},a,a.board)),!C&&!_&&(!d&&!n&&(s=e.distance(E.COORDS_BY_USER,o),Math.abs(e.distance(E.COORDS_BY_USER,h)+h.distance(E.COORDS_BY_USER,o)-s)>b.eps||Math.abs(e.distance(E.COORDS_BY_USER,u)+u.distance(E.COORDS_BY_USER,o)-s)>b.eps)||!d&&n&&!this.isSameDirection(e,o,h)&&!this.isSameDirection(e,o,u)||d&&!n&&!this.isSameDirection(o,e,h)&&!this.isSameDirection(o,e,u)))return;C?_||(v=this.isSameDir(e,o,h,u)?u:h):_?f=this.isSameDir(e,o,h,u)?h:u:this.isSameDir(e,o,h,u)?(f=h,v=u):(v=h,f=u),f&&e.setCoordinates(E.COORDS_BY_USER,f.usrCoords),v&&o.setCoordinates(E.COORDS_BY_USER,v.usrCoords)}},calcLabelQuadrant:function(a){return a<0&&(a+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((a+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(a,e,o,s){var t=e.usrCoords[1]-a.usrCoords[1],h=e.usrCoords[2]-a.usrCoords[2],u=s.usrCoords[1]-o.usrCoords[1],d=s.usrCoords[2]-o.usrCoords[2];return Math.abs(e.usrCoords[0])<b.eps&&(t=e.usrCoords[1],h=e.usrCoords[2]),Math.abs(a.usrCoords[0])<b.eps&&(t=-a.usrCoords[1],h=-a.usrCoords[2]),t*u+h*d>=0},isSameDirection:function(a,e,o){var s,t,h,u,d=!1;return s=e.usrCoords[1]-a.usrCoords[1],t=e.usrCoords[2]-a.usrCoords[2],h=o.usrCoords[1]-a.usrCoords[1],u=o.usrCoords[2]-a.usrCoords[2],Math.abs(s)<b.eps&&(s=0),Math.abs(t)<b.eps&&(t=0),Math.abs(h)<b.eps&&(h=0),Math.abs(u)<b.eps&&(u=0),(s>=0&&h>=0||s<=0&&h<=0)&&(d=t>=0&&u>=0||t<=0&&u<=0),d},det3p:function(a,e,o){return(a[1]-o[1])*(e[2]-o[2])-(e[1]-o[1])*(a[2]-o[2])},windingNumber:function(a,e,o){var s,t,h,u,d,n,p=0,f=e.length,v=a[1],C=a[2],_=0;if(f===0)return 0;if((o=o||!1)&&(_=1),isNaN(v)||isNaN(C)||(l.exists(e[0].coords)?(s=e[0].coords,t=e[f-1].coords):(s=e[0],t=e[f-1]),s.usrCoords[1]===v&&s.usrCoords[2]===C))return 1;for(n=0;n<f-_;n++)if(l.exists(e[n].coords)?(t=e[n].coords.usrCoords,h=e[(n+1)%f].coords.usrCoords):(t=e[n].usrCoords,h=e[(n+1)%f].usrCoords),!(t[0]===0||h[0]===0||isNaN(t[1])||isNaN(h[1])||isNaN(t[2])||isNaN(h[2]))){if(h[2]===C){if(h[1]===v)return 1;if(t[2]===C&&h[1]>v==t[1]<v)return 0}if(t[2]<C!=h[2]<C)if(d=2*(h[2]>t[2]?1:0)-1,t[1]>=v)if(h[1]>v)p+=d;else{if((u=this.det3p(t,h,a))===0)return 0;u>0+b.eps==h[2]>t[2]&&(p+=d)}else h[1]>v&&(u=this.det3p(t,h,a))>0+b.eps==h[2]>t[2]&&(p+=d)}return p},pnpoly:function(a,e,o,s){var t,h,u,d,n,p,f,v,C=o,_=!1;for(s===E.COORDS_BY_USER?(d=(p=new y(E.COORDS_BY_USER,[a,e],this.board)).scrCoords[1],n=p.scrCoords[2]):(d=a,n=e),t=0,h=(u=o.length)-2;t<u-1;h=t++)f=l.exists(C[t].coords)?C[t].coords:C[t],v=l.exists(C[h].coords)?C[h].coords:C[h],f.scrCoords[2]>n!=v.scrCoords[2]>n&&d<(v.scrCoords[1]-f.scrCoords[1])*(n-f.scrCoords[2])/(v.scrCoords[2]-f.scrCoords[2])+f.scrCoords[1]&&(_=!_);return _},intersectionFunction:function(a,e,o,s,t,h){var u,d,n=this;return u=e.elementClass===E.OBJECT_CLASS_CURVE&&(e.type===E.OBJECT_TYPE_ARC||e.type===E.OBJECT_TYPE_SECTOR),d=o.elementClass===E.OBJECT_CLASS_CURVE&&(o.type===E.OBJECT_TYPE_ARC||o.type===E.OBJECT_TYPE_SECTOR),e.elementClass!==E.OBJECT_CLASS_CURVE&&o.elementClass!==E.OBJECT_CLASS_CURVE||e.elementClass!==E.OBJECT_CLASS_CURVE&&e.elementClass!==E.OBJECT_CLASS_CIRCLE||o.elementClass!==E.OBJECT_CLASS_CURVE&&o.elementClass!==E.OBJECT_CLASS_CIRCLE?e.elementClass===E.OBJECT_CLASS_CURVE&&!u&&o.elementClass===E.OBJECT_CLASS_LINE||o.elementClass===E.OBJECT_CLASS_CURVE&&!d&&e.elementClass===E.OBJECT_CLASS_LINE?function(){return n.meetCurveLine(e,o,s,e.board,h)}:e.type===E.OBJECT_TYPE_POLYGON||o.type===E.OBJECT_TYPE_POLYGON?e.elementClass===E.OBJECT_CLASS_LINE?function(){return n.meetPolygonLine(o,e,s,e.board,h)}:o.elementClass===E.OBJECT_CLASS_LINE?function(){return n.meetPolygonLine(e,o,s,e.board,h)}:function(){return n.meetPathPath(e,o,s,e.board)}:e.elementClass===E.OBJECT_CLASS_LINE&&o.elementClass===E.OBJECT_CLASS_LINE?function(){var p,f,v=l.evaluate(e.visProp.straightfirst),C=l.evaluate(e.visProp.straightlast),_=l.evaluate(o.visProp.straightfirst),P=l.evaluate(o.visProp.straightlast);return l.evaluate(h)||v&&C&&_&&P?n.meet(e.stdform,o.stdform,s,e.board):(p=n.meetSegmentSegment(e.point1.coords.usrCoords,e.point2.coords.usrCoords,o.point1.coords.usrCoords,o.point2.coords.usrCoords),f=!v&&p[1]<0||!C&&p[1]>1||!_&&p[2]<0||!P&&p[2]>1?[0,NaN,NaN]:p[0],new y(E.COORDS_BY_USER,f,e.board))}:function(){var p,f,v,C=n.meet(e.stdform,o.stdform,s,e.board),_=!0;return h?C:(e.elementClass!==E.OBJECT_CLASS_LINE||(p=l.evaluate(e.visProp.straightfirst),f=l.evaluate(e.visProp.straightlast),p&&f||(v=n.affineRatio(e.point1.coords,e.point2.coords,C),!(!f&&v>1+b.eps||!p&&v<0-b.eps))))&&(o.elementClass!==E.OBJECT_CLASS_LINE||(p=l.evaluate(o.visProp.straightfirst),f=l.evaluate(o.visProp.straightlast),p&&f||(v=n.affineRatio(o.point1.coords,o.point2.coords,C),!(!f&&v>1+b.eps||!p&&v<0-b.eps))))?u&&((_=n.coordsOnArc(e,C))&&d&&(_=n.coordsOnArc(o,C)),!_)?new y(g.COORDS_BY_USER,[0,NaN,NaN],e.board):C:new y(g.COORDS_BY_USER,[0,NaN,NaN],e.board)}:function(){return n.meetCurveCurve(e,o,s,t,e.board)}},coordsOnArc:function(a,e){var o=this.rad(a.radiuspoint,a.center,e.usrCoords.slice(1)),s=0,t=this.rad(a.radiuspoint,a.center,a.anglepoint),h=l.evaluate(a.visProp.selection);return(h==="minor"&&t>Math.PI||h==="major"&&t<Math.PI)&&(s=t,t=2*Math.PI),!(o<s||o>t)},meet:function(a,e,o,s){var t=b.eps;return Math.abs(a[3])<t&&Math.abs(e[3])<t?this.meetLineLine(a,e,o,s):Math.abs(a[3])>=t&&Math.abs(e[3])<t?this.meetLineCircle(e,a,o,s):Math.abs(a[3])<t&&Math.abs(e[3])>=t?this.meetLineCircle(a,e,o,s):this.meetCircleCircle(a,e,o,s)},meetLineBoard:function(a,e,o){var s,t,h,u,d=[];for(l.exists(o)||(o=0),d[0]=b.crossProduct(a,[o,0,1]),d[1]=b.crossProduct(a,[o,1,0]),d[2]=b.crossProduct(a,[-o-e.canvasHeight,0,1]),d[3]=b.crossProduct(a,[-o-e.canvasWidth,1,0]),h=0;h<4;h++)if(Math.abs(d[h][0])>b.eps){for(u=2;u>0;u--)d[h][u]/=d[h][0];d[h][0]=1}return Math.abs(d[1][0])<b.eps?(s=d[0],t=d[2]):Math.abs(d[0][0])<b.eps?(s=d[1],t=d[3]):d[1][2]<0?(s=d[0],t=d[3][2]>e.canvasHeight?d[2]:d[3]):d[1][2]>e.canvasHeight?(s=d[2],t=d[3][2]<0?d[0]:d[3]):(s=d[1],t=d[3][2]<0?d[0]:d[3][2]>e.canvasHeight?d[2]:d[3]),[s=new y(E.COORDS_BY_SCREEN,s.slice(1),e),t=new y(E.COORDS_BY_SCREEN,t.slice(1),e)]},meetLineLine:function(a,e,o,s){var t=isNaN(a[5]+e[5])?[0,0,0]:b.crossProduct(a,e);return new y(E.COORDS_BY_USER,t,s)},meetLineCircle:function(a,e,o,s){var t,h,u,d,n,p,f,v,C;return e[4]<b.eps?Math.abs(b.innerProduct([1,e[6],e[7]],a,3))<b.eps?new y(E.COORDS_BY_USER,e.slice(6,8),s):new y(E.COORDS_BY_USER,[NaN,NaN],s):(u=e[0],h=e.slice(1,3),t=e[3],d=a[0],n=a.slice(1,3),p=t,(v=(f=h[0]*n[1]-h[1]*n[0])*f-4*p*(t*d*d-(h[0]*n[0]+h[1]*n[1])*d+u))>-b.eps*b.eps?(C=[(-f+(v=Math.sqrt(Math.abs(v))))/(2*p),(-f-v)/(2*p)],new y(E.COORDS_BY_USER,o===0?[-C[0]*-n[1]-d*n[0],-C[0]*n[0]-d*n[1]]:[-C[1]*-n[1]-d*n[0],-C[1]*n[0]-d*n[1]],s)):new y(E.COORDS_BY_USER,[0,0,0],s))},meetCircleCircle:function(a,e,o,s){var t;return a[4]<b.eps?Math.abs(this.distance(a.slice(6,2),e.slice(6,8))-e[4])<b.eps?new y(E.COORDS_BY_USER,a.slice(6,8),s):new y(E.COORDS_BY_USER,[0,0,0],s):e[4]<b.eps?Math.abs(this.distance(e.slice(6,2),a.slice(6,8))-a[4])<b.eps?new y(E.COORDS_BY_USER,e.slice(6,8),s):new y(E.COORDS_BY_USER,[0,0,0],s):(t=[e[3]*a[0]-a[3]*e[0],e[3]*a[1]-a[3]*e[1],e[3]*a[2]-a[3]*e[2],0,1,1/0,1/0,1/0],t=b.normalize(t),this.meetLineCircle(t,a,o,s))},meetCurveCurve:function(a,e,o,s,t,h){var u;return u=l.exists(h)&&h==="newton"?m.generalizedNewton(a,e,o,s):a.bezierDegree===3||e.bezierDegree===3?this.meetBezierCurveRedBlueSegments(a,e,o):this.meetCurveRedBlueSegments(a,e,o),new y(E.COORDS_BY_USER,u,t)},meetCurveLine:function(a,e,o,s,t){var h,u;return l.exists(s)||(s=a.board),a.elementClass===E.OBJECT_CLASS_CURVE?(h=a,u=e):(h=e,u=a),this.meetCurveLineDiscrete(h,u,o,s,!t)},meetCurveLineContinuous:function(a,e,o,s,t){var h,u,d,n,p,f,v,C,_,P,x,S,O,w=b.eps,T=b.eps;for(n=this.meetCurveLineDiscrete(a,e,o,s,t),p=n.usrCoords[1],f=n.usrCoords[2],u=function(M){var N,A;return M>a.maxX()||M<a.minX()?1/0:(N=p-a.X(M))*N+(A=f-a.Y(M))*A},d=function(M){var N=e.stdform[0]+e.stdform[1]*a.X(M)+e.stdform[2]*a.Y(M);return N*N},C=(a.maxX()-a.minX())/50,_=a.minX(),S=1e-4,x=NaN,P=0;P<50&&(h=m.root(u,[Math.max(_,a.minX()),Math.min(_+C,a.maxX())]),!((O=Math.abs(u(h)))<=S&&(x=h,(S=O)<w)));P++)_+=C;return h=x,O=d(h=m.root(d,[Math.max(h-C,a.minX()),Math.min(h+C,a.maxX())])),v=isNaN(O)||Math.abs(O)>T?0:1,new y(E.COORDS_BY_USER,[v,a.X(h),a.Y(h)],s)},meetCurveLineDiscrete:function(a,e,o,s,t){var h,u,d,n,p,f,v,C=e.point1.coords.usrCoords,_=e.point2.coords.usrCoords,P=0,x=a.numberPoints,S=l.evaluate(e.visProp.straightfirst),O=l.evaluate(e.visProp.straightlast);for(f=new y(E.COORDS_BY_USER,[0,NaN,NaN],s),C[0]===0?C=[1,_[1]+e.stdform[2],_[2]-e.stdform[1]]:_[0]===0&&(_=[1,C[1]+e.stdform[2],C[2]-e.stdform[1]]),n=a.points[0].usrCoords,h=1;h<x;h+=a.bezierDegree)if(d=n.slice(0),n=a.points[h].usrCoords,this.distance(d,n)>b.eps){for(v=a.bezierDegree===3?this.meetBeziersegmentBeziersegment([a.points[h-1].usrCoords.slice(1),a.points[h].usrCoords.slice(1),a.points[h+1].usrCoords.slice(1),a.points[h+2].usrCoords.slice(1)],[C.slice(1),_.slice(1)],t):[this.meetSegmentSegment(d,n,C,_)],u=0;u<v.length;u++)if(0<=(p=v[u])[1]&&p[1]<=1){if(P===o)return t&&(!S&&p[2]<0||!O&&p[2]>1)?f:f=new y(E.COORDS_BY_USER,p[0],s);P+=1}}return f},meetCurveRedBlueSegments:function(a,e,o){var s,t,h,u,d,n,p,f,v,C=0,_=e.numberPoints,P=a.numberPoints;if(_<=1||P<=1)return[0,NaN,NaN];for(s=1;s<P;s++)for(h=a.points[s-1].usrCoords,u=a.points[s].usrCoords,f=Math.min(h[1],u[1]),v=Math.max(h[1],u[1]),n=e.points[0].usrCoords,t=1;t<_;t++)if(d=n,n=e.points[t].usrCoords,Math.min(d[1],n[1])<v&&Math.max(d[1],n[1])>f&&(p=this.meetSegmentSegment(h,u,d,n))[1]>=0&&p[2]>=0&&(p[1]<1&&p[2]<1||s===P-1&&p[1]===1||t===_-1&&p[2]===1)){if(C===o)return p[0];C++}return[0,NaN,NaN]},meetSegmentSegment:function(a,e,o,s){var t,h,u,d=b.crossProduct(a,e),n=b.crossProduct(o,s),p=b.crossProduct(d,n);return Math.abs(p[0])<b.eps?[p,1/0,1/0]:(p[1]/=p[0],p[2]/=p[0],p[0]/=p[0],u=a[h=Math.abs(e[1]-e[0]*a[1])<b.eps?2:1]/a[0],t=(p[h]-u)/(e[0]!==0?e[h]/e[0]-u:e[h]),u=o[h=Math.abs(s[1]-s[0]*o[1])<b.eps?2:1]/o[0],[p,t,(p[h]-u)/(s[0]!==0?s[h]/s[0]-u:s[h])])},meetPathPath:function(a,e,o,s){var t,h,u,d;return(u=(t=g.Math.Clip._getPath(a,s)).length)>0&&this.distance(t[0].coords.usrCoords,t[u-1].coords.usrCoords,3)<b.eps&&t.pop(),(u=(h=g.Math.Clip._getPath(e,s)).length)>0&&this.distance(h[0].coords.usrCoords,h[u-1].coords.usrCoords,3)<b.eps*b.eps&&h.pop(),o<0||g.Math.Clip.isEmptyCase(t,h,"intersection")?new y(E.COORDS_BY_USER,[0,0,0],s):(g.Math.Clip.makeDoublyLinkedList(t),g.Math.Clip.makeDoublyLinkedList(h),o<(d=g.Math.Clip.findIntersections(t,h,s)[0]).length?d[o].coords:new y(E.COORDS_BY_USER,[0,0,0],s))},meetPolygonLine:function(a,e,o,s,t){var h,u,d,n=[0,0,0],p=a.borders.length,f=[];for(h=0;h<p;h++)d=a.borders[h],u=this.meetSegmentSegment(d.point1.coords.usrCoords,d.point2.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords),(!t||u[2]>=0&&u[2]<1)&&u[1]>=0&&u[1]<1&&f.push(u[0]);return o>=0&&o<f.length&&(n=f[o]),new y(E.COORDS_BY_USER,n,s)},_bezierSplit:function(a){var e,o,s,t,h,u;return e=[.5*(a[0][0]+a[1][0]),.5*(a[0][1]+a[1][1])],o=[.5*(a[1][0]+a[2][0]),.5*(a[1][1]+a[2][1])],s=[.5*(a[2][0]+a[3][0]),.5*(a[2][1]+a[3][1])],u=[.5*((t=[.5*(e[0]+o[0]),.5*(e[1]+o[1])])[0]+(h=[.5*(o[0]+s[0]),.5*(o[1]+s[1])])[0]),.5*(t[1]+h[1])],[[a[0],e,t,u],[u,h,s,a[3]]]},_bezierBbox:function(a){var e=[];return a.length===4?(e[0]=Math.min(a[0][0],a[1][0],a[2][0],a[3][0]),e[1]=Math.max(a[0][1],a[1][1],a[2][1],a[3][1]),e[2]=Math.max(a[0][0],a[1][0],a[2][0],a[3][0]),e[3]=Math.min(a[0][1],a[1][1],a[2][1],a[3][1])):(e[0]=Math.min(a[0][0],a[1][0]),e[1]=Math.max(a[0][1],a[1][1]),e[2]=Math.max(a[0][0],a[1][0]),e[3]=Math.min(a[0][1],a[1][1])),e},_bezierOverlap:function(a,e){return a[2]>=e[0]&&a[0]<=e[2]&&a[1]>=e[3]&&a[3]<=e[1]},_bezierListConcat:function(a,e,o,s){var t,h=l.exists(s),u=0,d=e.length,n=a.length;for(n>0&&d>0&&(a[n-1][1]===1&&e[0][1]===0||h&&a[n-1][2]===1&&e[0][2]===0)&&(u=1),t=u;t<d;t++)h&&(e[t][2]*=.5,e[t][2]+=s),e[t][1]*=.5,e[t][1]+=o,a.push(e[t])},_bezierMeetSubdivision:function(a,e,o){var s,t,h,u,d,n,p,f,v,C,_,P,x=[];return t=this._bezierBbox(e),s=this._bezierBbox(a),this._bezierOverlap(t,s)?o<5?(n=(h=this._bezierSplit(a))[0],p=h[1],u=(h=this._bezierSplit(e))[0],d=h[1],this._bezierListConcat(x,this._bezierMeetSubdivision(n,u,o+1),0,0),this._bezierListConcat(x,this._bezierMeetSubdivision(n,d,o+1),0,.5),this._bezierListConcat(x,this._bezierMeetSubdivision(p,u,o+1),.5,0),this._bezierListConcat(x,this._bezierMeetSubdivision(p,d,o+1),.5,.5),x):(_=[1].concat(a[0]),P=[1].concat(a[3]),v=[1].concat(e[0]),C=[1].concat(e[3]),(f=this.meetSegmentSegment(_,P,v,C))[1]>=0&&f[2]>=0&&f[1]<=1&&f[2]<=1?[f]:[]):[]},_bezierLineMeetSubdivision:function(a,e,o,s){var t,h,u,d,n,p,f,v,C,_,P=[];return t=this._bezierBbox(e),h=this._bezierBbox(a),s&&!this._bezierOverlap(h,t)?[]:o<5?(d=(u=this._bezierSplit(a))[0],n=u[1],this._bezierListConcat(P,this._bezierLineMeetSubdivision(d,e,o+1),0),this._bezierListConcat(P,this._bezierLineMeetSubdivision(n,e,o+1),.5),P):(C=[1].concat(a[0]),_=[1].concat(a[3]),f=[1].concat(e[0]),v=[1].concat(e[1]),(p=this.meetSegmentSegment(C,_,f,v))[1]>=0&&p[1]<=1&&(!s||p[2]>=0&&p[2]<=1)?[p]:[])},meetBeziersegmentBeziersegment:function(a,e,o){var s,t,h;for((s=a.length===4&&e.length===4?this._bezierMeetSubdivision(a,e,0):this._bezierLineMeetSubdivision(a,e,0,o)).sort(function(u,d){return 1e7*(u[1]-d[1])+(u[2]-d[2])}),t=[],h=0;h<s.length;h++)h!==0&&s[h][1]===s[h-1][1]&&s[h][2]===s[h-1][2]||t.push(s[h]);return t},meetBezierCurveRedBlueSegments:function(a,e,o){var s,t,h,u,d,n,p,f,v,C,_=0,P=0,x=e.numberPoints,S=a.numberPoints,O=[];if(x<e.bezierDegree+1||S<a.bezierDegree+1)return[0,NaN,NaN];for(x-=e.bezierDegree,S-=a.bezierDegree,a.type===E.OBJECT_TYPE_SECTOR&&(_=3,S-=3),e.type===E.OBJECT_TYPE_SECTOR&&(P=3,x-=3),t=_;t<S;t+=a.bezierDegree)for(n=[(s=a.points)[t].usrCoords.slice(1),s[t+1].usrCoords.slice(1)],a.bezierDegree===3&&(n[2]=s[t+2].usrCoords.slice(1),n[3]=s[t+3].usrCoords.slice(1)),f=this._bezierBbox(n),h=P;h<x;h+=e.bezierDegree)if(p=[(s=e.points)[h].usrCoords.slice(1),s[h+1].usrCoords.slice(1)],e.bezierDegree===3&&(p[2]=s[h+2].usrCoords.slice(1),p[3]=s[h+3].usrCoords.slice(1)),v=this._bezierBbox(p),this._bezierOverlap(f,v)){if((C=this.meetBeziersegmentBeziersegment(n,p)).length===0)continue;for(u=0;u<C.length;u++)(d=C[u])[1]<-b.eps||d[1]>1+b.eps||d[2]<-b.eps||d[2]>1+b.eps||O.push(d);if(O.length>o)return O[o][0]}return O.length>o?O[o][0]:[0,NaN,NaN]},bezierSegmentEval:function(a,e){var o,s,t,h=1-a;return s=0,t=0,s+=(o=h*h*h)*e[0][0],t+=o*e[0][1],s+=(o=3*a*h*h)*e[1][0],t+=o*e[1][1],s+=(o=3*a*a*h)*e[2][0],t+=o*e[2][1],[1,s+=(o=a*a*a)*e[3][0],t+=o*e[3][1]]},bezierArc:function(a,e,o,s,t){var h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A=.5*Math.PI,R=e[1],L=e[2],D=e[0],k=[],B=[];for(p=this.distance(e,a),R/=D,L/=D,f=this.rad(a.slice(1),e.slice(1),o.slice(1)),t===-1&&(f=2*Math.PI-f),(h=a)[1]/=h[0],h[2]/=h[0],h[0]/=h[0],n=h.slice(0),s?(k=[R,R+.333*(h[1]-R),R+.666*(h[1]-R),h[1]],B=[L,L+.333*(h[2]-L),L+.666*(h[2]-L),h[2]]):(k=[h[1]],B=[h[2]]);f>b.eps;)f>A?(v=A,f-=A):(v=f,f=0),N=[[1,0,0],[R*(1-(C=Math.cos(t*v)))+L*(_=Math.sin(t*v)),C,-_],[L*(1-C)-R*_,_,C]],n=[(T=b.matVecMult(N,h))[0]/T[0],T[1]/T[0],T[2]/T[0]],P=h[1]-R,x=h[2]-L,S=n[1]-R,O=n[2]-L,M=Math.sqrt((P+S)*(P+S)+(x+O)*(x+O)),w=Math.abs(O-x)>b.eps?(P+S)*(p/M-.5)/(O-x)*8/3:(x+O)*(p/M-.5)/(P-S)*8/3,u=[1,h[1]-w*x,h[2]+w*P],d=[1,n[1]+w*O,n[2]-w*S],k=k.concat([u[1],d[1],n[1]]),B=B.concat([u[2],d[2],n[2]]),h=n.slice(0);return s&&(k=k.concat([n[1]+.333*(R-n[1]),n[1]+.666*(R-n[1]),R]),B=B.concat([n[2]+.333*(L-n[2]),n[2]+.666*(L-n[2]),L])),[k,B]},projectPointToCircle:function(a,e,o){var s,t,h,u,d,n=e.center.coords.usrCoords;return l.exists(o)||(o=a.board),l.isPoint(a)?(s=a.coords.distance(E.COORDS_BY_USER,e.center.coords),t=a.coords.usrCoords):(s=a.distance(E.COORDS_BY_USER,e.center.coords),t=a.usrCoords),Math.abs(s)<b.eps&&(s=b.eps),d=e.Radius()/s,h=n[1]+d*(t[1]-n[1]),u=n[2]+d*(t[2]-n[2]),new y(E.COORDS_BY_USER,[h,u],o)},projectPointToLine:function(a,e,o){var s,t=[0,e.stdform[1],e.stdform[2]];return l.exists(o)||(o=l.exists(a.coords)?a.board:e.board),s=l.exists(a.coords)?a.coords.usrCoords:a.usrCoords,t=b.crossProduct(t,s),new y(E.COORDS_BY_USER,b.crossProduct(t,e.stdform),o)},projectCoordsToSegment:function(a,e,o){var s,t=[o[1]-e[1],o[2]-e[2]],h=[a[1]-e[1],a[2]-e[2]];return Math.abs(t[0])<b.eps&&Math.abs(t[1])<b.eps?[e,0]:(s=b.innerProduct(h,t),[[1,(s/=b.innerProduct(t,t))*t[0]+e[1],s*t[1]+e[2]],s])},projectCoordsToBeziersegment:function(a,e,o){var s;return s=g.Math.Numerics.fminbr(function(t){var h=[1,e.X(o+t),e.Y(o+t)];return h[1]-=a[1],h[2]-=a[2],h[1]*h[1]+h[2]*h[2]},[0,1]),[[1,e.X(s+o),e.Y(s+o)],s]},projectPointToCurve:function(a,e,o){l.exists(o)||(o=a.board);var s=a.X(),t=a.Y(),h=a.position||0;return this.projectCoordsToCurve(s,t,h,e,o)},projectCoordsToCurve:function(a,e,o,s,t){var h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A,R,L,D=Number.POSITIVE_INFINITY;if(l.exists(t)||(t=s.board),l.evaluate(s.visProp.curvetype)==="plot"){if(o=0,p=D,h=s.numberPoints===0?[0,1,1]:[s.Z(0),s.X(0),s.Y(0)],s.numberPoints>1)for(C=[1,a,e],s.bezierDegree===3?n=0:x=[s.Z(0),s.X(0),s.Y(0)],d=0;d<s.numberPoints-1;d++)s.bezierDegree===3?O=this.projectCoordsToBeziersegment(C,s,n):(S=[s.Z(d+1),s.X(d+1),s.Y(d+1)],O=this.projectCoordsToSegment(C,x,S)),v=O[1],_=O[0],0<=v&&v<=1?(f=this.distance(_,C),P=d+v):v<0?(_=x,f=this.distance(x,C),P=d):v>1&&d===s.numberPoints-2&&(_=S,f=this.distance(_,C),P=s.numberPoints-1),f<p&&(p=f,o=P,h=_),s.bezierDegree===3?(n++,d+=2):x=S;u=new y(E.COORDS_BY_USER,h,t)}else{for(w=function(k){var B,j;return k<s.minX()||k>s.maxX()?1/0:(B=a-s.X(k))*B+(j=e-s.Y(k))*j},N=w(o),R=s.minX(),A=((L=s.maxX())-R)/50,T=R,d=0;d<50;d++)((M=w(T))<N||N===1/0||isNaN(N))&&(o=T,N=M),T+=A;o=(o=(o=m.fminbr(w,[Math.max(o-A,R),Math.min(o+A,L)]))<R?R:o)>L?L:o,u=new y(E.COORDS_BY_USER,[s.X(o),s.Y(o)],t)}return[s.updateTransform(u),o]},projectCoordsToPolygon:function(a,e){var o,s,t,h,u,d=e.vertices.length,n=1/0;for(o=0;o<d-1;o++)0<=(t=g.Math.Geometry.projectCoordsToSegment(a,e.vertices[o].coords.usrCoords,e.vertices[o+1].coords.usrCoords))[1]&&t[1]<=1?(s=g.Math.Geometry.distance(t[0],a,3),h=t[0]):t[1]<0?(s=g.Math.Geometry.distance(e.vertices[o].coords.usrCoords,a,3),h=e.vertices[o].coords.usrCoords):(s=g.Math.Geometry.distance(e.vertices[o+1].coords.usrCoords,a,3),h=e.vertices[o+1].coords.usrCoords),s<n&&(u=h.slice(0),n=s);return u},projectPointToTurtle:function(a,e,o){var s,t,h,u,d,n,p,f,v,C,_=0,P=0,x=Number.POSITIVE_INFINITY,S=e.objects.length;for(l.exists(o)||(o=a.board),d=0;d<S;d++)(p=e.objects[d]).elementClass===E.OBJECT_CLASS_CURVE&&(s=(v=this.projectPointToCurve(a,p))[0],C=v[1],(n=this.distance(s.usrCoords,a.coords.usrCoords))<x&&(h=s.usrCoords[1],u=s.usrCoords[2],t=C,x=n,f=p,P=_),_+=p.numberPoints);return s=new y(E.COORDS_BY_USER,[h,u],o),[f.updateTransform(s),t+P]},projectPointToPoint:function(a,e){return e.coords},projectPointToBoard:function(a,e){var o,s,t,h=e||a.board,u=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],d=a.coords||a,n=h.getBoundingBox();for(o=0;o<4;o++)(t=u[o])[0]*d.usrCoords[t[1]]<t[0]*n[t[2]]&&((s=b.crossProduct([1,n[t[3]],n[t[4]]],[1,n[t[5]],n[t[6]]]))[3]=0,s=b.normalize(s),d=this.projectPointToLine({coords:d},{stdform:s},h));return d},distPointLine:function(a,e){var o,s=e[1],t=e[2],h=e[0];return Math.abs(s)+Math.abs(t)<b.eps?Number.POSITIVE_INFINITY:(o=s*a[1]+t*a[2]+h,s*=s,t*=t,Math.abs(o)/Math.sqrt(s+t))},reuleauxPolygon:function(a,e){var o,s=2*Math.PI,t=s/e,h=(e-1)/2,u=0,d=function(n,p){return function(f,v){var C=(f%s+s)%s,_=Math.floor(C/t)%e;return v||(u=a[0].Dist(a[h]),o=b.Geometry.rad([a[0].X()+1,a[0].Y()],a[0],a[h%e])),isNaN(_)?_:(C=.5*C+_*t*.5+o,a[_][n]()+u*Math[p](C))}};return[d("X","cos"),d("Y","sin"),0,s]},meet3Planes:function(a,e,o,s,t,h){var u,d,n,p,f,v=[0,0,0];for(u=b.crossProduct(t,a),d=b.crossProduct(a,o),n=b.crossProduct(o,t),p=b.innerProduct(a,n,3),f=0;f<3;f++)v[f]=(e*n[f]+s*u[f]+h*d[f])/p;return v},meetPlanePlane:function(a,e,o,s){var t,h,u,d=[0,0,0],n=[0,0,0];for(t=0;t<3;t++)d[t]=l.evaluate(a[t]),n[t]=l.evaluate(e[t]);for(h=b.crossProduct(d,n),t=0;t<3;t++)d[t]=l.evaluate(o[t]),n[t]=l.evaluate(s[t]);return u=b.crossProduct(d,n),b.crossProduct(h,u)},project3DTo3DPlane:function(a,e,o){var s,t;return o=o||[0,0,0],s=b.norm(e),t=(b.innerProduct(a,e,3)-b.innerProduct(o,e,3))/s,b.axpy(-t,e,a)},getPlaneBounds:function(a,e,o,s,t){var h,u,d,n,p;return a[2]+e[0]!==0?(d=[[a[0],e[0]],[a[1],e[1]]],n=[s-o[0],s-o[1]],h=(p=m.Gauss(d,n))[0],u=p[1],n=[t-o[0],t-o[1]],[h,(p=m.Gauss(d,n))[0],u,p[1]]):null}}),b.Geometry}),define("math/plot",["jxg","base/constants","base/coords","math/math","math/extrapolate","math/numerics","math/statistics","math/geometry","math/ia","utils/type"],function(g,E,y,b,m,l,c,a,e,o){return b.Plot={checkReal:function(s){var t,h,u=!1,d=s.length;for(t=0;t<d;t++)if(h=s[t].usrCoords,!isNaN(h[1])&&!isNaN(h[2])&&Math.abs(h[0])>b.eps){u=!0;break}return u},updateParametricCurveNaive:function(s,t,h,u){var d,n,p=!1,f=(h-t)/u;for(d=0;d<u;d++)n=t+d*f,s.points[d].setCoordinates(E.COORDS_BY_USER,[s.X(n,p),s.Y(n,p)],!1),s.points[d]._t=n,p=!0;return s},isSegmentOutside:function(s,t,h,u,d){return t<0&&u<0||t>d.canvasHeight&&u>d.canvasHeight||s<0&&h<0||s>d.canvasWidth&&h>d.canvasWidth},isDistOK:function(s,t,h,u){return Math.abs(s)<h&&Math.abs(t)<u&&!isNaN(s+t)},isSegmentDefined:function(s,t,h,u){return!(isNaN(s+t)&&isNaN(h+u))},updateParametricCurveOld:function(s,t,h){var u,d,n,p,f,v,C,_,P,x,S,O=!1,w=new y(E.COORDS_BY_USER,[0,0],s.board,!1),T=[],M=[],N=[],A=[],R=!1,L=0,D=function(k,B,j){var I,q,$=j[1]-k[1],Z=j[2]-k[2],V=B[0]-k[1],U=B[1]-k[2],J=V*V+U*U;return J>=b.eps&&(I=($*V+Z*U)/J)>0&&(I<=1?($-=I*V,Z-=I*U):($-=V,Z-=U)),q=$*$+Z*Z,Math.sqrt(q)};for(g.deprecated("Curve.updateParametricCurveOld()"),s.board.updateQuality===s.board.BOARD_QUALITY_LOW?(P=15,x=10,S=10):(P=21,x=.7,S=.7),A[0]=h-t,u=1;u<P;u++)A[u]=.5*A[u-1];u=1,T[0]=1,M[0]=0,d=t,w.setCoordinates(E.COORDS_BY_USER,[s.X(d,O),s.Y(d,O)],!1),O=!0,f=w.scrCoords[1],v=w.scrCoords[2],d=h,w.setCoordinates(E.COORDS_BY_USER,[s.X(d,O),s.Y(d,O)],!1),n=w.scrCoords[1],p=w.scrCoords[2],N[0]=[n,p],C=1,_=0,s.points=[],s.points[L++]=new y(E.COORDS_BY_SCREEN,[f,v],s.board,!1);do{for(R=this.isDistOK(n-f,p-v,x,S)||this.isSegmentOutside(f,v,n,p,s.board);_<P&&(!R||_<6)&&(_<=7||this.isSegmentDefined(f,v,n,p));)T[C]=u,M[C]=_,N[C]=[n,p],C+=1,d=t+(u=2*u-1)*A[++_],w.setCoordinates(E.COORDS_BY_USER,[s.X(d,O),s.Y(d,O)],!1,!0),n=w.scrCoords[1],p=w.scrCoords[2],R=this.isDistOK(n-f,p-v,x,S)||this.isSegmentOutside(f,v,n,p,s.board);L>1&&D(s.points[L-2].scrCoords,[n,p],s.points[L-1].scrCoords)<.015&&(L-=1),s.points[L]=new y(E.COORDS_BY_SCREEN,[n,p],s.board,!1),s.points[L]._t=d,L+=1,f=n,v=p,n=N[C-=1][0],p=N[C][1],_=M[C]+1,u=2*T[C]}while(C>0&&L<5e5);return s.numberPoints=s.points.length,s},_insertPoint_v2:function(s,t,h){var u=!isNaN(this._lastCrds[1]+this._lastCrds[2]),d=!isNaN(t.scrCoords[1]+t.scrCoords[2]),n=s.board.canvasWidth,p=s.board.canvasHeight,f=500;(!(d=d&&t.scrCoords[1]>-500&&t.scrCoords[2]>-500&&t.scrCoords[1]<n+f&&t.scrCoords[2]<p+f)&&u||d&&(!u||Math.abs(t.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(t.scrCoords[2]-this._lastCrds[2])>.7))&&(t._t=h,s.points.push(t),this._lastCrds=t.copy("scrCoords"))},neighborhood_isNaN_v2:function(s,t){var h,u,d=new y(E.COORDS_BY_USER,[0,0],s.board,!1);return h=t+b.eps,d.setCoordinates(E.COORDS_BY_USER,[s.X(h,!0),s.Y(h,!0)],!1),u=d.usrCoords,!!(isNaN(u[1]+u[2])||(h=t-b.eps,d.setCoordinates(E.COORDS_BY_USER,[s.X(h,!0),s.Y(h,!0)],!1),u=d.usrCoords,isNaN(u[1]+u[2])))},_borderCase:function(s,t,h,u,d,n,p,f){var v,C,_,P,x,S,O,w=null,T=!1;if(f<=1){if(C=new y(E.COORDS_BY_USER,[0,0],s.board,!1),isNaN(t[1]+t[2])&&!isNaN(u[1]+u[2])&&!this.neighborhood_isNaN_v2(s,d)||isNaN(h[1]+h[2])&&!isNaN(u[1]+u[2])&&!this.neighborhood_isNaN_v2(s,n)||isNaN(u[1]+u[2])&&(!isNaN(t[1]+t[2])||!isNaN(h[1]+h[2]))&&!this.neighborhood_isNaN_v2(s,p))return!1;P=0;do{if(isNaN(t[1]+t[2])&&!isNaN(u[1]+u[2]))x=d,S=p,O=n;else if(isNaN(h[1]+h[2])&&!isNaN(u[1]+u[2]))x=n,S=p,O=d;else if(isNaN(u[1]+u[2])&&!isNaN(h[1]+h[2]))x=p,S=n,O=n+(n-p);else{if(!isNaN(u[1]+u[2])||isNaN(t[1]+t[2]))return!1;x=p,S=d,O=d-(p-d)}v=.5*(x+S),C.setCoordinates(E.COORDS_BY_USER,[s.X(v,!0),s.Y(v,!0)],!1),_=C.usrCoords,(T=isNaN(_[1]+_[2]))?x=v:(O=S,S=v),++P}while(T&&P<30);if(P<30&&(w=_.slice(),u=_.slice(),S=v),(s.X(S,!0)-s.X(O,!0))/(S-O),(s.Y(S,!0)-s.Y(O,!0))/(S-O),w!==null)return this._insertPoint_v2(s,new y(E.COORDS_BY_USER,w,s.board,!1)),!0}return!1},_plotRecursive_v2:function(s,t,h,u,d,n,p){var f,v,C,_,P,x=0,S=new y(E.COORDS_BY_USER,[0,0],s.board,!1);if(!(s.numberPoints>65536))return n<this.nanLevel&&this._isUndefined(s,t,h,u,d)||n<this.nanLevel&&this._isOutside(t,h,u,d,s.board)?this:(f=.5*(h+d),S.setCoordinates(E.COORDS_BY_USER,[s.X(f,!0),s.Y(f,!0)],!1),v=S.scrCoords,this._borderCase(s,t,u,v,h,d,f,n)||(C=this._triangleDists(t,u,v),_=n<this.smoothLevel&&C[3]<p,P=n<this.jumpLevel&&(C[2]>.99*C[0]||C[1]>.99*C[0]||C[0]===1/0||C[1]===1/0||C[2]===1/0),n<this.smoothLevel+2&&C[0]<.5*(C[1]+C[2])&&(x=0,_=!1),--n,P?this._insertPoint_v2(s,new y(E.COORDS_BY_SCREEN,[NaN,NaN],s.board,!1),f):n<=x||_?this._insertPoint_v2(s,S,f):(this._plotRecursive_v2(s,t,h,v,f,n,p),isNaN(S.scrCoords[1]+S.scrCoords[2])||this._insertPoint_v2(s,S,f),this._plotRecursive_v2(s,v,f,u,d,n,p))),this)},updateParametricCurve_v2:function(s,t,h){var u,d,n,p,f,v,C,_,P,x=!1,S=new y(E.COORDS_BY_USER,[0,0],s.board,!1),O=new y(E.COORDS_BY_USER,[0,0],s.board,!1);return s.board.updateQuality===s.board.BOARD_QUALITY_LOW?(f=o.evaluate(s.visProp.recursiondepthlow)||13,v=2,this.smoothLevel=f-6,this.jumpLevel=3):(f=o.evaluate(s.visProp.recursiondepthhigh)||17,v=2,this.smoothLevel=f-9,this.jumpLevel=2),this.nanLevel=f-4,s.points=[],this.xterm==="x"?(C=.3*((_=s.board.getBoundingBox())[2]-_[0]),.3*(_[1]-_[3]),u=Math.max(t,_[0]-C),d=Math.min(h,_[2]+C)):(u=t,d=h),S.setCoordinates(E.COORDS_BY_USER,[s.X(u,x),s.Y(u,x)],!1),x=!0,O.setCoordinates(E.COORDS_BY_USER,[s.X(d,x),s.Y(d,x)],!1),P=this._findStartPoint(s,S.scrCoords,u,O.scrCoords,d),S.setCoordinates(E.COORDS_BY_SCREEN,P[0],!1),u=P[1],P=this._findStartPoint(s,O.scrCoords,d,S.scrCoords,u),O.setCoordinates(E.COORDS_BY_SCREEN,P[0],!1),d=P[1],this._visibleArea=[u,d],n=S.copy("scrCoords"),p=O.copy("scrCoords"),S._t=u,s.points.push(S),this._lastCrds=S.copy("scrCoords"),this._plotRecursive_v2(s,n,u,p,d,f,v),O._t=d,s.points.push(O),s.numberPoints=s.points.length,s},_insertLimesPoint:function(s,t,h,u,d){var n,p,f;Math.abs(this._lastUsrCrds[1])===1/0&&Math.abs(d.left_x)===1/0||Math.abs(this._lastUsrCrds[2])===1/0&&Math.abs(d.left_y)===1/0||((n=new y(E.COORDS_BY_USER,[d.left_x,d.left_y],s.board))._t=h,s.points.push(n),isNaN(d.left_x)||isNaN(d.left_y)||isNaN(d.right_x)||isNaN(d.right_y)||!(Math.abs(d.left_x-d.right_x)>b.eps||Math.abs(d.left_y-d.right_y)>b.eps)||((p=new y(E.COORDS_BY_SCREEN,t,s.board))._t=h,s.points.push(p)),(f=new y(E.COORDS_BY_USER,[d.right_x,d.right_y],s.board))._t=h,s.points.push(f),this._lastScrCrds=f.copy("scrCoords"),this._lastUsrCrds=f.copy("usrCoords"))},_insertPoint:function(s,t,h,u,d){var n,p=!isNaN(this._lastScrCrds[1]+this._lastScrCrds[2]),f=!isNaN(t[1]+t[2]),v=s.board.canvasWidth,C=s.board.canvasHeight,_=500;o.exists(d)?this._insertLimesPoint(s,t,h,u,d):(f=f&&t[1]>-500&&t[2]>-500&&t[1]<v+_&&t[2]<C+_,(p||f)&&(f&&p&&Math.abs(t[1]-this._lastScrCrds[1])<.8&&Math.abs(t[2]-this._lastScrCrds[2])<.8||Math.abs(t[1])===1/0&&Math.abs(this._lastUsrCrds[1])===1/0||Math.abs(t[2])===1/0&&Math.abs(this._lastUsrCrds[2])===1/0||((n=new y(E.COORDS_BY_SCREEN,t,s.board))._t=h,s.points.push(n),this._lastScrCrds=n.copy("scrCoords"),this._lastUsrCrds=n.copy("usrCoords"))))},_triangleDists:function(s,t,h){var u;return u=[s[0]*t[0],.5*(s[1]+t[1]),.5*(s[2]+t[2])],[a.distance(s,t,3),a.distance(s,h,3),a.distance(h,t,3),a.distance(h,u,3)]},_isUndefined:function(s,t,h,u,d){var n,p,f;if(!isNaN(t[1]+t[2])||!isNaN(u[1]+u[2]))return!1;for(f=new y(E.COORDS_BY_USER,[0,0],s.board,!1),p=0;p<20;++p)if(n=h+Math.random()*(d-h),f.setCoordinates(E.COORDS_BY_USER,[s.X(n,!0),s.Y(n,!0)],!1),!isNaN(f.scrCoords[0]+f.scrCoords[1]+f.scrCoords[2]))return!1;return!0},_isOutside:function(s,t,h,u,d){var n=500,p=d.canvasWidth,f=d.canvasHeight;return s[1]<-500&&h[1]<-500||s[2]<-500&&h[2]<-500||s[1]>p+n&&h[1]>p+n||s[2]>f+n&&h[2]>f+n},_isOutsidePoint:function(s,t){var h=500,u=t.canvasWidth,d=t.canvasHeight;return s[1]<-500||s[2]<-500||s[1]>u+h||s[2]>d+h},_findStartPoint:function(s,t,h,u,d){return new y(E.COORDS_BY_USER,[0,0],s.board,!1),s.board.getBoundingBox(),[t,h]},_getBorderPos:function(s,t,h,u,d,n,p){var f,v,C,_,P,x;if(v=new y(E.COORDS_BY_USER,[0,0],s.board,!1),_=0,isNaN(h[1]+h[2])&&!isNaN(d[1]+d[2]))x=t,P=u;else if(isNaN(p[1]+p[2])&&!isNaN(d[1]+d[2]))x=n,P=u;else if(isNaN(d[1]+d[2])&&!isNaN(p[1]+p[2]))x=u,P=n;else{if(!isNaN(d[1]+d[2])||isNaN(h[1]+h[2]))return!1;x=u,P=t}do f=.5*(P+x),v.setCoordinates(E.COORDS_BY_USER,[s.X(f,!0),s.Y(f,!0)],!1),C=v.usrCoords,isNaN(C[1]+C[2])?x=f:P=f,++_;while(_<30&&Math.abs(P-x)>b.eps);return f},_getCuspPos:function(s,t,h){var u=[s.X(t,!0),s.Y(t,!0)],d=[s.X(h,!0),s.Y(h,!0)];return l.fminbr(function(n){var p=[s.X(n,!0),s.Y(n,!0)];return-(Math.sqrt((u[0]-p[0])*(u[0]-p[0])+(u[1]-p[1])*(u[1]-p[1]))+Math.sqrt((d[0]-p[0])*(d[0]-p[0])+(d[1]-p[1])*(d[1]-p[1])))},[t,h],s)},_getJumpPos:function(s,t,h){return l.fminbr(function(u){var d=b.eps*b.eps,n=[s.X(u,!0),s.Y(u,!0)],p=[s.X(u+d,!0),s.Y(u+d,!0)];return-Math.abs((p[1]-n[1])/(p[0]-n[0]))},[t,h],s)},_getLimits:function(s,t){var h,u,d,n,p,f=2/(s.maxX()-s.minX());return u=(h=m.limit(t,-f,s.X))[0],h[1]==="infinite"&&(u=Math.sign(u)*(1/0)),n=(h=m.limit(t,-f,s.Y))[0],h[1]==="infinite"&&(n=Math.sign(n)*(1/0)),d=(h=m.limit(t,f,s.X))[0],h[1]==="infinite"&&(d=Math.sign(d)*(1/0)),p=(h=m.limit(t,f,s.Y))[0],h[1]==="infinite"&&(p=Math.sign(p)*(1/0)),{left_x:u,left_y:n,right_x:d,right_y:p,t}},_getLimes:function(s,t,h,u,d,n,p,f,v){var C;return f==="border"?C=this._getBorderPos(s,t,h,u,d,n,p):f==="cusp"?C=this._getCuspPos(s,t,n):f==="jump"&&(C=this._getJumpPos(s,t,n)),this._getLimits(s,C)},_plotNonRecursive:function(s,t,h,u,d,n){var p,f,v,C,_,P,x,S,O,w,T,M=null,N=!1,A="",R=[],L=0;for(S=s.board.origin.scrCoords,R[L++]=[t,h,u,d,n,1/0];L>0;){if(t=(T=R[--L])[0],h=T[1],u=T[2],d=T[3],O=T[4],w=T[5],N=!1,A="",M=null,s.points.length>65536)return;O<this.nanLevel&&(this._isUndefined(s,t,h,u,d)||this._isOutside(t,h,u,d,s.board))||(p=.5*(h+d),P=s.X(p,!0),x=s.Y(p,!0),f=[1,S[1]+P*s.board.unitX,S[2]-x*s.board.unitY],v=this._triangleDists(t,u,f),C=isNaN(t[1]+t[2]),_=isNaN(u[1]+u[2]),C&&!_||!C&&_?A="border":v[0]>.66*w||v[0]<this.cusp_threshold*(v[1]+v[2])||v[1]>5*v[2]||v[2]>5*v[1]?A="cusp":(v[2]>this.jump_threshold*v[0]||v[1]>this.jump_threshold*v[0]||v[0]===1/0||v[1]===1/0||v[2]===1/0)&&(A="jump"),N=A===""&&O<this.smoothLevel&&v[3]<this.smooth_threshold,O<this.testLevel&&!N&&(A===""?N=!0:M=this._getLimes(s,h,t,p,f,d,u,A,O)),M!==null?(f=[1,NaN,NaN],this._insertPoint(s,f,p,O,M)):O<=0||N?this._insertPoint(s,f,p,O,null):(R[L++]=[f,p,u,d,O-1,v[0]],R[L++]=[t,h,f,p,O-1,v[0]]))}return this},updateParametricCurve_v3:function(s,t,h){var u,d,n,p,f,v,C,_,P=!1,x=new y(E.COORDS_BY_USER,[0,0],s.board,!1),S=new y(E.COORDS_BY_USER,[0,0],s.board,!1);return f=s.board.updateQuality===s.board.BOARD_QUALITY_LOW?o.evaluate(s.visProp.recursiondepthlow)||14:o.evaluate(s.visProp.recursiondepthhigh)||17,this.smoothLevel=7,this.nanLevel=f-4,this.testLevel=4,this.cusp_threshold=.5,this.jump_threshold=.99,this.smooth_threshold=2,s.points=[],s.xterm==="x"?(v=.3*((C=s.board.getBoundingBox())[2]-C[0]),u=Math.max(t,C[0]-v),d=Math.min(h,C[2]+v)):(u=t,d=h),x.setCoordinates(E.COORDS_BY_USER,[s.X(u,P),s.Y(u,P)],!1),P=!0,S.setCoordinates(E.COORDS_BY_USER,[s.X(d,P),s.Y(d,P)],!1),_=this._findStartPoint(s,x.scrCoords,u,S.scrCoords,d),x.setCoordinates(E.COORDS_BY_SCREEN,_[0],!1),u=_[1],_=this._findStartPoint(s,S.scrCoords,d,x.scrCoords,u),S.setCoordinates(E.COORDS_BY_SCREEN,_[0],!1),d=_[1],this._visibleArea=[u,d],n=x.copy("scrCoords"),p=S.copy("scrCoords"),x._t=u,s.points.push(x),this._lastScrCrds=x.copy("scrCoords"),this._lastUsrCrds=x.copy("usrCoords"),this._plotNonRecursive(s,n,u,p,d,f),S._t=d,s.points.push(S),s.numberPoints=s.points.length,s},_criticalInterval:function(s,t,h){var u,d,n,p,f,v,C,_=!1,P=-1/0,x=!1,S=!1,O=0,w=[],T=[],M=[];for(C=c.abs(s),(p=c.median(C))<1e-7?(p=1e-7,x=!0):p*=this.criticalThreshold,u=0;u<t;u++)C[u]>p?(M.push({i:u,v:s[u],group:O}),P=u,_||(_=!0)):_&&u>P+4&&(M.length>0&&w.push(M.slice(0)),M=[],_=!1,O++);for(_&&M.length>1&&w.push(M.slice(0)),x&&w.length===0&&(S=!0),d=0;d<w.length;d++)if(T[d]="point",!((n=w[d].length)<64)){for(v=0,f=Math.sign(w[d][0].v),u=1;u<n;u++)Math.sign(w[d][u].v)!==f&&(v++,f=Math.sign(w[d][u].v));6*v>n&&(T[d]="interval")}return{smooth:S,groups:w,types:T}},Component:function(){this.left_isNaN=!1,this.right_isNaN=!1,this.left_t=null,this.right_t=null,this.t_values=[],this.x_values=[],this.y_values=[],this.len=0},findComponents:function(s,t,h,u){var d,n,p,f,v,C,_=[],P=0,x=0,S=0,O=!1,w=!1;for(p=(h-t)/u,_[P]=new this.Component,C=_[P],d=0,n=t;d<=u;d++,n+=p)f=s.X(n,w),v=s.Y(n,w),isNaN(f)||isNaN(v)?++S>1&&O&&(C.right_isNaN=!0,C.right_t=n-p,C.len=x,O=!1,_[++P]=new this.Component,C=_[P],S=0):(O||(O=!0,x=0,S>0&&(C.left_t=n-p,C.left_isNaN=!0)),S=0,C.t_values[x]=n,C.x_values[x]=f,C.y_values[x]=v,x++),d===0&&(w=!0);return O?C.len=x:_.pop(),_},getPointType:function(s,t,h,u,d,n,p){var f=d[0],v=n[0],C=u.length,_={idx:t,t:h,x:f[t],y:v[t],type:"other"};return t<5?(_.type="borderleft",_.idx=0,_.t=u[0],_.x=f[0],_.y=v[0],_):(t>p-6&&(_.type="borderright",_.idx=C-1,_.t=u[C-1],_.x=f[C-1],_.y=v[C-1]),_)},newtonApprox:function(s,t,h,u,d){var n,p=0;for(n=u;n>0;n--)p=(p+d[n][s])*(t-(n-1)*h)/n;return p+d[0][s]},thiele:function(s,t,h,u,d){var n,p=0;for(n=d;n>1;n--)p=(s-h[u+n])/(t[n][u+1]-t[n-2][u+1]+p);return t[0][u+1]+(s-h[u+1])/(t[1][u+1]+p)},differenceMethodExperiments:function(s,t){var h,u,d,n,p,f,v,C,_,P,x,S=s.t_values,O=s.x_values,w=s.y_values,T=[],M=[],N=[],A=[],R=[],L=[],D=[],k=[],B=0,j=[];for(p=S[1]-S[0],R.push([]),L.push([]),D.push([]),k.push([]),d=w.length,h=0;h<d;h++)R[0][h]=O[h],L[0][h]=w[h],D[0][h]=O[h],k[0][h]=w[h];for(R.push([]),L.push([]),D.push([]),k.push([]),f=p,d=w.length-1,h=0;h<d;h++)T[h]=O[h+1]-O[h],M[h]=w[h+1]-w[h],N[h]=T[h],A[h]=M[h],R[1][h]=T[h],L[1][h]=M[h],D[1][h]=f/T[h],k[1][h]=f/M[h];for(d--,n=Math.min(8,w.length-1),u=1;u<n;u++){for(R.push([]),L.push([]),D.push([]),k.push([]),f*=p,h=0;h<d;h++)T[h]=T[h+1]-T[h],M[h]=M[h+1]-M[h],R[u+1][h]=T[h],L[u+1][h]=M[h],D[u+1][h]=f/(D[u][h+1]-D[u][h])+D[u-1][h+1],k[u+1][h]=f/(k[u][h+1]-k[u][h])+k[u-1][h+1];if((x=this._criticalPoints(M,d,u))===!1){console.log("Polynomial of degree",u),x=[];break}if(x.length>0&&++B>1&&u%2==0)break;d--}for(h=0;h<x.length;h++){for(C=-1/0,_=0;_<x[h].length;_++)(P=Math.abs(x[h][_].v))>C&&(C=P,v=_);v=Math.floor(x[h][v].i+u/2),j.push(this.getPointType(t,v,S,O,w,N,A,d+1))}return[j,R,L,D,k]},getCenterOfCriticalInterval:function(s,t,h){var u,d,n,p,f,v=0,C=0,_=h[1]-h[0],P=[];for(u=-1/0,P=[],d=0;d<s.length;d++)(p=Math.abs(s[d].v))>u?(P=[d],u=p,n=d):u===p&&P.push(d);if(P.length>0&&(f=P.reduce(function(x,S){return x+S},0)/P.length,n=Math.floor(f),f+=s[0].i),u<1/0){for(d=0;d<s.length;d++)v+=Math.abs(s[d].v)*s[d].i,C+=Math.abs(s[d].v);f=v/C}return f+=t/2,[s[n].i+t/2,f,h[Math.floor(f)]+_*(f-Math.floor(f))]},differenceMethod:function(s,t){var h,u,d,n,p,f,v,C,_,P,x=s.t_values,S=s.x_values,O=s.y_values,w=[],T=[],M=0,N=-1,A=-1,R=[],L=[];for(d=O.length,w.push(new Float64Array(S)),T.push(new Float64Array(O)),d--,n=Math.min(12,d),u=0;u<n&&(w.push(new Float64Array(d)),T.push(new Float64Array(d)),w[u+1]=w[u].map(function(D,k,B){return B[k+1]-D}),T[u+1]=T[u].map(function(D,k,B){return B[k+1]-D}),(C=this._criticalInterval(T[u+1],d,u)).smooth===!0&&(A=u,R=[]),v=this._criticalInterval(w[u+1],d,u),N===-1&&v.smooth===!0&&(N=u),!(A>=0));u++){if(C.groups.length>0&&++M>2&&(u+1)%2==0){R=C.groups,P=C.types;break}d--}for(h=0;h<R.length;h++)P[h]!=="interval"&&(f=this.getCenterOfCriticalInterval(R[h],u+1,x),C[0],p=Math.floor(f[1]),_=f[2],L.push(this.getPointType(t,p,_,x,w,T,d+1)));return[L,w,T,N,A]},_insertPoint_v4:function(s,t,h,u){var d,n,p,f=null;s.points.length>0&&(f=s.points[s.points.length-1].scrCoords),d=new y(E.COORDS_BY_USER,t,s.board),f!==null&&(n=d.scrCoords[1]-f[1])*n+(p=d.scrCoords[2]-f[2])*p<.8*.8||(d._t=h,s.points.push(d))},getInterval:function(s,t,h){var u,d;return e.disable(),u=e.Interval(t,h),s.board.mathLib=e,s.board.mathLibJXG=e,s.X(u,!0),d=s.Y(u,!0),s.board.mathLib=Math,s.board.mathLibJXG=g.Math,d},sign:function(s){return s<0?-1:s>0?1:0},handleBorder:function(s,t,h,u,d){var n,p,f,v,C,_,P,x,S,O,w,T,M=h.idx;if(T=t.t_values[1]-t.t_values[0],h.type==="borderleft"?f=(p=n=t.left_isNaN?t.left_t:h.t-T)+T:h.type==="borderright"?p=(f=n=t.right_isNaN?t.right_t:h.t+T)-T:console.log("No bordercase!!!"),(O=this.findComponents(s,p,f,32)).length!==0){for(h.type==="borderleft"&&(p=O[0].left_t,f=O[0].t_values[0],T=O[0].t_values[1]-O[0].t_values[0],n=p=p===null?f-T:p,v=this.getInterval(s,p,f),o.isObject(v)&&(P=v.lo,x=v.hi,C=s.X(n,!0),_=d[1][M]<0?x:P,this._insertPoint_v4(s,[1,C,_],n))),w=O[0].t_values.length,S=0;S<w;S++)n=O[0].t_values[S],C=O[0].x_values[S],_=O[0].y_values[S],this._insertPoint_v4(s,[1,C,_],n);h.type==="borderright"&&(p=O[0].t_values[w-1],f=O[0].right_t,T=O[0].t_values[1]-O[0].t_values[0],n=f=f===null?p+T:f,v=this.getInterval(s,p,f),o.isObject(v)&&(P=v.lo,x=v.hi,C=s.X(n,!0),_=d[1][M]>0?x:P,this._insertPoint_v4(s,[1,C,_],n)))}},_seconditeration_v4:function(s,t,h,u,d){var n,p,f,v,C,_,P,x,S,O,w,T,M;for(p=t.t_values[h.idx-2],f=t.t_values[h.idx+2],C=this.findComponents(s,p,f,64),P=0;P<C.length;P++){for(_=C[P],x=(v=this.differenceMethod(_,s))[0],O=v[1],w=v[2],T=0,S=0;S<=x.length;S++){for(M=S===x.length?_.len:x[S].idx,n=T;n<M;n++)isNaN(_.x_values[n])||isNaN(_.y_values[n])||this._insertPoint_v4(s,[1,_.x_values[n],_.y_values[n]],_.t_values[n]);S<x.length&&(this.handleSingularity(s,_,x[S],O,w),T=x[S].idx+1)}M=_.len,P<C.length-1&&this._insertPoint_v4(s,[1,NaN,NaN],_.right_t)}return this},_recurse_v4:function(s,t,h,u,d,n,p,f){var v,C,_=.5*(t+h),P=s.X(_,!0),x=s.Y(_,!0);f!==0?(v=(P-u)*s.board.unitX,C=(x-d)*s.board.unitY,Math.sqrt(v*v+C*C)>2?this._recurse_v4(s,t,_,u,d,P,x,f-1):this._insertPoint_v4(s,[1,P,x],_),v=(P-n)*s.board.unitX,C=(x-p)*s.board.unitY,Math.sqrt(v*v+C*C)>2?this._recurse_v4(s,_,h,P,x,n,p,f-1):this._insertPoint_v4(s,[1,P,x],_)):this._insertPoint_v4(s,[1,NaN,NaN],_)},handleSingularity:function(s,t,h,u,d){var n,p,f,v,C,_,P,x,S,O,w,T=h.idx,M=100;n=h.t,console.log("HandleSingularity at t =",n),p=t.t_values[T-5],f=t.t_values[T+5],v=this.getInterval(s,p,f),o.isObject(v)?(x=v.lo,S=v.hi):d[0][T-1]<d[0][T+1]?(x=d[0][T-1],S=d[0][T+1]):(x=d[0][T+1],S=d[0][T-1]),P=s.X(n,!0),O=(d[0][T-3]-d[0][T-5])/(t.t_values[T-3]-t.t_values[T-5]),w=(d[0][T+3]-d[0][T+5])/(t.t_values[T+3]-t.t_values[T+5]),console.log(":::",O,w),O<-100?(this._insertPoint_v4(s,[1,P,x],n,!0),w<=M&&this._insertPoint_v4(s,[1,NaN,NaN],n)):O>M?(this._insertPoint_v4(s,[1,P,S],n),w>=-100&&this._insertPoint_v4(s,[1,NaN,NaN],n)):(x===-1/0&&(this._insertPoint_v4(s,[1,P,x],n,!0),this._insertPoint_v4(s,[1,NaN,NaN],n)),S===1/0&&(this._insertPoint_v4(s,[1,NaN,NaN],n),this._insertPoint_v4(s,[1,P,S],n,!0)),h.t<t.t_values[T]?(C=T-1,_=T):(C=T,_=T+1),p=t.t_values[C],f=t.t_values[_],this._recurse_v4(s,p,f,u[0][C],d[0][C],u[0][_],d[0][_],10)),w<-100?this._insertPoint_v4(s,[1,P,S],n):w>M&&this._insertPoint_v4(s,[1,P,x],n)},steps:1021,criticalThreshold:1e3,plot_v4:function(s,t,h,u){var d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A=(h-t)/u,R=function(k){return s.Y(k,!0)},L=function(k){return-s.Y(k,!0)},D=.5*A;for(p=this.findComponents(s,t,h,u),f=0;f<p.length;f++){for(v=p[f],C=(x=this.differenceMethod(v,s))[0],S=x[1],O=x[2],x[3],x[4],C.length!==0&&C[0].type==="borderleft"||C.unshift({idx:0,t:v.t_values[0],x:v.x_values[0],y:v.y_values[0],type:"borderleft"}),C[C.length-1].type!=="borderright"&&(n=v.t_values.length,C.push({idx:n-1,t:v.t_values[n-1],x:v.x_values[n-1],y:v.y_values[n-1],type:"borderright"})),P=0,_=0;_<=C.length;_++){for(n=_===C.length?v.len:C[_].idx-1,d=P;d<n-2;d++)this._insertPoint_v4(s,[1,v.x_values[d],v.y_values[d]],v.t_values[d]),d>=P+3&&d<n-3&&O.length>3&&Math.abs(O[2][d])>.2*Math.abs(O[0][d])&&(w=v.t_values[d],D=.25*A,N=this.getInterval(s,w,w+A),o.isObject(N)?O[2][d]>0?this._insertPoint_v4(s,[1,w+D,N.lo],w+D):this._insertPoint_v4(s,[1,w+A-D,N.hi],w+A-D):(T=l.fminbr(R,[w,w+A]))<(M=l.fminbr(L,[w,w+A]))?(this._insertPoint_v4(s,[1,s.X(T,!0),s.Y(T,!0)],T),this._insertPoint_v4(s,[1,s.X(M,!0),s.Y(M,!0)],M)):(this._insertPoint_v4(s,[1,s.X(M,!0),s.Y(M,!0)],M),this._insertPoint_v4(s,[1,s.X(T,!0),s.Y(T,!0)],T)));_<C.length&&(d=C[_].idx,C[_].type==="borderleft"||C[_].type==="borderright"?this.handleBorder(s,v,C[_],S,O):this._seconditeration_v4(s,v,C[_],S,O),P=C[_].idx+1+1)}n=v.len,f<p.length-1&&this._insertPoint_v4(s,[1,NaN,NaN],v.right_t)}},updateParametricCurve_v4:function(s,t,h){var u,d,n,p;s.xterm==="x"?(n=.3*((p=s.board.getBoundingBox())[2]-p[0]),u=Math.max(t,p[0]-n),d=Math.min(h,p[2]+n)):(u=t,d=h),s.points=[],this.plot_v4(s,u,d,this.steps),s.numberPoints=s.points.length},updateParametricCurve:function(s,t,h){return this.updateParametricCurve_v2(s,t,h)}},b.Plot}),define("math/metapost",["utils/type","math/math"],function(g,E){return E.Metapost={MP_ENDPOINT:0,MP_EXPLICIT:1,MP_GIVEN:2,MP_CURL:3,MP_OPEN:4,MP_END_CYCLE:5,UNITY:1,FRACTION_ONE:1,FRACTION_THREE:3,ONE_EIGHTY_DEG:Math.PI,THREE_SIXTY_DEG:2*Math.PI,EPS_SQ:1e-5*1e-5,make_choices:function(y){var b,m,l,c,a,e,o,s,t,h,u,d,n,p,f;o=y[0];do{if(!o)break;e=o.next,o.rtype>this.MP_EXPLICIT&&(o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)<this.EPS_SQ&&(o.rtype=this.MP_EXPLICIT,o.ltype===this.MP_OPEN&&(o.ltype=this.MP_CURL,o.set_left_curl(this.UNITY)),e.ltype=this.MP_EXPLICIT,e.rtype===this.MP_OPEN&&(e.rtype=this.MP_CURL,e.set_right_curl(this.UNITY)),o.rx=o.x,e.lx=o.x,o.ry=o.y,e.ly=o.y),o=e}while(o!==y[0]);for(m=y[0];m.ltype===this.MP_OPEN&&m.rtype===this.MP_OPEN;)if((m=m.next)===y[0]){m.ltype=this.MP_END_CYCLE;break}for(o=m;o;){if(e=o.next,o.rtype>=this.MP_GIVEN){for(;e.ltype===this.MP_OPEN&&e.rtype===this.MP_OPEN;)e=e.next;for(l=0,s=o,a=y.length,d=[],n=[],p=[],f=[null];h=s.next,d.push(h.x-s.x),n.push(h.y-s.y),p.push(this.mp_pyth_add(d[l],n[l])),l>0&&(u=n[l-1]/p[l-1],t=d[l-1]/p[l-1],f.push(Math.atan2(n[l]*t-d[l]*u,d[l]*t+n[l]*u))),l++,(s=h)===e&&(a=l),!(l>=a&&s.ltype!==this.MP_END_CYCLE););l===a?f.push(0):f.push(f[1]),e.ltype===this.MP_OPEN&&((c=e.rx-e.x)*c+(b=e.ry-e.y)*b<this.EPS_SQ?(e.ltype=this.MP_CURL,e.set_left_curl(this.UNITY)):(e.ltype=this.MP_GIVEN,e.set_left_given(Math.atan2(b,c)))),o.rtype===this.MP_OPEN&&o.ltype===this.MP_EXPLICIT&&((c=o.x-o.lx)*c+(b=o.y-o.ly)*b<this.EPS_SQ?(o.rtype=this.MP_CURL,o.set_right_curl(this.UNITY)):(o.rtype=this.MP_GIVEN,o.set_right_given(Math.atan2(b,c)))),this.mp_solve_choices(o,e,a,d,n,p,f)}else o.rtype===this.MP_ENDPOINT&&(o.rx=o.x,o.ry=o.y,e.lx=e.x,e.ly=e.y);if((o=e)===m)break}},mp_solve_choices:function(y,b,m,l,c,a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A,R,L,D,k,B;for(u=a.length+1,v=new Array(u),f=new Array(u),t=new Array(u),S=new Array(u),k=0;k<u;k++)S[k]=t[k]=f[k]=v[k]=0;for(n=0,p=y,_=0;;){if(P=p.next,n===0)if(p.rtype===this.MP_GIVEN){if(P.ltype===this.MP_GIVEN)return o=Math.atan2(c[0],l[0]),N=(M=this.mp_n_sin_cos(y.right_given()-o))[0],A=M[1],L=(R=this.mp_n_sin_cos(b.left_given()-o))[0],D=R[1],void this.mp_set_controls(y,b,l[0],c[0],A,N,-D,L);t[0]=p.right_given()-Math.atan2(c[0],l[0]),t[0]=this.reduce_angle(t[0]),v[0]=0,f[0]=0}else if(p.rtype===this.MP_CURL){if(P.ltype===this.MP_CURL)return y.rtype=this.MP_EXPLICIT,b.ltype=this.MP_EXPLICIT,C=Math.abs(b.left_tension()),O=Math.abs(y.right_tension()),x=this.UNITY/(3*O),y.rx=y.x+l[0]*x,y.ry=y.y+c[0]*x,x=this.UNITY/(3*C),b.lx=b.x-l[0]*x,void(b.ly=b.y-c[0]*x);T=p.right_curl(),C=Math.abs(P.left_tension()),O=Math.abs(p.right_tension()),v[0]=this.mp_curl_ratio(T,O,C),t[0]=-e[1]*v[0],f[0]=0}else p.rtype===this.MP_OPEN&&(v[0]=0,t[0]=0,f[0]=this.FRACTION_ONE);else if(p.ltype===this.MP_END_CYCLE||p.ltype===this.MP_OPEN){if(o=this.UNITY/(3*Math.abs(_.right_tension())-this.UNITY),w=a[n]*(this.FRACTION_THREE-this.UNITY/Math.abs(_.right_tension())),h=this.UNITY/(3*Math.abs(P.left_tension())-this.UNITY),d=a[n-1]*(this.FRACTION_THREE-this.UNITY/Math.abs(P.left_tension())),w*=T=this.FRACTION_ONE-v[n-1]*o,(C=Math.abs(p.left_tension()))<(O=Math.abs(p.right_tension()))?w*=Math.pow(C/O,2):C>O&&(d*=Math.pow(O/C,2)),x=d/(d+w),v[n]=x*h,s=-e[n+1]*v[n],_.rtype===this.MP_CURL?(f[n]=0,t[n]=s-e[1]*(this.FRACTION_ONE-x)):(x=(this.FRACTION_ONE-x)/T,s-=e[n]*x,x*=o,t[n]=s-t[n-1]*x,f[n]=-f[n-1]*x),p.ltype===this.MP_END_CYCLE){for(o=0,h=this.FRACTION_ONE;(n-=1)===0&&(n=m),o=t[n]-o*v[n],h=f[n]-h*v[n],n!==m;);for(o/=this.FRACTION_ONE-h,S[m]=o,t[0]=o,B=1;B<m;B++)t[B]=t[B]+o*f[B];break}}else{if(p.ltype===this.MP_CURL){T=p.left_curl(),C=Math.abs(p.left_tension()),O=Math.abs(_.right_tension()),x=this.mp_curl_ratio(T,C,O),S[m]=-t[m-1]*x/(this.FRACTION_ONE-x*v[m-1]);break}if(p.ltype===this.MP_GIVEN){S[m]=p.left_given()-Math.atan2(c[m-1],l[m-1]),S[m]=this.reduce_angle(S[m]);break}}_=p,p=P,n+=1}for(n=m-1;n>-1;n--)S[n]=t[n]-S[n+1]*v[n];for(p=y,n=0;P=p.next,N=(M=this.mp_n_sin_cos(S[n]))[0],A=M[1],L=(R=this.mp_n_sin_cos(-e[n+1]-S[n+1]))[0],D=R[1],this.mp_set_controls(p,P,l[n],c[n],A,N,D,L),p=P,++n!==m;);},mp_n_sin_cos:function(y){return[Math.cos(y),Math.sin(y)]},mp_set_controls:function(y,b,m,l,c,a,e,o){var s,t,h,u,d;h=Math.abs(b.left_tension()),s=Math.abs(y.right_tension()),d=this.mp_velocity(c,a,e,o,s),t=this.mp_velocity(e,o,c,a,h),(y.right_tension()<0||b.left_tension()<0)&&(c>=0&&e>=0||c<=0&&e<=0)&&(u=Math.abs(c)*o+Math.abs(e)*a)>0&&(u*=1.00024414062,y.right_tension()<0&&this.mp_ab_vs_cd(Math.abs(e),this.FRACTION_ONE,d,u)<0&&(d=Math.abs(e)/u),b.left_tension()<0&&this.mp_ab_vs_cd(Math.abs(c),this.FRACTION_ONE,t,u)<0&&(t=Math.abs(c)/u)),y.rx=y.x+(m*a-l*c)*d,y.ry=y.y+(l*a+m*c)*d,b.lx=b.x-(m*o+l*e)*t,b.ly=b.y-(l*o-m*e)*t,y.rtype=this.MP_EXPLICIT,b.ltype=this.MP_EXPLICIT},mp_pyth_add:function(y,b){return Math.sqrt(y*y+b*b)},mp_curl_ratio:function(y,b,m){var l=1/b,c=1/m;return Math.min(4,((3-l)*l*l*y+c*c*c)/(l*l*l*y+(3-c)*c*c))},mp_ab_vs_cd:function(y,b,m,l){return y*b==m*l?0:y*b>m*l?1:-1},mp_velocity:function(y,b,m,l,c){return Math.min(4,(2+Math.sqrt(2)*(y-m/16)*(m-y/16)*(b-l))/(1.5*c*(2+(Math.sqrt(5)-1)*b+(3-Math.sqrt(5))*l)))},reduce_angle:function(y){return Math.abs(y)>this.ONE_EIGHTY_DEG&&(y>0?y-=this.THREE_SIXTY_DEG:y+=this.THREE_SIXTY_DEG),y},makeknots:function(y,b,m){var l,c,a=[];for(b=b||1,c=y.length,l=0;l<c;l++)a.push({x:y[l][0],y:y[l][1],ltype:this.MP_OPEN,rtype:this.MP_OPEN,ly:b,ry:b,lx:b,rx:b,left_curl:function(){return this.lx||0},right_curl:function(){return this.rx||0},left_tension:function(){return this.ly||(this.ly=1),this.ly},right_tension:function(){return this.ry||(this.ry=1),this.ry},set_right_curl:function(e){this.rx=e||0},set_left_curl:function(e){this.lx=e||0}});for(c=a.length,l=0;l<c;l++)a[l].next=a[l+1]||a[l],a[l].set_right_given=a[l].set_right_curl,a[l].set_left_given=a[l].set_left_curl,a[l].right_given=a[l].right_curl,a[l].left_given=a[l].left_curl;return a[c-1].next=a[0],m||(a[c-1].rtype=this.MP_ENDPOINT,a[c-1].ltype=this.MP_CURL,a[0].rtype=this.MP_CURL),a},curve:function(y,b){var m,l,c,a,e=[],o=[];for(c in b=b||{tension:1,direction:{},curl:{},isClosed:!1},l=(m=this.makeknots(y,g.evaluate(b.tension),b.isClosed)).length,b.direction)b.direction.hasOwnProperty(c)&&(a=g.evaluate(b.direction[c]),g.isArray(a)?(a[0]!==!1&&(m[c].lx=a[0]*Math.PI/180,m[c].ltype=this.MP_GIVEN),a[1]!==!1&&(m[c].rx=a[1]*Math.PI/180,m[c].rtype=this.MP_GIVEN)):(m[c].lx=a*Math.PI/180,m[c].rx=a*Math.PI/180,m[c].ltype=m[c].rtype=this.MP_GIVEN));for(c in b.curl)b.curl.hasOwnProperty(c)&&(a=g.evaluate(b.curl[c]),parseInt(c,10)===0?(m[c].rtype=this.MP_CURL,m[c].set_right_curl(a)):parseInt(c,10)===l-1&&(m[c].ltype=this.MP_CURL,m[c].set_left_curl(a)));for(this.make_choices(m),c=0;c<l-1;c++)e.push(m[c].x),e.push(m[c].rx),e.push(m[c+1].lx),o.push(m[c].y),o.push(m[c].ry),o.push(m[c+1].ly);return e.push(m[l-1].x),o.push(m[l-1].y),b.isClosed&&(e.push(m[l-1].rx),o.push(m[l-1].ry),e.push(m[0].lx),o.push(m[0].ly),e.push(m[0].x),o.push(m[0].y)),[e,o]}},E.Metapost}),define("utils/zip",["jxg"],function(g){var E=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];return g.Util=g.Util||{},g.Util.Unzip=function(a){var e,o,s,t,h=[],u=0,d=[],n=new Array(32768),p=0,f=!1,v=a.length,C=0,_=1,P=new Array(288),x=new Array(32),S=0,O=null,w=(new Array(64),new Array(64),0),T=new Array(17),M=[];function N(){return C<v?a[C++]:-1}function A(){_=1}function R(){var J;try{return J=1&_,(_>>=1)===0&&(J=1&(_=N()),_=_>>1|128),J}catch(z){throw z}}function L(J){var z=0,X=J;try{for(;X--;)z=z<<1|R();J&&(z=E[z]>>8-J)}catch(G){throw G}return z}function D(){p=0}function k(J){n[p++]=J,h.push(String.fromCharCode(J)),p===32768&&(p=0)}function B(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function j(){for(;;){if(T[w]>=t)return-1;if(s[T[w]]===w)return T[w]++;T[w]++}}function I(){var J,z=O[S];if(w===17)return-1;if(S++,w++,(J=j())>=0)z.b0=J;else if(z.b0=32768,I())return-1;if((J=j())>=0)z.b1=J,z.jump=null;else if(z.b1=32768,z.jump=O[S],z.jumppos=S,I())return-1;return w--,0}function q(J,z,X,G){var Q;for(O=J,S=0,s=X,t=z,Q=0;Q<17;Q++)T[Q]=0;return w=0,I()?-1:0}function $(J){for(var z,X,G=0,Q=J[G];;)if(R()){if(!(32768&Q.b1))return Q.b1;for(Q=Q.jump,z=J.length,X=0;X<z;X++)if(J[X]===Q){G=X;break}}else{if(!(32768&Q.b0))return Q.b0;Q=J[++G]}}function Z(){var J,z,X,G,Q,ie,ce,he,ae,oe,H,de,ne,ge,fe;do if(J=R(),(z=L(2))===0)for(A(),ae=N(),ae|=N()<<8,H=N(),65535&(ae^~(H|=N()<<8))&&g.debug(`BlockLen checksum mismatch
`);ae--;)k(N());else if(z===1)for(;;)if((G=E[L(7)]>>1)>23?(G=G<<1|R())>199?G=(G-=128)<<1|R():(G-=48)>143&&(G+=136):G+=256,G<256)k(G);else{if(G===256)break;for(he=L(b[G-=257])+y[G],G=E[L(5)]>>3,l[G]>8?(oe=L(8),oe|=L(l[G]-8)<<8):oe=L(l[G]),oe+=m[G],G=0;G<he;G++)k(n[p-oe&32767])}else if(z===2){for(ie=new Array(320),ne=257+L(5),ge=1+L(5),fe=4+L(4),G=0;G<19;G++)ie[G]=0;for(G=0;G<fe;G++)ie[c[G]]=L(3);for(he=x.length,X=0;X<he;X++)x[X]=new B;if(q(x,19,ie))return D(),1;for(de=ne+ge,X=0,-1;X<de;)if((G=$(x))<16)ie[X++]=G;else if(G===16){if(X+(G=3+L(2))>de)return D(),1;for(Q=X?ie[X-1]:0;G--;)ie[X++]=Q}else{if(X+(G=G===17?3+L(3):11+L(7))>de)return D(),1;for(;G--;)ie[X++]=0}for(he=P.length,X=0;X<he;X++)P[X]=new B;if(q(P,ne,ie))return D(),1;for(he=P.length,X=0;X<he;X++)x[X]=new B;for(ce=[],X=ne;X<ie.length;X++)ce[X-ne]=ie[X];if(q(x,ge,ce))return D(),1;for(;;)if((G=$(P))>=256){if((G-=256)===0)break;for(he=L(b[G-=1])+y[G],G=$(x),l[G]>8?(oe=L(8),oe|=L(l[G]-8)<<8):oe=L(l[G]),oe+=m[G];he--;)k(n[p-oe&32767])}else k(G)}while(!J);return D(),A(),0}function V(){var J,z,X,G,Q,ie=[];try{if(h=[],f=!1,ie[0]=N(),ie[1]=N(),ie[0]===120&&ie[1]===218&&(Z(),d[u]=[h.join(""),"geonext.gxt"],u++),ie[0]===31&&ie[1]===139&&(U(),d[u]=[h.join(""),"file"],u++),ie[0]===80&&ie[1]===75){if(f=!0,ie[2]=N(),ie[3]=N(),ie[2]===3&&ie[3]===4){for(ie[0]=N(),ie[1]=N(),e=N(),e|=N()<<8,Q=N(),Q|=N()<<8,N(),N(),N(),N(),N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,G=N(),G|=N()<<8,X=N(),X|=N()<<8,J=0,M=[];G--;)(z=N())==="/"|z===":"?J=0:J<255&&(M[J++]=String.fromCharCode(z));for(o||(o=M),J=0;J<X;)z=N(),J++;if(Q===8&&(Z(),d[u]=new Array(2),d[u][0]=h.join(""),d[u][1]=M.join(""),u++),U())return!1}return!0}}catch(ce){throw ce}return!1}function U(){var J,z,X=[];if(8&e&&(X[0]=N(),X[1]=N(),X[2]=N(),X[3]=N(),X[0]===80&&X[1]===75&&X[2]===7&&X[3]===8?(N(),N()<<8,N()<<16,N()<<24):X[0]|X[1]<<8|X[2]<<16|X[3]<<24,N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24),f&&V())return!1;if(X[0]=N(),X[0]!==8)return!0;if(e=N(),N(),N(),N(),N(),N(),N(),4&e)for(X[0]=N(),X[2]=N(),w=X[0]+256*X[1],J=0;J<w;J++)N();if(8&e)for(J=0,M=[],z=N();z;)z!=="7"&&z!==":"||(J=0),J<255&&(M[J++]=z),z=N();if(16&e)for(z=N();z;)z=N();return 2&e&&(N(),N()),Z(),N(),N()<<8,N()<<16,N()<<24,N(),N()<<8,N()<<16,N()<<24,f&&V(),!1}T[0]=0,g.Util.Unzip.prototype.unzipFile=function(J){var z;for(this.unzip(),z=0;z<d.length;z++)if(d[z][1]===J)return d[z][0];return""},g.Util.Unzip.prototype.unzip=function(){return V(),d}},g.Util}),define("utils/encoding",["jxg"],function(g){var E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return g.Util=g.Util||{},g.Util.UTF8={encode:function(y){var b,m,l="",c=y.length;if(y=y.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(y));for(b=0;b<c;b++)(m=y.charCodeAt(b))<128?l+=String.fromCharCode(m):m>127&&m<2048?(l+=String.fromCharCode(m>>6|192),l+=String.fromCharCode(63&m|128)):(l+=String.fromCharCode(m>>12|224),l+=String.fromCharCode(m>>6&63|128),l+=String.fromCharCode(63&m|128));return l},decode:function(y){var b,m,l,c=0,a=0,e=0,o=[],s=y.length,t=[];for(b=0;b<s;b++)m=y.charCodeAt(b),l=E[m],a=e!==0?63&m|a<<6:255>>l&m,(e=E[256+e+l])===0&&(a>65535?o.push(55232+(a>>10),56320+(1023&a)):o.push(a),++c%1e4==0&&(t.push(String.fromCharCode.apply(null,o)),o=[]));return t.push(String.fromCharCode.apply(null,o)),t.join("")},asciiCharCodeAt:function(y,b){var m=y.charCodeAt(b);if(m>255)switch(m){case 8364:m=128;break;case 8218:m=130;break;case 402:m=131;break;case 8222:m=132;break;case 8230:m=133;break;case 8224:m=134;break;case 8225:m=135;break;case 710:m=136;break;case 8240:m=137;break;case 352:m=138;break;case 8249:m=139;break;case 338:m=140;break;case 381:m=142;break;case 8216:m=145;break;case 8217:m=146;break;case 8220:m=147;break;case 8221:m=148;break;case 8226:m=149;break;case 8211:m=150;break;case 8212:m=151;break;case 732:m=152;break;case 8482:m=153;break;case 353:m=154;break;case 8250:m=155;break;case 339:m=156;break;case 382:m=158;break;case 376:m=159}return m}},g.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(g,E){var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b="=";function m(c,a){return 255&c.charCodeAt(a)}function l(c,a){return y.indexOf(c.charAt(a))}return g.Util=g.Util||{},g.Util.Base64={encode:function(c){var a,e,o,s,t,h=[];for(s=(o=(t=E.encode(c)).length)%3,a=0;a<o-s;a+=3)e=m(t,a)<<16|m(t,a+1)<<8|m(t,a+2),h.push(y.charAt(e>>18),y.charAt(e>>12&63),y.charAt(e>>6&63),y.charAt(63&e));switch(s){case 1:e=m(t,o-1),h.push(y.charAt(e>>2),y.charAt(e<<4&63),b,b);break;case 2:e=m(t,o-2)<<8|m(t,o-1),h.push(y.charAt(e>>10),y.charAt(e>>4&63),y.charAt(e<<2&63),b)}return h.join("")},decode:function(c,a){var e,o,s,t,h,u,d=[],n=[];if((s=(e=c.replace(/[^A-Za-z0-9+/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(e.charAt(s-1)===b&&(t=1,e.charAt(s-2)===b&&(t=2),s-=4),o=0;o<s;o+=4)h=l(e,o)<<18|l(e,o+1)<<12|l(e,o+2)<<6|l(e,o+3),n.push(h>>16,h>>8&255,255&h),o%1e4==0&&(d.push(String.fromCharCode.apply(null,n)),n=[]);switch(t){case 1:h=l(e,s)<<12|l(e,s+1)<<6|l(e,s+2),n.push(h>>10,h>>2&255);break;case 2:h=l(e,o)<<6|l(e,o+1),n.push(h>>4)}return d.push(String.fromCharCode.apply(null,n)),u=d.join(""),a&&(u=E.decode(u)),u},decodeAsArray:function(c){var a,e=this.decode(c),o=[],s=e.length;for(a=0;a<s;a++)o[a]=e.charCodeAt(a);return o}},g.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(g,E,y,b){return g.Server={modules:{},runningCalls:{},handleError:function(m){g.debug("error occured, server says: "+m.message)},callServer:function(m,l,c,a){var e,o,s,t,h,u,d;for(u in a=a||!1,c)c.hasOwnProperty(u)&&""+escape(u)+escape(c[u]);h=b.toJSON(c);do t=m+Math.floor(4096*Math.random());while(b.exists(this.runningCalls[t]));return this.runningCalls[t]={action:m},b.exists(c.module)&&(this.runningCalls[t].module=c.module),e=g.serverBase+"JXGServer.py",o="action="+escape(m)+"&id="+t+"&dataJSON="+escape(y.encode(h)),this.cbp=function(n){var p,f,v,C,_,P,x,S;if(p=new E.Unzip(y.decodeAsArray(n)).unzip(),b.isArray(p)&&p.length>0&&(p=p[0][0]),b.exists(p)){if((f=window.JSON&&window.JSON.parse?window.JSON.parse(p):new Function("return "+p)()).type==="error")this.handleError(f);else if(f.type==="response"){for(P=f.id,x=0;x<f.fields.length;x++)C=(v=f.fields[x]).namespace+(typeof new Function("return "+v.namespace)()=="object"?".":".prototype.")+v.name+" = "+v.value,new Function(C)();for(x=0;x<f.handler.length;x++){for(v=f.handler[x],_=[],S=0;S<v.parameters.length;S++)_[S]='"'+v.parameters[S]+'": '+v.parameters[S];C="if(typeof JXG.Server.modules."+this.runningCalls[P].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[P].module+" = {};",C+="JXG.Server.modules."+this.runningCalls[P].module+"."+v.name+"_cb = "+v.callback+";",C+="JXG.Server.modules."+this.runningCalls[P].module+"."+v.name+" = function ("+v.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[P].module+"."+v.name+"_cb;var __JXGSERVER_PAR__ = {"+_.join(",")+', "module": "'+this.runningCalls[P].module+'", "handler": "'+v.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(C)()}delete this.runningCalls[P],l(f.data)}}},this.cb=g.bind(this.cbp,this),window.XMLHttpRequest?(s=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):s=new ActiveXObject("Microsoft.XMLHTTP"),!(!s||(s.open("POST",e,!a),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a||(s.onreadystatechange=(d=this.cb,function(){return s.readyState===4&&s.status===200&&(d(s.responseText),!0)})),s.send(o),!a))&&(this.cb(s.responseText),!0)},loadModule_cb:function(m){var l;for(l=0;l<m.length;l++)g.debug(m[l].name+": "+m[l].value)},loadModule:function(m){return g.Server.callServer("load",g.Server.loadModule_cb,{module:m},!0)}},g.Server.load=g.Server.loadModule,g.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(g,E,y,b,m,l){var c;return y.Symbolic={generateSymbolicCoordinatesPartial:function(a,e,o,s){var t,h,u,d=e.ancestors,n=0,p=function(f){return s==="underscore"?o+"_{"+f+"}":s==="brace"?o+"["+f+"]":o+f};for(h in a.listOfFreePoints=[],a.listOfDependantPoints=[],d)if(d.hasOwnProperty(h)&&(t=0,l.isPoint(d[h]))){for(u in d[h].ancestors)d[h].ancestors.hasOwnProperty(u)&&t++;t===0?(d[h].symbolic.x=d[h].coords.usrCoords[1],d[h].symbolic.y=d[h].coords.usrCoords[2],a.listOfFreePoints.push(d[h])):(n+=1,d[h].symbolic.x=p(n),n+=1,d[h].symbolic.y=p(n),a.listOfDependantPoints.push(d[h]))}return l.isPoint(e)&&(e.symbolic.x="x",e.symbolic.y="y"),n},clearSymbolicCoordinates:function(a){var e=function(o){var s,t=o&&o.length||0;for(s=0;s<t;s++)l.isPoint(o[s])&&(o[s].symbolic.x="",o[s].symbolic.y="")};e(a.listOfFreePoints),e(a.listOfDependantPoints),delete a.listOfFreePoints,delete a.listOfDependantPoints},generatePolynomials:function(a,e,o){var s,t,h,u,d=e.ancestors,n=[],p=[];for(s in o&&this.generateSymbolicCoordinatesPartial(a,e,"u","brace"),d[e.id]=e,d)if(d.hasOwnProperty(s)&&(u=0,n=[],l.isPoint(d[s]))){for(t in d[s].ancestors)d[s].ancestors.hasOwnProperty(t)&&u++;if(u>0)for(n=d[s].generatePolynomial(),h=0;h<n.length;h++)p.push(n[h])}return o&&this.clearSymbolicCoordinates(a),p},geometricLocusByGroebnerBase:function(a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P=a.options.locus,x={},S=this.generateSymbolicCoordinatesPartial(a,e,"u","brace"),O=new E(g.COORDS_BY_USR,[0,0],a),w=new E(g.COORDS_BY_USR,[a.canvasWidth,a.canvasHeight],a),T=1,M=0,N=0,A=0;if(m.modules.geoloci===c&&m.loadModule("geoloci"),m.modules.geoloci===c)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(d=O.usrCoords[1],n=w.usrCoords[1],p=w.usrCoords[2],f=O.usrCoords[2],P.translateToOrigin&&a.listOfFreePoints.length>0){for(M=(t=P.toOrigin!==c&&P.toOrigin!==null&&l.isInArray(a.listOfFreePoints,P.toOrigin.id)?P.toOrigin:a.listOfFreePoints[0]).symbolic.x,N=t.symbolic.y,u=0;u<a.listOfFreePoints.length;u++)a.listOfFreePoints[u].symbolic.x-=M,a.listOfFreePoints[u].symbolic.y-=N;if(d-=M,n-=M,p-=N,f-=N,P.translateTo10&&a.listOfFreePoints.length>1){for(h=P.to10!==c&&P.to10!==null&&P.to10.id!==P.toOrigin.id&&l.isInArray(a.listOfFreePoints,P.to10.id)?P.to10:a.listOfFreePoints[0].id===t.id?a.listOfFreePoints[1]:a.listOfFreePoints[0],A=b.rad([1,0],[0,0],[h.symbolic.x,h.symbolic.y]),v=Math.cos(-A),C=Math.sin(-A),u=0;u<a.listOfFreePoints.length;u++)_=a.listOfFreePoints[u].symbolic.x,a.listOfFreePoints[u].symbolic.x=v*a.listOfFreePoints[u].symbolic.x-C*a.listOfFreePoints[u].symbolic.y,a.listOfFreePoints[u].symbolic.y=C*_+v*a.listOfFreePoints[u].symbolic.y;if(h.symbolic.y=0,_=d,d=v*d-C*p,p=C*_+v*p,_=n,n=v*n-C*f,f=C*_+v*f,P.stretch&&Math.abs(h.symbolic.x)>y.eps){for(T=h.symbolic.x,u=0;u<a.listOfFreePoints.length;u++)a.listOfFreePoints[u].symbolic.x/=T,a.listOfFreePoints[u].symbolic.y/=T;for(u=0;u<a.objectsList.length;u++)a.objectsList[u].elementClass===g.OBJECT_CLASS_CIRCLE&&a.objectsList[u].method==="pointRadius"&&(x[u]=a.objectsList[u].radius,a.objectsList[u].radius/=T);d/=T,n/=T,p/=T,f/=T,h.symbolic.x=1}}for(u=0;u<a.listOfFreePoints.length;u++)_=a.listOfFreePoints[u].symbolic.x,Math.abs(_)<y.eps&&(a.listOfFreePoints[u].symbolic.x=0),Math.abs(_-Math.round(_))<y.eps&&(a.listOfFreePoints[u].symbolic.x=Math.round(_)),_=a.listOfFreePoints[u].symbolic.y,Math.abs(_)<y.eps&&(a.listOfFreePoints[u].symbolic.y=0),Math.abs(_-Math.round(_))<y.eps&&(a.listOfFreePoints[u].symbolic.y=Math.round(_))}for(u in o=this.generatePolynomials(a,e).join(","),this.cbp=function(R){s=R},this.cb=l.bind(this.cbp,this),m.modules.geoloci.lociCoCoA(d,n,p,f,S,o,T,A,M,N,this.cb,!0),this.clearSymbolicCoordinates(a),x)x.hasOwnProperty(u)&&(a.objects[u].radius=x[u]);return s}},y.Symbolic}),define("math/clip",["jxg","base/constants","base/coords","math/math","math/geometry","utils/type"],function(g,E,y,b,m,l){return b.Clip={_isSeparator:function(c){return isNaN(c.coords.usrCoords[1])&&isNaN(c.coords.usrCoords[2])},makeDoublyLinkedList:function(c){var a,e=null,o=[],s=c.length;if(s>0)for(a=0;a<s;a++)this._isSeparator(c[a])?(c[a]._next=c[(a+1)%s],c[a]._prev=c[(s+a-1)%s]):(e===null&&(e=a,o.push(e)),this._isSeparator(c[(a+1)%s])||a===s-1?(c[a]._next=c[e],c[e]._prev=c[a],c[a]._end=!0,e=null):(c[a]._next=c[(a+1)%s],c[e]._prev=c[a]),this._isSeparator(c[(s+a-1)%s])||(c[a]._prev=c[(s+a-1)%s]));return o},Vertex:function(c,a,e,o,s,t){this.pos=a,this.intersection=!0,this.coords=c,this.elementClass=E.OBJECT_CLASS_POINT,this.data={alpha:e,path:o,pathname:s,done:!1,type:t,idx:0},this.neighbour=null,this.entry_exit=!1},_addToList:function(c,a,e){var o=c.length,s=b.eps*b.eps;o>0&&Math.abs(c[o-1].coords.usrCoords[0]-a.usrCoords[0])<s&&Math.abs(c[o-1].coords.usrCoords[1]-a.usrCoords[1])<s&&Math.abs(c[o-1].coords.usrCoords[2]-a.usrCoords[2])<s||c.push({pos:e,intersection:!1,coords:a,elementClass:E.OBJECT_CLASS_POINT})},sortIntersections:function(c){var a,e,o,s,t,h,u=[],d=c.length;for(a=0;a<d;a++)if(c[a].sort(function(n,p){return n.data.alpha>p.data.alpha?1:-1}),c[a].length>0){for(t=c[a].length-1,h=(s=(o=c[a][0]).data.path[o.pos])._next,a===d-1&&(s._end=!1),o.data.alpha===0&&o.data.type==="T"?(s.intersection=!0,s.data=o.data,s.neighbour=o.neighbour,s.neighbour.neighbour=s,s.entry_exit=!1,c[a][0]=s):(o._prev=s,o._prev._next=o),e=1;e<=t;e++)(o=c[a][e])._prev=c[a][e-1],o._prev._next=o;(o=c[a][t])._next=h,o._next._prev=o,a===d-1&&(o._end=!0),u=u.concat(c[a])}return u},_inbetween:function(c,a,e){var o,s=b.eps*b.eps,t=e[1]-a[1],h=e[2]-a[2],u=c[1]-a[1],d=c[2]-a[2];return t===0&&h===0&&u===0&&d===0||(o=Math.abs(u)<s&&Math.abs(t)<s?d/h:u/t,Math.abs(o)<s&&(o=0),o)},_print_array:function(c){var a,e;for(a=0;a<c.length;a++)try{e="",c[a]._end&&(e=" end"),console.log(a,c[a].coords.usrCoords,c[a].data.type,"	","prev",c[a]._prev.coords.usrCoords,"next",c[a]._next.coords.usrCoords+e)}catch{console.log(a,c[a].coords.usrCoords)}},_print_list:function(c){for(var a,e=0;e<100&&(a=c.data?c.data.alpha:"-",console.log("	",c.coords.usrCoords,`
		is:`,c.intersection,"end:",c._end,a,`
		-:`,c._prev.coords.usrCoords,`
		+:`,c._next.coords.usrCoords,`
		n:`,c.intersection?c.neighbour.coords.usrCoords:"-"),!c._end);)c=c._next,e++},_noOverlap:function(c,a,e,o){var s,t,h,u,d,n=Math.sqrt(b.eps),p=!1;for(s=0;s<3;s++)if(t=Math.min(c[s],a[s]),h=Math.max(c[s],a[s]),u=Math.min(e[s],o[s]),d=Math.max(e[s],o[s]),h<u-n||t>d+n){p=!0;break}return p},findIntersections:function(c,a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P,x=[],S=b.eps,O=c.length,w=a.length,T=[],M=[],N=[],A=!1,R=!1;for(s=0;s<w;s++)N.push([]);for(o=0;o<O;o++)if(M.push([]),this._isSeparator(c[o])||this._isSeparator(c[(o+1)%O]))A=!0;else{if(A&&o===O-1)break;for(h=c[o].coords.usrCoords,u=c[(o+1)%O].coords.usrCoords,s=0;s<w;s++)if(this._isSeparator(a[s])||this._isSeparator(a[(s+1)%w]))R=!0;else{if(R&&s===w-1)break;if(d=a[s].coords.usrCoords,n=a[(s+1)%w].coords.usrCoords,!this._noOverlap(h,u,d,n)&&(x=m.meetSegmentSegment(h,u,d,n),p=m.distance(h,u,3),f=m.distance(d,n,3),x[1]*p>-S&&x[1]<1-S/p&&x[2]*f>-S&&x[2]<1-S/f||x[1]===1/0&&x[2]===1/0&&b.norm(x[0],3)<S)){if(t=new y(E.COORDS_BY_USER,x[0],e),C="X",Math.abs(x[1])*p<S||Math.abs(x[2])*f<S)C="T",Math.abs(x[1])*p<S&&(x[1]=0),Math.abs(x[2])*f<S&&(x[2]=0),t=x[1]===0?new y(E.COORDS_BY_USER,h,e):new y(E.COORDS_BY_USER,d,e);else if(x[1]===1/0&&x[2]===1/0&&b.norm(x[0],3)<S){(v=this._inbetween(h,d,n))>=0&&v<1&&(C="T",t=new y(E.COORDS_BY_USER,h,e),x[1]=0,x[2]=v,_=new this.Vertex(t,o,x[1],c,"S",C),P=new this.Vertex(t,s,x[2],a,"C",C),_.neighbour=P,P.neighbour=_,M[o].push(_),N[s].push(P)),v=this._inbetween(d,h,u),m.distance(h,d,3)>S&&v>=0&&v<1&&(C="T",t=new y(E.COORDS_BY_USER,d,e),x[1]=v,x[2]=0,_=new this.Vertex(t,o,x[1],c,"S",C),P=new this.Vertex(t,s,x[2],a,"C",C),_.neighbour=P,P.neighbour=_,M[o].push(_),N[s].push(P));continue}_=new this.Vertex(t,o,x[1],c,"S",C),P=new this.Vertex(t,s,x[2],a,"C",C),_.neighbour=P,P.neighbour=_,M[o].push(_),N[s].push(P)}}}for(T=this.sortIntersections(M),o=0;o<T.length;o++)T[o].data.idx=o,T[o].neighbour.data.idx=o;return[T,this.sortIntersections(N)]},_getPosition:function(c,a,e,o){var s=m.det3p(c,a,e),t=m.det3p(c,e,o);return m.det3p(a,e,o)>=0?s>=0&&t>=0?"left":"right":s>=0||t>=0?"left":"right"},_classifyDegenerateIntersections:function(c){var a,e,o,s,t,h,u,d,n,p,f,v,C,_;for(n=m.det3p,u=0,c._tours=0;;){if(c.intersection&&c.data.type==="T"&&(a=c._next.coords.usrCoords,e=c._prev.coords.usrCoords,m.distance(c.coords.usrCoords,a,3)<b.eps&&(a=c._next._next.coords.usrCoords),m.distance(c.coords.usrCoords,e,3)<b.eps&&(e=c._prev._prev.coords.usrCoords),s=(t=c.neighbour)._prev.coords.usrCoords,o=t._next.coords.usrCoords,m.distance(t.coords.usrCoords,o,3)<b.eps&&(o=t._next._next.coords.usrCoords),m.distance(t.coords.usrCoords,s,3)<b.eps&&(s=t._prev._prev.coords.usrCoords),f=n(c.coords.usrCoords,e,s),v=n(c.coords.usrCoords,a,o),C=n(c.coords.usrCoords,e,o),_=n(c.coords.usrCoords,a,s),f===0&&v===0&&C===0&&_===0&&(c.coords.usrCoords[1]*=1+Math.random()*b.eps,c.coords.usrCoords[2]*=1+Math.random()*b.eps,t.coords.usrCoords[1]=c.coords.usrCoords[1],t.coords.usrCoords[2]=c.coords.usrCoords[2],f=n(c.coords.usrCoords,e,s),v=n(c.coords.usrCoords,a,o),C=n(c.coords.usrCoords,e,o),_=n(c.coords.usrCoords,a,s)),p=!1,f===0?m.affineRatio(c.coords.usrCoords,e,s)<0&&(p=!0):v===0?m.affineRatio(c.coords.usrCoords,a,o)<0&&(p=!0):C===0?m.affineRatio(c.coords.usrCoords,e,o)>0&&(p=!0):_===0&&m.affineRatio(c.coords.usrCoords,a,s)>0&&(p=!0),p&&(d=s,s=o,o=d,d=f,f=C,C=d,d=v,v=_,_=d),l.exists(c.delayedStatus)||(c.delayedStatus=[]),f===0&&v===0?c.delayedStatus=["on","on"]:f===0?(h=this._getPosition(a,s,t.coords.usrCoords,o),c.delayedStatus=["on",h]):v===0?(h=this._getPosition(e,s,t.coords.usrCoords,o),c.delayedStatus=[h,"on"]):c.delayedStatus.length===0&&(this._getPosition(e,s,t.coords.usrCoords,o)!==this._getPosition(a,s,t.coords.usrCoords,o)?c.data.type="X":c.data.type="B")),l.exists(c._tours)&&c._tours++,c._tours>3||c._end||u>1e3){u>1e3&&console.log("Clipping: _classifyDegenerateIntersections exit"),l.exists(c._tours)&&delete c._tours;break}c.intersection&&u++,c=c._next}},_handleIntersectionChains:function(c){var a,e=0,o="Null",s=!1,t=!1,h=!1;for(h;c.intersection===!0&&(c.data.type==="T"&&(c.delayedStatus[0]!=="on"&&c.delayedStatus[1]==="on"?(s=!0,a=c,o=c.delayedStatus[0]):s&&c.delayedStatus[0]==="on"&&c.delayedStatus[1]==="on"?c.data.type="B":s&&c.delayedStatus[0]==="on"&&c.delayedStatus[1]!=="on"&&(s=!1,o===c.delayedStatus[1]?(a.data.type="DB",c.data.type="DB"):(a.data.type="DX",c.data.type="DX"))),e++),c._end&&(t=!0),!t||s;){if(e>1e3){console.log("Warning: _handleIntersectionChains: intersection chain reached maximum numbers of iterations");break}c=c._next}},_handleFullyDegenerateCase:function(c,a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P,x,S=[c,a];for(t=0;t<2;t++){for(v=(o=S[t]).length,p=0,x=!0;p<v;p++)if(!o[p].intersection){x=!1;break}if(x)for(C=(s=S[(t+1)%2]).length,p=0;p<v;p++){for(u=o[p].coords.usrCoords,d=o[p]._next.coords.usrCoords,h=[.5*(u[0]+d[0]),.5*(u[1]+d[1]),.5*(u[2]+d[2])],f=0,_=!1;f<C;f++)if(Math.abs(m.det3p(s[f].coords.usrCoords,s[(f+1)%C].coords.usrCoords,h))<b.eps){_=!0;break}if(!_){n={pos:p,intersection:!1,coords:new y(E.COORDS_BY_USER,h,e),elementClass:E.OBJECT_CLASS_POINT},P=o[p]._next,o[p]._next=n,n._prev=o[p],n._next=P,P._prev=n,o[p]._end&&(o[p]._end=!1,n._end=!0);break}}}},_getStatus:function(c,a){for(;c.intersection&&!c._end;)c=c._next;return[c,m.windingNumber(c.coords.usrCoords,a)===0?"entry":"exit"]},markEntryExit:function(c,a,e){var o,s,t,h,u,d,n,p=null,f=0;for(d=e.length,u=0;u<d;u++)for(n=e[u],this._classifyDegenerateIntersections(c[n]),this._handleIntersectionChains(c[n]),s=(h=this._getStatus(c[n],a))[0],o=h[1],s._starter=!0,t=0,p=null,f=0;s.intersection===!0&&(s.data.type==="X"&&f===1&&(p.entry_exit=o,o==="exit"&&(p.data.type="X"),f=2),s.data.type!=="X"&&s.data.type!=="DB"||(s.entry_exit=o,o=o==="entry"?"exit":"entry"),s.data.type==="DX"&&(f===0?(p=s,f=1):f===1?(s.entry_exit=o,p.entry_exit=o,o==="exit"?p.data.type="X":s.data.type="X",o=o==="entry"?"exit":"entry",p=null,f=0):f===2&&(s.entry_exit=o,s.data.type="X",o=o==="entry"?"exit":"entry",p=null,f=0))),s=s._next,!(l.exists(s._starter)||t>1e4);)t++},_stayOnPath:function(c,a){var e=!0;return c.intersection&&c.data.type!=="B"&&(e=a===c.entry_exit),e},_addVertex:function(c,a,e){return isNaN(a.coords.usrCoords[1])||isNaN(a.coords.usrCoords[2])||c.push(a),a.intersection&&a.data.done?(e&&console.log("Add last intersection point",a.coords.usrCoords,"on",a.data.pathname,a.entry_exit,a.data.type),!0):(a.intersection&&(a.data.done=!0,e&&console.log("Add intersection point",a.coords.usrCoords,"on",a.data.pathname,a.entry_exit,a.data.type)),!1)},tracing:function(c,a,e){var o,s,t,h,u=0,d=1e4,n=0,p=[],f=!1,v=!1;for(v;n<a.length&&u<d;)if((s=a[n]).data.done||s.data.type!=="X")n++;else{p.length>0&&p.push([NaN,NaN]),t=s.data.idx,o=c,f=this._addVertex(p,s,v),h=s.entry_exit;do{if(f)break;if(e==="intersection"&&s.entry_exit==="entry"||e==="union"&&s.entry_exit==="exit"||e==="difference"&&o===c==(s.entry_exit==="exit")){do if(s=s._next,f=this._addVertex(p,s,v))break;while(this._stayOnPath(s,h));u++}else{do if(s=s._prev,f=this._addVertex(p,s,v))break;while(this._stayOnPath(s,h));u++}if(f)break;if(!s.neighbour)return console.log("Tracing: emergency break - no neighbour!!!!!!!!!!!!!!!!!",u),[[0],[0]];if((s=s.neighbour).data.done)break;s.data.done=!0,h=s.entry_exit,o=s.data.path}while(s.data.idx!==t&&u<d);u>=d&&console.log("Tracing: stopping an infinite loop!",u),n++}return this._getCoordsArrays(p,!1)},isEmptyCase:function(c,a,e){return e==="intersection"&&(c.length===0||a.length===0)||e==="union"&&c.length===0&&a.length===0||e==="difference"&&c.length===0},_getCoordsArrays:function(c,a){var e,o=[],s=[],t=c.length;for(e=0;e<t;e++)c[e].coords?(o.push(c[e].coords.usrCoords[1]),s.push(c[e].coords.usrCoords[2])):(o.push(c[e][0]),s.push(c[e][1]));return a&&t>0&&(c[0].coords?(o.push(c[0].coords.usrCoords[1]),s.push(c[0].coords.usrCoords[2])):(o.push(c[0][0]),s.push(c[0][1]))),[o,s]},handleEmptyIntersection:function(c,a,e){var o,s,t=!1,h=[];if(c.length===0)return h=e==="union"?a:[],this._getCoordsArrays(h,!0);if(a.length===0)return h=e==="intersection"?[]:c,this._getCoordsArrays(h,!0);if(c.length>0)for(o=c[0];o.intersection&&!(o=o._next)._end;);if(a.length>0)for(s=a[0];s.intersection&&!(s=s._next)._end;);return m.windingNumber(o.coords.usrCoords,a)===0?m.windingNumber(s.coords.usrCoords,c)!==0?(e==="union"?(h=h.concat(c)).push(c[0]):e==="difference"&&((h=h.concat(c)).push(c[0]),m.signedPolygon(c)*m.signedPolygon(a)>0&&h.reverse(),h.push([NaN,NaN])),e!=="difference"&&e!=="intersection"||((h=h.concat(a)).push(a[0]),t=!1)):e==="difference"?(h=h.concat(c),t=!0):e==="union"&&((h=h.concat(c)).push(c[0]),h.push([NaN,NaN]),(h=h.concat(a)).push(a[0])):e==="intersection"?(h=h.concat(c),t=!0):e==="union"&&(h=h.concat(a)).push(a[0]),this._getCoordsArrays(h,t)},_countCrossingIntersections:function(c){var a,e=c.length,o=0;for(a=0;a<e;a++)c[a].data.type==="X"&&o++;return o},_getPath:function(c,a){var e,o,s,t,h,u,d,n=[];if(c.elementClass!==E.OBJECT_CLASS_CURVE||c.type!==E.OBJECT_TYPE_ARC&&c.type!==E.OBJECT_TYPE_SECTOR){if(c.elementClass===E.OBJECT_CLASS_CURVE&&l.exists(c.points))for(o=c.numberPoints,e=0;e<o;e++)this._addToList(n,c.points[e],e);else if(c.type===E.OBJECT_TYPE_POLYGON)for(e=0;e<c.vertices.length;e++)this._addToList(n,c.vertices[e].coords,e);else if(c.elementClass===E.OBJECT_CLASS_CIRCLE)for(d=359,s=c.Radius(),t=2*Math.PI/d,e=0;e<=d;e++)this._addToList(n,new y(E.COORDS_BY_USER,[c.center.coords.usrCoords[0],c.center.coords.usrCoords[1]+Math.cos(e*t)*s,c.center.coords.usrCoords[2]+Math.sin(e*t)*s],a),e);else if(l.isArray(c))for(o=c.length,e=0;e<o;e++)l.exists(c[e].coords)?this._addToList(n,c[e].coords,e):l.isArray(c[e])?this._addToList(n,new y(E.COORDS_BY_USER,c[e],a),e):l.exists(c[e].usrCoords)&&this._addToList(n,c[e],e)}else{for(h=m.rad(c.radiuspoint,c.center,c.anglepoint),d=Math.floor(180*h/Math.PI),s=c.Radius(),t=h/d,u=Math.atan2(c.radiuspoint.coords.usrCoords[2]-c.center.coords.usrCoords[2],c.radiuspoint.coords.usrCoords[1]-c.center.coords.usrCoords[1]),c.type===E.OBJECT_TYPE_SECTOR&&this._addToList(n,c.center.coords,0),e=0;e<=d;e++)this._addToList(n,new y(E.COORDS_BY_USER,[c.center.coords.usrCoords[0],c.center.coords.usrCoords[1]+Math.cos(e*t+u)*s,c.center.coords.usrCoords[2]+Math.sin(e*t+u)*s],a),e+1);c.type===E.OBJECT_TYPE_SECTOR&&this._addToList(n,c.center.coords,d+2)}return n},greinerHormann:function(c,a,e,o){var s,t,h,u,d=[],n=[];return(s=(d=this._getPath(c,o)).length)>0&&m.distance(d[0].coords.usrCoords,d[s-1].coords.usrCoords,3)<b.eps&&d.pop(),(s=(n=this._getPath(a,o)).length)>0&&m.distance(n[0].coords.usrCoords,n[s-1].coords.usrCoords,3)<b.eps*b.eps&&n.pop(),this.isEmptyCase(d,n,e)?[[],[]]:(h=this.makeDoublyLinkedList(d),u=this.makeDoublyLinkedList(n),t=this.findIntersections(d,n,o)[0],this._handleFullyDegenerateCase(d,n,o),this.markEntryExit(d,n,h),this.markEntryExit(n,d,u),this._countCrossingIntersections(t)===0?this.handleEmptyIntersection(d,n,e):this.tracing(d,t,e))},union:function(c,a,e){return this.greinerHormann(c,a,"union",e)},intersection:function(c,a,e){return this.greinerHormann(c,a,"intersection",e)},difference:function(c,a,e){return this.greinerHormann(c,a,"difference",e)}},g.extend(b.Clip,{}),b.Clip}),define("math/poly",["jxg","math/math","utils/type"],function(g,E,y){return E.Poly={},E.Poly.Ring=function(b){this.vars=b},g.extend(E.Poly.Ring.prototype,{}),E.Poly.Monomial=function(b,m,l){var c;if(!y.exists(b))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(y.isArray(l)||(l=[]),c=(l=l.slice(0,b.vars.length)).length;c<b.vars.length;c++)l.push(0);this.ring=b,this.coefficient=m||0,this.exponents=y.deepCopy(l)},g.extend(E.Poly.Monomial.prototype,{copy:function(){return new E.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var b,m=[];for(b=0;b<this.ring.vars.length;b++)m.push(this.ring.vars[b]+"^"+this.exponents[b]);return this.coefficient+"*"+m.join("*")}}),E.Poly.Polynomial=function(b,m){var l;if(!y.exists(b))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");l=y.exists(m)&&y.isString(m)?void 0:[],this.ring=b,this.monomials=l},g.extend(E.Poly.Polynomial.prototype,{findSignature:function(b){var m;for(m=0;m<this.monomials.length;m++)if(y.cmpArrays(this.monomials[m].exponents,b))return m;return-1},addSubMonomial:function(b,m){var l;(l=this.findSignature(b.exponents))>-1?this.monomials[l].coefficient+=m*b.coefficient:(b.coefficient*=m,this.monomials.push(b))},add:function(b){var m;if(!y.exists(b)||b.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(y.isArray(b.exponents))this.addSubMonomial(b,1);else for(m=0;m<b.monomials.length;m++)this.addSubMonomial(b.monomials[m],1)},sub:function(b){var m;if(!y.exists(b)||b.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(y.isArray(b.exponents))this.addSubMonomial(b,-1);else for(m=0;m<b.monomials.length;m++)this.addSubMonomial(b.monomials[m],-1)},copy:function(){var b,m;for(m=new E.Poly.Polynomial(this.ring),b=0;b<this.monomials.length;b++)m.monomials.push(this.monomials[b].copy());return m},print:function(){var b,m=[];for(b=0;b<this.monomials.length;b++)m.push("("+this.monomials[b].print()+")");return m.join("+")}}),E.Poly}),define("math/complex",["jxg","utils/type"],function(g,E){return g.Complex=function(y,b){this.isComplex=!0,y&&y.isComplex&&(b=y.imaginary,y=y.real),this.real=y||0,this.imaginary=b||0,this.absval=0,this.angle=0},g.extend(g.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(y){return E.isNumber(y)?this.real+=y:(this.real+=y.real,this.imaginary+=y.imaginary),this},sub:function(y){return E.isNumber(y)?this.real-=y:(this.real-=y.real,this.imaginary-=y.imaginary),this},mult:function(y){var b,m;return E.isNumber(y)?(this.real*=y,this.imaginary*=y):(b=this.real,m=this.imaginary,this.real=b*y.real-m*y.imaginary,this.imaginary=b*y.imaginary+m*y.real),this},div:function(y){var b,m,l;if(E.isNumber(y)){if(Math.abs(y)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=y,this.imaginary/=y}else{if(Math.abs(y.real)<Math.eps&&Math.abs(y.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;b=y.real*y.real+y.imaginary*y.imaginary,l=this.real,m=this.imaginary,this.real=(l*y.real+m*y.imaginary)/b,this.imaginary=(m*y.real-l*y.imaginary)/b}return this},conj:function(){return this.imaginary*=-1,this}}),g.C={},g.C.add=function(y,b){var m=new g.Complex(y);return m.add(b),m},g.C.sub=function(y,b){var m=new g.Complex(y);return m.sub(b),m},g.C.mult=function(y,b){var m=new g.Complex(y);return m.mult(b),m},g.C.div=function(y,b){var m=new g.Complex(y);return m.div(b),m},g.C.conj=function(y){var b=new g.Complex(y);return b.conj(),b},g.C.abs=function(y){var b=new g.Complex(y);return b.conj(),b.mult(y),Math.sqrt(b.real)},g.Complex.C=g.C,g.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(g,E,y){var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},m=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1],10),parseInt(l[2],10),parseInt(l[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1],10),parseInt(l[2],10),parseInt(l[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];return g.rgbParser=function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v=l;if(!E.exists(l))return[];if(E.exists(c)&&E.exists(a)&&(v=[l,c,a]),e=v,f=!1,E.isArray(e)){for(u=0;u<3;u++)f=f||/\./.test(v[u].toString());for(u=0;u<3;u++)f=f&&v[u]>=0&&v[u]<=1;return f?[Math.ceil(255*v[0]),Math.ceil(255*v[1]),Math.ceil(255*v[2])]:v}for(typeof v=="string"&&(e=v),e.charAt(0)==="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,"").toLowerCase(),e=b[e]||e,u=0;u<m.length;u++)s=m[u].re,t=m[u].process,(h=s.exec(e))&&(d=(o=t(h))[0],n=o[1],p=o[2]);return isNaN(d)||isNaN(n)||isNaN(p)?[]:[d=d<0||isNaN(d)?0:d>255?255:d,n=n<0||isNaN(n)?0:n>255?255:n,p=p<0||isNaN(p)?0:p>255?255:p]},g.rgb2css=function(l,c,a){var e;return"rgb("+(e=g.rgbParser(l,c,a))[0]+", "+e[1]+", "+e[2]+")"},g.rgb2hex=function(l,c,a){var e,o,s;return o=(e=g.rgbParser(l,c,a))[1],s=e[2],e=(e=e[0]).toString(16),o=o.toString(16),s=s.toString(16),e.length===1&&(e="0"+e),o.length===1&&(o="0"+o),s.length===1&&(s="0"+s),"#"+e+o+s},g.hex2rgb=function(l){return g.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),g.rgb2css(l)},g.hsv2rgb=function(l,c,a){var e,o,s,t,h,u,d,n,p;if(l=(l%360+360)%360,c===0){if(!(isNaN(l)||l<y.eps))return"#ffffff";e=a,o=a,s=a}else switch(u=l>=360?0:l,d=a*(1-c),n=a*(1-c*(t=(u/=60)-(h=Math.floor(u)))),p=a*(1-c*(1-t)),h){case 0:e=a,o=p,s=d;break;case 1:e=n,o=a,s=d;break;case 2:e=d,o=a,s=p;break;case 3:e=d,o=n,s=a;break;case 4:e=p,o=d,s=a;break;case 5:e=a,o=d,s=n}return["#",e=(e=Math.round(255*e).toString(16)).length===2?e:e.length===1?"0"+e:"00",o=(o=Math.round(255*o).toString(16)).length===2?o:o.length===1?"0"+o:"00",s=(s=Math.round(255*s).toString(16)).length===2?s:s.length===1?"0"+s:"00"].join("")},g.rgb2hsv=function(l,c,a){var e,o,s,t,h,u,d,n,p,f,v,C,_;return o=(e=g.rgbParser(l,c,a))[1],s=e[2],t=(e=e[0])/255,h=o/255,u=s/255,C=Math.max(e,o,s),n=(_=Math.min(e,o,s))/255,f=0,(v=d=C/255)>0&&(f=(v-n)/v),p=1/(d-n),f>0&&(C===e?p*=h-u:p=C===o?2+(u-t)*p:4+(t-h)*p),(p*=60)<0&&(p+=360),C===_&&(p=0),[p,f,v]},g.rgb2LMS=function(l,c,a){var e,o,s,t,h,u,d,n=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return o=(e=g.rgbParser(l,c,a))[1],s=e[2],e=e[0],e=Math.pow(e,.476190476),o=Math.pow(o,.476190476),s=Math.pow(s,.476190476),(d=[t=e*n[0][0]+o*n[0][1]+s*n[0][2],h=e*n[1][0]+o*n[1][1]+s*n[1][2],u=e*n[2][0]+o*n[2][1]+s*n[2][2]]).l=t,d.m=h,d.s=u,d},g.LMS2rgb=function(l,c,a){var e,o,s,t,h=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],u=function(d){for(var n=127,p=64;p>0;){if(Math.pow(n,.476190476)>d)n-=p;else{if(Math.pow(n+1,.476190476)>d)return n;n+=p}p/=2}return n===254&&13.994955247<d?255:n};return e=l*h[0][0]+c*h[0][1]+a*h[0][2],o=l*h[1][0]+c*h[1][1]+a*h[1][2],s=l*h[2][0]+c*h[2][1]+a*h[2][2],(t=[e=u(e),o=u(o),s=u(s)]).r=e,t.g=o,t.b=s,t},g.rgba2rgbo=function(l){var c;return l.length===9&&l.charAt(0)==="#"?(c=parseInt(l.substr(7,2).toUpperCase(),16)/255,l=l.substr(0,7)):c=1,[l,c]},g.rgbo2rgba=function(l,c){var a;return l==="none"?l:((a=Math.round(255*c).toString(16)).length===1&&(a="0"+a),l+a)},g.rgb2bw=function(l){var c,a,e,o="0123456789ABCDEF";return l==="none"?l:(e=g.rgbParser(l),c=Math.floor(.3*e[0]+.59*e[1]+.11*e[2]),l="#"+(a=o.charAt(c>>4&15)+o.charAt(15&c))+a+a)},g.rgb2cb=function(l,c){var a,e,o,s,t,h,u,d,n,p,f,v="0123456789ABCDEF";if(l==="none")return l;switch(e=(t=g.rgb2LMS(l))[0],o=t[1],s=t[2],c=c.toLowerCase()){case"protanopia":h=-.06150039994295001,u=.08277001656812001,d=-.013200141220000003,n=.05858939668799999,p=-.07934519995360001,f=.013289415272000003,e=s/o<.6903216543277437?-(u*o+d*s)/h:-(p*o+f*s)/n;break;case"tritanopia":h=-.00058973116217,u=.007690316482,d=-.01011703519052,n=.025495080838999994,p=-.0422740347,f=.017005316784,s=o/e<.8349489908460004?-(h*e+u*o)/d:-(n*e+p*o)/f;break;default:h=-.06150039994295001,u=.08277001656812001,d=-.013200141220000003,n=.05858939668799999,p=-.07934519995360001,f=.013289415272000003,o=s/e<.5763833686400911?-(h*e+d*s)/u:-(n*e+f*s)/p}return a=g.LMS2rgb(e,o,s),l="#"+(v.charAt(a[0]>>4&15)+v.charAt(15&a[0])),l+=v.charAt(a[1]>>4&15)+v.charAt(15&a[1]),l+=v.charAt(a[2]>>4&15)+v.charAt(15&a[2])},g.autoHighlight=function(l){var c=g.rgba2rgbo(l),a=c[0],e=c[1];return l.charAt(0)==="#"?(e*=e<.3?1.8:.4,g.rgbo2rgba(a,e)):l},g.contrast=function(l,c,a,e){var o,s,t,h,u;return c=c||"#000000",a=a||"#ffffff",e=e||7,o=g.rgbParser(l),s=g.rgbParser("#000000"),u=(t=.2126*Math.pow(o[0]/255,2.2)+.7152*Math.pow(o[1]/255,2.2)+.0722*Math.pow(o[2]/255,2.2))>(h=.2126*Math.pow(s[0]/255,2.2)+.7152*Math.pow(s[1]/255,2.2)+.0722*Math.pow(s[2]/255,2.2))?Math.floor((t+.05)/(h+.05)):Math.floor((h+.05)/(t+.05)),(u-=1)>e?c:a},g.setClassicColors=function(){g.Options.elements.strokeColor="blue",g.Options.elements.fillColor="red",g.Options.hatch.strokeColor="blue",g.Options.angle.fillColor="#ff7f00",g.Options.angle.highlightFillColor="#ff7f00",g.Options.angle.strokeColor="#ff7f00",g.Options.angle.label.strokeColor="blue",g.Options.arc.strokeColor="blue",g.Options.circle.center.fillColor="red",g.Options.circle.center.strokeColor="blue",g.Options.circumcircle.strokeColor="blue",g.Options.circumcircle.center.fillColor="red",g.Options.circumcircle.center.strokeColor="blue",g.Options.circumcirclearc.strokeColor="blue",g.Options.circumcirclesector.strokeColor="blue",g.Options.circumcirclesector.fillColor="green",g.Options.circumcirclesector.highlightFillColor="green",g.Options.conic.strokeColor="blue",g.Options.curve.strokeColor="blue",g.Options.incircle.strokeColor="blue",g.Options.incircle.center.fillColor="red",g.Options.incircle.center.strokeColor="blue",g.Options.inequality.fillColor="red",g.Options.integral.fillColor="red",g.Options.integral.curveLeft.color="red",g.Options.integral.curveRight.color="red",g.Options.line.strokeColor="blue",g.Options.point.fillColor="red",g.Options.point.strokeColor="red",g.Options.polygon.fillColor="green",g.Options.polygon.highlightFillColor="green",g.Options.polygon.vertices.strokeColor="red",g.Options.polygon.vertices.fillColor="red",g.Options.regularpolygon.fillColor="green",g.Options.regularpolygon.highlightFillColor="green",g.Options.regularpolygon.vertices.strokeColor="red",g.Options.regularpolygon.vertices.fillColor="red",g.Options.riemannsum.fillColor="yellow",g.Options.sector.fillColor="green",g.Options.sector.highlightFillColor="green",g.Options.semicircle.center.fillColor="red",g.Options.semicircle.center.strokeColor="blue",g.Options.slopetriangle.fillColor="red",g.Options.slopetriangle.highlightFillColor="red",g.Options.turtle.arrow.strokeColor="blue"},g.extend(g,{paletteWong:{black:"#000000",orange:"#E69F00",skyblue:"#56B4E9",bluishgreen:"#009E73",yellow:"#F0E442",darkblue:"#0072B2",vermillion:"#D55E00",reddishpurple:"#CC79A7",blue:"#0072B2",red:"#D55E00",green:"#009E73",purple:"#CC79A7",white:"#ffffff"}}),g.palette=g.paletteWong,g}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(g,E,y,b,m){return g.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],maxBoundingBox:[-1/0,1/0,1/0,-1/0],zoomFactor:1,zoomX:1,zoomY:1,title:"",description:"",showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showFullscreen:!1,fullscreen:{symbol:'<svg height="1em" width="1em" version="1.1" viewBox="10 10 18 18"><path fill="#666" d="m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z"></path><path fill="#666" d="m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z"></path><path fill="#666" d="m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z"></path><path fill="#666" d="M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z"></path></svg>',id:null},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,maxFrameRate:40,registerEvents:!0,minimizeReflow:"none",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},drag:{enabled:!0},keyboard:{enabled:!0,dx:10,dy:10,panShift:!0,panCtrl:!1},resize:{enabled:!0,throttle:10},moveTarget:null,selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1},showInfobox:!0},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",fillColor:b.palette.red,highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,gradient:null,gradientSecondColor:"#ffffff",gradientSecondOpacity:1,gradientStartOffset:0,gradientEndOffset:1,gradientAngle:0,gradientCX:.5,gradientCY:.5,gradientR:.5,gradientFX:.5,gradientFY:.5,gradientFR:0,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,shadowColor:"black",trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,rotatable:!0,dragToTopOfLayer:!1,precision:"inherit",draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1,tabindex:0},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},beautifulScientificTickLabels:!1,useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,ticksPerLabel:!1,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,digits:3,ticksDistance:1,face:"|",strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"none",highlightFillColor:"none",visible:"inherit",includeBoundaries:!1,type:"linear"},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",face:"|",strokeWidth:2,strokeColor:b.palette.blue,ticksDistance:.2},precision:{touch:30,touchMax:100,mouse:4,pen:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,unused9:19,unused8:18,unused7:17,unused6:16,unused5:15,unused4:14,unused3:13,unused2:12,unused1:11,unused0:10,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:"auto",type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:b.palette.orange,highlightFillColor:b.palette.orange,strokeColor:b.palette.orange,fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"#000000",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:b.palette.blue},arc:{visible:!1,fillColor:"none"}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",useDirection:!1,center:{},radiusPoint:{},anglePoint:{}},arrow:{firstArrow:!1,lastArrow:{type:1,highlightSize:6,size:6}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,highlightSize:8,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},tabindex:-1,label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"#000000"},line2:{strokeColor:"#000000"}},boxplot:{dir:"vertical",smallWidth:.5,strokeWidth:2,strokeColor:b.palette.blue,fillColor:b.palette.blue,fillOpacity:.2,highlightStrokeWidth:2,highlightStrokeColor:b.palette.blue,highlightFillColor:b.palette.blue,highlightFillOpacity:.1},button:{disabled:!1,display:"html"},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1,display:"html"},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,fillColor:b.palette.red,strokeColor:b.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:b.palette.red,strokeColor:b.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:b.palette.yellow,highlightFillColor:b.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""},line:{visible:!1}},curve:{strokeWidth:1,strokeColor:b.palette.blue,fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:15,doAdvancedPlotOld:!1,plotVersion:2,label:{position:"lft"},firstArrow:!1,lastArrow:!1},foreignobject:{attractors:[],fixed:!0,visible:!0},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#c0c0c0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"#000000",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:b.palette.red,strokeColor:b.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},inequality:{fillColor:b.palette.red,fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:b.palette.red,fillOpacity:.3,highlightFillColor:b.palette.red,highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:b.palette.red,fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:b.palette.red,fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288,display:"html"},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"#000000",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"#000000",fixed:!0,position:"urt",offset:[10,10],autoPosition:!1},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],rowHeight:20,strokeWidth:5},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:b.palette.blue,highlightStrokeColor:"#c3d9ff",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},metapostspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},mirrorelement:{fixed:!0,point:{},center:{},type:"Euclidean"},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",strokeWidth:2,fillColor:b.palette.red,strokeColor:b.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",zoom:!1,showInfobox:"inherit",infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,attractToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:b.palette.yellow,highlightFillColor:b.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:b.palette.red,fillColor:b.palette.red,fixed:!1,visible:"inherit"},label:{offset:[0,0]}},polygonalchain:{fillColor:"none",highlightFillColor:"none"},prescribedangle:{anglePoint:{size:2,visible:!1,withLabel:!1}},reflection:{fixed:!0,center:{},type:"Euclidean"},regularpolygon:{hasInnerPoints:!1,fillColor:b.palette.yellow,highlightFillColor:b.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:b.palette.red,fillColor:b.palette.red,fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:b.palette.yellow},sector:{fillColor:b.palette.yellow,highlightFillColor:b.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiusPoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglePoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,fillColor:b.palette.red,strokeColor:b.palette.red,highlightFillColor:"#eeeeee",highlightStrokeColor:b.palette.red,name:""}},slider:{snapWidth:-1,precision:2,digits:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,visible:"inherit",fixed:!0,scalable:!1,tabindex:null,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,digits:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,visible:"inherit",fixed:!0,tabindex:null,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{visible:"inherit",strokeColor:"#000000"},moveOnUp:!0},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:b.palette.red,fillOpacity:.4,highlightFillColor:b.palette.red,highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,digits:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,fontUnit:"px",digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"#000000",highlightStrokeColor:"#000000",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,useKatex:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:b.palette.red,lastArrow:!0}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},g.Validator=function(){var l,c=function(u){return m.isString(u)},a=function(u){return Math.abs(u-Math.round(u))<y.eps},e=function(u){return a(u)&&u>0},o=function(u){return u>0},s=function(u){return u>=0},t={},h={attractorDistance:s,color:c,defaultDistance:m.isNumber,display:function(u){return u==="html"||u==="internal"},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(u){return m.exists(g.normalizePointFace(u))},factor:m.isNumber,fillColor:c,fillOpacity:m.isNumber,firstArrow:!1,fontSize:a,dash:a,gridX:m.isNumber,gridY:m.isNumber,hasGrid:!1,highlightFillColor:c,highlightFillOpacity:m.isNumber,highlightStrokeColor:c,highlightStrokeOpacity:m.isNumber,insertTicks:!1,lastArrow:!1,layer:function(u){return a(u)&&u>=0},majorHeight:a,minorHeight:a,minorTicks:s,minTicksDistance:e,numberPointsHigh:e,numberPointsLow:e,opacity:m.isNumber,radius:m.isNumber,RDPsmoothing:!1,renderer:function(u){return u==="vml"||u==="svg"||u==="canvas"||u==="no"},right:function(u){return/^[0-9]+px$/.test(u)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:s,snapSizeX:o,snapSizeY:o,snapWidth:m.isNumber,snapToGrid:!1,snatchDistance:s,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:c,strokeOpacity:m.isNumber,strokeWidth:s,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(l in h)h.hasOwnProperty(l)&&(t[l.toLowerCase()]=h[l]);return t}(),g.normalizePointFace=function(l){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[l]},g.useStandardOptions=function(l){var c,a,e,o,s=g.Options,t=l.hasGrid;for(c in l.options.grid.hasGrid=s.grid.hasGrid,l.options.grid.gridX=s.grid.gridX,l.options.grid.gridY=s.grid.gridY,l.options.grid.gridColor=s.grid.gridColor,l.options.grid.gridOpacity=s.grid.gridOpacity,l.options.grid.gridDash=s.grid.gridDash,l.options.grid.snapToGrid=s.grid.snapToGrid,l.options.grid.snapSizeX=s.grid.SnapSizeX,l.options.grid.snapSizeY=s.grid.SnapSizeY,l.takeSizeFromFile=s.takeSizeFromFile,o=function(h,u){h.visProp.fillcolor=u.fillColor,h.visProp.highlightfillcolor=u.highlightFillColor,h.visProp.strokecolor=u.strokeColor,h.visProp.highlightstrokecolor=u.highlightStrokeColor},l.objects)if(l.objects.hasOwnProperty(c))if((e=l.objects[c]).elementClass===E.OBJECT_CLASS_POINT)o(e,s.point);else if(e.elementClass===E.OBJECT_CLASS_LINE)for(o(e,s.line),a=0;a<e.ticks.length;a++)e.ticks[a].majorTicks=s.line.ticks.majorTicks,e.ticks[a].minTicksDistance=s.line.ticks.minTicksDistance,e.ticks[a].visProp.minorheight=s.line.ticks.minorHeight,e.ticks[a].visProp.majorheight=s.line.ticks.majorHeight;else e.elementClass===E.OBJECT_CLASS_CIRCLE?o(e,s.circle):e.type===E.OBJECT_TYPE_ANGLE?o(e,s.angle):e.type===E.OBJECT_TYPE_ARC?o(e,s.arc):e.type===E.OBJECT_TYPE_POLYGON?o(e,s.polygon):e.type===E.OBJECT_TYPE_CONIC?o(e,s.conic):e.type===E.OBJECT_TYPE_CURVE?o(e,s.curve):e.type===E.OBJECT_TYPE_SECTOR&&(e.arc.visProp.fillcolor=s.sector.fillColor,e.arc.visProp.highlightfillcolor=s.sector.highlightFillColor,e.arc.visProp.fillopacity=s.sector.fillOpacity,e.arc.visProp.highlightfillopacity=s.sector.highlightFillOpacity);l.fullUpdate(),t&&!l.hasGrid?l.removeGrids(l):!t&&l.hasGrid&&l.create("grid",[])},g.useBlackWhiteOptions=function(l){var c=g.Options;c.point.fillColor=b.rgb2bw(c.point.fillColor),c.point.highlightFillColor=b.rgb2bw(c.point.highlightFillColor),c.point.strokeColor=b.rgb2bw(c.point.strokeColor),c.point.highlightStrokeColor=b.rgb2bw(c.point.highlightStrokeColor),c.line.fillColor=b.rgb2bw(c.line.fillColor),c.line.highlightFillColor=b.rgb2bw(c.line.highlightFillColor),c.line.strokeColor=b.rgb2bw(c.line.strokeColor),c.line.highlightStrokeColor=b.rgb2bw(c.line.highlightStrokeColor),c.circle.fillColor=b.rgb2bw(c.circle.fillColor),c.circle.highlightFillColor=b.rgb2bw(c.circle.highlightFillColor),c.circle.strokeColor=b.rgb2bw(c.circle.strokeColor),c.circle.highlightStrokeColor=b.rgb2bw(c.circle.highlightStrokeColor),c.arc.fillColor=b.rgb2bw(c.arc.fillColor),c.arc.highlightFillColor=b.rgb2bw(c.arc.highlightFillColor),c.arc.strokeColor=b.rgb2bw(c.arc.strokeColor),c.arc.highlightStrokeColor=b.rgb2bw(c.arc.highlightStrokeColor),c.polygon.fillColor=b.rgb2bw(c.polygon.fillColor),c.polygon.highlightFillColor=b.rgb2bw(c.polygon.highlightFillColor),c.sector.fillColor=b.rgb2bw(c.sector.fillColor),c.sector.highlightFillColor=b.rgb2bw(c.sector.highlightFillColor),c.curve.strokeColor=b.rgb2bw(c.curve.strokeColor),c.grid.gridColor=b.rgb2bw(c.grid.gridColor),g.useStandardOptions(l)},g.Options.normalizePointFace=g.normalizePointFace,g.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(g,E,y,b,m,l,c,a){return g.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},g.extend(g.AbstractRenderer.prototype,{_updateVisual:function(e,o,s){(s||this.enhancedRendering)&&(o=o||{},this.setObjectTransition(e),c.evaluate(e.visProp.draft)?this.setDraft(e):(o.stroke||(e.highlighted?(this.setObjectStrokeColor(e,e.visProp.highlightstrokecolor,e.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(e,e.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity),this.setObjectStrokeWidth(e,e.visProp.strokewidth))),o.fill||(e.highlighted?this.setObjectFillColor(e,e.visProp.highlightfillcolor,e.visProp.highlightfillopacity):this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity)),o.dash||this.setDashStyle(e,e.visProp),o.shadow||this.setShadow(e),o.gradient||this.setShadow(e),o.tabindex||this.setTabindex(e)))},_getHighlighted:function(e){var o=!1;return c.exists(e.board)&&c.exists(e.board.highlightedObjects)||(o=!0),!o&&c.exists(e.board.highlightedObjects[e.id])?"highlight":""},drawPoint:function(e){var o,s=E.normalizePointFace(c.evaluate(e.visProp.face));o=s==="o"?"ellipse":s==="[]"?"rect":"path",e.rendNode=this.appendChildPrim(this.createPrim(o,e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,o),this._updateVisual(e,{dash:!0,shadow:!0},!0),this.updatePoint(e)},updatePoint:function(e){var o,s=c.evaluate(e.visProp.size),t=E.normalizePointFace(c.evaluate(e.visProp.face)),h=c.evaluate(e.visProp.sizeunit),u=c.evaluate(e.visProp.zoom);isNaN(e.coords.scrCoords[2]+e.coords.scrCoords[1])||(h==="user"&&(s*=Math.sqrt(e.board.unitX*e.board.unitY)),o=(s*=e.board&&u?Math.sqrt(e.board.zoomX*e.board.zoomY):1)===0?0:s+1,t==="o"?this.updateEllipsePrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2],o,o):t==="[]"?this.updateRectPrim(e.rendNode,e.coords.scrCoords[1]-s,e.coords.scrCoords[2]-s,2*s,2*s):this.updatePathPrim(e.rendNode,this.updatePathStringPoint(e,s,t),e.board),this._updateVisual(e,{dash:!1,shadow:!1}),this.setShadow(e))},changePointStyle:function(e){var o=this.getElementById(e.id);c.exists(o)&&this.remove(o),this.drawPoint(e),c.clearVisPropOld(e),e.visPropCalc.visible||this.display(e,!1),c.evaluate(e.visProp.draft)&&this.setDraft(e)},drawLine:function(e){e.rendNode=this.appendChildPrim(this.createPrim("line",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"lines"),this.updateLine(e)},updateLine:function(e){this._updateVisual(e),this.updatePathWithArrowHeads(e),this.setLineCap(e)},drawCurve:function(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"path"),this.updateCurve(e)},updateCurve:function(e){this._updateVisual(e),this.updatePathWithArrowHeads(e),this.setLineCap(e)},updatePathWithArrowHeads:function(e,o){var s,t,h=e.visProp,u=o?"highlight":"";s=o&&h.highlightstrokewidth?Math.max(c.evaluate(h.highlightstrokewidth),c.evaluate(h.strokewidth)):c.evaluate(h.strokewidth),t=this.getArrowHeadData(e,s,u),this.makeArrows(e,t),e.elementClass===b.OBJECT_CLASS_LINE?this.updateLineWithEndings(e,t):e.elementClass===b.OBJECT_CLASS_CURVE&&this.updatePath(e),this.setArrowSize(e,t)},getArrowHeadData:function(e,o,s){var t,h,u,d,n=m.eps,p=0,f=0,v=0,C=0,_=c.evaluate(e.visProp.firstarrow),P=c.evaluate(e.visProp.lastarrow);return(_||P)&&(t=c.exists(_.type)?c.evaluate(_.type):e.elementClass===b.OBJECT_CLASS_LINE?1:7,h=c.exists(P.type)?c.evaluate(P.type):e.elementClass===b.OBJECT_CLASS_LINE?1:7,_&&(d=6,c.exists(_.size)&&(d=c.evaluate(_.size)),s!==""&&c.exists(_[s+"size"])&&(d=c.evaluate(_[s+"size"])),u=o*d,t===2?(u*=.5,n+=o*d):t===3?(u=o*d/3,n+=o):t===4||t===5||t===6?(u=o*d/1.5,n+=o*d):t===7?(u=0,d=10,n+=o):n+=o*d,p+=u,v=d),P&&(d=6,c.exists(P.size)&&(d=c.evaluate(P.size)),s!==""&&c.exists(P[s+"size"])&&(d=c.evaluate(P[s+"size"])),u=o*d,h===2?(u*=.5,n+=o*d):h===3?(u=o*d/3,n+=o):h===4||h===5||h===6?(u=o*d/1.5,n+=o*d):h===7?(u=0,d=10,n+=o):n+=o*d,f+=u,C=d)),e.visPropCalc.typeFirst=t,e.visPropCalc.typeLast=h,{evFirst:_,evLast:P,typeFirst:t,typeLast:h,offFirst:p,offLast:f,sizeFirst:v,sizeLast:C,showFirst:1,showLast:1,minLen:n,strokeWidth:o}},updateLineWithEndings:function(e,o){var s,t,h;return s=new y(b.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),t=new y(b.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),h=c.evaluate(e.visProp.margin),l.calcStraight(e,s,t,h),this.handleTouchpoints(e,s,t,o),this.getPositionArrowHead(e,s,t,o),this.updateLinePrim(e.rendNode,s.scrCoords[1],s.scrCoords[2],t.scrCoords[1],t.scrCoords[2],e.board),this},updatePath:function(e){return c.evaluate(e.visProp.handdrawing)?this.updatePathPrim(e.rendNode,this.updatePathStringBezierPrim(e),e.board):this.updatePathPrim(e.rendNode,this.updatePathStringPrim(e),e.board),this},getPositionArrowHead:function(e,o,s,t){var h,u,d,n,p;return(t.evFirst||t.evLast)&&(u=d=n=p=0,h=o.distance(b.COORDS_BY_SCREEN,s),t.evFirst&&e.board.renderer.type!=="vml"&&(h>=t.minLen?(u=(s.scrCoords[1]-o.scrCoords[1])*t.offFirst/h,d=(s.scrCoords[2]-o.scrCoords[2])*t.offFirst/h):t.showFirst=0),t.evLast&&e.board.renderer.type!=="vml"&&(h>=t.minLen?(n=(s.scrCoords[1]-o.scrCoords[1])*t.offLast/h,p=(s.scrCoords[2]-o.scrCoords[2])*t.offLast/h):t.showLast=0),o.setCoordinates(b.COORDS_BY_SCREEN,[o.scrCoords[1]+u,o.scrCoords[2]+d],!1,!0),s.setCoordinates(b.COORDS_BY_SCREEN,[s.scrCoords[1]-n,s.scrCoords[2]-p],!1,!0)),this},handleTouchpoints:function(e,o,s,t){var h,u,d,n,p,f,v;return(t.evFirst||t.evLast)&&(d=n=p=f=v=0,h=c.evaluate(e.point1.visProp.size)+c.evaluate(e.point1.visProp.strokewidth),u=c.evaluate(e.point2.visProp.size)+c.evaluate(e.point2.visProp.strokewidth),t.evFirst&&c.evaluate(e.visProp.touchfirstpoint)&&(d=o.distance(b.COORDS_BY_SCREEN,s),n=(s.scrCoords[1]-o.scrCoords[1])*h/d,p=(s.scrCoords[2]-o.scrCoords[2])*h/d),t.evLast&&c.evaluate(e.visProp.touchlastpoint)&&(d=o.distance(b.COORDS_BY_SCREEN,s),f=(s.scrCoords[1]-o.scrCoords[1])*u/d,v=(s.scrCoords[2]-o.scrCoords[2])*u/d),o.setCoordinates(b.COORDS_BY_SCREEN,[o.scrCoords[1]+n,o.scrCoords[2]+p],!1,!0),s.setCoordinates(b.COORDS_BY_SCREEN,[s.scrCoords[1]-f,s.scrCoords[2]-v],!1,!0)),this},setArrowSize:function(e,o){return o.evFirst&&this._setArrowWidth(e.rendNodeTriangleStart,o.showFirst*o.strokeWidth,e.rendNode,o.sizeFirst),o.evLast&&this._setArrowWidth(e.rendNodeTriangleEnd,o.showLast*o.strokeWidth,e.rendNode,o.sizeLast),this},setLineCap:function(e){},drawTicks:function(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"path")},updateTicks:function(e){},drawEllipse:function(e){e.rendNode=this.appendChildPrim(this.createPrim("ellipse",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"ellipse"),this.updateEllipse(e)},updateEllipse:function(e){this._updateVisual(e);var o=e.Radius();o>0&&Math.abs(e.center.coords.usrCoords[0])>m.eps&&!isNaN(o+e.center.coords.scrCoords[1]+e.center.coords.scrCoords[2])&&o*e.board.unitX<2e6&&this.updateEllipsePrim(e.rendNode,e.center.coords.scrCoords[1],e.center.coords.scrCoords[2],o*e.board.unitX,o*e.board.unitY)},drawPolygon:function(e){e.rendNode=this.appendChildPrim(this.createPrim("polygon",e.id),c.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"polygon"),this.updatePolygon(e)},updatePolygon:function(e){this._updateVisual(e,{stroke:!0,dash:!0}),this.updatePolygonPrim(e.rendNode,e)},displayCopyright:function(e,o){},drawInternalText:function(e){},updateInternalText:function(e){},drawText:function(e){var o,s,t,h;c.evaluate(e.visProp.display)==="html"&&a.isBrowser&&this.type!=="no"?((o=this.container.ownerDocument.createElement("div")).style.position="absolute",o.className=c.evaluate(e.visProp.cssclass),t=c.evaluate(e.visProp.layer),c.exists(t)||(t=0),s=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),o.style.zIndex=s+t,this.container.appendChild(o),o.setAttribute("id",this.container.id+"_"+e.id)):o=this.drawInternalText(e),e.rendNode=o,e.htmlStr="",e.visProp.islabel&&c.exists(e.visProp.anchor)?(h=c.evaluate(e.visProp.anchor.visProp.visible),e.prepareUpdate().updateVisibility(h)):e.prepareUpdate().updateVisibility(),this.updateText(e)},updateText:function(e){var o,s,t,h,u,d,n,p,f,v=e.plaintext;if(e.visPropCalc.visible)if(this.updateTextStyle(e,!1),c.evaluate(e.visProp.display)==="html"&&this.type!=="no"){if(isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(s=e.coords.scrCoords[1],s=Math.abs(s)<1e6?s:1e6,o=(p=e.getAnchorX())==="right"?e.board.canvasWidth-s:p==="middle"?s-.5*e.size[0]:s,e.visPropOld.left!==p+o&&(p==="right"?(e.rendNode.style.right=o+"px",e.rendNode.style.left="auto"):(e.rendNode.style.left=o+"px",e.rendNode.style.right="auto"),e.visPropOld.left=p+o),s=e.coords.scrCoords[2]+this.vOffsetText,s=Math.abs(s)<1e6?s:1e6,o=(f=e.getAnchorY())==="bottom"?e.board.canvasHeight-s:f==="middle"?s-.5*e.size[1]:s,e.visPropOld.top!==f+o&&(f==="bottom"?(e.rendNode.style.top="auto",e.rendNode.style.bottom=o+"px"):(e.rendNode.style.bottom="auto",e.rendNode.style.top=o+"px"),e.visPropOld.top=f+o)),e.htmlStr!==v){try{e.type===c.OBJECT_TYPE_BUTTON?e.rendNodeButton.innerHTML=v:e.type===c.OBJECT_TYPE_CHECKBOX||e.type===c.OBJECT_TYPE_INPUT?e.rendNodeLabel.innerHTML=v:e.rendNode.innerHTML=v}catch{t=e.rendNode.parentNode,e.rendNode.parentNode.removeChild(e.rendNode),e.rendNode.innerHTML=v,t.appendChild(e.rendNode)}if(e.htmlStr=v,c.evaluate(e.visProp.usemathjax))try{MathJax.typeset?MathJax.typeset([e.rendNode]):MathJax.Hub.Queue(["Typeset",MathJax.Hub,e.rendNode]),n="fullscreenwrap_"+(d=e.board.container),document.getElementById(n)&&(h=e.board.containerObj._cssFullscreenStore.scale,u=e.board.containerObj._cssFullscreenStore.vshift,a.scaleJSXGraphDiv("#"+n,"#"+d,h,u))}catch{g.debug("MathJax (not yet) loaded")}else if(c.evaluate(e.visProp.usekatex))try{katex.render(v,e.rendNode,{throwOnError:!1})}catch{g.debug("KaTeX (not yet) loaded")}else if(c.evaluate(e.visProp.useasciimathml))try{AMprocessNode(e.rendNode,!1)}catch{g.debug("AsciiMathML (not yet) loaded")}}this.transformImage(e,e.transformations)}else this.updateInternalText(e)},_css2js:function(e){var o,s,t,h,u,d=[],n=c.trim(e).replace(/;$/,"").split(";");for(s=n.length,o=0;o<s;++o)c.trim(n[o])!==""&&(u=n[o].split(":"),t=c.trim(u[0].replace(/-([a-z])/gi,function(p,f){return f.toUpperCase()})),h=c.trim(u[1]),d.push({key:t,val:h}));return d},updateTextStyle:function(e,o){var s,t,h,u,d,n,p,f,v,C=e.visProp,_=a.isBrowser?C.display:"internal",P=["rendNode","rendNodeTag","rendNodeLabel"],x=P.length,S=c.evaluate(C.fontunit),O=["cssdefaultstyle","cssstyle"],w=O.length;if(o?(h=C.highlightstrokecolor,t=C.highlightstrokeopacity,u=C.highlightcssclass):(h=C.strokecolor,t=C.strokeopacity,u=C.cssclass),this.type!=="no"&&(_==="html"||this.type!=="canvas")){for(f=0;f<w;f++)if((v=c.evaluate(C[(o?"highlight":"")+O[f]]))!==""&&e.visPropOld[O[f]]!==v){for(n=this._css2js(v),d=0;d<x;d++)if(c.exists(e[P[d]]))for(p in n)n.hasOwnProperty(p)&&(e[P[d]].style[n[p].key]=n[p].val);e.visPropOld[O[f]]=v}if(s=c.evaluate(C.fontsize),e.visPropOld.fontsize!==s){e.needsSizeUpdate=!0;try{for(d=0;d<x;d++)c.exists(e[P[d]])&&(e[P[d]].style.fontSize=s+S)}catch{for(d=0;d<x;d++)c.exists(e[P[d]])&&(e[P[d]].style.fontSize=s)}e.visPropOld.fontsize=s}}return this.setObjectTransition(e),_==="html"&&this.type!=="no"?(e.visPropOld.cssclass!==u&&(e.rendNode.className=u,e.visPropOld.cssclass=u,e.needsSizeUpdate=!0),this.setObjectStrokeColor(e,h,t)):this.updateInternalTextStyle(e,h,t),this},updateInternalTextStyle:function(e,o,s){this.setObjectStrokeColor(e,o,s)},drawImage:function(e){},updateImage:function(e){this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),this.updateImageURL(e),this.transformImage(e,e.transformations),this._updateVisual(e,{stroke:!0,dash:!0},!0)},joinTransforms:function(e,o){var s,t=e.board.origin.scrCoords[1],h=e.board.origin.scrCoords[2],u=e.board.unitX,d=e.board.unitY,n=o.length,p=[[1,0,0],[-t/u,1/u,0],[h/d,0,-1/d]];for(s=0;s<n;s++)p=m.matMatMult(o[s].matrix,p);return p=m.matMatMult([[1,0,0],[t,u,0],[h,0,-d]],p)},transformImage:function(e,o){},updateImageURL:function(e){},updateImageStyle:function(e,o){e.rendNode.className=c.evaluate(o?e.visProp.highlightcssclass:e.visProp.cssclass)},drawForeignObject:function(e){},updateForeignObject:function(e){},appendChildPrim:function(e,o){},appendNodesToElement:function(e,o){},createPrim:function(e,o){return null},remove:function(e){},makeArrows:function(e,o){},_setArrowWidth:function(e,o,s){},updateEllipsePrim:function(e,o,s,t,h){},updateLinePrim:function(e,o,s,t,h,u){},updatePathPrim:function(e,o,s){},updatePathStringPoint:function(e,o,s){},updatePathStringPrim:function(e){},updatePathStringBezierPrim:function(e){},updatePolygonPrim:function(e,o){},updateRectPrim:function(e,o,s,t,h){},setPropertyPrim:function(e,o,s){},setTabindex:function(e){var o;e.board.attr.keyboard.enabled&&c.exists(e.rendNode)&&(o=c.evaluate(e.visProp.tabindex),e.visPropCalc.visible&&!c.evaluate(e.visProp.fixed)||(o=null),o!==e.visPropOld.tabindex&&(e.rendNode.setAttribute("tabindex",o),e.visPropOld.tabindex=o))},display:function(e,o){e&&(e.visPropOld.visible=o)},show:function(e){},hide:function(e){},setBuffering:function(e,o){},setDashStyle:function(e){},setDraft:function(e){if(c.evaluate(e.visProp.draft)){var o=e.board.options.elements.draft.color,s=e.board.options.elements.draft.opacity;this.setObjectTransition(e),e.type===b.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,o,s):(e.elementClass===b.OBJECT_CLASS_POINT?this.setObjectFillColor(e,o,s):this.setObjectFillColor(e,"none",0),this.setObjectStrokeColor(e,o,s),this.setObjectStrokeWidth(e,e.board.options.elements.draft.strokeWidth))}},removeDraft:function(e){this.setObjectTransition(e),e.type===b.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity):(e.type===b.OBJECT_CLASS_POINT&&this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity),this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity),this.setObjectStrokeWidth(e,e.visProp.strokewidth))},setGradient:function(e){},updateGradient:function(e){},setObjectTransition:function(e,o){},setObjectFillColor:function(e,o,s){},setObjectStrokeColor:function(e,o,s){},setObjectStrokeWidth:function(e,o){},setShadow:function(e){},highlight:function(e){var o,s,t=e.visProp;if(this.setObjectTransition(e),!t.draft){if(e.type===b.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,t.highlightfillcolor,t.highlightfillopacity),o=0;o<e.borders.length;o++)this.setObjectStrokeColor(e.borders[o],e.borders[o].visProp.highlightstrokecolor,e.borders[o].visProp.highlightstrokeopacity);else e.elementClass===b.OBJECT_CLASS_TEXT?this.updateTextStyle(e,!0):e.type===b.OBJECT_TYPE_IMAGE?(this.updateImageStyle(e,!0),this.setObjectFillColor(e,t.highlightfillcolor,t.highlightfillopacity)):(this.setObjectStrokeColor(e,t.highlightstrokecolor,t.highlightstrokeopacity),this.setObjectFillColor(e,t.highlightfillcolor,t.highlightfillopacity));t.highlightstrokewidth&&(s=Math.max(c.evaluate(t.highlightstrokewidth),c.evaluate(t.strokewidth)),this.setObjectStrokeWidth(e,s),e.elementClass!==b.OBJECT_CLASS_LINE&&e.elementClass!==b.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(e,!0))}return this},noHighlight:function(e){var o,s,t=e.visProp;if(this.setObjectTransition(e),!c.evaluate(e.visProp.draft)){if(e.type===b.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,t.fillcolor,t.fillopacity),o=0;o<e.borders.length;o++)this.setObjectStrokeColor(e.borders[o],e.borders[o].visProp.strokecolor,e.borders[o].visProp.strokeopacity);else e.elementClass===b.OBJECT_CLASS_TEXT?this.updateTextStyle(e,!1):e.type===b.OBJECT_TYPE_IMAGE?(this.updateImageStyle(e,!1),this.setObjectFillColor(e,t.fillcolor,t.fillopacity)):(this.setObjectStrokeColor(e,t.strokecolor,t.strokeopacity),this.setObjectFillColor(e,t.fillcolor,t.fillopacity));s=c.evaluate(t.strokewidth),this.setObjectStrokeWidth(e,s),e.elementClass!==b.OBJECT_CLASS_LINE&&e.elementClass!==b.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(e,!1)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(e,o){var s,t,h=function(d){d||(d=window.event),d.stopPropagation?d.stopPropagation():d.cancelBubble=!0},u=function(d,n,p){var f;p=p||"",(f=s.createElement("span")).innerHTML=d,f.style.paddingLeft="7px",f.style.paddingRight="7px",f.classList!==void 0&&f.classList.add("JXG_navigation_button"),f.setAttribute("id",p),t.appendChild(f),a.addEvent(f,"click",function(v){return c.bind(n,e)(),!1},e),a.addEvent(f,"mouseup",h,e),a.addEvent(f,"mousedown",h,e),a.addEvent(f,"touchend",h,e),a.addEvent(f,"touchstart",h,e)};a.isBrowser&&this.type!=="no"&&(s=e.containerObj.ownerDocument,(t=s.createElement("div")).setAttribute("id",e.container+"_navigationbar"),t.style.color=o.strokecolor,t.style.backgroundColor=o.fillcolor,t.style.padding=o.padding,t.style.position=o.position,t.style.fontSize=o.fontsize,t.style.cursor=o.cursor,t.style.zIndex=o.zindex,e.containerObj.appendChild(t),t.style.right=o.right,t.style.bottom=o.bottom,t.classList!==void 0&&t.classList.add("JXG_navigation"),e.attr.showfullscreen&&u(e.attr.fullscreen.symbol,function(){e.toFullscreen(e.attr.fullscreen.id)},e.container+"_navigation_fullscreen"),e.attr.showscreenshot&&u(e.attr.screenshot.symbol,function(){window.setTimeout(function(){e.renderer.screenshot(e,"",!1)},330)},e.container+"_navigation_screenshot"),e.attr.showreload&&u("↻",function(){e.reload()},e.container+"_navigation_reload"),e.attr.showcleartraces&&u("⊗",function(){e.clearTraces()},e.container+"_navigation_cleartraces"),e.attr.shownavigation&&(e.attr.showzoom&&(u("–",e.zoomOut,e.container+"_navigation_out"),u("o",e.zoom100,e.container+"_navigation_100"),u("+",e.zoomIn,e.container+"_navigation_in")),u("←",e.clickLeftArrow,e.container+"_navigation_left"),u("↓",e.clickUpArrow,e.container+"_navigation_up"),u("↑",e.clickDownArrow,e.container+"_navigation_down"),u("→",e.clickRightArrow,e.container+"_navigation_right")))},getElementById:function(e){return c.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+e):""},removeToInsertLater:function(e){var o=e.parentNode,s=e.nextSibling;if(o!==null)return o.removeChild(e),function(){s?o.insertBefore(e,s):o.appendChild(e)}},resize:function(e,o){},createTouchpoints:function(e){},showTouchpoint:function(e){},hideTouchpoint:function(e){},updateTouchpoint:function(e,o){},dumpToDataURI:function(e){},dumpToCanvas:function(e,o,s,t){},screenshot:function(e){},setLayer:function(e,o){}}),g.AbstractRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(g,E,y,b,m){return g.FileReader={handleRemoteFile:function(l,c,a,e,o,s){var t=!1;try{t=new XMLHttpRequest,a.toLowerCase()==="raw"?t.overrideMimeType("text/plain; charset="+o):t.overrideMimeType("text/xml; charset="+o)}catch{try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch{t=!1}}}if(t){t.open("GET",l,e),a.toLowerCase()==="raw"?this.cbp=function(){var h=t;h.readyState===4&&c(h.responseText)}:this.cbp=function(){var h=t,u="";h.readyState===4&&(u=!y.exists(h.responseStream)||h.responseText.slice(0,2)!=="PK"&&b.asciiCharCodeAt(h.responseText.slice(0,1),0)!==31?h.responseText:m.decode(jxgBinFileReader(h)),this.parseString(u,c,a,s))},this.cb=y.bind(this.cbp,this),t.onreadystatechange=this.cb;try{t.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read remote file '"+l+"'.")}}else g.debug("AJAX not activated!")},handleLocalFile:function(l,c,a,e,o,s){y.exists(e)||(e=!0),a.toLowerCase()==="raw"?this.cbp=function(h){c(h.target.result)}:this.cbp=function(h){var u=h.target.result;this.parseString(u,c,a,s)},this.cb=y.bind(this.cbp,this);var t=new FileReader;t.onload=this.cb,a.toLowerCase()==="raw"?t.readAsText(l):t.readAsText(l,o)},parseFileContent:function(l,c,a,e,o,s){y.isString(l)||FileReader===void 0?this.handleRemoteFile(l,c,a,e,o,s):this.handleLocalFile(l,c,a,e,o,s)},parseString:function(l,c,a,e){var o;if(a=a.toLowerCase(),o=g.readers[a],y.exists(o))new o(c,l).read();else if(a!=="jessiecode")throw new Error("JSXGraph: There is no reader available for '"+a+"'.");y.isFunction(e)&&e(c)}},!E.isMetroApp()&&E.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
</script>
`),g.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(g,E,y){return g.GeonextParser={replacePow:function(b){var m,l,c,a,e,o,s,t,h,u,d,n;for(u=(b=b.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),a=-1;u>=0&&u<b.length-1;){if(a===u)throw new Error("JSXGraph: Error while parsing expression '"+b+"'");if(a=u,h=b.slice(0,u),d=b.slice(u+1),h.charAt(h.length-1)===")"){for(m=1,l=h.length-2;l>=0&&m>0;)(c=h.charAt(l))===")"?m++:c==="("&&(m-=1),l-=1;if(m!==0)throw new Error("JSXGraph: Missing '(' in expression");for(e="",s=h.substring(0,l+1),t=l;t>=0&&s.substr(t,1).match(/([\w.]+)/);)e=RegExp.$1+e,t-=1;e=(e+=h.substring(l+1,h.length)).replace(/([()+*%^\-/\][])/g,"\\$1")}else e="[\\w\\.]+";if(d.match(/^([\w.]*\()/)){for(m=1,l=RegExp.$1.length;l<d.length&&m>0;)(c=d.charAt(l))===")"?m-=1:c==="("&&(m+=1),l+=1;if(m!==0)throw new Error("JSXGraph: Missing ')' in expression");o=(o=d.substring(0,l)).replace(/([()+*%^\-/[\]])/g,"\\$1")}else o="[\\w\\.]+";n=new RegExp("("+e+")\\^("+o+")"),u=(b=b.replace(n,"pow($1,$2)")).indexOf("^")}return b},replaceIf:function(b){var m,l,c,a,e,o,s,t,h,u="",d=null,n=null,p=null;if((c=b.indexOf("If("))<0)return b;for(b=b.replace(/""/g,"0");c>=0;){for(m=b.slice(0,c),l=b.slice(c+3),e=1,a=0,o=-1,s=-1;a<l.length&&e>0;)(t=l.charAt(a))===")"?e-=1:t==="("?e+=1:t===","&&e===1&&(o<0?o=a:s=a),a+=1;if(h=l.slice(0,a-1),l=l.slice(a),o<0||s<0)return"";d=h.slice(0,o),n=h.slice(o+1,s),p=h.slice(s+1),u+=m+"(("+(d=this.replaceIf(d))+")?("+(n=this.replaceIf(n))+"):("+(p=this.replaceIf(p))+"))",d=null,n=null,c=(b=l).indexOf("If(")}return u+=l},replaceNameById:function(b,m,l){var c,a,e,o,s=0,t=["X","Y","L","V"],h=function(u){return l?"$('"+u+"')":u};for(o=0;o<t.length;o++)for(s=b.indexOf(t[o]+"(");s>=0;)s>=0&&(c=b.indexOf(")",s+2))>=0&&(a=(a=b.slice(s+2,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+2)+(l?"$('":"")+h(e.id)+b.slice(c))),c=b.indexOf(")",s+2),s=b.indexOf(t[o]+"(",c);for(s=b.indexOf("Dist(");s>=0;)s>=0&&(c=b.indexOf(",",s+5))>=0&&(a=(a=b.slice(s+5,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+5)+h(e.id)+b.slice(c))),c=b.indexOf(",",s+5),s=b.indexOf(",",c),(c=b.indexOf(")",s+1))>=0&&(a=(a=b.slice(s+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+1)+h(e.id)+b.slice(c))),c=b.indexOf(")",s+1),s=b.indexOf("Dist(",c);for(t=["Deg","Rad"],o=0;o<t.length;o++)for(s=b.indexOf(t[o]+"(");s>=0;)s>=0&&(c=b.indexOf(",",s+4))>=0&&(a=(a=b.slice(s+4,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+4)+h(e.id)+b.slice(c))),c=b.indexOf(",",s+4),s=b.indexOf(",",c),(c=b.indexOf(",",s+1))>=0&&(a=(a=b.slice(s+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+1)+h(e.id)+b.slice(c))),c=b.indexOf(",",s+1),s=b.indexOf(",",c),(c=b.indexOf(")",s+1))>=0&&(a=(a=b.slice(s+1,c)).replace(/\\(['"])?/g,"$1"),(e=m.elementsByName[a])&&(b=b.slice(0,s+1)+h(e.id)+b.slice(c))),c=b.indexOf(")",s+1),s=b.indexOf(t[o]+"(",c);return b},replaceIdByObj:function(b){var m=/(X|Y|L)\(([\w_]+)\)/g;return b=b.replace(m,"$('$2').$1()"),m=/(V)\(([\w_]+)\)/g,b=b.replace(m,"$('$2').Value()"),m=/(Dist)\(([\w_]+),([\w_]+)\)/g,b=b.replace(m,"dist($('$2'), $('$3'))"),m=/(Deg)\(([\w_]+),([ \w[\w_]+),([\w_]+)\)/g,b=b.replace(m,"deg($('$2'),$('$3'),$('$4'))"),m=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,b=b.replace(m,"rad($('$1'),$('$2'),$('$3'))"),m=/N\((.+)\)/g,b=b.replace(m,"($1)")},geonext2JS:function(b,m){var l,c,a,e=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],o=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(c=b=(b=(b=b.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),c=this.replaceNameById(c,m),c=this.replaceIf(c),c=this.replacePow(c),c=this.replaceIdByObj(c),a=0;a<e.length;a++)l=new RegExp(["(\\W|^)(",e[a],")"].join(""),"ig"),c=c.replace(l,["$1",o[a]].join(""));return c=(c=(c=(c=(c=c.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(b,m,l){var c,a,e,o;for(a in y.exists(l)||(l=b.board),c=l.elementsByName)c.hasOwnProperty(a)&&a!==b.name&&(c[a].elementClass===E.OBJECT_CLASS_TEXT&&y.evaluate(c[a].visProp.islabel)||(o=(o=a.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),e=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+o+")(,[\\w\\[\\]'_ ]+)*\\)","g"),m.search(e)>=0&&c[a].addChild(b)))},gxt2jc:function(b,m){var l;return l=b=(b=(b=b.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),l=(l=(l=(l=this.replaceNameById(l,m,!0)).replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")}},g.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","utils/event","utils/color","utils/type"],function(g,E,y,b,m,l,c,a,e){return g.GeometryElement=function(o,s,t,h){var u,d,n;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},c.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(d in this.board=o,this.type=t,this._org_type=t,this.elementClass=h||E.OBJECT_CLASS_OTHER,this.id=s.id,u=s.name,e.exists(u)||(u=this.board.generateName(this)),u!==""&&(this.board.elementsByName[u]=this),this.name=u,this.needsRegularUpdate=s.needsregularupdate,e.clearVisPropOld(this),n=this.resolveShortcuts(s))n.hasOwnProperty(d)&&this._set(d,n[d]);this.visProp.draft=n.draft&&n.draft.draft}},g.extend(g.GeometryElement.prototype,{addChild:function(o){var s,t;for(s in this.childElements[o.id]=o,this.addDescendants(o),o.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(s))for(t in this.descendants[s].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(t)&&(this.descendants[s].ancestors[this.ancestors[t].id]=this.ancestors[t]);for(s in this.ancestors)if(this.ancestors.hasOwnProperty(s))for(t in this.descendants)this.descendants.hasOwnProperty(t)&&(this.ancestors[s].descendants[this.descendants[t].id]=this.descendants[t]);return this},addDescendants:function(o){var s;for(s in this.descendants[o.id]=o,o.childElements)o.childElements.hasOwnProperty(s)&&this.addDescendants(o.childElements[s]);return this},addParents:function(o){var s,t,h;for(t=(h=e.isArray(o)?o:arguments).length,s=0;s<t;++s)e.exists(h[s])&&(e.isId(this.board,h[s])?this.parents.push(h[s]):e.exists(h[s].id)&&this.parents.push(h[s].id));this.parents=e.uniqueArray(this.parents)},setParents:function(o){this.parents=[],this.addParents(o)},removeChild:function(o){return delete this.childElements[o.id],this.removeDescendants(o),delete o.ancestors[this.id],this},removeDescendants:function(o){var s;for(s in delete this.descendants[o.id],o.childElements)o.childElements.hasOwnProperty(s)&&this.removeDescendants(o.childElements[s]);return this},countChildren:function(){var o,s,t=0;for(o in s=this.childElements)s.hasOwnProperty(o)&&o.indexOf("Label")<0&&t++;return t},getName:function(){return this.name},addTransform:function(o){return this},draggable:function(){return this.isDraggable&&!e.evaluate(this.visProp.fixed)&&this.type!==E.OBJECT_TYPE_GLIDER},setPosition:function(o,s){var t,h,u,d,n=[];if(!e.exists(this.parents))return this;for(u=this.parents.length,h=0;h<u;++h)if(t=this.board.select(this.parents[h]),e.isPoint(t)){if(!t.draggable())return this;n.push(t)}for(s.length===3&&(s=s.slice(1)),d=this.board.create("transform",s,{type:"translate"}),(u=n.length)>0?d.applyOnce(n):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(d):this.addTransform(d),h=0;h<u;++h)n[h].type===E.OBJECT_TYPE_GLIDER&&n[h].updateGlider();return this},setPositionDirectly:function(o,s,t){var h=new y(o,s,this.board,!1),u=new y(o,t,this.board,!1),d=m.subtract(h.usrCoords,u.usrCoords);return this.setPosition(E.COORDS_BY_USER,d),this},generatePolynomial:function(){return[]},animate:function(o,s,t){t=t||{};var h,u,d,n=this.board.attr.animationdelay,p=Math.ceil(s/n),f=this,v=function(_,P,x){var S,O,w,T,M;for(S=a.rgb2hsv(_),w=((O=a.rgb2hsv(P))[0]-S[0])/p,T=(O[1]-S[1])/p,M=(O[2]-S[2])/p,f.animationData[x]=[],d=0;d<p;d++)f.animationData[x][p-d-1]=a.hsv2rgb(S[0]+(d+1)*w,S[1]+(d+1)*T,S[2]+(d+1)*M)},C=function(_,P,x,S){var O,w;if(_=parseFloat(_),P=parseFloat(P),!isNaN(_)&&!isNaN(P))for(w=(P-_)/p,f.animationData[x]=[],d=0;d<p;d++)O=_+(d+1)*w,f.animationData[x][p-d-1]=S?Math.floor(O):O};for(h in this.animationData={},o)if(o.hasOwnProperty(h))switch(u=h.toLowerCase()){case"strokecolor":case"fillcolor":v(this.visProp[u],o[h],u);break;case"size":if(!e.isPoint(this))break;C(this.visProp[u],o[h],u,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":C(this.visProp[u],o[h],u,!1)}return this.animationCallback=t.callback,this.board.addAnimation(this),this},update:function(){return e.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(o){return this.prepareUpdate().update().updateVisibility(o).updateRenderer()},setDisplayRendNode:function(o){var s,t,h,u,d;if(o===void 0&&(o=this.visPropCalc.visible),o===this.visPropOld.visible)return this;for(this.board.renderer.display(this,o),t=this.inherits.length,h=0;h<t;h++)if(d=this.inherits[h],e.isArray(d))for(u=d.length,s=0;s<u;s++)e.exists(d[s])&&e.exists(d[s].rendNode)&&e.evaluate(d[s].visProp.visible)==="inherit"&&d[s].setDisplayRendNode(o);else e.exists(d)&&e.exists(d.rendNode)&&e.evaluate(d.visProp.visible)==="inherit"&&d.setDisplayRendNode(o);return this.hasLabel&&e.exists(this.label)&&e.exists(this.label.rendNode)&&e.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(o),this},hide:function(){return this.setAttribute({visible:!1}),this},hideElement:function(){return this.hide(),this},show:function(){return this.setAttribute({visible:!0}),this},showElement:function(){return this.show(),this},updateVisibility:function(o){var s,t,h,u,d,n;if(this.needsUpdate){for(o!==void 0?this.visPropCalc.visible=o:(n=e.evaluate(this.visProp.visible),e.exists(this.hiddenByParent)&&this.hiddenByParent&&(n=!1),n!=="inherit"&&(this.visPropCalc.visible=n)),t=this.inherits.length,h=0;h<t;h++)if(d=this.inherits[h],e.isArray(d))for(u=d.length,s=0;s<u;s++)e.exists(d[s])&&e.evaluate(d[s].visProp.visible)==="inherit"&&d[s].prepareUpdate().updateVisibility(this.visPropCalc.visible);else e.exists(d)&&e.evaluate(d.visProp.visible)==="inherit"&&d.prepareUpdate().updateVisibility(this.visPropCalc.visible);e.exists(this.label)&&e.exists(this.label.visProp)&&e.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(o,s){var t;if(o=o.toLocaleLowerCase(),this.visProp.hasOwnProperty(o)&&o.indexOf("color")>=0&&e.isString(s)&&s.length===9&&s.charAt(0)==="#")s=a.rgba2rgbo(s),this.visProp[o]=s[0],this.visProp[o.replace("color","opacity")]=s[1];else if(s===null||!e.isObject(s)||e.exists(s.id)||e.exists(s.name))this.visProp[o]=s;else for(t in this.visProp[o]={},s)s.hasOwnProperty(t)&&(this.visProp[o][t.toLocaleLowerCase()]=s[t])},resolveShortcuts:function(o){var s,t,h,u=["traceattributes","traceAttributes"];for(s in l.shortcuts)if(l.shortcuts.hasOwnProperty(s)){if(e.exists(o[s]))for(t=0;t<l.shortcuts[s].length;t++)e.exists(o[l.shortcuts[s][t]])||(o[l.shortcuts[s][t]]=o[s]);for(h=0;h<u.length;h++)e.isObject(o[u[h]])&&(o[u[h]]=this.resolveShortcuts(o[u[h]]))}return o},setLabel:function(o){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(o)},setLabelText:function(o){return e.exists(this.label)&&(o=o.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(o)),this},setName:function(o){o=o.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(o),this.setAttribute({name:o})},setProperty:function(){g.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(o){var s,t,h,u,d,n,p,f,v,C={};for(s=0;s<arguments.length;s++)n=arguments[s],e.isString(n)?(f=n.split(":"),C[e.trim(f[0])]=e.trim(f[1])):e.isArray(n)?C[n[0]]=n[1]:g.extend(C,n);for(s in C=this.resolveShortcuts(C))if(C.hasOwnProperty(s)){if(u=s.replace(/\s+/g,"").toLowerCase(),d=C[s],e.isObject(d)&&e.exists(this.visProp[u])){if(this.visProp[u]=e.merge(this.visProp[u],d),this.type===E.OBJECT_TYPE_TICKS&&e.exists(this.labels))for(h=this.labels.length,t=0;t<h;t++)this.labels[t].setAttribute(d);else if(e.exists(this[u]))if(e.isArray(this[u]))for(t=0;t<this[u].length;t++)this[u][t].setAttribute(d);else this[u].setAttribute(d);continue}switch(v=this.visProp[u],u){case"name":v=this.name,delete this.board.elementsByName[this.name],this.name=d,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(d==="false"||d===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":p=(d=a.rgba2rgbo(d))[1],d=d[0],p===0&&e.exists(this.label)&&this.hasLabel&&this.label.hideElement(),e.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=d,this.board.renderer.setObjectStrokeColor(this.label,d,p)),this.elementClass===E.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=d,this.visProp.strokeopacity=p,this.board.renderer.setObjectStrokeColor(this,d,p));break;case"infoboxtext":e.isString(d)?this.infoboxText=d:this.infoboxText=!1;break;case"visible":this.visProp.visible=d!=="false"&&(d==="true"||d),this.setDisplayRendNode(e.evaluate(this.visProp.visible)),e.evaluate(this.visProp.visible)&&e.exists(this.updateSize)&&this.updateSize();break;case"face":e.isPoint(this)&&(this.visProp.face=d,this.board.renderer.changePointStyle(this));break;case"trace":d==="false"||d===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=d!=="pause";break;case"gradient":this.visProp.gradient=d,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":d=a.rgba2rgbo(d),this.visProp.gradientsecondcolor=d[0],this.visProp.gradientsecondopacity=d[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=d,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=d,e.evaluate(d)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=d;break;case"radius":this.type!==E.OBJECT_TYPE_ANGLE&&this.type!==E.OBJECT_TYPE_SECTOR||this.setRadius(d);break;case"rotate":(this.elementClass===E.OBJECT_CLASS_TEXT&&e.evaluate(this.visProp.display)==="internal"||this.type===E.OBJECT_TYPE_IMAGE)&&this.addRotation(d);break;case"ticksdistance":this.type===E.OBJECT_TYPE_TICKS&&e.isNumber(d)&&(this.ticksFunction=this.makeTicksFunction(d));break;case"generatelabelvalue":this.type===E.OBJECT_TYPE_TICKS&&e.isFunction(d)&&(this.generateLabelValue=d);break;case"onpolygon":this.type===E.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!d);break;case"disabled":e.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!d);break;case"checked":e.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!d);break;case"maxlength":e.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!d);break;case"layer":this.board.renderer.setLayer(this,e.evaluate(d)),this._set(u,d);break;case"tabindex":e.exists(this.rendNode)&&(this.rendNode.setAttribute("tabindex",d),this._set(u,d));break;default:e.exists(this.visProp[u])&&(!g.Validator[u]||g.Validator[u]&&g.Validator[u](d)||g.Validator[u]&&e.isFunction(d)&&g.Validator[u](d()))&&(d=(!d.toLowerCase||d.toLowerCase()!=="false")&&d,this._set(u,d))}this.triggerEventHandlers(["attribute:"+u],[v,d,this])}return this.triggerEventHandlers(["attribute"],[C,this]),e.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){g.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(o){var s;switch(o=o.toLowerCase()){case"needsregularupdate":s=this.needsRegularUpdate;break;case"labelcolor":s=this.label.visProp.strokecolor;break;case"infoboxtext":s=this.infoboxText;break;case"withlabel":s=this.hasLabel;break;default:s=this.visProp[o]}return s},setDash:function(o){return this.setAttribute({dash:o}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new y(E.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new y(E.COORDS_BY_USER,[0,0],this.board)},setArrow:function(o,s){return this.visProp.firstarrow=o,this.visProp.lastarrow=s,s&&(this.type=E.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var o=e.evaluate(this.visProp.gradient);o!=="linear"&&o!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var o,s=this;return g.elements.text?((o=e.deepCopy(this.visProp.label,null)).id=this.id+"Label",o.isLabel=!0,o.anchor=this,o.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=g.elements.text(this.board,[0,0,function(){return e.isFunction(s.name)?s.name():s.name}],o),this.label.needsUpdate=!0,this.label.dump=!1,this.label.fullUpdate(),this.hasLabel=!0)):g.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(o){return o=e.def(o,!1),!e.evaluate(this.visProp.highlight)||this.highlighted&&!o||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var o;for(o in this.traces)this.traces.hasOwnProperty(o)&&this.board.renderer.remove(this.traces[o]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=b.normalize(this.stdform),this},toJSON:function(){var o,s,t=['{"name":',this.name];for(s in t.push(', "id":'+this.id),o=[],this.visProp)this.visProp.hasOwnProperty(s)&&e.exists(this.visProp[s])&&o.push('"'+s+'":'+this.visProp[s]);return t.push(', "visProp":{'+o.toString()+"}"),t.push("}"),t.join("")},addRotation:function(o){var s,t,h,u,d,n=this;return(this.elementClass===E.OBJECT_CLASS_TEXT&&e.evaluate(this.visProp.display)==="internal"||this.type===E.OBJECT_TYPE_IMAGE)&&o!==0&&(s=this.board.create("transform",[function(){return-n.X()},function(){return-n.Y()}],{type:"translate"}),t=this.board.create("transform",[function(){return n.X()},function(){return n.Y()}],{type:"translate"}),h=this.board.create("transform",[function(){return n.board.unitX/n.board.unitY},function(){return 1}],{type:"scale"}),u=this.board.create("transform",[function(){return n.board.unitY/n.board.unitX},function(){return 1}],{type:"scale"}),d=this.board.create("transform",[function(){return e.evaluate(o)*Math.PI/180}],{type:"rotate"}),s.bindTo(this),h.bindTo(this),d.bindTo(this),u.bindTo(this),t.bindTo(this)),this},highlightStrokeColor:function(o){return g.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:o}),this},strokeColor:function(o){return g.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:o}),this},strokeWidth:function(o){return g.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:o}),this},fillColor:function(o){return g.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:o}),this},highlightFillColor:function(o){return g.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:o}),this},labelColor:function(o){return g.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:o}),this},dash:function(o){return g.deprecated("dash()","setAttribute()"),this.setAttribute({dash:o}),this},visible:function(o){return g.deprecated("visible()","setAttribute()"),this.setAttribute({visible:o}),this},shadow:function(o){return g.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:o}),this},getType:function(){return this.elType},getParents:function(){return e.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var o,s=e.deepCopy(this.visProp),t=[],h=t.length;for(s.id=this.id,s.name=this.name,o=0;o<h;o++)delete s[t[o]];return s},hasPoint:function(o,s){return!1},addTicks:function(o){return o.id!==""&&e.exists(o.id)||(o.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(o),this.ticks.push(o),o.id},removeAllTicks:function(){var o;if(e.exists(this.ticks)){for(o=this.ticks.length-1;o>=0;o--)this.removeTicks(this.ticks[o]);this.ticks=[],this.board.update()}},removeTicks:function(o){var s,t;if(e.exists(this.defaultTicks)&&this.defaultTicks===o&&(this.defaultTicks=null),e.exists(this.ticks)){for(s=this.ticks.length-1;s>=0;s--)if(this.ticks[s]===o){if(this.board.removeObject(this.ticks[s]),this.ticks[s].ticks)for(t=0;t<this.ticks[s].ticks.length;t++)e.exists(this.ticks[s].labels[t])&&this.board.removeObject(this.ticks[s].labels[t]);delete this.ticks[s];break}}},getSnapSizes:function(){var o,s,t;return o=e.evaluate(this.visProp.snapsizex),s=e.evaluate(this.visProp.snapsizey),o<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(o=(t=this.board.defaultAxes.x.defaultTicks).ticksDelta*(e.evaluate(t.visProp.minorticks)+1)),s<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(s=(t=this.board.defaultAxes.y.defaultTicks).ticksDelta*(e.evaluate(t.visProp.minorticks)+1)),[o,s]},handleSnapToGrid:function(o,s){var t,h,u,d,n,p,f,v,C,_=e.evaluate(this.visProp.attracttogrid),P=e.evaluate(this.visProp.attractorunit),x=e.evaluate(this.visProp.attractordistance);return!e.exists(this.coords)||e.evaluate(this.visProp.fixed)||(e.evaluate(this.visProp.snaptogrid)||_||o===!0)&&(t=this.coords.usrCoords[1],h=this.coords.usrCoords[2],v=(f=this.getSnapSizes())[0],C=f[1],v>0&&C>0&&(p=this.board.getBoundingBox(),u=Math.round(t/v)*v,d=Math.round(h/C)*C,n=new g.Coords(E.COORDS_BY_USER,[u,d],this.board),(!_||n.distance(P==="screen"?E.COORDS_BY_SCREEN:E.COORDS_BY_USER,this.coords)<x)&&(t=u,h=d,s||(t<p[0]?t+=v:t>p[2]&&(t-=v),h<p[3]?h+=C:h>p[1]&&(h-=C)),this.coords.setCoordinates(E.COORDS_BY_USER,[t,h])))),this},getBoundingBox:function(){var o,s,t,h,u,d=[1/0,1/0,-1/0,-1/0];if(this.type===E.OBJECT_TYPE_POLYGON){if((s=this.vertices.length-1)<=0)return d;for(o=0;o<s;o++)t=this.vertices[o].X(),d[0]=t<d[0]?t:d[0],d[2]=t>d[2]?t:d[2],t=this.vertices[o].Y(),d[1]=t<d[1]?t:d[1],d[3]=t>d[3]?t:d[3]}else if(this.elementClass===E.OBJECT_CLASS_CIRCLE)h=this.center.X(),u=this.center.Y(),d=[h-this.radius,u+this.radius,h+this.radius,u-this.radius];else if(this.elementClass===E.OBJECT_CLASS_CURVE){if((s=this.vertices.length)===0)return d;for(o=0;o<s;o++)t=this.points[o].coords.usrCoords[1],d[0]=t<d[0]?t:d[0],d[2]=t>d[2]?t:d[2],t=this.points[o].coords.usrCoords[1],d[1]=t<d[1]?t:d[1],d[3]=t>d[3]?t:d[3]}return d},addEvent:g.shortcut(g.GeometryElement.prototype,"on"),removeEvent:g.shortcut(g.GeometryElement.prototype,"off"),__evt__over:function(o){},__evt__mouseover:function(o){},__evt__out:function(o){},__evt__mouseout:function(o){},__evt__move:function(o){},__evt__mousemove:function(o){},__evt__drag:function(o){},__evt__mousedrag:function(o){},__evt__pendrag:function(o){},__evt__touchdrag:function(o){},__evt__down:function(o){},__evt__mousedown:function(o){},__evt__pendown:function(o){},__evt__touchdown:function(o){},__evt__up:function(o){},__evt__mouseup:function(o){},__evt__penup:function(o){},__evt__touchup:function(o){},__evt__attribute:function(o,s){},__evt__attribute_:function(o,s,t){},__evt:function(){}}),g.GeometryElement}),define("base/coordselement",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","utils/type"],function(g,E,y,b,m,l,c,a){return g.CoordsElement=function(e,o){var s;for(a.exists(e)||(e=[1,0,0]),s=0;s<e.length;++s)e[s]=parseFloat(e[s]);this.coords=new l(c.COORDS_BY_USER,e,this.board),this.initialCoords=new l(c.COORDS_BY_USER,e,this.board),this.position=null,this.isConstrained=!1,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=a.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),a.exists(this.element)&&this.addAnchor(e,o),this.isDraggable=!0},g.extend(g.CoordsElement.prototype,{updateConstraint:function(){return this},updateCoords:function(e){return this.needsUpdate?(a.exists(e)||(e=!1),a.evaluate(this.visProp.frozen)||this.updateConstraint(),this.type===c.OBJECT_TYPE_GLIDER&&(this.isConstrained&&(e=!1),e?this.updateGliderFromParent():this.updateGlider()),this.updateTransform(e),this):this},updateGlider:function(){var e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M=2*Math.PI,N=!1,A=this.slideObject,R=[];if(this.needsUpdateFromParent=!1,A.elementClass===c.OBJECT_CLASS_CIRCLE)a.evaluate(this.visProp.isgeonext)&&(M=1),P=y.projectPointToCircle(this,A,this.board),x=y.rad([A.center.X()+1,A.center.Y()],A.center,this)/M;else if(A.elementClass===c.OBJECT_CLASS_LINE){if(this.onPolygon){if(o=A.point1.coords.usrCoords,t=(s=A.point2.coords.usrCoords)[e=1]-o[e],Math.abs(t)<E.eps&&(t=s[e=2]-o[e]),d=(y.projectPointToLine(this,A,this.board).usrCoords[e]-o[e])/t,u=A.parentPolygon,d<0){for(e=0;e<u.borders.length;e++)if(A===u.borders[e]){A=u.borders[(e-1+u.borders.length)%u.borders.length];break}}else if(d>1){for(e=0;e<u.borders.length;e++)if(A===u.borders[e]){A=u.borders[(e+1+u.borders.length)%u.borders.length];break}}A.id!==this.slideObject.id&&(this.slideObject=A)}o=A.point1.coords,s=A.point2.coords,(t=o.distance(c.COORDS_BY_USER,s))<E.eps?(P=o,N=!0,x=0):(P=y.projectPointToLine(this,A,this.board),o=o.usrCoords.slice(0),s=s.usrCoords.slice(0),Math.abs(s[0])<E.eps?(t=s[e=1],Math.abs(t)<E.eps&&(t=s[e=2]),x=((t=(P.usrCoords[e]-o[e])/t)>=0?1:-1)*(t=Math.abs(t))/(t+1)):Math.abs(o[0])<E.eps?(t=o[e=1],Math.abs(t)<E.eps&&(t=o[e=2]),x=(t=(P.usrCoords[e]-s[e])/t)<0?(1-2*t)/(1-t):1/(t+1)):(t=s[e=1]-o[e],Math.abs(t)<E.eps&&(t=s[e=2]-o[e]),x=(P.usrCoords[e]-o[e])/t)),S=a.evaluate(this.visProp.snapwidth),a.evaluate(S)>0&&Math.abs(this._smax-this._smin)>=E.eps&&(h=(x=Math.max(Math.min(x,1),0))*(this._smax-this._smin)+this._smin,x=((h=Math.round(h/S)*S)-this._smin)/(this._smax-this._smin),this.update(!0)),o=A.point1.coords,!a.evaluate(A.visProp.straightfirst)&&Math.abs(o.usrCoords[0])>E.eps&&x<0&&(P=o,N=!0,x=0),s=A.point2.coords,!a.evaluate(A.visProp.straightlast)&&Math.abs(s.usrCoords[0])>E.eps&&x>1&&(P=s,N=!0,x=1)}else if(A.type===c.OBJECT_TYPE_TURTLE)this.updateConstraint(),P=(O=y.projectPointToTurtle(this,A,this.board))[0],x=O[1];else if(A.elementClass===c.OBJECT_CLASS_CURVE)if(A.type===c.OBJECT_TYPE_ARC||A.type===c.OBJECT_TYPE_SECTOR)P=y.projectPointToCircle(this,A,this.board),f=y.rad(A.radiuspoint,A.center,this),n=0,p=y.rad(A.radiuspoint,A.center,A.anglepoint),x=f,((S=a.evaluate(A.visProp.selection))==="minor"&&p>Math.PI||S==="major"&&p<Math.PI)&&(n=p,p=2*Math.PI),(f<n||f>p)&&(x=p,(f<n&&f>.5*n||f>p&&f>.5*p+Math.PI)&&(x=n),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),M=p-n,this.visProp.isgeonext&&(M=1),Math.abs(M)>E.eps&&(x/=M);else if(this.updateConstraint(),A.transformations.length>0){for(T=!1,(O=A.getTransformationSource())[0]&&(T=O[0],R.push(A),R.push(O[1]));O[0]&&a.exists(O[1]._transformationSource);)O=O[1].getTransformationSource(),R.push(O[1]);if(w=this.coords.usrCoords,T){for(e=0;e<R.length;e++)R[e].updateTransformMatrix(),_=E.inverse(R[e].transformMat),w=E.matVecMult(_,w);for(v=new l(c.COORDS_BY_USER,w,this.board).usrCoords,w=(C=y.projectCoordsToCurve(v[1],v[2],this.position||0,R[R.length-1],this.board))[0].usrCoords,e=R.length-2;e>=0;e--)w=E.matVecMult(R[e].transformMat,w);C[0]=new l(c.COORDS_BY_USER,w,this.board)}else A.updateTransformMatrix(),_=E.inverse(A.transformMat),w=E.matVecMult(_,w),v=new l(c.COORDS_BY_USER,w,this.board).usrCoords,C=y.projectCoordsToCurve(v[1],v[2],this.position||0,A,this.board);P=C[0],x=C[1]}else P=(O=y.projectPointToCurve(this,A,this.board))[0],x=O[1];else a.isPoint(A)&&(P=y.projectPointToPoint(this,A,this.board),x=this.position);this.coords.setCoordinates(c.COORDS_BY_USER,P.usrCoords,N),this.position=x},updateGliderFromParent:function(){var e,o,s,t,h,u,d,n,p,f,v,C,_=this.slideObject,P=[],x=2*Math.PI;if(this.needsUpdateFromParent){if(_.elementClass===c.OBJECT_CLASS_CIRCLE)s=_.Radius(),a.evaluate(this.visProp.isgeonext)&&(x=1),h=[_.center.X()+s*Math.cos(this.position*x),_.center.Y()+s*Math.sin(this.position*x)];else if(_.elementClass===c.OBJECT_CLASS_LINE)e=_.point1.coords.usrCoords,o=_.point2.coords.usrCoords,e[0]===0&&e[1]===0&&e[2]===0||o[0]===0&&o[1]===0&&o[2]===0?h=[0,0,0]:Math.abs(o[0])<E.eps?(t=Math.min(Math.abs(this.position),1-E.eps),t/=1-t,this.position<0&&(t=-t),h=[e[0]+t*o[0],e[1]+t*o[1],e[2]+t*o[2]]):Math.abs(e[0])<E.eps?(t=Math.max(this.position,E.eps),t=(t=Math.min(t,2-E.eps))>1?(t-1)/(t-2):(1-t)/t,h=[o[0]+t*e[0],o[1]+t*e[1],o[2]+t*e[2]]):(t=this.position,h=[e[0]+t*(o[0]-e[0]),e[1]+t*(o[1]-e[1]),e[2]+t*(o[2]-e[2])]);else if(_.type===c.OBJECT_TYPE_TURTLE)this.coords.setCoordinates(c.COORDS_BY_USER,[_.Z(this.position),_.X(this.position),_.Y(this.position)]),this.updateConstraint(),h=y.projectPointToTurtle(this,_,this.board)[0].usrCoords;else if(_.elementClass===c.OBJECT_CLASS_CURVE){for(n=!1,(u=_.getTransformationSource())[0]&&(n=u[0],P.push(_),P.push(u[1]));u[0]&&a.exists(u[1]._transformationSource);)u=u[1].getTransformationSource(),P.push(u[1]);if(n?this.coords.setCoordinates(c.COORDS_BY_USER,[P[P.length-1].Z(this.position),P[P.length-1].X(this.position),P[P.length-1].Y(this.position)]):this.coords.setCoordinates(c.COORDS_BY_USER,[_.Z(this.position),_.X(this.position),_.Y(this.position)]),_.type===c.OBJECT_TYPE_ARC||_.type===c.OBJECT_TYPE_SECTOR)p=y.rad([_.center.X()+1,_.center.Y()],_.center,_.radiuspoint),f=0,C=y.rad(_.radiuspoint,_.center,_.anglepoint),(_.visProp.selection==="minor"&&C>Math.PI||_.visProp.selection==="major"&&C<Math.PI)&&(f=C,C=2*Math.PI),x=C-f,a.evaluate(this.visProp.isgeonext)&&(x=1),((v=this.position*x)<f||v>C)&&(((v=C)<f&&v>.5*f||v>C&&v>.5*C+Math.PI)&&(v=f),this.position=v,Math.abs(x)>E.eps&&(this.position/=x)),s=_.Radius(),h=[_.center.X()+s*Math.cos(this.position*x+p),_.center.Y()+s*Math.sin(this.position*x+p)];else if(this.updateConstraint(),n)for(h=y.projectPointToCurve(this,P[P.length-1],this.board)[0].usrCoords,d=P.length-2;d>=0;d--)h=new l(c.COORDS_BY_USER,E.matVecMult(P[d].transformMat,h),this.board).usrCoords;else h=y.projectPointToCurve(this,_,this.board)[0].usrCoords}else a.isPoint(_)&&(h=y.projectPointToPoint(this,_,this.board).usrCoords);this.coords.setCoordinates(c.COORDS_BY_USER,h,!1)}else this.needsUpdateFromParent=!0},updateRendererGeneric:function(e){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>E.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[e](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(e){return this.isReal&&e.isReal?this.coords.distance(c.COORDS_BY_USER,e.coords):NaN},snapToGrid:function(e){return this.handleSnapToGrid(e)},handleSnapToPoints:function(e){var o,s,t,h,u,d,n,p,f=0,v=1/0,C=null,_=a.evaluate(this.visProp.ignoredsnaptopoints),P=!1;if(h=this.board.objectsList.length,_&&(n=_.length),a.evaluate(this.visProp.snaptopoints)||e){for(u=a.evaluate(this.visProp.attractorunit),d=a.evaluate(this.visProp.attractordistance),o=0;o<h;o++){if(s=this.board.objectsList[o],_){for(P=!1,p=0;p<n;p++)if(s===this.board.select(_[p])){P=!0;break}if(P)continue}a.isPoint(s)&&s!==this&&s.visPropCalc.visible&&(t=y.projectPointToPoint(this,s,this.board),(f=u==="screen"?t.distance(c.COORDS_BY_SCREEN,this.coords):t.distance(c.COORDS_BY_USER,this.coords))<d&&f<v&&(v=f,C=t))}C!==null&&this.coords.setCoordinates(c.COORDS_BY_USER,C.usrCoords)}return this},snapToPoints:function(e){return this.handleSnapToPoints(e)},handleAttractors:function(){var e,o,s,t,h=0,u=a.evaluate(this.visProp.attractorunit),d=a.evaluate(this.visProp.attractordistance),n=a.evaluate(this.visProp.snatchdistance),p=a.evaluate(this.visProp.attractors),f=p.length;if(d!==0){for(e=0;e<f;e++)if(o=this.board.select(p[e]),a.exists(o)&&o!==this){if(a.isPoint(o)?s=y.projectPointToPoint(this,o,this.board):o.elementClass===c.OBJECT_CLASS_LINE?(t=y.projectCoordsToSegment(this.coords.usrCoords,o.point1.coords.usrCoords,o.point2.coords.usrCoords),s=!a.evaluate(o.visProp.straightfirst)&&t[1]<0?o.point1.coords:!a.evaluate(o.visProp.straightlast)&&t[1]>1?o.point2.coords:new l(c.COORDS_BY_USER,t[0],this.board)):o.elementClass===c.OBJECT_CLASS_CIRCLE?s=y.projectPointToCircle(this,o,this.board):o.elementClass===c.OBJECT_CLASS_CURVE?s=y.projectPointToCurve(this,o,this.board)[0]:o.type===c.OBJECT_TYPE_TURTLE?s=y.projectPointToTurtle(this,o,this.board)[0]:o.type===c.OBJECT_TYPE_POLYGON&&(s=new l(c.COORDS_BY_USER,y.projectCoordsToPolygon(this.coords.usrCoords,o),this.board)),(h=u==="screen"?s.distance(c.COORDS_BY_SCREEN,this.coords):s.distance(c.COORDS_BY_USER,this.coords))<d){this.type===c.OBJECT_TYPE_GLIDER&&(o===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===o)||this.makeGlider(o);break}h>=n&&(o===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===o)&&this.popSlideObject()}return this}},setPositionDirectly:function(e,o){var s,t,h,u,d=this.coords;if(this.relativeCoords)return t=new l(e,o,this.board),a.evaluate(this.visProp.islabel)?(h=m.subtract(t.scrCoords,d.scrCoords),this.relativeCoords.scrCoords[1]+=h[1],this.relativeCoords.scrCoords[2]+=h[2]):(h=m.subtract(t.usrCoords,d.usrCoords),this.relativeCoords.usrCoords[1]+=h[1],this.relativeCoords.usrCoords[2]+=h[2]),this;for(this.coords.setCoordinates(e,o),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),s=this.transformations.length-1;s>=0;s--)e===c.COORDS_BY_SCREEN?u=new l(e,o,this.board).usrCoords:(o.length===2&&(o=[1].concat(o)),u=o),this.initialCoords.setCoordinates(c.COORDS_BY_USER,E.matVecMult(E.inverse(this.transformations[s].matrix),u));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===c.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(e,o){var s;return o=new l(e,o,this.board),s=this.board.create("transform",o.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(s):this.addTransform(this,s),this.prepareUpdate().update(),this},setPosition:function(e,o){return this.setPositionDirectly(e,o)},setGliderPosition:function(e){return this.type===c.OBJECT_TYPE_GLIDER&&(this.position=e,this.board.update()),this},makeGlider:function(e){var o,s,t,h=this.board.select(e),u=!1;if(h.type===c.OBJECT_TYPE_POLYGON){for(o=Number.MAX_VALUE,s=0;s<h.borders.length;s++)(t=g.Math.Geometry.distPointLine(this.coords.usrCoords,h.borders[s].stdform))<o&&(o=t,e=h.borders[s]);h=this.board.select(e),u=!0}if(!a.exists(h))throw new Error("JSXGraph: slide object undefined.");if(h.type===c.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(e),this.slideObjects.push(this.slideObject),this.addParents(e),this.type=c.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=u,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===c.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===c.OBJECT_CLASS_TEXT?this.elType="text":this.type===c.OBJECT_TYPE_IMAGE?this.elType="image":this.type===c.OBJECT_TYPE_FOREIGNOBJECT&&(this.elType="foreignobject"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var e,o;if(this.type!==c.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,delete this.updateConstraint,this.isConstrained=!1,this.isDraggable)return;this.isDraggable=!0,this.elementClass===c.OBJECT_CLASS_POINT&&(this.type=c.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(e in this.board.objects)this.board.objects.hasOwnProperty(e)&&(o=this.board.objects[e]).descendants&&(delete o.descendants[this.id],delete o.childElements[this.id],this.hasLabel&&(delete o.descendants[this.label.id],delete o.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===c.OBJECT_CLASS_POINT?(this.type=c.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===c.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===c.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(e){var o,s,t=[],h=["X","Y"],u=function(n){return function(){return n}},d=function(n){return function(){return n.Value()}};for(this.elementClass===c.OBJECT_CLASS_POINT&&(this.type=c.OBJECT_TYPE_CAS),this.isDraggable=!1,o=0;o<e.length;o++)s=e[o],a.isString(s)?(t[o]=this.board.jc.snippet(s,!0,null,!0),e.length===2&&(this[h[o]+"jc"]=e[o])):a.isFunction(s)?t[o]=s:a.isNumber(s)?t[o]=u(s):a.isObject(s)&&a.isFunction(s.Value)&&(t[o]=d(s)),t[o].origin=s;return e.length===1?this.updateConstraint=function(){var n=t[0]();return a.isArray(n)?this.coords.setCoordinates(c.COORDS_BY_USER,n):this.coords=n,this}:e.length===2?(this.XEval=t[0],this.YEval=t[1],this.setParents([t[0].origin,t[1].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.COORDS_BY_USER,[this.XEval(),this.YEval()]),this}):(this.ZEval=t[0],this.XEval=t[1],this.YEval=t[2],this.setParents([t[0].origin,t[1].origin,t[2].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]),this}),this.isConstrained=!0,this.prepareUpdate().update(),this.board.isSuspendedUpdate||(this.updateVisibility().updateRenderer(),this.hasLabel&&this.label.fullUpdate()),this},addAnchor:function(e,o){this.relativeCoords=o?new l(c.COORDS_BY_SCREEN,e.slice(0,2),this.board):new l(c.COORDS_BY_USER,e,this.board),this.element.addChild(this),o&&this.addParents(this.element),this.XEval=function(){var s,t,h;return a.evaluate(this.visProp.islabel)?(h=a.evaluate(this.visProp.offset),s=parseFloat(h[0]),t=this.element.getLabelAnchor(),new l(c.COORDS_BY_SCREEN,[s+this.relativeCoords.scrCoords[1]+t.scrCoords[1],0],this.board).usrCoords[1]):(t=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+t.usrCoords[1])},this.YEval=function(){var s,t,h;return a.evaluate(this.visProp.islabel)?(h=a.evaluate(this.visProp.offset),s=-parseFloat(h[1]),t=this.element.getLabelAnchor(),new l(c.COORDS_BY_SCREEN,[0,s+this.relativeCoords.scrCoords[2]+t.scrCoords[2]],this.board).usrCoords[2]):(t=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+t.usrCoords[2])},this.ZEval=a.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(c.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.isConstrained=!0,this.updateConstraint()},updateTransform:function(e){var o;if(this.transformations.length===0)return this;for(o=0;o<this.transformations.length;o++)this.transformations[o].update();return this},addTransform:function(e,o){var s,t=a.isArray(o)?o:[o],h=t.length;for(this.transformations.length===0&&(this.baseElement=e),s=0;s<h;s++)this.transformations.push(t[s]);return this},startAnimation:function(e,o,s){var t=this;return s=s||250,this.type!==c.OBJECT_TYPE_GLIDER||a.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){t._anim(e,o)},s),a.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return a.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(e,o,s){s=s||{};var t,h,u,d,n,p=[],f=[],v=o/this.board.attr.animationdelay,C=function(_,P){return function(){return e[_][P]}};if(a.isArray(e)){for(u=e.length,t=0;t<u;t++)a.isPoint(e[t])?f[t]=e[t]:f[t]={elementClass:c.OBJECT_CLASS_POINT,X:C(t,0),Y:C(t,1)};if((o=o||0)===0)return this.setPosition(c.COORDS_BY_USER,[f[f.length-1].X(),f[f.length-1].Y()]),this.board.update(this);if(!a.exists(s.interpolate)||s.interpolate)for(h=b.Neville(f),t=0;t<v;t++)p[t]=[],p[t][0]=h[0]((v-t)/v*h[3]()),p[t][1]=h[1]((v-t)/v*h[3]());else{for(u=e.length-1,t=0;t<v;++t)n=t/v*u-(d=Math.floor(t/v*u)),p[t]=[],p[t][0]=(1-n)*f[d].X()+n*f[d+1].X(),p[t][1]=(1-n)*f[d].Y()+n*f[d+1].Y();p.push([f[u].X(),f[u].Y()]),p.reverse()}this.animationPath=p}else a.isFunction(e)&&(this.animationPath=e,this.animationStart=new Date().getTime());return this.animationCallback=s.callback,this.board.addAnimation(this),this},moveTo:function(e,o,s){s=s||{},e=new l(c.COORDS_BY_USER,e,this.board);var t,h=this.board.attr.animationdelay,u=Math.ceil(o/h),d=[],n=this.coords.usrCoords[1],p=this.coords.usrCoords[2],f=e.usrCoords[1]-n,v=e.usrCoords[2]-p,C=function(_){return s.effect&&s.effect==="<>"?Math.pow(Math.sin(_/u*Math.PI/2),2):_/u};if(!a.exists(o)||o===0||Math.abs(e.usrCoords[0]-this.coords.usrCoords[0])>E.eps)return this.setPosition(c.COORDS_BY_USER,e.usrCoords),this.board.update(this);if(!a.exists(s.callback)&&Math.abs(f)<E.eps&&Math.abs(v)<E.eps)return this;for(t=u;t>=0;t--)d[u-t]=[e.usrCoords[0],n+f*C(t),p+v*C(t)];return this.animationPath=d,this.animationCallback=s.callback,this.board.addAnimation(this),this},visit:function(e,o,s){e=new l(c.COORDS_BY_USER,e,this.board);var t,h,u,d=this.board.attr.animationdelay,n=[],p=this.coords.usrCoords[1],f=this.coords.usrCoords[2],v=e.usrCoords[1]-p,C=e.usrCoords[2]-f,_=function(P){var x=P<u/2?2*P/u:2*(u-P)/u;return s.effect&&s.effect==="<>"?Math.pow(Math.sin(x*Math.PI/2),2):x};for(a.isNumber(s)?s={repeat:s}:(s=s||{},a.exists(s.repeat)||(s.repeat=1)),u=Math.ceil(o/(d*s.repeat)),h=0;h<s.repeat;h++)for(t=u;t>=0;t--)n[h*(u+1)+u-t]=[e.usrCoords[0],p+v*_(t),f+C*_(t)];return this.animationPath=n,this.animationCallback=s.callback,this.board.addAnimation(this),this},_anim:function(e,o){var s,t,h,u,d,n,p,f,v;return this.intervalCount+=1,this.intervalCount>o&&(this.intervalCount=0),this.slideObject.elementClass===c.OBJECT_CLASS_LINE?(p=this.slideObject.point1.coords.scrCoords,f=this.slideObject.point2.coords.scrCoords,s=Math.round((f[1]-p[1])*this.intervalCount/o),t=Math.round((f[2]-p[2])*this.intervalCount/o),e>0?u=this.slideObject.point1:(u=this.slideObject.point2,s*=-1,t*=-1),this.coords.setCoordinates(c.COORDS_BY_SCREEN,[u.coords.scrCoords[1]+s,u.coords.scrCoords[2]+t])):this.slideObject.elementClass===c.OBJECT_CLASS_CURVE?(d=e>0?Math.round(this.intervalCount/o*this.board.canvasWidth):Math.round((o-this.intervalCount)/o*this.board.canvasWidth),this.coords.setCoordinates(c.COORDS_BY_SCREEN,[d,0]),v=y.projectPointToCurve(this,this.slideObject,this.board),this.coords=v[0],this.position=v[1]):this.slideObject.elementClass===c.OBJECT_CLASS_CIRCLE&&(h=2*Math.PI,h*=e<0?this.intervalCount/o:(o-this.intervalCount)/o,n=this.slideObject.Radius(),this.coords.setCoordinates(c.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+n*Math.cos(h),this.slideObject.center.coords.usrCoords[2]+n*Math.sin(h)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var e=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(e=this.parents),this.type===c.OBJECT_TYPE_GLIDER&&(e=[this.X(),this.Y(),this.slideObject.id]),e}}),g.CoordsElement.create=function(e,o,s,t,h,u){var d,n,p=!1;for(n=0;n<s.length;n++)(a.isFunction(s[n])||a.isString(s[n]))&&(p=!0);if(p)(d=new e(o,[0,0],t,h,u)).addConstraint(s);else if(a.isNumber(s[0])&&a.isNumber(s[1]))d=new e(o,s,t,h,u),a.exists(t.slideobject)?d.makeGlider(t.slideobject):d.baseElement=d,d.isDraggable=!0;else{if(!a.isObject(s[0])||!a.isTransformationOrArray(s[1]))return!1;(d=new e(o,[0,0],t,h,u)).addTransform(s[0],s[1]),d.isDraggable=!1}return d.handleSnapToGrid(),d.handleSnapToPoints(),d.handleAttractors(),d.addParents(s),d},g.CoordsElement}),define("base/text",["jxg","base/constants","base/element","parser/geonext","utils/env","utils/type","math/math","base/coordselement"],function(g,E,y,b,m,l,c,a){var e=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};return g.Text=function(o,s,t,h){this.constructor(o,t,E.OBJECT_TYPE_TEXT,E.OBJECT_CLASS_TEXT),this.element=this.board.select(t.anchor),this.coordsConstructor(s,l.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.board.finalizeAdding(this),this.setText(h),l.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=l.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},g.Text.prototype=new y,l.copyPrototypeMethods(g.Text,a,"coordsConstructor"),g.extend(g.Text.prototype,{hasPoint:function(o,s){var t,h,u,d,n,p,f,v;return l.isObject(l.evaluate(this.visProp.precision))?(f=this.board._inputDevice,v=l.evaluate(this.visProp.precision[f])):v=this.board.options.precision.hasPoint,this.transformations.length>0&&(o=(t=c.matVecMult(c.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,o,s]))[1],s=t[2]),h=(t=(n=this.getAnchorX())==="right"?this.coords.scrCoords[1]-this.size[0]:n==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],u=(d=(p=this.getAnchorY())==="top"?this.coords.scrCoords[2]+this.size[1]:p==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],l.evaluate(this.visProp.dragarea)==="all"?o>=t-v&&o<h+v&&s>=u-v&&s<=d+v:s>=u-v&&s<=d+v&&(o>=t-v&&o<=t+2*v||o>=h-2*v&&o<=h+v)},_createFctUpdateText:function(o){var s,t,h=l.evaluate(this.visProp.parse),u=l.evaluate(this.visProp.usemathjax),d=l.evaluate(this.visProp.usekatex),n=!1;this.orgText=o,l.isFunction(o)?this.updateText=function(){t=o().toString(),this.plaintext=!h||u||d?t:this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(t)))}:(l.isNumber(o)?this.content=l.toFixed(o,l.evaluate(this.visProp.digits)):l.isString(o)&&h&&(l.evaluate(this.visProp.useasciimathml)?this.content="'`"+o+"`'":u||d?(this.content=this.valueTagToJessieCode(o),this.content=this.content.replace(/\\/g,"\\\\")):this.content=this.poorMansTeX(this.valueTagToJessieCode(o)),n=!0),n?(s=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=this.unescapeTicks(s())}):this.updateText=function(){this.plaintext=o})},_setText:function(o){return this._createFctUpdateText(o),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(o){var s;return this.visProp.castext=o,s=l.isFunction(o)?function(){return l.sanitizeHTML(o())}:l.isNumber(o)?o:l.sanitizeHTML(o),this._setText(s)},setText:function(o){return this._setText(o)},updateSize:function(){var o,s,t,h=l.evaluate(this.visProp.display);return m.isBrowser&&this.board.renderer.type!=="no"?(t=this.rendNode,h==="html"||this.board.renderer.type==="vml"?l.exists(t.offsetWidth)?(s=this,window.setTimeout(function(){s.size=[t.offsetWidth,t.offsetHeight],s.needsUpdate=!0,s.updateRenderer()},0)):this.size=this.crudeSizeEstimate():h==="internal"&&(this.board.renderer.type==="svg"?(s=this,window.setTimeout(function(){try{o=t.getBBox(),s.size=[o.width,o.height],s.needsUpdate=!0,s.updateRenderer()}catch{}},0)):this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate())),this):this},crudeSizeEstimate:function(){var o=parseFloat(l.evaluate(this.visProp.fontsize));return[o*this.plaintext.length*.45,.9*o]},utf8_decode:function(o){return o.replace(/&#x(\w+);/g,function(s,t){return String.fromCharCode(parseInt(t,16))})},replaceSub:function(o){if(!o.indexOf)return o;for(var s,t=o.indexOf("_{");t>=0;)(s=(o=o.substr(0,t)+o.substr(t).replace(/_\{/,"<sub>")).substr(t).indexOf("}"))>=0&&(o=o.substr(0,s)+o.substr(s).replace(/\}/,"</sub>")),t=o.indexOf("_{");for(t=o.indexOf("_");t>=0;)t=(o=o.substr(0,t)+o.substr(t).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return o},replaceSup:function(o){if(!o.indexOf)return o;for(var s,t=o.indexOf("^{");t>=0;)(s=(o=o.substr(0,t)+o.substr(t).replace(/\^\{/,"<sup>")).substr(t).indexOf("}"))>=0&&(o=o.substr(0,s)+o.substr(s).replace(/\}/,"</sup>")),t=o.indexOf("^{");for(t=o.indexOf("^");t>=0;)t=(o=o.substr(0,t)+o.substr(t).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return o},getSize:function(){return this.size},setCoords:function(o,s){var t,h,u;return l.isArray(o)&&o.length>1&&(s=o[1],o=o[0]),l.evaluate(this.visProp.islabel)&&l.exists(this.element)?(h=(o-(t=this.element.getLabelAnchor()).usrCoords[1])*this.board.unitX,u=-(s-t.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(E.COORDS_BY_SCREEN,[h,u])):this.coords.setCoordinates(E.COORDS_BY_USER,[o,s]),this.fullUpdate(),this},update:function(o){return this.needsUpdate?(this.updateCoords(o),this.updateText(),l.evaluate(this.visProp.display)==="internal"&&l.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return l.evaluate(this.visProp.autoposition)&&this.setAutoPosition().updateConstraint(),this.updateRendererGeneric("updateText")},expandShortMath:function(o){return o.replace(/([)0-9.])\s*([(a-zA-Z_])/g,"$1*$2")},generateTerm:function(o,s,t){var h,u,d,n,p='""';if(d=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),n=o.indexOf("</value>"),d>=0)for(;d>=0;)p+=' + "'+this.replaceSub(this.replaceSup(o.slice(0,d)))+'"',u=(u=o.slice(d+7,n)).replace(/\s+/g,""),s===!0&&(u=this.expandShortMath(u)),(h=(h=(h=t?u:b.geonext2JS(u,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&l.isNumber(l.bind(this.board.jc.snippet(h,!0,"",!1),this)())?p+="+("+h+").toFixed("+l.evaluate(this.visProp.digits)+")":p+="+("+h+")",d=(o=o.slice(n+8)).indexOf("<value>"),n=o.indexOf("</value>");return p+=' + "'+this.replaceSub(this.replaceSup(o))+'"',p=(p=(p=this.convertGeonextAndSketchometry2CSS(p)).replace(/&amp;/g,"&")).replace(/"/g,"'")},valueTagToJessieCode:function(o){var s,t,h,u,d=[],n='"';if(h=(o=(o=(o=(o=(o=o||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),u=o.indexOf("</value>"),h>=0)for(;h>=0;)d.push(n+this.escapeTicks(o.slice(0,h))+n),t=(t=o.slice(h+7,u)).replace(/\s+/g,""),(s=(s=t=this.expandShortMath(t)).replace(/\\"/g,"'").replace(/\\'/g,"'")).indexOf("toFixed")<0&&l.isNumber(l.bind(this.board.jc.snippet(s,!0,"",!1),this)())?d.push("("+s+").toFixed("+l.evaluate(this.visProp.digits)+")"):d.push("("+s+")"),h=(o=o.slice(u+8)).indexOf("<value>"),u=o.indexOf("</value>");return d.push(n+this.escapeTicks(o)+n),d.join(" + ").replace(/&amp;/g,"&")},poorMansTeX:function(o){return o=o.replace(/<arc\s*\/*>/g,"&ang;").replace(/&lt;arc\s*\/*&gt;/g,"&ang;").replace(/<sqrt\s*\/*>/g,"&radic;").replace(/&lt;sqrt\s*\/*&gt;/g,"&radic;"),this.convertGeonextAndSketchometry2CSS(this.replaceSub(this.replaceSup(o)))},escapeTicks:function(o){return o.replace(/"/g,"%22").replace(/'/g,"%27")},unescapeTicks:function(o){return o.replace(/%22/g,'"').replace(/%27/g,"'")},convertGeonext2CSS:function(o){return l.isString(o)&&(o=(o=(o=(o=o.replace(/(<|&lt;)overline(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/overline(>|&gt;)/g,"</span>")).replace(/(<|&lt;)arrow(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/arrow(>|&gt;)/g,"</span>")),o},convertSketchometry2CSS:function(o){return l.isString(o)&&(o=(o=(o=(o=o.replace(/(<|&lt;)sketchofont(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchofont(>|&gt;)/g,"</span>")).replace(/(<|&lt;)sketchometry-light(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchometry-light(>|&gt;)/g,"</span>")),o},convertGeonextAndSketchometry2CSS:function(o){return o=this.convertGeonext2CSS(o),o=this.convertSketchometry2CSS(o)},notifyParents:function(o){var s,t=null;o=(o=o.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do(t=(s=/<value>([\w\s*/^\-+()[\],<>=!]+)<\/value>/).exec(o))!==null&&(b.findDependencies(this,t[1],this.board),o=(o=o.substr(t.index)).replace(s,""));while(t!==null);return this},getParents:function(){var o;return o=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(o=this.parents),o},bounds:function(){var o=this.coords.usrCoords;return l.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[o[1],o[2]+this.size[1]/this.board.unitY,o[1]+this.size[0]/this.board.unitX,o[2]]},getAnchorX:function(){var o=l.evaluate(this.visProp.anchorx);if(o==="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";default:return"right"}return o},getAnchorY:function(){var o=l.evaluate(this.visProp.anchory);if(o==="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";default:return"middle"}return o},getNumberofConflicts:function(o,s,t,h){var u,d,n,p,f=0;for(p=this.board.options.precision.hasPoint,this.board.options.precision.hasPoint=.25*(t+h),u=0,n=this.board.objectsList.length;u<n;u++)(d=this.board.objectsList[u]).visPropCalc.visible&&d.elType!=="axis"&&d.elType!=="ticks"&&d!==this.board.infobox&&d!==this&&d.hasPoint(o,s)&&f++;return this.board.options.precision.hasPoint=p,f},setAutoPosition:function(){var o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w=this.size[0],T=this.size[1],M={conflicts:1/0,angle:0,r:0},N=2*Math.PI/12;if(this===this.board.infobox||!this.visPropCalc.visible||!l.evaluate(this.visProp.islabel)||!this.element)return this;if(v=l.evaluate(this.visProp.offset),t=(u=this.element.getLabelAnchor()).scrCoords[1],h=u.scrCoords[2],P=v[0],x=v[1],(f=this.getNumberofConflicts(t+P,h-x,w,T))===0)return this;for(p=.2*(C=12),d=Math.atan2(x,P),M.conflicts=f,M.angle=d,M.r=C;M.conflicts>0&&C<28;){for(_=1,n=d+N;_<12&&M.conflicts>0&&(o=t+C*(S=Math.cos(n)),s=h-C*(O=Math.sin(n)),(f=this.getNumberofConflicts(o,s,w,T))<M.conflicts&&(M.conflicts=f,M.angle=n,M.r=C),M.conflicts!==0);_++)n+=N;C+=p}return C=M.r,S=Math.cos(M.angle),O=Math.sin(M.angle),this.visProp.offset=[C*S,C*O],this.visProp.anchorx=S<-.2?"right":S>.2?"left":"middle",this}}),g.createText=function(o,s,t){var h,u=l.copyAttributes(t,o.options,"text"),d=s.slice(0,-1),n=s[s.length-1];if(u.anchor=u.parent||u.anchor,!(h=a.create(g.Text,o,d,u,n)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return u.rotate!==0&&u.display==="internal"&&h.addRotation(u.rotate),h},g.registerElement("text",g.createText),g.createHTMLSlider=function(o,s,t){var h,u,d=l.copyAttributes(t,o.options,"htmlslider");if(s.length!==2||s[0].length!==2||s[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof s[0]+"' and '"+typeof s[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);d.anchor=d.parent||d.anchor,d.fixed=d.fixed||!0,u=[s[0][0],s[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],(h=g.createText(o,u,d)).type=l.OBJECT_TYPE_HTMLSLIDER,h.rendNodeForm=h.rendNode.childNodes[0],h.rendNodeRange=h.rendNodeForm.childNodes[0],h.rendNodeRange.min=s[1][0],h.rendNodeRange.max=s[1][2],h.rendNodeRange.step=d.step,h.rendNodeRange.value=s[1][1],h.rendNodeLabel=h.rendNodeForm.childNodes[1],h.rendNodeLabel.id=h.rendNode.id+"_label",d.withlabel&&(h.rendNodeLabel.innerHTML=h.name+"="),h.rendNodeOut=h.rendNodeForm.childNodes[2],h.rendNodeOut.value=s[1][1];try{h.rendNodeForm.id=h.rendNode.id+"_form",h.rendNodeRange.id=h.rendNode.id+"_range",h.rendNodeOut.id=h.rendNode.id+"_out"}catch(n){g.debug(n)}return h.rendNodeRange.style.width=d.widthrange+"px",h.rendNodeRange.style.verticalAlign="middle",h.rendNodeOut.style.width=d.widthout+"px",h._val=s[1][1],g.supportsVML()?m.addEvent(h.rendNodeForm,"change",e,h):m.addEvent(h.rendNodeForm,"input",e,h),h.Value=function(){return this._val},h},g.registerElement("htmlslider",g.createHTMLSlider),{Text:g.Text,createText:g.createText,createHTMLSlider:g.createHTMLSlider}}),define("utils/uuid",["jxg"],function(g){var E="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return g.Util=g.Util||{},g.Util.genUUID=function(y){var b,m,l=[],c=0;for((y=y||"")!==""&&y.substr(y.length-1)!=="-"&&(y+="-"),m=0;m<36;m++)m===8||m===13||m===18||m===23?l[m]="-":m===14?l[m]="4":(c<=2&&(c=33554432+16777216*Math.random()|0),b=15&c,c>>=4,l[m]=E[m===19?3&b|8:b]);return y+l.join("")},g.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/ia","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Interval,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(g,E){if(typeof g!="object"&&typeof g!="function")throw new TypeError("Object prototype may only be an Object: "+g);if(g===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(E!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function y(){}return y.prototype=g,new y});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}},r,_ccache;JXG.JessieCode=function(g,E){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.operands=this.getPossibleOperands(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="",typeof g=="string"&&this.parse(g,E)},JXG.extend(JXG.JessieCode.prototype,{node:function(g,E,y){return{type:g,value:E,children:y}},createNode:function(g,E,y){var b,m=this.node(g,E,[]);for(b=2;b<arguments.length;b++)m.children.push(arguments[b]);return m.type=="node_const"&&Type.isNumber(m.value)&&(m.isMath=!0),m.line=this.parCurLine,m.col=this.parCurColumn,m},pushScope:function(g){var E={args:g,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=E,E.id=this.scopes.push(E)-1,E},popScope:function(){var g=this.scope.previous;return this.scope=g!==null?g:this.scope,this.scope},getElementById:function(g){return this.board.objects[g]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:(_ccache={},(r=function(g){var E,y;return typeof _ccache[this.board.id+g]=="function"?E=_ccache[this.board.id+g]:(y=this,(E=function(b,m){var l;return(l=Type.exists(m)?m:{}).name===void 0&&l.id===void 0&&(l.name=y.lhs[y.scope.id]!==0?y.lhs[y.scope.id]:""),y.board.create(g,b,l)}).creator=!0,_ccache[this.board.id+g]=E),E}).clearCache=function(){_ccache={}},r),letvar:function(g,E){this.builtIn[g]&&this._warn('"'+g+'" is a predefined value.'),this.scope.locals[g]=E},isLocalVariable:function(g){for(var E=this.scope;E!==null;){if(Type.exists(E.locals[g]))return E;E=E.previous}return null},isParameter:function(g){for(var E=this.scope;E!==null;){if(Type.indexOf(E.args,g)>-1)return E;E=E.previous}return null},isCreator:function(g){return!!JXG.elements[g]},isMathMethod:function(g){return g!=="E"&&!!Math[g]},isBuiltIn:function(g){return!!this.builtIn[g]},getvar:function(g,E,y){var b;if(E=Type.def(E,!1),(b=this.isLocalVariable(g))!==null)return b.locals[g];if(g==="$board"||g==="EULER"||g==="PI")return this.builtIn[g];if(y){if(this.isBuiltIn(g))return this.builtIn[g];if(this.isMathMethod(g))return Math[g];if(this.isCreator(g))return this.creator(g)}return E||(b=this.board.select(g))===g?void 0:b},resolve:function(g){for(var E=this.scope;E!==null;){if(Type.exists(E.locals[g]))return E.locals[g];E=E.previous}},getvarJS:function(g,E,y){var b,m="";return E=Type.def(E,!1),y=Type.def(y,!1),this.isParameter(g)!==null?g:this.isLocalVariable(g)===null||y?this.isCreator(g)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(y?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+g+"'].concat([a, props])); })":(y&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(g)?(m=this.builtIn[g].src||this.builtIn[g],Type.isNumber(m)||m.match(/board\.select/)?m:(g=m.split(".").pop(),Type.exists(this.board.mathLib)&&(b=new RegExp("^Math."+g)).exec(m)!==null?m.replace(b,"$jc$.board.mathLib."+g):Type.exists(this.board.mathLibJXG)&&(b=new RegExp("^JXG.Math.")).exec(m)!==null?m.replace(b,"$jc$.board.mathLibJXG."):m)):this.isMathMethod(g)?"$jc$.board.mathLib."+g:E?"":(Type.isId(this.board,g)?(m="$jc$.board.objects['"+g+"']",this.board.objects[g].elType==="slider"&&(m+=".Value()")):Type.isName(this.board,g)?(m="$jc$.board.elementsByName['"+g+"']",this.board.elementsByName[g].elType==="slider"&&(m+=".Value()")):Type.isGroup(this.board,g)&&(m="$jc$.board.groups['"+g+"']"),m)):"$jc$.resolve('"+g+"')"},makeMap:function(g){return g.isMap=!0,g},functionCodeJS:function(g){var E=g.children[0].join(", "),y="",b="";return g.value==="op_map"&&(y="{ return  ",b=" }"),"function ("+E+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+y+this.compile(g.children[1],!0)+b+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,that=this,list=node.children[0],scope=this.pushScope(list),_that;if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{for(fun=eval(str),scope.argtypes=[],i=0;i<list.length;i++)scope.argtypes.push(that.resolveType(list[i],node));return fun}catch(g){return $jc$._warn(`error compiling function

`+str+`

`+g.toString()),function(){}}}(this),this.popScope()}else fun=function(g,E,y){return function(){var b,m;for(m=E.scope,E.scope=E.scopes[y],b=0;b<g.length;b++)E.scope.locals[g[b]]=arguments[b];return b=E.execute(node.children[1]),E.scope=m,b}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=(_that=this,function(){return _that.compile(_that.replaceIDs(Type.deepCopy(node)))}),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(g){var E,y={};for(E=0;E<arguments.length;E++)y=Type.deepCopy(y,arguments[E],!0);return y},setProp:function(g,E,y){var b,m,l={};g.elementClass!==Const.OBJECT_CLASS_POINT||E!=="X"&&E!=="Y"?g.elementClass!==Const.OBJECT_CLASS_TEXT||E!=="X"&&E!=="Y"?g.type&&g.elementClass&&g.visProp?Type.exists(g[g.methodMap[E]])&&typeof g[g.methodMap[E]]!="function"?g[g.methodMap[E]]=y:(l[E]=y,g.setAttribute(l)):g[E]=y:(typeof y=="number"?g[E]=function(){return y}:typeof y=="function"?(g.isDraggable=!1,g[E]=y):typeof y=="string"&&(g.isDraggable=!1,g[E]=Type.createFunction(y,this.board,null,!0),g[E+"jc"]=y),g[E].origin=y,this.board.update()):(E=E.toLowerCase(),g.isDraggable&&typeof y=="number"?(b=E==="x"?y:g.X(),m=E==="y"?y:g.Y(),g.setPosition(Const.COORDS_BY_USER,[b,m])):!g.isDraggable||typeof y!="function"&&typeof y!="string"?g.isDraggable||(b=E==="x"?y:g.XEval.origin,m=E==="y"?y:g.YEval.origin,g.addConstraint([b,m])):(b=E==="x"?y:g.coords.usrCoords[1],m=E==="y"?y:g.coords.usrCoords[2],g.addConstraint([b,m])),this.board.update())},_genericParse:function(g,E,y,b){var m,l,c,a,e=g.replace(/\r\n/g,`
`).split(`
`),o=[];b||(this.code+=g+`
`),Text&&(l=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(y)||(y=!1),m=0;m<e.length;m++)y&&(e[m]=JXG.GeonextParser.geonext2JS(e[m],this.board)),o.push(e[m]);switch(g=o.join(`
`),c=parser.parse(g),this.CA&&(c=this.CA.expandDerivatives(c,null,c),c=this.CA.removeTrivialNodes(c)),E){case"parse":a=this.execute(c);break;case"manipulate":a=this.compile(c);break;case"getAst":a=c;break;default:a=!1}}catch(s){throw s}finally{Text&&(Text.Text.prototype.setText=l)}return a},parse:function(g,E,y){return this._genericParse(g,"parse",E,y)},manipulate:function(g,E,y){return this._genericParse(g,"manipulate",E,y)},getAST:function(g,E,y){return this._genericParse(g,"getAst",E,y)},snippet:function(g,E,y,b){var m;return E=Type.def(E,!0),y=Type.def(y,""),b=Type.def(b,!1),m=(E?" function ("+y+") { return ":"")+g+(E?"; }":"")+";",this.parse(m,b,!0)},replaceIDs:function(g){var E,y;if(g.replaced&&(y=this.board.objects[g.children[1][0].value],Type.exists(y)&&y.name!==""&&(g.type="node_var",g.value=y.name,g.children.length=0,delete g.replaced)),Type.isArray(g))for(E=0;E<g.length;E++)g[E]=this.replaceIDs(g[E]);if(g.children)for(E=g.children.length;E>0;E--)Type.exists(g.children[E-1])&&(g.children[E-1]=this.replaceIDs(g.children[E-1]));return g},replaceNames:function(g){var E,y;if(y=g.value,g.type==="node_op"&&y==="op_lhs"&&g.children.length===1?this.isLHS=!0:g.type==="node_var"&&(this.isLHS?this.letvar(y,!0):!Type.exists(this.getvar(y,!0))&&Type.exists(this.board.elementsByName[y])&&(g=this.createReplacementNode(g))),Type.isArray(g))for(E=0;E<g.length;E++)g[E]=this.replaceNames(g[E]);if(g.children)for(E=g.children.length;E>0;E--)Type.exists(g.children[E-1])&&(g.children[E-1]=this.replaceNames(g.children[E-1]));return g.type==="node_op"&&g.value==="op_lhs"&&g.children.length===1&&(this.isLHS=!1),g},createReplacementNode:function(g){var E=g.value,y=this.board.elementsByName[E];return(g=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",y.id)])).replaced=!0,g},collectDependencies:function(g,E){var y,b,m,l;if(Type.isArray(g))for(l=g.length,y=0;y<l;y++)this.collectDependencies(g[y],E);else if(b=g.value,g.type==="node_var"&&(m=this.getvar(b))&&m.visProp&&m.type&&m.elementClass&&m.id&&(E[m.id]=m),g.type==="node_op"&&g.value==="op_execfun"&&g.children.length>1&&g.children[0].value==="$"&&g.children[1].length>0&&(E[m=g.children[1][0].value]=this.board.objects[m]),g.children)for(y=g.children.length;y>0;y--)Type.exists(g.children[y-1])&&this.collectDependencies(g.children[y-1],E)},resolveProperty:function(g,E,y){return y=Type.def(y,!1),g&&g.methodMap&&(Type.exists(g.subs)&&Type.exists(g.subs[E])?g=g.subs:Type.exists(g.methodMap[E])?E=g.methodMap[E]:(g=g.visProp,E=E.toLowerCase())),Type.isFunction(g)&&this._error("Accessing function properties is not allowed."),Type.exists(g)||this._error(g+" is not an object"),Type.exists(g[E])||this._error("unknown property "+E),y&&typeof g[E]=="function"?function(){return g[E].apply(g,arguments)}:g[E]},resolveType:function(g,E){var y,b;if(Type.isArray(E)){for(y=0;y<E.length;y++)if((b=this.resolveType(g,E[y]))!=="any")return b}if(E.type==="node_op"&&E.value==="op_execfun"&&E.children[0].type==="node_var"&&E.children[0].value===g)return"function";if(E.type==="node_op"){for(y=0;y<E.children.length;y++)if(E.children[0].type==="node_var"&&E.children[0].value===g&&(E.value==="op_add"||E.value==="op_sub"||E.value==="op_mul"||E.value==="op_div"||E.value==="op_mod"||E.value==="op_exp"||E.value==="op_neg"))return"any";for(y=0;y<E.children.length;y++)if((b=this.resolveType(g,E.children[y]))!=="any")return b}return"any"},getLHS:function(g){var E;if(g.type==="node_var")E={o:this.scope.locals,what:g.value};else if(g.type==="node_op"&&g.value==="op_property")E={o:this.execute(g.children[0]),what:g.children[1]};else{if(g.type!=="node_op"||g.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");E={o:this.execute(g.children[0]),what:this.execute(g.children[1])}}return E},getLHSCompiler:function(g,E){var y;if(g.type==="node_var")y=g.value;else if(g.type==="node_op"&&g.value==="op_property")y=[this.compile(g.children[0],E),"'"+g.children[1]+"'"];else{if(g.type!=="node_op"||g.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");y=[this.compile(g.children[0],E),g.children[1].type==="node_const"?g.children[1].value:this.compile(g.children[1],E)]}return y},execute:function(g){var E,y,b,m,l,c,a,e,o,s,t=[];if(E=0,!g)return E;switch(this.line=g.line,this.col=g.col,g.type){case"node_op":switch(g.value){case"op_none":g.children[0]&&this.execute(g.children[0]),g.children[1]&&(E=this.execute(g.children[1]));break;case"op_assign":y=this.getLHS(g.children[0]),this.lhs[this.scope.id]=y.what,y.o.type&&y.o.elementClass&&y.o.methodMap&&y.what==="label"&&this._error("Left-hand side of assignment is read-only."),E=this.execute(g.children[1]),y.o!==this.scope.locals||Type.isArray(y.o)&&typeof y.what=="number"?this.setProp(y.o,y.what,E):this.letvar(y.what,E),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(g.children[0])&&(E=this.execute(g.children[1]));break;case"op_conditional":case"op_if_else":E=this.execute(g.children[0])?this.execute(g.children[1]):this.execute(g.children[2]);break;case"op_while":for(;this.execute(g.children[0]);)this.execute(g.children[1]);break;case"op_do":do this.execute(g.children[0]);while(this.execute(g.children[1]));break;case"op_for":for(this.execute(g.children[0]);this.execute(g.children[1]);this.execute(g.children[2]))this.execute(g.children[3]);break;case"op_proplst":g.children[0]&&this.execute(g.children[0]),g.children[1]&&this.execute(g.children[1]);break;case"op_emptyobject":E={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(g.children[0]),E=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][g.children[0]]=this.execute(g.children[1]);break;case"op_array":for(E=[],l=g.children[0].length,b=0;b<l;b++)E.push(this.execute(g.children[0][b]));break;case"op_extvalue":E=this.execute(g.children[0]),E=typeof(b=this.execute(g.children[1]))=="number"&&Math.abs(Math.round(b)-b)<Mat.eps?E[b]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(g.children[0]);this._error("Unexpected return.");break;case"op_map":g.children[1].isMath||g.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(e=this.defineFunction(g)).isMap=!0,E=e;break;case"op_function":(e=this.defineFunction(g)).isMap=!1,E=e;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,c=g.children[1],Type.exists(g.children[2]))if(g.children[3])for(a=g.children[2],o={},b=0;b<a.length;b++)o=Type.deepCopy(o,this.execute(a[b]),!0);else o=this.execute(g.children[2]);for(g.children[0]._isFunctionName=!0,e=this.execute(g.children[0]),delete g.children[0]._isFunctionName,s=e&&e.sc?e.sc:this,!e.creator&&Type.exists(g.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),b=0;b<c.length;b++)Type.exists(e.scope)&&Type.exists(e.scope.argtypes)&&e.scope.argtypes[b]==="function"?(c[b]._isFunctionName=!0,t[b]=this.execute(c[b]),delete c[b]._isFunctionName):t[b]=this.execute(c[b]),this.dpstack[this.pscope].push({line:g.children[1][b].line,col:g.children[1][b].ecol});if(typeof e!="function"||e.creator)if(typeof e=="function"&&e.creator){m=this.line;try{for((E=e(t,o)).jcLineStart=m,E.jcLineEnd=g.eline,b=m;b<=g.line;b++)this.lineToElement[b]=E;E.debugParents=this.dpstack[this.pscope]}catch(h){this._error(h.toString())}}else this._error("Function '"+e+"' is undefined.");else E=e.apply(s,t);this.dpstack.pop(),this.pscope--;break;case"op_property":m=this.execute(g.children[0]),y=g.children[1],E=this.resolveProperty(m,y,!1),Type.exists(E)&&(E.sc=m);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(g.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),y=this.getvar(g.children[0]),E=this.del(y);break;case"op_eq":E=this.execute(g.children[0])==this.execute(g.children[1]);break;case"op_neq":E=this.execute(g.children[0])!=this.execute(g.children[1]);break;case"op_approx":E=Math.abs(this.execute(g.children[0])-this.execute(g.children[1]))<Mat.eps;break;case"op_gt":E=this.execute(g.children[0])>this.execute(g.children[1]);break;case"op_lt":E=this.execute(g.children[0])<this.execute(g.children[1]);break;case"op_geq":E=this.execute(g.children[0])>=this.execute(g.children[1]);break;case"op_leq":E=this.execute(g.children[0])<=this.execute(g.children[1]);break;case"op_or":E=this.execute(g.children[0])||this.execute(g.children[1]);break;case"op_and":E=this.execute(g.children[0])&&this.execute(g.children[1]);break;case"op_not":E=!this.execute(g.children[0]);break;case"op_add":E=this.add(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_sub":E=this.sub(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_div":E=this.div(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_mod":E=this.mod(this.execute(g.children[0]),this.execute(g.children[1]),!0);break;case"op_mul":E=this.mul(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_exp":E=this.pow(this.execute(g.children[0]),this.execute(g.children[1]));break;case"op_neg":E=this.neg(this.execute(g.children[0]))}break;case"node_var":E=this.getvar(g.value,!1,g._isFunctionName);break;case"node_const":E=g.value===null?null:Number(g.value);break;case"node_const_bool":E=g.value;break;case"node_str":E=g.value.replace(/\\(.)/g,"$1")}return E},compile:function(g,E){var y,b,m,l="";if(Type.exists(E)||(E=!1),!g)return l;switch(g.type){case"node_op":switch(g.value){case"op_none":g.children[0]&&(l=this.compile(g.children[0],E)),g.children[1]&&(l+=this.compile(g.children[1],E));break;case"op_assign":E?(y=this.getLHSCompiler(g.children[0],E),Type.isArray(y)?l="$jc$.setProp("+y[0]+", "+y[1]+", "+this.compile(g.children[1],E)+`);
`:(this.isLocalVariable(y)!==this.scope&&(this.scope.locals[y]=!0),l="$jc$.scopes["+this.scope.id+"].locals['"+y+"'] = "+this.compile(g.children[1],E)+`;
`)):l=(y=this.compile(g.children[0]))+" = "+this.compile(g.children[1],E)+`;
`;break;case"op_if":l=" if ("+this.compile(g.children[0],E)+") "+this.compile(g.children[1],E);break;case"op_if_else":l=" if ("+this.compile(g.children[0],E)+")"+this.compile(g.children[1],E),l+=" else "+this.compile(g.children[2],E);break;case"op_conditional":l="(("+this.compile(g.children[0],E)+")?("+this.compile(g.children[1],E),l+="):("+this.compile(g.children[2],E)+"))";break;case"op_while":l=" while ("+this.compile(g.children[0],E)+`) {
`+this.compile(g.children[1],E)+`}
`;break;case"op_do":l=` do {
`+this.compile(g.children[0],E)+"} while ("+this.compile(g.children[1],E)+`);
`;break;case"op_for":l=" for ("+this.compile(g.children[0],E)+this.compile(g.children[1],E)+"; "+this.compile(g.children[2],E).slice(0,-2)+`) {
`+this.compile(g.children[3],E)+`
}
`;break;case"op_proplst":g.children[0]&&(l=this.compile(g.children[0],E)+", "),l+=this.compile(g.children[1],E);break;case"op_prop":l=g.children[0]+": "+this.compile(g.children[1],E);break;case"op_emptyobject":l=E?"{}":"<< >>";break;case"op_proplst_val":l=this.compile(g.children[0],E);break;case"op_array":for(m=[],b=0;b<g.children[0].length;b++)m.push(this.compile(g.children[0][b],E));l="["+m.join(", ")+"]";break;case"op_extvalue":l=this.compile(g.children[0],E)+"["+this.compile(g.children[1],E)+"]";break;case"op_return":l=" return "+this.compile(g.children[0],E)+`;
`;break;case"op_map":g.children[1].isMath||g.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),m=g.children[0],l=E?" $jc$.makeMap(function ("+m.join(", ")+") { return "+this.compile(g.children[1],E)+"; })":"map ("+m.join(", ")+") -> "+this.compile(g.children[1],E);break;case"op_function":m=g.children[0],this.pushScope(m),l=E?this.functionCodeJS(g):" function ("+m.join(", ")+") "+this.compile(g.children[1],E),this.popScope();break;case"op_execfunmath":console.log("op_execfunmath: TODO"),l="-1";break;case"op_execfun":if(g.children[2]){for(m=[],b=0;b<g.children[2].length;b++)m.push(this.compile(g.children[2][b],E));y=E?"$jc$.mergeAttributes("+m.join(", ")+")":m.join(", ")}for(g.children[0].withProps=!!g.children[2],m=[],b=0;b<g.children[1].length;b++)m.push(this.compile(g.children[1][b],E));l=this.compile(g.children[0],E)+"("+m.join(", ")+(g.children[2]&&E?", "+y:"")+")"+(g.children[2]&&!E?" "+y:""),E&&(l+=`
`),E&&g.children[0].value==="$"&&(l="$jc$.board.objects["+this.compile(g.children[1][0],E)+"]");break;case"op_property":l=E&&g.children[1]!=="X"&&g.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(g.children[0],E)+", '"+g.children[1]+"', true)":this.compile(g.children[0],E)+"."+g.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),l=E?"$jc$.use('":"use('",l+=g.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),l=E?"$jc$.del(":"remove(",l+=this.compile(g.children[0],E)+")";break;case"op_eq":l="("+this.compile(g.children[0],E)+" === "+this.compile(g.children[1],E)+")";break;case"op_neq":l="("+this.compile(g.children[0],E)+" !== "+this.compile(g.children[1],E)+")";break;case"op_approx":l="("+this.compile(g.children[0],E)+" ~= "+this.compile(g.children[1],E)+")";break;case"op_gt":l=E?"$jc$.gt("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" > "+this.compile(g.children[1],E)+")";break;case"op_lt":l=E?"$jc$.lt("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" < "+this.compile(g.children[1],E)+")";break;case"op_geq":l=E?"$jc$.geq("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" >= "+this.compile(g.children[1],E)+")";break;case"op_leq":l=E?"$jc$.leq("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" <= "+this.compile(g.children[1],E)+")";break;case"op_or":l="("+this.compile(g.children[0],E)+" || "+this.compile(g.children[1],E)+")";break;case"op_and":l="("+this.compile(g.children[0],E)+" && "+this.compile(g.children[1],E)+")";break;case"op_not":l="!("+this.compile(g.children[0],E)+")";break;case"op_add":l=E?"$jc$.add("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" + "+this.compile(g.children[1],E)+")";break;case"op_sub":l=E?"$jc$.sub("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" - "+this.compile(g.children[1],E)+")";break;case"op_div":l=E?"$jc$.div("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" / "+this.compile(g.children[1],E)+")";break;case"op_mod":l=E?"$jc$.mod("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+", true)":"("+this.compile(g.children[0],E)+" % "+this.compile(g.children[1],E)+")";break;case"op_mul":l=E?"$jc$.mul("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+" * "+this.compile(g.children[1],E)+")";break;case"op_exp":l=E?"$jc$.pow("+this.compile(g.children[0],E)+", "+this.compile(g.children[1],E)+")":"("+this.compile(g.children[0],E)+"^"+this.compile(g.children[1],E)+")";break;case"op_neg":l=E?"$jc$.neg("+this.compile(g.children[0],E)+")":"(-"+this.compile(g.children[0],E)+")"}break;case"node_var":l=E?this.getvarJS(g.value,!1,g.withProps):g.value;break;case"node_const":case"node_const_bool":l=g.value;break;case"node_str":l="'"+g.value+"'"}return g.needsBrackets&&(l=E?`{
`+l+`
}
`:"<< "+l+" >>"),l},getName:function(g,E){var y="";return Type.exists(g)&&Type.exists(g.getName)?(y=g.getName(),Type.exists(y)&&y!==""||!E||(y=g.id)):E&&(y=g.id),y},X:function(g){return g.X()},Y:function(g){return g.Y()},V:function(g){return g.Value()},L:function(g){return g.L()},area:function(g){return Type.exists(g)&&Type.exists(g.Area)||this._error("Error: Can't calculate area."),g.Area()},dist:function(g,E){return Type.exists(g)&&Type.exists(g.Dist)||this._error("Error: Can't calculate distance."),g.Dist(E)},radius:function(g){return Type.exists(g)&&Type.exists(g.Radius)||this._error("Error: Can't calculate radius."),g.Radius()},add:function(g,E){var y,b,m;if(g=Type.evalSlider(g),E=Type.evalSlider(E),Interval.isInterval(g)||Interval.isInterval(E))m=Interval.add(g,E);else if(Type.isArray(g)&&Type.isArray(E))for(b=Math.min(g.length,E.length),m=[],y=0;y<b;y++)m[y]=g[y]+E[y];else Type.isNumber(g)&&Type.isNumber(E)?m=g+E:Type.isString(g)||Type.isString(E)?m=g.toString()+E.toString():this._error("Operation + not defined on operands "+typeof g+" and "+typeof E);return m},sub:function(g,E){var y,b,m;if(g=Type.evalSlider(g),E=Type.evalSlider(E),Interval.isInterval(g)||Interval.isInterval(E))m=Interval.sub(g,E);else if(Type.isArray(g)&&Type.isArray(E))for(b=Math.min(g.length,E.length),m=[],y=0;y<b;y++)m[y]=g[y]-E[y];else Type.isNumber(g)&&Type.isNumber(E)?m=g-E:this._error("Operation - not defined on operands "+typeof g+" and "+typeof E);return m},neg:function(g){var E,y,b;if(g=Type.evalSlider(g),Interval.isInterval(g))b=Interval.negative(g);else if(Type.isArray(g))for(y=g.length,b=[],E=0;E<y;E++)b[E]=-g[E];else Type.isNumber(g)?b=-g:this._error("Unary operation - not defined on operand "+typeof g);return b},mul:function(g,E){var y,b,m;if(g=Type.evalSlider(g),E=Type.evalSlider(E),Type.isArray(g)&&Type.isNumber(E)&&(y=g,E=g=E),Interval.isInterval(g)||Interval.isInterval(E))m=Interval.mul(g,E);else if(Type.isArray(g)&&Type.isArray(E))b=Math.min(g.length,E.length),m=Mat.innerProduct(g,E,b);else if(Type.isNumber(g)&&Type.isArray(E))for(b=E.length,m=[],y=0;y<b;y++)m[y]=g*E[y];else Type.isNumber(g)&&Type.isNumber(E)?m=g*E:this._error("Operation * not defined on operands "+typeof g+" and "+typeof E);return m},div:function(g,E){var y,b,m;if(g=Type.evalSlider(g),E=Type.evalSlider(E),Interval.isInterval(g)||Interval.isInterval(E))m=Interval.div(g,E);else if(Type.isArray(g)&&Type.isNumber(E))for(b=g.length,m=[],y=0;y<b;y++)m[y]=g[y]/E;else Type.isNumber(g)&&Type.isNumber(E)?m=g/E:this._error("Operation * not defined on operands "+typeof g+" and "+typeof E);return m},mod:function(g,E){var y,b,m;if(g=Type.evalSlider(g),E=Type.evalSlider(E),Interval.isInterval(g)||Interval.isInterval(E))return Interval.fmod(g,E);if(Type.isArray(g)&&Type.isNumber(E))for(b=g.length,m=[],y=0;y<b;y++)m[y]=Mat.mod(g[y],E,!0);else Type.isNumber(g)&&Type.isNumber(E)?m=Mat.mod(g,E,!0):this._error("Operation * not defined on operands "+typeof g+" and "+typeof E);return m},pow:function(g,E){return g=Type.evalSlider(g),E=Type.evalSlider(E),Interval.isInterval(g)||Interval.isInterval(E)?Interval.pow(g,E):Mat.pow(g,E)},lt:function(g,E){return Interval.isInterval(g)||Interval.isInterval(E)?Interval.lt(g,E):g<E},leq:function(g,E){return Interval.isInterval(g)||Interval.isInterval(E)?Interval.leq(g,E):g<=E},gt:function(g,E){return Interval.isInterval(g)||Interval.isInterval(E)?Interval.gt(g,E):g>E},geq:function(g,E){return Interval.isInterval(g)||Interval.isInterval(E)?Intervalt.geq(g,E):g>=E},randint:function(g,E,y){return Type.exists(y)||(y=1),Math.round(Math.random()*(E-g)/y)*y+g},DDD:function(g){console.log("Dummy derivative function. This should never appear!")},ifthen:function(g,E,y){return g?E:y},del:function(g){typeof g=="object"&&JXG.exists(g.type)&&JXG.exists(g.elementClass)&&this.board.removeObject(g)},use:function(g){var E,y,b=!1;if(typeof g=="string"){for(E in JXG.boards)if(JXG.boards.hasOwnProperty(E)&&JXG.boards[E].container===g){y=JXG.boards[E],b=!0;break}}else y=g,b=!0;b?(this.board=y,this.builtIn.$board=y,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+g+"' not found!")},findSymbol:function(g,E){var y,b;for(b=(E=Type.def(E,-1))===-1?this.scope:this.scopes[E];b!==null;){for(y in b.locals)if(b.locals.hasOwnProperty(y)&&b.locals[y]===g)return[y,b];b=b.previous}return[]},importModule:function(g){return priv.modules[g.toLowerCase()]},defineBuiltIn:function(){var g=this,E={PI:Math.PI,EULER:Math.E,D:g.DDD,X:g.X,Y:g.Y,V:g.V,L:g.L,acosh:Mat.acosh,acot:Mat.acot,asinh:Mat.asinh,binomial:Mat.binomial,cbrt:Mat.cbrt,cosh:Mat.cosh,cot:Mat.cot,deg:Geometry.trueAngle,A:g.area,area:g.area,dist:g.dist,R:g.radius,radius:g.radius,erf:Mat.erf,erfc:Mat.erfc,erfi:Mat.erfi,factorial:Mat.factorial,gcd:Mat.gcd,lb:Mat.log2,lcm:Mat.lcm,ld:Mat.log2,lg:Mat.log10,ln:Math.log,log:Mat.log,log10:Mat.log10,log2:Mat.log2,ndtr:Mat.ndtr,ndtri:Mat.ndtri,nthroot:Mat.nthroot,pow:Mat.pow,rad:Geometry.rad,ratpow:Mat.ratpow,trunc:Type.trunc,sinh:Mat.sinh,randint:g.randint,IfThen:g.ifthen,import:g.importModule,use:g.use,remove:g.del,$:g.getElementById,getName:g.getName,name:g.getName,$board:g.board,$log:g.log};return E.rad.sc=Geometry,E.deg.sc=Geometry,E.factorial.sc=Mat,E.X.src="$jc$.X",E.Y.src="$jc$.Y",E.V.src="$jc$.V",E.L.src="$jc$.L",E.acosh.src="JXG.Math.acosh",E.acot.src="JXG.Math.acot",E.asinh.src="JXG.Math.asinh",E.binomial.src="JXG.Math.binomial",E.cbrt.src="JXG.Math.cbrt",E.cot.src="JXG.Math.cot",E.cosh.src="JXG.Math.cosh",E.deg.src="JXG.Math.Geometry.trueAngle",E.erf.src="JXG.Math.erf",E.erfc.src="JXG.Math.erfc",E.erfi.src="JXG.Math.erfi",E.A.src="$jc$.area",E.area.src="$jc$.area",E.dist.src="$jc$.dist",E.R.src="$jc$.radius",E.radius.src="$jc$.radius",E.factorial.src="JXG.Math.factorial",E.gcd.src="JXG.Math.gcd",E.lb.src="JXG.Math.log2",E.lcm.src="JXG.Math.lcm",E.ld.src="JXG.Math.log2",E.lg.src="JXG.Math.log10",E.ln.src="Math.log",E.log.src="JXG.Math.log",E.log10.src="JXG.Math.log10",E.log2.src="JXG.Math.log2",E.ndtr.src="JXG.Math.ndtr",E.ndtri.src="JXG.Math.ndtri",E.nthroot.src="JXG.Math.nthroot",E.pow.src="JXG.Math.pow",E.rad.src="JXG.Math.Geometry.rad",E.ratpow.src="JXG.Math.ratpow",E.trunc.src="JXG.trunc",E.sinh.src="JXG.Math.sinh",E.randint.src="$jc$.randint",E.import.src="$jc$.importModule",E.use.src="$jc$.use",E.remove.src="$jc$.del",E.IfThen.src="$jc$.ifthen",E.$.src="(function (n) { return $jc$.board.select(n); })",E.getName.src="$jc$.getName",E.name.src="$jc$.getName",E.$board&&(E.$board.src="$jc$.board"),E.$log.src="$jc$.log",E},getPossibleOperands:function(){var g,E,y,b,m,l,c,a,e,o,s,t,h,u,d=["E"],n=this.defineBuiltIn(),p=Math;for(h=function(f,v){return f.toLowerCase().localeCompare(v.toLowerCase())},u=function(f,v){var C=null;if(v==="jc")C=n[f];else{if(v!=="Math")return;C=p[f]}if(!d.includes(f))return JXG.isFunction(C)?{name:f,type:"function",numParams:C.length,origin:v}:JXG.isNumber(C)?{name:f,type:"constant",value:C,origin:v}:void(C!==void 0&&console.error("undefined type",C))},g=Object.getOwnPropertyNames(n).sort(h),E=Object.getOwnPropertyNames(p).sort(h),y=[],b=0,m=0;b<g.length||m<E.length;)g[b]===E[m]?(l=u(E[m],"Math"),JXG.exists(l)&&y.push(l),b++,m++):!JXG.exists(E[m])||g[b].toLowerCase().localeCompare(E[m].toLowerCase())<0?(l=u(g[b],"jc"),JXG.exists(l)&&y.push(l),b++):(l=u(E[m],"Math"),JXG.exists(l)&&y.push(l),m++);for(e=[],o=[],s=[],t={},c=y.length,b=0;b<c;b++){switch((a=y[b]).type){case"function":e.push(a.name),a.origin==="jc"&&o.push(a.name);break;case"constant":s.push(a.name)}t[a.name]=a}return{all:t,list:y,functions:e,functions_jessiecode:o,constants:s}},_debug:function(g){typeof console=="object"?console.log(g):Env.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=g+"<br />")},_error:function(g){var E=new Error("Error("+this.line+"): "+g);throw E.line=this.line,E},_warn:function(g){typeof console=="object"?console.log("Warning("+this.line+"): "+g):Env.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+g+"<br />")},_log:function(g){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+g.toString()}):console.log("Log: ",arguments)}});var parser=function(){var g=function(pe,W,se,le){for(se=se||{},le=pe.length;le--;se[pe[le]]=W);return se},E=[2,14],y=[1,13],b=[1,37],m=[1,14],l=[1,15],c=[1,21],a=[1,16],e=[1,17],o=[1,33],s=[1,18],t=[1,19],h=[1,12],u=[1,59],d=[1,60],n=[1,58],p=[1,46],f=[1,48],v=[1,49],C=[1,50],_=[1,51],P=[1,52],x=[1,53],S=[1,54],O=[1,45],w=[1,38],T=[1,39],M=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],N=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],A=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],R=[2,48],L=[1,72],D=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],k=[1,78],B=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],j=[1,82],I=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],q=[1,83],$=[1,84],Z=[1,85],V=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],U=[1,89],J=[1,90],z=[1,91],X=[1,92],G=[1,97],Q=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],ie=[1,103],ce=[1,104],he=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],ae=[1,105],oe=[1,106],H=[1,107],de=[1,126],ne=[1,139],ge=[83,86],fe=[1,150],ye=[10,66,86],Ce=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ue=[1,167],Pe=[10,86],Ee={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,5],[63,6],[92,1],[92,3]],performAction:function(pe,W,se,le,re,F,K){var Y=F.length-1;switch(re){case 1:return F[Y-1];case 2:this.$=te.createNode(ee(K[Y-4]),"node_op","op_if",F[Y-2],F[Y]);break;case 3:this.$=te.createNode(ee(K[Y-6]),"node_op","op_if_else",F[Y-4],F[Y-2],F[Y]);break;case 4:this.$=te.createNode(ee(K[Y-4]),"node_op","op_while",F[Y-2],F[Y]);break;case 5:this.$=te.createNode(ee(K[Y-8]),"node_op","op_for",F[Y-6],F[Y-4],F[Y-2],F[Y]);break;case 6:this.$=te.createNode(ee(K[Y-6]),"node_op","op_do",F[Y-5],F[Y-2]);break;case 7:this.$=te.createNode(ee(K[Y-1]),"node_op","op_use",F[Y]);break;case 8:this.$=te.createNode(ee(K[Y-1]),"node_op","op_delete",F[Y]);break;case 9:this.$=te.createNode(ee(K[Y-1]),"node_op","op_return",void 0);break;case 10:this.$=te.createNode(ee(K[Y-2]),"node_op","op_return",F[Y-1]);break;case 11:case 14:this.$=te.createNode(ee(K[Y]),"node_op","op_none");break;case 12:this.$=F[Y-1],this.$.needsBrackets=!0;break;case 13:this.$=te.createNode(ee(K[Y-1]),"node_op","op_none",F[Y-1],F[Y]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=F[Y];break;case 22:case 65:case 93:this.$=F[Y-1];break;case 25:this.$=te.createNode(ee(K[Y-2]),"node_op","op_assign",F[Y-2],F[Y]),this.$.isMath=!1;break;case 27:this.$=te.createNode(ee(K[Y-4]),"node_op","op_conditional",F[Y-4],F[Y-2],F[Y]),this.$.isMath=!1;break;case 29:this.$=te.createNode(ee(K[Y-2]),"node_op","op_or",F[Y-2],F[Y]),this.$.isMath=!1;break;case 31:this.$=te.createNode(ee(K[Y-2]),"node_op","op_and",F[Y-2],F[Y]),this.$.isMath=!1;break;case 33:this.$=te.createNode(ee(K[Y-2]),"node_op","op_eq",F[Y-2],F[Y]),this.$.isMath=!1;break;case 34:this.$=te.createNode(ee(K[Y-2]),"node_op","op_neq",F[Y-2],F[Y]),this.$.isMath=!1;break;case 35:this.$=te.createNode(ee(K[Y-2]),"node_op","op_approx",F[Y-2],F[Y]),this.$.isMath=!1;break;case 37:this.$=te.createNode(ee(K[Y-2]),"node_op","op_lt",F[Y-2],F[Y]),this.$.isMath=!1;break;case 38:this.$=te.createNode(ee(K[Y-2]),"node_op","op_gt",F[Y-2],F[Y]),this.$.isMath=!1;break;case 39:this.$=te.createNode(ee(K[Y-2]),"node_op","op_leq",F[Y-2],F[Y]),this.$.isMath=!1;break;case 40:this.$=te.createNode(ee(K[Y-2]),"node_op","op_geq",F[Y-2],F[Y]),this.$.isMath=!1;break;case 42:this.$=te.createNode(ee(K[Y-2]),"node_op","op_add",F[Y-2],F[Y]),this.$.isMath=!0;break;case 43:this.$=te.createNode(ee(K[Y-2]),"node_op","op_sub",F[Y-2],F[Y]),this.$.isMath=!0;break;case 45:this.$=te.createNode(ee(K[Y-2]),"node_op","op_mul",F[Y-2],F[Y]),this.$.isMath=!0;break;case 46:this.$=te.createNode(ee(K[Y-2]),"node_op","op_div",F[Y-2],F[Y]),this.$.isMath=!0;break;case 47:this.$=te.createNode(ee(K[Y-2]),"node_op","op_mod",F[Y-2],F[Y]),this.$.isMath=!0;break;case 49:this.$=te.createNode(ee(K[Y-2]),"node_op","op_exp",F[Y-2],F[Y]),this.$.isMath=!0;break;case 51:this.$=te.createNode(ee(K[Y-1]),"node_op","op_not",F[Y]),this.$.isMath=!1;break;case 53:this.$=te.createNode(ee(K[Y-1]),"node_op","op_neg",F[Y]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=F[Y],this.$.isMath=!1;break;case 59:case 91:this.$=te.createNode(ee(K[Y-2]),"node_op","op_property",F[Y-2],F[Y]),this.$.isMath=!0;break;case 60:case 90:this.$=te.createNode(ee(K[Y-3]),"node_op","op_extvalue",F[Y-3],F[Y-1]),this.$.isMath=!0;break;case 61:this.$=te.createNode(ee(K[Y]),"node_var",F[Y]);break;case 69:this.$=F[Y],this.$.isMath=!0;break;case 70:this.$=te.createNode(ee(K[Y]),"node_const",null);break;case 71:this.$=te.createNode(ee(K[Y]),"node_const_bool",!0);break;case 72:this.$=te.createNode(ee(K[Y]),"node_const_bool",!1);break;case 73:this.$=te.createNode(ee(K[Y]),"node_str",F[Y].substring(1,F[Y].length-1));break;case 74:this.$=te.createNode(ee(K[Y]),"node_const",parseFloat(F[Y]));break;case 75:this.$=te.createNode(ee(K[Y]),"node_const",NaN);break;case 76:this.$=te.createNode(ee(K[Y]),"node_const",1/0);break;case 77:this.$=te.createNode(ee(K[Y-1]),"node_op","op_array",[]);break;case 78:this.$=te.createNode(ee(K[Y-2]),"node_op","op_array",F[Y-1]);break;case 79:this.$=te.createNode(ee(K[Y-1]),"node_op","op_emptyobject",{}),this.$.needsBrackets=!0;break;case 80:this.$=te.createNode(ee(K[Y-2]),"node_op","op_proplst_val",F[Y-1]),this.$.needsBrackets=!0;break;case 82:this.$=te.createNode(ee(K[Y-2]),"node_op","op_proplst",F[Y-2],F[Y]);break;case 83:this.$=te.createNode(ee(K[Y-2]),"node_op","op_prop",F[Y-2],F[Y]);break;case 87:case 89:this.$=te.createNode(ee(K[Y-1]),"node_op","op_execfun",F[Y-1],F[Y]),this.$.isMath=!0;break;case 88:this.$=te.createNode(ee(K[Y-2]),"node_op","op_execfun",F[Y-2],F[Y-1],F[Y],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 104:this.$=[F[Y]];break;case 95:case 99:case 105:this.$=F[Y-2].concat(F[Y]);break;case 96:this.$=te.createNode(ee(K[Y]),"node_var",F[Y]),this.$.isMath=!0;break;case 100:this.$=te.createNode(ee(K[Y-3]),"node_op","op_function",[],F[Y]),this.$.isMath=!1;break;case 101:this.$=te.createNode(ee(K[Y-4]),"node_op","op_function",F[Y-2],F[Y]),this.$.isMath=!1;break;case 102:this.$=te.createNode(ee(K[Y-4]),"node_op","op_map",[],F[Y]);break;case 103:this.$=te.createNode(ee(K[Y-5]),"node_op","op_map",F[Y-3],F[Y])}},table:[g([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],E,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:y,8:b,9:20,11:4,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{1:[2,1]},g(M,[2,13]),g(N,[2,15]),g(N,[2,16]),g(N,[2,17]),g(N,[2,18]),g(N,[2,19]),g(N,[2,20]),g(N,[2,21]),g([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],E,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:y,8:b,9:20,11:65,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{20:[1,66]},{20:[1,67]},{8:b,9:69,16:[1,68],20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{16:[1,70]},g(N,[2,11]),g(A,[2,23]),g(A,[2,24]),g([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],R,{32:[1,71],57:L}),g([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),g(D,[2,54],{88:77,8:k,64:[1,75],65:[1,76]}),g(D,[2,55],{88:79,8:k,64:[1,81],65:[1,80]}),g(B,[2,28],{39:j}),g(A,[2,56]),g(A,[2,57]),g(A,[2,58]),g(I,[2,30],{41:q,42:$,43:Z}),g(A,[2,61]),g(A,[2,62]),g(A,[2,63]),g(A,[2,64]),{8:b,9:86,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:[1,87]},{8:[1,88]},g(V,[2,32],{45:U,46:J,47:z,48:X}),g(A,[2,66]),g(A,[2,67]),g(A,[2,68]),g(A,[2,69]),{20:G,72:98,73:99,77:_,78:P,79:x,80:S,83:[1,93],84:94,85:95,87:96},{8:b,20:o,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,81:101,82:O,91:w,93:T},g(Q,[2,36],{50:ie,51:ce}),g(A,[2,70]),g(A,[2,71]),g(A,[2,72]),g(A,[2,73]),g(A,[2,74]),g(A,[2,75]),g(A,[2,76]),g(he,[2,41],{53:ae,54:oe,55:H}),g(A,[2,44]),g(A,[2,50]),{8:b,20:o,31:109,50:u,51:d,52:108,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:110,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:111,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:b,9:20,11:4,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:113,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:114,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:115,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{14:[1,116]},g(N,[2,7]),g(N,[2,8]),g(N,[2,9]),{16:[1,117]},g(N,[2,22]),{8:b,20:o,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:119,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,36:121,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{20:[1,122]},{8:b,9:123,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(A,[2,87],{89:124,90:125,68:127,20:de,82:O}),{8:b,10:[1,128],20:o,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,81:129,82:O,91:w,93:T},g(A,[2,89]),{8:b,9:130,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{20:[1,131]},{8:b,20:o,31:109,38:132,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,40:133,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,40:134,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,40:135,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{10:[1,136]},{10:[1,137],20:ne,92:138},{10:[1,140],20:ne,92:141},{8:b,20:o,31:109,44:142,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,44:143,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,44:144,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,44:145,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(A,[2,79]),{83:[1,146],86:[1,147]},g(ge,[2,81]),{35:[1,148]},{35:[2,84]},{35:[2,85]},{35:[2,86]},g(A,[2,77]),{66:[1,149],86:fe},g(ye,[2,98]),{8:b,20:o,31:109,49:151,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,49:152,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:153,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:154,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,31:109,50:u,51:d,52:155,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(A,[2,51]),g([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],R,{57:L}),g(A,[2,52]),g(A,[2,53]),g([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,156]},{10:[1,157]},{16:[1,158]},{8:[1,159]},g(N,[2,10]),g(A,[2,25]),g(A,[2,49]),{35:[1,160]},g(B,[2,29],{39:j}),g(A,[2,59]),{66:[1,161]},g([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,162]}),g(A,[2,94]),g(A,[2,96]),g(A,[2,97]),g(Ce,[2,92]),{10:[1,163],86:fe},{66:[1,164]},g(A,[2,91]),g(I,[2,31],{41:q,42:$,43:Z}),g(V,[2,33],{45:U,46:J,47:z,48:X}),g(V,[2,34],{45:U,46:J,47:z,48:X}),g(V,[2,35],{45:U,46:J,47:z,48:X}),g(A,[2,65]),{25:165,26:h},{10:[1,166],86:ue},g(Pe,[2,104]),{94:[1,168]},{10:[1,169],86:ue},g(Q,[2,37],{50:ie,51:ce}),g(Q,[2,38],{50:ie,51:ce}),g(Q,[2,39],{50:ie,51:ce}),g(Q,[2,40],{50:ie,51:ce}),g(A,[2,80]),{20:G,72:98,73:99,77:_,78:P,79:x,80:S,85:170,87:96},{8:b,20:o,29:171,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(A,[2,78]),{8:b,20:o,29:172,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(he,[2,42],{53:ae,54:oe,55:H}),g(he,[2,43],{53:ae,54:oe,55:H}),g(A,[2,45]),g(A,[2,46]),g(A,[2,47]),{6:6,7:y,8:b,9:20,11:173,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:b,9:20,11:174,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:175,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:176,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,20:o,29:177,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(A,[2,60]),{20:de,68:127,82:O,90:178},g(Ce,[2,93]),g(A,[2,90]),g(A,[2,100]),{25:179,26:h},{20:[1,180]},{8:b,9:181,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{94:[1,182]},g(ge,[2,82]),g(ge,[2,83]),g(ye,[2,99]),g(M,[2,2],{12:[1,183]}),g(N,[2,4]),{16:[1,184]},{10:[1,185]},g(A,[2,27]),g(A,[2,95]),g(A,[2,101]),g(Pe,[2,105]),g(A,[2,102]),{8:b,9:186,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{6:6,7:y,8:b,9:20,11:187,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{8:b,9:188,20:o,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},{16:[1,189]},g(A,[2,103]),g(N,[2,3]),{10:[1,190]},g(N,[2,6]),{6:6,7:y,8:b,9:20,11:191,13:7,14:m,15:l,16:c,17:a,18:8,19:e,20:o,21:s,22:9,23:t,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:u,51:d,52:56,56:57,58:n,59:26,60:27,61:29,62:30,63:31,65:p,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:f,75:v,76:C,77:_,78:P,79:x,80:S,82:O,91:w,93:T},g(N,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(pe,W){if(!W.recoverable){var se=new Error(pe);throw se.hash=W,se}this.trace(pe)},parse:function(pe){var W=this,se=[0],le=[null],re=[],F=this.table,K="",Y=0,De=0,Xe=0,Fe=2,Be=1,Ue=re.slice.call(arguments,1),me=Object.create(this.lexer),xe={yy:{}};for(var Re in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Re)&&(xe.yy[Re]=this.yy[Re]);me.setInput(pe,xe.yy),xe.yy.lexer=me,xe.yy.parser=this,me.yylloc===void 0&&(me.yylloc={});var Le=me.yylloc;re.push(Le);var Je=me.options&&me.options.ranges;typeof xe.yy.parseError=="function"?this.parseError=xe.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var be,ke,Se,ve,Ie,Ne,_e,Ye,Me,Ge=function(){var Te;return typeof(Te=me.lex()||Be)!="number"&&(Te=W.symbols_[Te]||Te),Te},we={};;){if(Se=se[se.length-1],this.defaultActions[Se]?ve=this.defaultActions[Se]:(be==null&&(be=Ge()),ve=F[Se]&&F[Se][be]),ve===void 0||!ve.length||!ve[0]){var je="";for(Ne in Me=[],F[Se])this.terminals_[Ne]&&Ne>Fe&&Me.push("'"+this.terminals_[Ne]+"'");je=me.showPosition?"Parse error on line "+(Y+1)+`:
`+me.showPosition()+`
Expecting `+Me.join(", ")+", got '"+(this.terminals_[be]||be)+"'":"Parse error on line "+(Y+1)+": Unexpected "+(be==Be?"end of input":"'"+(this.terminals_[be]||be)+"'"),this.parseError(je,{text:me.match,token:this.terminals_[be]||be,line:me.yylineno,loc:Le,expected:Me})}if(ve[0]instanceof Array&&ve.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Se+", token: "+be);switch(ve[0]){case 1:se.push(be),le.push(me.yytext),re.push(me.yylloc),se.push(ve[1]),be=null,ke?(be=ke,ke=null):(De=me.yyleng,K=me.yytext,Y=me.yylineno,Le=me.yylloc,Xe>0);break;case 2:if(_e=this.productions_[ve[1]][1],we.$=le[le.length-_e],we._$={first_line:re[re.length-(_e||1)].first_line,last_line:re[re.length-1].last_line,first_column:re[re.length-(_e||1)].first_column,last_column:re[re.length-1].last_column},Je&&(we._$.range=[re[re.length-(_e||1)].range[0],re[re.length-1].range[1]]),(Ie=this.performAction.apply(we,[K,De,Y,xe.yy,ve[1],le,re].concat(Ue)))!==void 0)return Ie;_e&&(se=se.slice(0,-1*_e*2),le=le.slice(0,-1*_e),re=re.slice(0,-1*_e)),se.push(this.productions_[ve[1]][0]),le.push(we.$),re.push(we._$),Ye=F[se[se.length-2]][se[se.length-1]],se.push(Ye);break;case 3:return!0}}return!0}},te={node:function(pe,W,se){return{type:pe,value:W,children:se}},createNode:function(pe,W,se,le){var re,F=this.node(W,se,[]);for(re=3;re<arguments.length;re++)F.children.push(arguments[re]);return F.line=pe[0],F.col=pe[1],F.eline=pe[2],F.ecol=pe[3],F}},ee=function(pe){return[pe.first_line,pe.first_column,pe.last_line,pe.last_column]},Ae=function(){var pe={EOF:1,parseError:function(W,se){if(!this.yy.parser)throw new Error(W);this.yy.parser.parseError(W,se)},setInput:function(W,se){return this.yy=se||this.yy||{},this._input=W,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var W=this._input[0];return this.yytext+=W,this.yyleng++,this.offset++,this.match+=W,this.matched+=W,W.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),W},unput:function(W){var se=W.length,le=W.split(/(?:\r\n?|\n)/g);this._input=W+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-se),this.offset-=se;var re=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),le.length-1&&(this.yylineno-=le.length-1);var F=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:le?(le.length===re.length?this.yylloc.first_column:0)+re[re.length-le.length].length-le[0].length:this.yylloc.first_column-se},this.options.ranges&&(this.yylloc.range=[F[0],F[0]+this.yyleng-se]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(W){this.unput(this.match.slice(W))},pastInput:function(){var W=this.matched.substr(0,this.matched.length-this.match.length);return(W.length>20?"...":"")+W.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var W=this.match;return W.length<20&&(W+=this._input.substr(0,20-W.length)),(W.substr(0,20)+(W.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var W=this.pastInput(),se=new Array(W.length+1).join("-");return W+this.upcomingInput()+`
`+se+"^"},test_match:function(W,se){var le,re,F;if(this.options.backtrack_lexer&&(F={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(F.yylloc.range=this.yylloc.range.slice(0))),(re=W[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=re.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:re?re[re.length-1].length-re[re.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+W[0].length},this.yytext+=W[0],this.match+=W[0],this.matches=W,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(W[0].length),this.matched+=W[0],le=this.performAction.call(this,this.yy,this,se,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),le)return le;if(this._backtrack){for(var K in F)this[K]=F[K];return!1}return!1},next:function(){if(this.done)return this.EOF;var W,se,le,re;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var F=this._currentRules(),K=0;K<F.length;K++)if((le=this._input.match(this.rules[F[K]]))&&(!se||le[0].length>se[0].length)){if(se=le,re=K,this.options.backtrack_lexer){if((W=this.test_match(le,F[K]))!==!1)return W;if(this._backtrack){se=!1;continue}return!1}if(!this.options.flex)break}return se?(W=this.test_match(se,F[re]))!==!1&&W:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var W=this.next();return W||this.lex()},begin:function(W){this.conditionStack.push(W)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(W){return(W=this.conditionStack.length-1-Math.abs(W||0))>=0?this.conditionStack[W]:"INITIAL"},pushState:function(W){this.begin(W)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(W,se,le,re){switch(le){case 0:case 5:case 6:break;case 1:case 2:return 78;case 3:case 4:return 77;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:case 22:return 94;case 23:return 82;case 24:return 83;case 25:return 26;case 26:return 27;case 27:return 16;case 28:return"#";case 29:return 34;case 30:return 35;case 31:return 79;case 32:return 64;case 33:return 65;case 34:return 66;case 35:return 8;case 36:return 10;case 37:return 58;case 38:return 57;case 39:return 53;case 40:return 54;case 41:return 55;case 42:return 50;case 43:return 51;case 44:return 47;case 45:return 45;case 46:return 48;case 47:return 46;case 48:return 41;case 49:return 43;case 50:return 42;case 51:return 39;case 52:return 37;case 53:return 32;case 54:return 86;case 55:return 5;case 56:return 20;case 57:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:=>)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],inclusive:!0}}};return pe}();function Oe(){this.yy={}}return Ee.lexer=Ae,Oe.prototype=Ee,Ee.Parser=Oe,new Oe}();return require!==void 0&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(g){g[1]||(console.log("Usage: "+g[0]+" FILE"),process.exit(1));var E=require("fs").readFileSync(require("path").normalize(g[1]),"utf8");return exports.parser.parse(E)},require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/composition",["jxg","utils/type"],function(g,E){return g.Composition=function(y){var b,m=this,l=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],c=function(a){return function(){var e;for(e in m.elements)m.elements.hasOwnProperty(e)&&E.exists(m.elements[e][a])&&m.elements[e][a].apply(m.elements[e],arguments);return m}};for(b=0;b<l.length;b++)this[l[b]]=c(l[b]);for(b in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},y)y.hasOwnProperty(b)&&this.add(b,y[b]);this.dump=!0,this.subs={}},g.extend(g.Composition.prototype,{add:function(y,b){return!(E.exists(this[y])||!E.exists(b))&&(E.exists(b.id)?this.elements[b.id]=b:this.elements[y]=b,E.exists(b.name)&&(this.elementsByName[b.name]=b),b.on("attribute:name",this.nameListener,this),this.objectsList.push(b),this[y]=b,this.methodMap[y]=b,!0)},remove:function(y){var b,m=!1;for(b in this.elements)if(this.elements.hasOwnProperty(b)&&this.elements[b].id===this[y].id){m=!0;break}return m&&(delete this.elements[this[y].id],delete this[y]),m},nameListener:function(y,b,m){delete this.elementsByName[y],this.elementsByName[b]=m},select:function(y){return E.exists(g.Board)?g.Board.prototype.select.call(this,y):new g.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var y;for(y in this.subs)this.subs.hasOwnProperty(y)&&this.subs[y].visProp;return this.attr}}),g.Composition}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","utils/color","utils/type","utils/event","utils/env","base/composition"],function(g,E,y,b,m,l,c,a,e,o,s,t,h,u,d){return g.Board=function(n,p,f,v,C,_,P,x,S,O,w){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_MODE_ZOOM=17,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,t.exists(w.document)&&w.document!==!1?this.document=w.document:document!==void 0&&t.isObject(document)&&(this.document=document),this.container=n,this.containerObj=u.isBrowser?this.document.getElementById(this.container):null,u.isBrowser&&p.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+n+"' not found.");this.renderer=p,this.grids=[],this.options=t.deepCopy(b),this.attr=w,this.dimension=2,this.jc=new o,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,v[0],v[1]],this.zoomX=C,this.zoomY=_,this.unitX=P*this.zoomX,this.unitY=x*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=S,this.canvasHeight=O,t.exists(f)&&f!==""&&u.isBrowser&&!t.exists(this.document.getElementById(f))?this.id=f:this.id=this.generateId(),h.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.touchMoveLastId=1/0,this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(E.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._inputDevice="mouse",this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this._isScrolling=!1,this._isResizing=!1,this.selectingBox=[[0,0],[0,0]],this.mathLib=Math,this.mathLibJXG=g.Math,this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},g.extend(g.Board.prototype,{generateName:function(n){var p,f,v=this.attr.maxnamelength,C="",_="",P=[],x="";if(n.type===E.OBJECT_TYPE_TICKS)return"";for(p=t.isPoint(n)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:n.type===E.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.isPoint(n)||n.elementClass===E.OBJECT_CLASS_LINE||n.type===E.OBJECT_TYPE_ANGLE||(C=n.type===E.OBJECT_TYPE_POLYGON?"P_{":n.elementClass===E.OBJECT_CLASS_CIRCLE?"k_{":n.elementClass===E.OBJECT_CLASS_TEXT?"t_{":"s_{",_="}"),f=0;f<v;f++)P[f]=0;for(;P[v-1]<p.length;){for(P[0]=1;P[0]<p.length;P[0]++){for(x=C,f=v;f>0;f--)x+=p[P[f-1]];if(!t.exists(this.elementsByName[x+_]))return x+_}for(P[0]=p.length,f=1;f<v;f++)P[f-1]===p.length&&(P[f-1]=1,P[f]+=1)}return""},generateId:function(){for(var n=1;t.exists(g.boards["jxgBoard"+n]);)n=Math.round(65535*Math.random());return"jxgBoard"+n},setId:function(n,p){var f,v=this.numObjects,C=n.id;if(this.numObjects+=1,C===""||!t.exists(C))for(C=this.id+p+v;t.exists(this.objects[C]);)f=Math.round(65535*Math.random()),C=this.id+p+v+"-"+f;return n.id=C,this.objects[C]=n,n._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=n,C},finalizeAdding:function(n){t.evaluate(n.visProp.visible)===!1&&this.renderer.display(n,!1)},finalizeLabel:function(n){n.hasLabel&&!t.evaluate(n.label.visProp.islabel)&&t.evaluate(n.label.visProp.visible)===!1&&this.renderer.display(n.label,!1)},checkFrameRate:function(n){var p=!1,f=new Date().getTime();return t.exists(n.pointerId)&&this.touchMoveLastId!==n.pointerId&&(p=!0,this.touchMoveLastId=n.pointerId),!p&&(f-this.touchMoveLast)*this.attr.maxframerate>=1e3&&(p=!0),p&&(this.touchMoveLast=f),p},getCoordsTopLeftCorner:function(){var n,p,f,v,C,_=this.document.ownerDocument||this.document,P=_.documentElement||this.document.body.parentNode,x=_.body,S=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),S.getBoundingClientRect){for(f=S.getBoundingClientRect(),v=1,C=S;C&&t.exists(C.parentNode);)t.exists(C.style)&&t.exists(C.style.zoom)&&C.style.zoom!==""&&(v*=parseFloat(C.style.zoom)),C=C.parentNode;return(n=[f.left*v,f.top*v])[0]+=u.getProp(S,"border-left-width"),n[1]+=u.getProp(S,"border-top-width"),this.renderer.type!=="vml"&&(n[0]+=u.getProp(S,"padding-left"),n[1]+=u.getProp(S,"padding-top")),this.cPos=n.slice(),this.cPos}return n=u.getOffset(S),p=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&p.defaultView&&(n[0]+=u.getProp(P,"margin-left"),n[1]+=u.getProp(P,"margin-top"),n[0]+=u.getProp(P,"border-left-width"),n[1]+=u.getProp(P,"border-top-width"),n[0]+=u.getProp(P,"padding-left"),n[1]+=u.getProp(P,"padding-top")),x&&(n[0]+=u.getProp(x,"left"),n[1]+=u.getProp(x,"top")),typeof google=="object"&&google.translate&&(n[0]+=10,n[1]+=25),n[0]+=u.getProp(S,"border-left-width"),n[1]+=u.getProp(S,"border-top-width"),this.renderer.type!=="vml"&&(n[0]+=u.getProp(S,"padding-left"),n[1]+=u.getProp(S,"padding-top")),n[0]+=this.attr.offsetx,n[1]+=this.attr.offsety,this.cPos=n.slice(),this.cPos},getMousePosition:function(n,p){var f,v,C=this.getCoordsTopLeftCorner();return f=u.getPosition(n,p,this.document),t.exists(this.cssTransMat)||this.updateCSSTransforms(),v=[1,f[0]-C[0],f[1]-C[1]],(v=l.matVecMult(this.cssTransMat,v))[1]/=v[0],v[2]/=v[0],[v[1],v[2]]},initMoveOrigin:function(n,p){this.drag_dx=n-this.origin.scrCoords[1],this.drag_dy=p-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(n,p,f,v){var C,_,P,x=[],S=[],O=this.objectsList.length,w={visProp:{layer:-1e4}};for(_=0;_<O;_++)P=(C=this.objectsList[_]).hasPoint&&C.hasPoint(n,p),C.visPropCalc.visible&&P&&(C.triggerEventHandlers([v+"down","down"],[f]),this.downObjects.push(C)),P&&C.isDraggable&&C.visPropCalc.visible&&(this.geonextCompatibilityMode&&(t.isPoint(C)||C.elementClass===E.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!t.evaluate(C.visProp.fixed)&&(C.visProp.layer>w.visProp.layer||C.visProp.layer===w.visProp.layer&&C.lastDragTime.getTime()>=w.lastDragTime.getTime())&&(this.attr.ignorelabels&&t.exists(w.label)&&C===w.label||(w=C,x.push(w),t.exists(w.coords)?S.push(e.subtract(w.coords.scrCoords.slice(1),[n,p])):S.push([0,0])));return this.attr.drag.enabled&&x.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(x.length=1,this._drag_offset=S[0]):(x=x.slice(-1),this._drag_offset=S[S.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&t.exists(x[0])&&t.evaluate(x[0].visProp.dragtotopoflayer)&&x.length===1&&t.exists(x[0].rendNode)&&x[0].rendNode.parentNode.appendChild(x[0].rendNode),this.previousRotation=0,this.previousScale=1,x.length>=1&&(x[0].highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[f,x[0]])),x},moveObject:function(n,p,f,v,C){var _,P,x,S=new y(E.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(n,p),this);f&&f.obj&&((_=f.obj).coords&&(P=_.coords.scrCoords.slice()),this.drag_position=[S.scrCoords[1],S.scrCoords[2]],this.drag_position=e.add(this.drag_position,this._drag_offset),t.exists(_.coords)?_.setPositionDirectly(E.COORDS_BY_SCREEN,this.drag_position):(this.displayInfobox(!1),isNaN(f.targets[0].Xprev+f.targets[0].Yprev)||_.setPositionDirectly(E.COORDS_BY_SCREEN,[S.scrCoords[1],S.scrCoords[2]],[f.targets[0].Xprev,f.targets[0].Yprev]),f.targets[0].Xprev=S.scrCoords[1],f.targets[0].Yprev=S.scrCoords[2]),t.exists(_.coords)&&(_.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(_),_.prepareUpdate().update(!0).updateRenderer()),_.coords&&(x=_.coords.scrCoords),_.coords&&P[1]===x[1]&&P[2]===x[2]||(_.triggerEventHandlers([C+"drag","drag"],[v]),this.update()),_.highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[v,_]),_.lastDragTime=new Date)},twoFingerMove:function(n,p,f){var v;t.exists(n)&&t.exists(n.obj)&&((v=n.obj).elementClass===E.OBJECT_CLASS_LINE||v.type===E.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(n.targets,v,p):v.elementClass===E.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(n.targets,v,p),f&&v.triggerEventHandlers(["touchdrag","drag"],[f]))},twoFingerTouchObject:function(n,p,f){var v,C,_,P,x,S,O,w,T,M,N,A,R,L,D,k,B=0;if(t.exists(n[0])&&t.exists(n[1])&&!isNaN(n[0].Xprev+n[0].Yprev+n[1].Xprev+n[1].Yprev)){if(f===n[0].num?(L=n[1],D=n[0]):(L=n[0],D=n[1]),k=new y(E.COORDS_BY_SCREEN,[L.Xprev,L.Yprev],this).usrCoords,C=new y(E.COORDS_BY_SCREEN,[D.Xprev,D.Yprev],this).usrCoords,v=new y(E.COORDS_BY_SCREEN,[D.X,D.Y],this).usrCoords,P=l.crossProduct(k,C),_=l.crossProduct(k,v),S=l.crossProduct(P,_),Math.abs(S[0])<l.eps)return;if(t.evaluate(p.visProp.rotatable)&&(B=c.rad(C.slice(1),k.slice(1),v.slice(1))),(O=this.create("transform",[B,[k[1],k[2]]],{type:"rotate"})).update(),t.evaluate(p.visProp.scalable)&&(x=c.distance(v,k)/c.distance(C,k),w=this.create("transform",[-k[1],-k[2]],{type:"translate"}),T=this.create("transform",[x,x],{type:"scale"}),M=this.create("transform",[k[1],k[2]],{type:"translate"}),O.melt(w).melt(T).melt(M)),p.elementClass===E.OBJECT_CLASS_LINE)N=[],p.point1.draggable()&&N.push(p.point1),p.point2.draggable()&&N.push(p.point2),O.applyOnce(N);else if(p.type===E.OBJECT_TYPE_POLYGON){for(N=[],R=p.vertices.length-1,A=0;A<R;++A)p.vertices[A].draggable()&&N.push(p.vertices[A]);O.applyOnce(N)}this.update(),p.highlight(!0)}},twoFingerTouchCircle:function(n,p,f){var v,C,_,P,x,S,O,w,T,M,N;p.method!=="pointCircle"&&p.method!=="pointLine"&&t.exists(n[0])&&t.exists(n[1])&&!isNaN(n[0].Xprev+n[0].Yprev+n[1].Xprev+n[1].Yprev)&&(f===n[0].num?(v=n[1],C=n[0]):(v=n[0],C=n[1]),x=new y(E.COORDS_BY_SCREEN,[v.Xprev,v.Yprev],this).usrCoords,P=new y(E.COORDS_BY_SCREEN,[C.Xprev,C.Yprev],this).usrCoords,_=new y(E.COORDS_BY_SCREEN,[C.X,C.Y],this).usrCoords,O=c.rad(P.slice(1),x.slice(1),_.slice(1)),w=this.create("transform",[-x[1],-x[2]],{type:"translate"}),T=this.create("transform",[O],{type:"rotate"}),w.melt(T),t.evaluate(p.visProp.scalable)&&(S=c.distance(x,_)/c.distance(x,P),M=this.create("transform",[S,S],{type:"scale"}),w.melt(M)),N=this.create("transform",[x[1],x[2]],{type:"translate"}),w.melt(N),p.center.draggable()&&w.applyOnce([p.center]),p.method==="twoPoints"?p.point2.draggable()&&w.applyOnce([p.point2]):p.method==="pointRadius"&&t.isNumber(p.updateRadius.origin)&&p.setRadius(p.radius*S),this.update(p.center),p.highlight(!0))},highlightElements:function(n,p,f,v){var C,_,P,x={},S=this.objectsList.length;for(C=0;C<S;C++)P=(_=this.objectsList[C]).id,t.exists(_.hasPoint)&&_.visPropCalc.visible&&_.hasPoint(n,p)&&(this.updateInfobox(_),t.exists(this.highlightedObjects[P])||(x[P]=_,_.highlight(),this.triggerEventHandlers(["mousehit","hit"],[f,_,v])),_.mouseover?_.triggerEventHandlers(["mousemove","move"],[f]):(_.triggerEventHandlers(["mouseover","over"],[f]),_.mouseover=!0));for(C=0;C<S;C++)P=(_=this.objectsList[C]).id,_.mouseover&&(x[P]||(_.triggerEventHandlers(["mouseout","out"],[f]),_.mouseover=!1))},saveStartPos:function(n,p){var f,v,C=[];if(n.type===E.OBJECT_TYPE_TICKS)C.push([1,NaN,NaN]);else if(n.elementClass===E.OBJECT_CLASS_LINE)C.push(n.point1.coords.usrCoords),C.push(n.point2.coords.usrCoords);else if(n.elementClass===E.OBJECT_CLASS_CIRCLE)C.push(n.center.coords.usrCoords),n.method==="twoPoints"&&C.push(n.point2.coords.usrCoords);else if(n.type===E.OBJECT_TYPE_POLYGON)for(v=n.vertices.length-1,f=0;f<v;f++)C.push(n.vertices[f].coords.usrCoords);else if(n.type===E.OBJECT_TYPE_SECTOR)C.push(n.point1.coords.usrCoords),C.push(n.point2.coords.usrCoords),C.push(n.point3.coords.usrCoords);else if(t.isPoint(n)||n.type===E.OBJECT_TYPE_GLIDER)C.push(n.coords.usrCoords);else if(n.elementClass===E.OBJECT_CLASS_CURVE)n.points.length>0&&C.push(n.points[0].usrCoords);else try{C.push(n.coords.usrCoords)}catch(_){g.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+_)}for(v=C.length,f=0;f<v;f++)p.Zstart.push(C[f][0]),p.Xstart.push(C[f][1]),p.Ystart.push(C[f][2])},mouseOriginMoveStart:function(n){var p,f;return(p=this._isRequiredKeyPressed(n,"pan"))&&(f=this.getMousePosition(n),this.initMoveOrigin(f[0],f[1])),p},mouseOriginMove:function(n){var p,f=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return f&&(p=this.getMousePosition(n),this.moveOrigin(p[0],p[1],!0)),f},touchStartMoveOriginOneFinger:function(n){var p,f,v=n[g.touchProperty];return(p=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&v.length===1)&&(f=this.getMousePosition(n,0),this.initMoveOrigin(f[0],f[1])),p},touchOriginMove:function(n){var p,f=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return f&&(p=this.getMousePosition(n,0),this.moveOrigin(p[0],p[1],!0)),f},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){if(u.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(n){return t.exists(n)&&n.preventDefault(),!1}),this.addFullscreenEventHandlers(),this.addKeyboardEventHandlers(),u.isBrowser){try{this.startResizeObserver()}catch{u.addEvent(window,"resize",this.resizeListener,this),this.startIntersectionObserver()}u.addEvent(window,"scroll",this.scrollListener,this)}},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers(),this.removeFullscreenEventHandlers(),this.removeKeyboardEventHandlers(),u.isBrowser&&(t.exists(this.resizeObserver)?this.stopResizeObserver():(u.removeEvent(window,"resize",this.resizeListener,this),this.stopIntersectionObserver()),u.removeEvent(window,"scroll",this.scrollListener,this))},addPointerEventHandlers:function(){if(!this.hasPointerHandlers&&u.isBrowser){var n=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(u.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),u.addEvent(n,"MSPointerMove",this.pointerMoveListener,this)):(u.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),u.addEvent(n,"pointermove",this.pointerMoveListener,this)),u.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),u.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0}},addMouseEventHandlers:function(){if(!this.hasMouseHandlers&&u.isBrowser){var n=this.attr.movetarget||this.containerObj;u.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),u.addEvent(n,"mousemove",this.mouseMoveListener,this),u.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),u.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0}},addTouchEventHandlers:function(n){if(!this.hasTouchHandlers&&u.isBrowser){var p=this.attr.movetarget||this.containerObj;u.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),u.addEvent(p,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0}},addFullscreenEventHandlers:function(){var n,p=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],f=p.length;if(!this.hasFullsceenEventHandlers&&u.isBrowser){for(n=0;n<f;n++)u.addEvent(this.document,p[n],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!0}},addKeyboardEventHandlers:function(){this.attr.keyboard.enabled&&!this.hasKeyboardHandlers&&u.isBrowser&&(u.addEvent(this.containerObj,"keydown",this.keyDownListener,this),u.addEvent(this.containerObj,"focusin",this.keyFocusInListener,this),u.addEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!0)},removeKeyboardEventHandlers:function(){this.hasKeyboardHandlers&&u.isBrowser&&(u.removeEvent(this.containerObj,"keydown",this.keyDownListener,this),u.removeEvent(this.containerObj,"focusin",this.keyFocusInListener,this),u.removeEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!1)},removeFullscreenEventHandlers:function(){var n,p=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],f=p.length;if(this.hasFullsceenEventHandlers&&u.isBrowser){for(n=0;n<f;n++)u.removeEvent(this.document,p[n],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!1}},removePointerEventHandlers:function(){if(this.hasPointerHandlers&&u.isBrowser){var n=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(u.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),u.removeEvent(n,"MSPointerMove",this.pointerMoveListener,this)):(u.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),u.removeEvent(n,"pointermove",this.pointerMoveListener,this)),u.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),u.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?u.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(u.removeEvent(this.document,"pointerup",this.pointerUpListener,this),u.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this.hasPointerHandlers=!1}},removeMouseEventHandlers:function(){if(this.hasMouseHandlers&&u.isBrowser){var n=this.attr.movetarget||this.containerObj;u.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),u.removeEvent(n,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(u.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),u.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),u.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1}},removeTouchEventHandlers:function(){if(this.hasTouchHandlers&&u.isBrowser){var n=this.attr.movetarget||this.containerObj;u.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),u.removeEvent(n,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(u.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1}},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(n){var p,f,v,C,_,P,x,S,O,w,T,M,N=!1,A=this.attr.zoom.factorx,R=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(n.preventDefault(),P=c.distance([n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY],2),n.scale===void 0&&(n.scale=P/this.prevDist),!!t.exists(this.prevCoords)&&(f=[n.touches[0].clientX-this.prevCoords[0][0],n.touches[0].clientY-this.prevCoords[0][1]],v=[n.touches[1].clientX-this.prevCoords[1][0],n.touches[1].clientY-this.prevCoords[1][1]],f[0]*f[0]+f[1]*f[1]<100&&v[0]*v[0]+v[1]*v[1]<100||(C=c.rad(f,[0,0],v),this.isPreviousGesture!=="pan"&&Math.abs(C)>.2*Math.PI&&Math.abs(C)<1.8*Math.PI&&(N=!0),this.isPreviousGesture==="pan"||N||(Math.abs(n.scale)<.77||Math.abs(n.scale)>1.3)&&(N=!0),_=n.scale/this.prevScale,this.prevScale=n.scale,this.prevCoords=[[n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY]],p=new y(E.COORDS_BY_SCREEN,this.getMousePosition(n,0),this),this.attr.pan.enabled&&this.attr.pan.needtwofingers&&!N?(this.isPreviousGesture="pan",this.moveOrigin(p.scrCoords[1],p.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(_-1)<.5&&((this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(x=Math.abs(n.touches[0].clientX-n.touches[1].clientX),S=Math.abs(n.touches[0].clientY-n.touches[1].clientY),O=Math.abs(Math.atan2(S,x)),M=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&O<M?(this.attr.zoom.factorx=_,this.attr.zoom.factory=1,w=0,T=0):this.attr.zoom.pinchvertical&&Math.abs(O-.5*Math.PI)<M?(this.attr.zoom.factorx=1,this.attr.zoom.factory=_,w=0,T=0):(this.attr.zoom.factorx=_,this.attr.zoom.factory=_,w=p.usrCoords[1],T=p.usrCoords[2]),this.zoomIn(w,T),this.attr.zoom.factorx=A,this.attr.zoom.factory=R)),!1))},gestureStartListener:function(n){var p;return n.preventDefault(),this.prevScale=1,this.prevDist=c.distance([n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY],2),this.prevCoords=[[n.touches[0].clientX,n.touches[0].clientY],[n.touches[1].clientX,n.touches[1].clientY]],this.isPreviousGesture="none",p=this.getMousePosition(n,0),this.initMoveOrigin(p[0],p[1]),this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(n,p){var f=this.attr[p];return!!f.enabled&&!(!(f.needshift&&n.shiftKey||!f.needshift&&!n.shiftKey)||!(f.needctrl&&n.ctrlKey||!f.needctrl&&!n.ctrlKey))},_isPointerRegistered:function(n){var p,f=this._board_touches.length;for(p=0;p<f;p++)if(this._board_touches[p].pointerId===n.pointerId)return!0;return!1},_pointerStorePosition:function(n){var p,f;for(p=0,f=!1;p<this._board_touches.length;p++)if(this._board_touches[p].pointerId===n.pointerId){this._board_touches[p].clientX=n.clientX,this._board_touches[p].clientY=n.clientY,f=!0;break}return!f&&this._board_touches.length<2&&this._board_touches.push({pointerId:n.pointerId,clientX:n.clientX,clientY:n.clientY}),this},_pointerRemoveTouches:function(n){var p;for(p=0;p<this._board_touches.length;p++)if(this._board_touches[p].pointerId===n.pointerId){this._board_touches.splice(p,1);break}return this},_pointerClearTouches:function(){this._board_touches.length>0&&this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this._board_touches=[],this.touches=[]},_getPointerInputDevice:function(n){if(u.isBrowser){if(n.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)return"touch";if(n.pointerType==="mouse")return"mouse";if(n.pointerType==="pen")return"pen"}return"mouse"},pointerDownListener:function(n,p){var f,v,C,_,P,x,S,O,w,T;if(!p&&this._isPointerRegistered(n))return!1;if(!p&&n.isPrimary&&this._pointerClearTouches(),this.hasPointerUp||(window.navigator.msPointerEnabled?u.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(u.addEvent(this.document,"pointerup",this.pointerUpListener,this),u.addEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&t.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(x=window.getSelection()).removeAllRanges)try{x.removeAllRanges()}catch{}if(this._inputDevice=this._getPointerInputDevice(n),O=this._inputDevice,this.options.precision.hasPoint=this.options.precision[O],_=this.getMousePosition(n),this._testForSelection(n),this.selectingMode)return this._startSelecting(_),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[n]);if(this.attr.drag.enabled&&p?(P=[p],this.mode=this.BOARD_MODE_DRAG):P=this.initMoveObject(_[0],_[1],n,O),S={num:n.pointerId,X:_[0],Y:_[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},P.length>0){for(T=P[P.length-1],w=!1,f=0;f<this.touches.length;f++)if(this.touches[f].obj===T){v=f,C=this.touches[f].targets.push(S)-1,w=!0;break}w||(C=0,v=this.touches.push({obj:T,targets:[S]})-1),this.dehighlightAll(),T.highlight(!0),this.saveStartPos(T,this.touches[v].targets[C]),n&&n.preventDefault?n.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(n.preventDefault(),n.stopPropagation()),!!u.isBrowser&&(this._getPointerInputDevice(n)!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(n):(this._pointerStorePosition(n),n.touches=this._board_touches,n.touches.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(n)||n.touches.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(n))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[n]),!1)},pointerMoveListener:function(n){var p,f,v,C,_;if(this._getPointerInputDevice(n)==="touch"&&!this._isPointerRegistered(n))return this.BOARD_MODE_NONE;if(!this.checkFrameRate(n))return!1;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(n.preventDefault(),n.stopPropagation()),this.updateQuality=this.BOARD_QUALITY_LOW,this._inputDevice=this._getPointerInputDevice(n),_=this._inputDevice,this.options.precision.hasPoint=this.options.precision[_],this.selectingMode)v=this.getMousePosition(n),this._moveSelecting(v),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[n,this.mode]);else if(!this.mouseOriginMove(n))if(this.mode===this.BOARD_MODE_DRAG){for(p=0;p<this.touches.length;p++)for(C=this.touches[p].targets,f=0;f<C.length;f++)if(C[f].num===n.pointerId){v=this.getMousePosition(n),C[f].X=v[0],C[f].Y=v[1],C.length===1?this.moveObject(v[0],v[1],this.touches[p],n,_):C.length===2&&(this.twoFingerMove(this.touches[p],n.pointerId,n),C[f].Xprev=v[0],C[f].Yprev=v[1]);break}}else this._getPointerInputDevice(n)==="touch"&&(this._pointerStorePosition(n),this._board_touches.length===2&&(n.touches=this._board_touches,this.gestureChangeListener(n))),v=this.getMousePosition(n),this.highlightElements(v[0],v[1],n,-1);return this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[n,this.mode]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(n){var p,f,v,C,_=!1;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[n]),this.displayInfobox(!1),n){for(p=0;p<this.touches.length;p++)for(C=this.touches[p].targets,f=0;f<C.length;f++)if(C[f].num===n.pointerId){C.splice(f,1),C.length===0&&this.touches.splice(p,1);break}}if(this.originMoveEnd(),this.update(),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[n]),this.stopSelectionMode();else for(p=this.downObjects.length-1;p>-1;p--){for(v=!1,f=0;f<this.touches.length;f++)this.touches[f].obj.id===this.downObjects[p].id&&(v=!0);v||(this.downObjects[p].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[n]),t.exists(this.downObjects[p].coords)||(this.downObjects[p].snapToGrid(),this.downObjects[p].snapToPoints(),_=!0),this.downObjects.splice(p,1))}return this.hasPointerUp&&(window.navigator.msPointerEnabled?u.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(u.removeEvent(this.document,"pointerup",this.pointerUpListener,this),u.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),_&&this.update(),this._pointerClearTouches(),!0},touchStartListener:function(n){var p,f,v,C,_,P,x,S,O,w,T=this.options.precision.touch,M=n[g.touchProperty];for(this.hasTouchEnd||(u.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&t.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,p=0;p<M.length;p++)M[p].jxg_isused=!1;for(p=0;p<this.touches.length;p++)for(w=this.touches[p].targets,C=0;C<w.length;C++){w[C].num=-1,T=this.options.precision.touch;do{for(_=0;_<M.length;_++)if(Math.abs(Math.pow(M[_].screenX-w[C].X,2)+Math.pow(M[_].screenY-w[C].Y,2))<T*T){w[C].num=_,w[C].X=M[_].screenX,w[C].Y=M[_].screenY,M[_].jxg_isused=!0;break}T*=2}while(w[C].num===-1&&T<this.options.precision.touchMax);w[C].num===-1&&(g.debug("i couldn't find a targettouches for target no "+C+" on "+this.touches[p].obj.name+" ("+this.touches[p].obj.id+"). Removed the target."),g.debug("eps = "+T+", touchMax = "+b.precision.touchMax),w.splice(p,1))}for(p=0;p<M.length;p++)if(!M[p].jxg_isused){if(f=this.getMousePosition(n,p),this.selectingMode)return this._startSelecting(f),this.triggerEventHandlers(["touchstartselecting","startselecting"],[n]),n.preventDefault(),n.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if((v=this.initMoveObject(f[0],f[1],n,"touch")).length!==0){if(P=v[v.length-1],O={num:p,X:M[p].screenX,Y:M[p].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},t.isPoint(P)||P.elementClass===E.OBJECT_CLASS_TEXT||P.type===E.OBJECT_TYPE_TICKS||P.type===E.OBJECT_TYPE_IMAGE)S=[O],this.saveStartPos(P,S[0]),this.touches.push({obj:P,targets:S}),P.highlight(!0);else if(P.elementClass===E.OBJECT_CLASS_LINE||P.elementClass===E.OBJECT_CLASS_CIRCLE||P.elementClass===E.OBJECT_CLASS_CURVE||P.type===E.OBJECT_TYPE_POLYGON){for(x=!1,C=0;C<this.touches.length;C++)P.id===this.touches[C].obj.id&&(x=!0,this.touches[C].targets.length===1&&(this.saveStartPos(P,O),this.touches[C].targets.push(O)),M[p].jxg_isused=!0);x||(S=[O],this.saveStartPos(P,S[0]),this.touches.push({obj:P,targets:S}),P.highlight(!0))}}M[p].jxg_isused=!0}return this.touches.length>0&&(n.preventDefault(),n.stopPropagation()),M.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(n)||M.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(n)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[n]),!1},touchMoveListener:function(n){var p,f,v,C,_=n[g.touchProperty];if(!this.checkFrameRate(n))return!1;if(this.mode!==this.BOARD_MODE_NONE&&(n.preventDefault(),n.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(p=0;p<_.length;p++)if(!_[p].jxg_isused){f=this.getMousePosition(n,p),this._moveSelecting(f),this.triggerEventHandlers(["touchmoves","moveselecting"],[n,this.mode]);break}}else if(!this.touchOriginMove(n))if(this.mode===this.BOARD_MODE_DRAG){for(p=0;p<this.touches.length;p++)if((C=this.touches[p].targets).length===1){if(_[C[0].num]){if((f=this.getMousePosition(n,C[0].num))[0]<0||f[0]>this.canvasWidth||f[1]<0||f[1]>this.canvasHeight)return;C[0].X=f[0],C[0].Y=f[1],this.moveObject(f[0],f[1],this.touches[p],n,"touch")}}else if(C.length===2&&C[0].num>-1&&C[1].num>-1&&_[C[0].num]&&_[C[1].num]){if(f=this.getMousePosition(n,C[0].num),v=this.getMousePosition(n,C[1].num),f[0]<0||f[0]>this.canvasWidth||f[1]<0||f[1]>this.canvasHeight||v[0]<0||v[0]>this.canvasWidth||v[1]<0||v[1]>this.canvasHeight)return;C[0].X=f[0],C[0].Y=f[1],C[1].X=v[0],C[1].Y=v[1],this.twoFingerMove(this.touches[p],C[0].num,n),this.twoFingerMove(this.touches[p],C[1].num),C[0].Xprev=f[0],C[0].Yprev=f[1],C[1].Xprev=v[0],C[1].Yprev=v[1]}}else _.length===2&&this.gestureChangeListener(n),f=this.getMousePosition(n,0),this.highlightElements(f[0],f[1],n,-1);return this.mode!==this.BOARD_MODE_DRAG&&this.displayInfobox(!1),this.triggerEventHandlers(["touchmove","move"],[n,this.mode]),this.options.precision.hasPoint=this.options.precision.mouse,this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},touchEndListener:function(n){var p,f,v,C,_,P,x=this.options.precision.touch,S=[],O=n&&n[g.touchProperty],w=!1;if(this.triggerEventHandlers(["touchend","up"],[n]),this.displayInfobox(!1),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[n]),this.stopSelectionMode();else if(O&&O.length>0){for(p=0;p<this.touches.length;p++)S[p]=this.touches[p];for(this.touches.length=0,p=0;p<O.length;p++)O[p].jxg_isused=!1;for(p=0;p<S.length;p++){for(C=!1,_=0,P=S[p].targets,f=0;f<P.length;f++)for(P[f].found=!1,v=0;v<O.length;v++)if(Math.abs(Math.pow(O[v].screenX-P[f].X,2)+Math.pow(O[v].screenY-P[f].Y,2))<x*x){P[f].found=!0,P[f].num=v,P[f].X=O[v].screenX,P[f].Y=O[v].screenY,_+=1;break}if(t.isPoint(S[p].obj)?C=P[0]&&P[0].found:S[p].obj.elementClass===E.OBJECT_CLASS_LINE?C=P[0]&&P[0].found||P[1]&&P[1].found:S[p].obj.elementClass===E.OBJECT_CLASS_CIRCLE&&(C=_===1||_===3),C)for(this.touches.push({obj:S[p].obj,targets:[]}),f=0;f<P.length;f++)P[f].found&&this.touches[this.touches.length-1].targets.push({num:P[f].num,X:P[f].screenX,Y:P[f].screenY,Xprev:NaN,Yprev:NaN,Xstart:P[f].Xstart,Ystart:P[f].Ystart,Zstart:P[f].Zstart});else S[p].obj.noHighlight()}}else this.touches.length=0;for(p=this.downObjects.length-1;p>-1;p--){for(C=!1,f=0;f<this.touches.length;f++)this.touches[f].obj.id===this.downObjects[p].id&&(C=!0);C||(this.downObjects[p].triggerEventHandlers(["touchup","up"],[n]),t.exists(this.downObjects[p].coords)||(this.downObjects[p].snapToGrid(),this.downObjects[p].snapToPoints(),w=!0),this.downObjects.splice(p,1))}return O&&O.length!==0||(this.hasTouchEnd&&(u.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),w&&this.update()),!0},mouseDownListener:function(n){var p,f,v;if(this.document.selection&&t.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return u.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,this._inputDevice="mouse",this.options.precision.hasPoint=this.options.precision.mouse,p=this.getMousePosition(n),this._testForSelection(n),this.selectingMode?(this._startSelecting(p),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[n])):((f=this.initMoveObject(p[0],p[1],n,"mouse")).length===0?(this.mode=this.BOARD_MODE_NONE,v=!0):(this.mouse={obj:null,targets:[{X:p[0],Y:p[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=f[f.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),n&&n.preventDefault?n.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(v=this.mouseOriginMoveStart(n)),this.triggerEventHandlers(["mousedown","down"],[n]),v)},mouseMoveListener:function(n){var p;if(!this.checkFrameRate(n))return!1;p=this.getMousePosition(n),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.selectingMode?(this._moveSelecting(p),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[n,this.mode])):this.mouseOriginMove(n)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(p[0],p[1],this.mouse,n,"mouse"):this.highlightElements(p[0],p[1],n,-1),this.triggerEventHandlers(["mousemove","move"],[n,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(n){var p;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[n]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(t.exists(this.mouse.obj.coords)||(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints())),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(n),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[n]),this.stopSelectionMode();else for(p=0;p<this.downObjects.length;p++)this.downObjects[p].triggerEventHandlers(["mouseup","up"],[n]);this.downObjects.length=0,this.hasMouseUp&&(u.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(n){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(n,"zoom"))return!0;var p=(n=n||window.event).detail?-n.detail:n.wheelDelta/40,f=new y(E.COORDS_BY_SCREEN,this.getMousePosition(n),this);return p>0?this.zoomIn(f.usrCoords[1],f.usrCoords[2]):this.zoomOut(f.usrCoords[1],f.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[n]),n.preventDefault(),!1},keyDownListener:function(n){var p,f,v,C,_,P,x=n.target.id,S=0,O=0,w=t.evaluate(this.attr.keyboard.dx)/this.unitX,T=t.evaluate(this.attr.keyboard.dy)/this.unitY,M=!1,N=!0;return!(!this.attr.keyboard.enabled||x==="")&&(!(C=this.containerObj.shadowRoot||document).activeElement||(f=C.activeElement).tagName!=="INPUT"&&f.tagName!=="textarea")&&(p=x.replace(this.containerObj.id+"_",""),f=this.select(p),t.exists(f.coords)&&(P=f.coords.usrCoords.slice(1)),t.evaluate(this.attr.keyboard.panshift)&&n.shiftKey||t.evaluate(this.attr.keyboard.panctrl)&&n.ctrlKey?(t.evaluate(this.attr.zoom.enabled)===!0&&(M=!0),n.keyCode===38?this.clickUpArrow():n.keyCode===40?this.clickDownArrow():n.keyCode===37?this.clickLeftArrow():n.keyCode===39?this.clickRightArrow():M&&n.keyCode===171?this.zoomIn():M&&n.keyCode===173?this.zoomOut():M&&n.keyCode===79?this.zoom100():N=!1):(t.exists(f.visProp)&&(t.exists(f.visProp.snaptogrid)&&f.visProp.snaptogrid&&t.evaluate(f.visProp.snapsizex)&&t.evaluate(f.visProp.snapsizey)?(S=(v=f.getSnapSizes())[0],O=v[1],w=Math.max(S,w),T=Math.max(O,T)):t.exists(f.visProp.attracttogrid)&&f.visProp.attracttogrid&&t.evaluate(f.visProp.attractordistance)&&t.evaluate(f.visProp.attractorunit)&&(O=S=1.1*t.evaluate(f.visProp.attractordistance),t.evaluate(f.visProp.attractorunit)==="screen"&&(S/=this.unitX,O/=this.unitX),w=Math.max(S,w),T=Math.max(O,T))),n.keyCode===38?_=[0,T]:n.keyCode===40?_=[0,-T]:n.keyCode===37?_=[-w,0]:n.keyCode===39?_=[w,0]:N=!1,_&&f.isDraggable&&f.visPropCalc.visible&&(this.geonextCompatibilityMode&&(t.isPoint(f)||f.elementClass===E.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!t.evaluate(f.visProp.fixed)&&(t.exists(f.coords)&&(_[0]+=P[0],_[1]+=P[1]),f.setPosition(g.COORDS_BY_USER,_),t.exists(f.coords)&&this.updateInfobox(f),this.triggerEventHandlers(["hit"],[n,f]))),this.update(),N&&t.exists(n.preventDefault)&&n.preventDefault(),N)},keyFocusInListener:function(n){var p,f,v=n.target.id;if(!this.attr.keyboard.enabled||v==="")return!1;p=v.replace(this.containerObj.id+"_",""),f=this.select(p),t.exists(f.highlight)&&f.highlight(!0),t.exists(f.coords)&&this.updateInfobox(f),this.triggerEventHandlers(["hit"],[n,f])},keyFocusOutListener:function(n){if(!this.attr.keyboard.enabled)return!1;this.dehighlightAll(),this.displayInfobox(!1)},updateContainerDims:function(){var n,p,f,v;n=(f=this.containerObj.getBoundingClientRect()).width,p=f.height,window&&window.getComputedStyle&&(v=window.getComputedStyle(this.containerObj,null),n-=parseFloat(v.getPropertyValue("border-left-width"))+parseFloat(v.getPropertyValue("border-right-width")),p-=parseFloat(v.getPropertyValue("border-top-width"))+parseFloat(v.getPropertyValue("border-bottom-width"))),n<=0||p<=0||isNaN(n)||isNaN(p)||(isNaN(this.getBoundingBox()[0])&&this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"keep"),t.exists(this._prevDim)&&this._prevDim.w===n&&this._prevDim.h===p||(this.resizeContainer(n,p,!0),this._prevDim={w:n,h:p}))},startResizeObserver:function(){var n=this;u.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this.resizeObserver=new ResizeObserver(function(p){n._isResizing||(n._isResizing=!0,window.setTimeout(function(){try{n.updateContainerDims()}catch{n.stopResizeObserver()}finally{n._isResizing=!1}},n.attr.resize.throttle))}),this.resizeObserver.observe(this.containerObj))},stopResizeObserver:function(){u.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&t.exists(this.resizeObserver)&&this.resizeObserver.unobserve(this.containerObj)},resizeListener:function(){var n=this;u.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this._isScrolling||this._isResizing||(this._isResizing=!0,window.setTimeout(function(){n.updateContainerDims(),n._isResizing=!1},this.attr.resize.throttle)))},scrollListener:function(n){var p=this;u.isBrowser&&(this._isScrolling||(this._isScrolling=!0,window.setTimeout(function(){p._isScrolling=!1},66)))},startIntersectionObserver:function(){var n=this;try{this.intersectionObserver=new IntersectionObserver(function(p){isNaN(n.getBoundingBox()[0])&&n.updateContainerDims()},{root:null,rootMargin:"0px",threshold:.8}),this.intersectionObserver.observe(n.containerObj)}catch{console.log("JSXGraph: IntersectionObserver not available in this browser.")}},stopIntersectionObserver:function(){t.exists(this.intersectionObserver)&&this.intersectionObserver.unobserve(this.containerObj)},initInfobox:function(){var n=t.copyAttributes({},this.options,"infobox");return n.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],n),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.displayInfobox(!1),this},updateInfobox:function(n){var p,f,v,C,_,P=t.evaluate(n.visProp.showinfobox);return!t.evaluate(this.attr.showinfobox)&&P==="inherit"||!P||t.isPoint(n)&&(v=n.coords.usrCoords[1],C=n.coords.usrCoords[2],_=t.evaluate(n.visProp.infoboxdigits),this.infobox.setCoords(v+this.infobox.distanceX/this.unitX,C+this.infobox.distanceY/this.unitY),typeof n.infoboxText!="string"?(_==="auto"?(p=t.autoDigits(v),f=t.autoDigits(C)):t.isNumber(_)?(p=t.toFixed(v,_),f=t.toFixed(C,_)):(p=v,f=C),this.highlightInfobox(p,f,n)):this.highlightCustomInfobox(n.infoboxText,n),this.displayInfobox(!0)),this},displayInfobox:function(n){return this.infobox.hiddenByParent===n&&(this.infobox.hiddenByParent=!n,this.infobox.prepareUpdate().updateVisibility(n).updateRenderer()),this},showInfobox:function(n){return this.displayInfobox(n)},highlightInfobox:function(n,p,f){return this.highlightCustomInfobox("("+n+", "+p+")",f),this},highlightCustomInfobox:function(n,p){return this.infobox.setText(n),this},dehighlightAll:function(){var n,p,f=!1;for(n in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(n)&&(p=this.highlightedObjects[n],(this.hasMouseHandlers||this.hasPointerHandlers)&&p.noHighlight(),f=!0);return this.highlightedObjects={},this.renderer.type==="canvas"&&f&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(n,p){return[n,p]},getUsrCoordsOfMouse:function(n){var p=this.getCoordsTopLeftCorner(),f=u.getPosition(n,null,this.document),v=f[0]-p[0],C=f[1]-p[1];return new y(E.COORDS_BY_SCREEN,[v,C],this).usrCoords.slice(1)},getAllUnderMouse:function(n){var p=this.getAllObjectsUnderMouse(n);return p.push(this.getUsrCoordsOfMouse(n)),p},getAllObjectsUnderMouse:function(n){var p,f,v=this.getCoordsTopLeftCorner(),C=u.getPosition(n,null,this.document),_=C[0]-v[0],P=C[1]-v[1],x=[],S=this.objectsList.length;for(p=0;p<S;p++)(f=this.objectsList[p]).visPropCalc.visible&&f.hasPoint&&f.hasPoint(_,P)&&(x[x.length]=f);return x},updateCoords:function(){var n,p,f=this.objectsList.length;for(p=0;p<f;p++)n=this.objectsList[p],t.exists(n.coords)&&(t.evaluate(n.visProp.frozen)?n.coords.screen2usr():n.coords.usr2screen());return this},moveOrigin:function(n,p,f){var v,C,_,P;return t.exists(n)&&t.exists(p)&&(v=this.origin.scrCoords[1],C=this.origin.scrCoords[2],this.origin.scrCoords[1]=n,this.origin.scrCoords[2]=p,f&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy),_=new y(E.COORDS_BY_SCREEN,[0,0],this).usrCoords,P=new y(E.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords,(_[1]<this.maxboundingbox[0]||_[2]>this.maxboundingbox[1]||P[1]>this.maxboundingbox[2]||P[2]<this.maxboundingbox[3])&&(this.origin.scrCoords[1]=v,this.origin.scrCoords[2]=C)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(n){var p,f,v,C,_,P,x,S=[],O=n.indexOf("<data>"),w=n.indexOf("</data>"),T=function(L,D,k,B){return function(){var j,I;I=(j=L.select(D.id)).coords.usrCoords[B],B===2?j.setPositionDirectly(E.COORDS_BY_USER,[k(),I]):j.setPositionDirectly(E.COORDS_BY_USER,[I,k()]),j.prepareUpdate().update()}},M=function(L,D,k){return function(){var B,j;B=L.select(D.id),j=k(),B.setAttribute({visible:j})}},N=function(L,D,k,B){return function(){var j,I;j=L.select(D.id),I=k(),B==="strokewidth"?j.visProp.strokewidth=I:(I=s.rgba2rgbo(I),j.visProp[B+"color"]=I[0],j.visProp[B+"opacity"]=I[1])}},A=function(L,D,k){return function(){L.select(D.id).position=k()}},R=function(L,D,k){return function(){L.select(D.id).setStyle(k())}};if(!(O<0)){for(;O>=0;){if(f=(p=n.slice(O+6,w)).indexOf("="),v=p.slice(0,f),C=p.slice(f+1),f=v.indexOf("."),_=v.slice(0,f),P=this.elementsByName[t.unescapeHTML(_)],x=v.slice(f+1).replace(/\s+/g,"").toLowerCase(),C=t.createFunction(C,this,"",!0),t.exists(this.elementsByName[_]))switch(x){case"x":S.push(T(this,P,C,2));break;case"y":S.push(T(this,P,C,1));break;case"visible":S.push(M(this,P,C));break;case"position":S.push(A(this,P,C));break;case"stroke":S.push(N(this,P,C,"stroke"));break;case"style":S.push(R(this,P,C));break;case"strokewidth":S.push(N(this,P,C,"strokewidth"));break;case"fill":S.push(N(this,P,C,"fill"));break;case"label":break;default:g.debug("property '"+x+"' in conditions not yet implemented:"+C)}else g.debug("debug conditions: |"+_+"| undefined");O=(n=n.slice(w+7)).indexOf("<data>"),w=n.indexOf("</data>")}this.updateConditions=function(){var L;for(L=0;L<S.length;L++)S[L]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var n=new y(E.COORDS_BY_USER,[0,0],this),p=new y(E.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),f=n.scrCoords[1]-p.scrCoords[1],v=n.scrCoords[2]-p.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(f)>25;)this.options.grid.snapSizeX*=2,f/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(v)>25;)this.options.grid.snapSizeY*=2,v/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(n,p){var f=this.getBoundingBox(),v=this.attr.zoom.factorx,C=this.attr.zoom.factory,_=(f[2]-f[0])*(1-1/v),P=(f[1]-f[3])*(1-1/C),x=.5,S=.5,O=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&v>1||this.zoomY>this.attr.zoom.max&&C>1||this.zoomX<O&&v<1||this.zoomY<O&&C<1?this:(t.isNumber(n)&&t.isNumber(p)&&(x=(n-f[0])/(f[2]-f[0]),S=(f[1]-p)/(f[1]-f[3])),this.setBoundingBox([f[0]+_*x,f[1]-P*S,f[2]-_*(1-x),f[3]+P*(1-S)],this.keepaspectratio,"update"),this.applyZoom())},zoomOut:function(n,p){var f=this.getBoundingBox(),v=this.attr.zoom.factorx,C=this.attr.zoom.factory,_=(f[2]-f[0])*(1-v),P=(f[1]-f[3])*(1-C),x=.5,S=.5,O=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<O||this.zoomY<O?this:(t.isNumber(n)&&t.isNumber(p)&&(x=(n-f[0])/(f[2]-f[0]),S=(f[1]-p)/(f[1]-f[3])),this.setBoundingBox([f[0]+_*x,f[1]-P*S,f[2]-_*(1-x),f[3]+P*(1-S)],this.keepaspectratio,"update"),this.applyZoom())},zoom100:function(){var n,p,f;return t.exists(this.attr.boundingbox)?this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"reset"):(p=((n=this.getBoundingBox())[2]-n[0])*(1-this.zoomX)*.5,f=(n[1]-n[3])*(1-this.zoomY)*.5,this.setBoundingBox([n[0]+p,n[1]-f,n[2]-p,n[3]+f],this.keepaspectratio,"reset")),this.applyZoom()},zoomAllPoints:function(){var n,p,f,v,C=0,_=0,P=0,x=0,S=this.objectsList.length;for(n=0;n<S;n++)v=this.objectsList[n],t.isPoint(v)&&v.visPropCalc.visible&&(v.coords.usrCoords[1]<C?C=v.coords.usrCoords[1]:v.coords.usrCoords[1]>_&&(_=v.coords.usrCoords[1]),v.coords.usrCoords[2]>x?x=v.coords.usrCoords[2]:v.coords.usrCoords[2]<P&&(P=v.coords.usrCoords[2]));return p=50/this.unitX,f=50/this.unitY,this.setBoundingBox([C-p,x+f,_+p,P-f],this.keepaspectratio,"update"),this.applyZoom()},zoomElements:function(n){var p,f,v,C,_,P,x,S=[1/0,-1/0,-1/0,1/0];if(!t.isArray(n)||n.length===0)return this;for(p=0;p<n.length;p++)f=this.select(n[p]).bounds(),t.isArray(f)&&(f[0]<S[0]&&(S[0]=f[0]),f[1]>S[1]&&(S[1]=f[1]),f[2]>S[2]&&(S[2]=f[2]),f[3]<S[3]&&(S[3]=f[3]));return t.isArray(S)&&(v=.5*(S[0]+S[2]),C=.5*(S[1]+S[3]),_=1.5*(S[2]-S[0])*.5,P=1.5*(S[1]-S[3])*.5,x=Math.max(_,P),this.setBoundingBox([v-x,C+x,v+x,C-x],this.keepaspectratio,"update")),this},setZoom:function(n,p){var f=this.attr.zoom.factorx,v=this.attr.zoom.factory;return this.attr.zoom.factorx=n/this.zoomX,this.attr.zoom.factory=p/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=f,this.attr.zoom.factory=v,this},removeObject:function(n,p){var f,v;if(t.isArray(n)){for(v=0;v<n.length;v++)this.removeObject(n[v]);return this}if(n=this.select(n),!t.exists(n)||t.isString(n))return this;try{for(f in n.childElements)n.childElements.hasOwnProperty(f)&&n.childElements[f].board.removeObject(n.childElements[f]);for(f in n.objects)n.objects.hasOwnProperty(f)&&n.objects[f].board.removeObject(n.objects[f]);if(p)for(f in this.objects)this.objects.hasOwnProperty(f)&&t.exists(this.objects[f].childElements)&&t.exists(this.objects[f].childElements.hasOwnProperty(n.id))&&(delete this.objects[f].childElements[n.id],delete this.objects[f].descendants[n.id]);else if(t.exists(n.ancestors))for(f in n.ancestors)n.ancestors.hasOwnProperty(f)&&t.exists(n.ancestors[f].childElements)&&t.exists(n.ancestors[f].childElements.hasOwnProperty(n.id))&&(delete n.ancestors[f].childElements[n.id],delete n.ancestors[f].descendants[n.id]);if(n._pos>-1)for(this.objectsList.splice(n._pos,1),f=n._pos;f<this.objectsList.length;f++)this.objectsList[f]._pos--;else n.type!==E.OBJECT_TYPE_TURTLE&&g.debug("Board.removeObject: object "+n.id+" not found in list.");delete this.objects[n.id],delete this.elementsByName[n.name],n.visProp&&t.evaluate(n.visProp.trace)&&n.clearTrace(),t.exists(n.remove)&&n.remove()}catch(C){g.debug(n.id+": Could not be removed: "+C)}return this.update(),this},removeAncestors:function(n){var p;for(p in n.ancestors)n.ancestors.hasOwnProperty(p)&&this.removeAncestors(n.ancestors[p]);return this.removeObject(n),this},initGeonextBoard:function(){var n,p,f;return n=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),p=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),f=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[n,p],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[n,f],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(n,p,f,v){var C;return v||(C=this.getBoundingBox()),this.canvasWidth=parseFloat(n),this.canvasHeight=parseFloat(p),f||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),v||this.setBoundingBox(C,this.keepaspectratio,"keep"),this},showDependencies:function(){var n,p,f,v,C;for(n in p=`<p>
`,this.objects)if(this.objects.hasOwnProperty(n)){for(f in C=0,this.objects[n].childElements)this.objects[n].childElements.hasOwnProperty(f)&&(C+=1);for(f in C>=0&&(p+="<strong>"+this.objects[n].id+":</strong> "),this.objects[n].childElements)this.objects[n].childElements.hasOwnProperty(f)&&(p+=this.objects[n].childElements[f].id+"("+this.objects[n].childElements[f].name+"), ");p+=`<p>
`}return p+=`</p>
`,(v=window.open()).document.open(),v.document.write(p),v.document.close(),this},showXML:function(){var n=window.open("");return n.document.open(),n.document.write("<pre>"+t.escapeHTML(this.xmlString)+"</pre>"),n.document.close(),this},prepareUpdate:function(){var n,p,f=this.objectsList.length;for(n=0;n<f;n++)(p=this.objectsList[n]).needsUpdate=p.needsRegularUpdate||this.needsFullUpdate;for(n in this.groups)this.groups.hasOwnProperty(n)&&((p=this.groups[n]).needsUpdate=p.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(n){var p,f;for(n=this.select(n),p=0;p<this.objectsList.length;p++)f=this.objectsList[p],this.needsFullUpdate&&f.elementClass===E.OBJECT_CLASS_TEXT&&f.updateSize(),f.update(!t.exists(n)||f.id!==n.id).updateVisibility();for(p in this.groups)this.groups.hasOwnProperty(p)&&this.groups[p].update(n);return this},updateRenderer:function(){var n,p=this.objectsList.length;if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(n=0;n<p;n++)this.objectsList[n].updateRenderer();return this},updateRendererCanvas:function(){var n,p,f,v,C,_=this.objectsList.length,P=this.options.layer,x=this.options.layer.numlayers,S=Number.NEGATIVE_INFINITY;for(f=0;f<x;f++){for(C in v=Number.POSITIVE_INFINITY,P)P.hasOwnProperty(C)&&P[C]>S&&P[C]<v&&(v=P[C]);for(S=v,n=0;n<_;n++)(p=this.objectsList[n]).visProp.layer===v&&p.prepareUpdate().updateRenderer()}return this},addHook:function(n,p,f){return g.deprecated("Board.addHook()","Board.on()"),p=t.def(p,"update"),f=t.def(f,this),this.hooks.push([p,n]),this.on(p,n,f),this.hooks.length-1},addEvent:g.shortcut(g.Board.prototype,"on"),removeHook:function(n){return g.deprecated("Board.removeHook()","Board.off()"),this.hooks[n]&&(this.off(this.hooks[n][0],this.hooks[n][1]),this.hooks[n]=null),this},removeEvent:g.shortcut(g.Board.prototype,"off"),updateHooks:function(n){var p=Array.prototype.slice.call(arguments,0);return g.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),p[0]=t.def(p[0],"update"),this.triggerEventHandlers([p[0]],arguments),this},addChild:function(n){return t.exists(n)&&t.exists(n.containerObj)&&(this.dependentBoards.push(n),this.update()),this},removeChild:function(n){var p;for(p=this.dependentBoards.length-1;p>=0;p--)this.dependentBoards[p]===n&&this.dependentBoards.splice(p,1);return this},update:function(n){var p,f,v,C,_;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(_=this.document.activeElement,C=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(_=this.document.activeElement,C=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(n).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),C&&(C(),_.focus()),f=this.dependentBoards.length,p=0;p<f;p++)v=this.dependentBoards[p],t.exists(v)&&v!==this&&(v.updateQuality=this.updateQuality,v.prepareUpdate().updateElements().updateConditions(),v.renderer.suspendRedraw(),v.updateRenderer(),v.renderer.unsuspendRedraw(),v.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var n;for(n=0;n<this.grids.length;n++)this.removeObject(this.grids[n]);return this.grids.length=0,this.update(),this},create:function(n,p,f){var v,C;for(n=n.toLowerCase(),t.exists(p)||(p=[]),t.exists(f)||(f={}),C=0;C<p.length;C++)!t.isString(p[C])||n==="text"&&C===2||n==="solidofrevolution3d"&&C===2||!(n!=="input"&&n!=="checkbox"&&n!=="button"||C!==2&&C!==3)||n==="curve"&&C>0||(p[C]=this.select(p[C]));if(!t.isFunction(g.elements[n]))throw new Error("JSXGraph: create: Unknown element type given: "+n);return v=g.elements[n](this,p,f),t.exists(v)?(v.prepareUpdate&&v.update&&v.updateRenderer&&v.fullUpdate(),v):(g.debug("JSXGraph: create: failure creating "+n),v)},createElement:function(){return g.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var n;for(n=0;n<this.objectsList.length;n++)this.objectsList[n].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(n,p,f){var v,C,_,P,x=0,S=0,O=u.getDimensions(this.container,this.document);return t.isArray(n)?(n[0]<this.maxboundingbox[0]||n[1]>this.maxboundingbox[1]||n[2]>this.maxboundingbox[2]||n[3]<this.maxboundingbox[3]||(t.exists(f)||(f="reset"),_=this.unitX,P=this.unitY,this.canvasWidth=parseInt(O.width,10),this.canvasHeight=parseInt(O.height,10),C=this.canvasWidth,v=this.canvasHeight,p?(this.unitX=C/(n[2]-n[0]),this.unitY=v/(n[1]-n[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?(this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY),S=.5*(v/this.unitY-(n[1]-n[3]))):(this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),x=.5*(C/this.unitX-(n[2]-n[0]))),this.keepaspectratio=!0):(this.unitX=C/(n[2]-n[0]),this.unitY=v/(n[1]-n[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*(n[0]-x),this.unitY*(n[1]+S)),f==="update"?(this.zoomX*=this.unitX/_,this.zoomY*=this.unitY/P):f==="reset"&&(this.zoomX=t.exists(this.attr.zoomx)?this.attr.zoomx:1,this.zoomY=t.exists(this.attr.zoomy)?this.attr.zoomy:1)),this):this},getBoundingBox:function(){var n=new y(E.COORDS_BY_SCREEN,[0,0],this).usrCoords,p=new y(E.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords;return[n[1],n[2],p[1],p[2]]},addAnimation:function(n){var p=this;return this.animationObjects[n.id]=n,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){p.animate()},n.board.attr.animationdelay)),this},stopAllAnimation:function(){var n;for(n in this.animationObjects)this.animationObjects.hasOwnProperty(n)&&t.exists(this.animationObjects[n])&&(this.animationObjects[n]=null,delete this.animationObjects[n]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var n,p,f,v,C,_,P,x,S=0,O=null;for(p in this.animationObjects)if(this.animationObjects.hasOwnProperty(p)&&t.exists(this.animationObjects[p])){if(S+=1,(f=this.animationObjects[p]).animationPath&&(v=t.isFunction(f.animationPath)?f.animationPath(new Date().getTime()-f.animationStart):f.animationPath.pop(),!t.exists(v)||!t.isArray(v)&&isNaN(v)?delete f.animationPath:(f.setPositionDirectly(E.COORDS_BY_USER,v),f.fullUpdate(),O=f)),f.animationData){for(C in P=0,f.animationData)f.animationData.hasOwnProperty(C)&&(_=f.animationData[C].pop(),t.exists(_)?(P+=1,(n={})[C]=_,f.setAttribute(n)):delete f.animationData[_]);P===0&&delete f.animationData}t.exists(f.animationData)||t.exists(f.animationPath)||(this.animationObjects[p]=null,delete this.animationObjects[p],t.exists(f.animationCallback)&&(x=f.animationCallback,f.animationCallback=null,x()))}return S===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(O),this},migratePoint:function(n,p,f){var v,C,_,P,x,S,O=!1;for(C in n=this.select(n),p=this.select(p),t.exists(n.label)&&(S=n.label.id,O=!0,this.removeObject(n.label)),n.childElements)if(n.childElements.hasOwnProperty(C)){for(_ in P=!1,v=n.childElements[C])v.hasOwnProperty(_)&&v[_]===n&&(v[_]=p,P=!0);for(P&&delete n.childElements[C],x=0;x<v.parents.length;x++)v.parents[x]===n.id&&(v.parents[x]=p.id);p.addChild(v)}return f&&(O&&(delete p.childElements[S],delete p.descendants[S]),p.label&&this.removeObject(p.label),delete this.elementsByName[p.name],p.name=n.name,O&&p.createLabel()),this.removeObject(n),t.exists(p.name)&&p.name!==""&&(this.elementsByName[p.name]=p),this.fullUpdate(),this},emulateColorblindness:function(n){var p,f;if(t.exists(n)||(n="none"),this.currentCBDef===n)return this;for(p in this.objects)this.objects.hasOwnProperty(p)&&(f=this.objects[p],n!=="none"?(this.currentCBDef==="none"&&(f.visPropOriginal={strokecolor:f.visProp.strokecolor,fillcolor:f.visProp.fillcolor,highlightstrokecolor:f.visProp.highlightstrokecolor,highlightfillcolor:f.visProp.highlightfillcolor}),f.setAttribute({strokecolor:s.rgb2cb(t.evaluate(f.visPropOriginal.strokecolor),n),fillcolor:s.rgb2cb(t.evaluate(f.visPropOriginal.fillcolor),n),highlightstrokecolor:s.rgb2cb(t.evaluate(f.visPropOriginal.highlightstrokecolor),n),highlightfillcolor:s.rgb2cb(t.evaluate(f.visPropOriginal.highlightfillcolor),n)})):t.exists(f.visPropOriginal)&&g.extend(f.visProp,f.visPropOriginal));return this.currentCBDef=n,this.update(),this},select:function(n,p){var f,v,C,_,P=n;if(P===null)return P;if(t.isString(P)&&P!=="")t.exists(this.objects[P])?P=this.objects[P]:t.exists(this.elementsByName[P])?P=this.elementsByName[P]:t.exists(this.groups[P])&&(P=this.groups[P]);else if(!p&&(t.isFunction(P)||t.isObject(P)&&!t.isFunction(P.setAttribute))){for(v={},_=(f=t.filterElements(this.objectsList,P)).length,C=0;C<_;C++)v[f[C].id]=f[C];P=new d(v)}else t.isObject(P)&&t.exists(P.id)&&!t.exists(this.objects[P.id])&&(P=null);return P},hasPoint:function(n,p){var f=n,v=p,C=this.getBoundingBox();return t.exists(n)&&t.isArray(n.usrCoords)&&(f=n.usrCoords[1],v=n.usrCoords[2]),!!(t.isNumber(f)&&t.isNumber(v)&&C[0]<f&&f<C[2]&&C[1]>v&&v>C[3])},updateCSSTransforms:function(){var n=this.containerObj;for(this.cssTransMat=u.getCSSTransformMatrix(n),n=n.parentNode===n.getRootNode()?n.parentNode.host:n.parentNode;n;)this.cssTransMat=l.matMatMult(u.getCSSTransformMatrix(n),this.cssTransMat),n=n.parentNode===n.getRootNode()?n.parentNode.host:n.parentNode;return this.cssTransMat=l.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(n){this.isSelecting=!0,this.selectingBox=[[n[0],n[1]],[n[0],n[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(n){this.isSelecting&&(this.selectingBox[1]=[n[0],n[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(n){var p=this.getMousePosition(n);this.isSelecting=!1,this.selectingBox[1]=[p[0],p[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var n=this.selectingBox[0],p=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(g.COORDS_BY_SCREEN,[n[0],n[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(g.COORDS_BY_SCREEN,[n[0],p[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(g.COORDS_BY_SCREEN,[p[0],p[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(g.COORDS_BY_SCREEN,[p[0],n[1]])},_testForSelection:function(n){this._isRequiredKeyPressed(n,"selection")&&(t.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(n){var p;return t.exists(this.selectionPolygon)||(p=t.copyAttributes(n,b,"board","selection")).enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],p)),this},__evt__down:function(n){},__evt__mousedown:function(n){},__evt__pendown:function(n){},__evt__pointerdown:function(n){},__evt__touchstart:function(n){},__evt__up:function(n){},__evt__mouseup:function(n){},__evt__pointerup:function(n){},__evt__touchend:function(n){},__evt__move:function(n,p){},__evt__mousemove:function(n,p){},__evt__penmove:function(n,p){},__evt__pointermove:function(n,p){},__evt__touchmove:function(n,p){},__evt__hit:function(n,p,f){},__evt__mousehit:function(n,p,f){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},toFullscreen:function(n){var p,f,v,C=this.document;return n=n||this.container,this._fullscreen_inner_id=n,v=C.getElementById(n),p="fullscreenwrap_"+n,C.getElementById(p)?f=C.getElementById(p):((f=document.createElement("div")).classList.add("JXG_wrap_private"),f.setAttribute("id",p),v.parentNode.insertBefore(f,v),f.appendChild(v)),f.requestFullscreen=f.requestFullscreen||f.webkitRequestFullscreen||f.mozRequestFullScreen||f.msRequestFullscreen,(C.fullscreenElement!==void 0?C.fullscreenElement:C.webkitFullscreenElement!==void 0?C.webkitFullscreenElement:C.msFullscreenElement)===null?f.requestFullscreen&&f.requestFullscreen():t.exists(document.exitFullscreen)?document.exitFullscreen():t.exists(document.webkitExitFullscreen)&&document.webkitExitFullscreen(),this},fullscreenListener:function(n){var p,f,v,C=this.document;if(p=this._fullscreen_inner_id,t.exists(p)){if(v=C.fullscreenElement!==void 0?C.fullscreenElement:C.webkitFullscreenElement!==void 0?C.webkitFullscreenElement:C.msFullscreenElement,f=C.getElementById(p),v)f._cssFullscreenStore={id:v.id,isFullscreen:!0,margin:f.style.margin},f.style.margin="",u.scaleJSXGraphDiv(v.id,p,C),v=null;else if(t.exists(f._cssFullscreenStore)){try{C.styleSheets[C.styleSheets.length-1].deleteRule(0)}catch{console.log("JSXGraph: Could not remove CSS rules for full screen mode")}f._cssFullscreenStore.isFullscreen=!1,f.style.margin=f._cssFullscreenStore.margin}this.updateCSSTransforms()}},createRoulette:function(n,p,f,v,C,_,P){var x=this;return new function(){var S,O=0,w=0,T=0,M=f,N=m.root(function(Z){var V=n.X(M),U=n.Y(M),J=p.X(Z),z=p.Y(Z);return(V-J)*(V-J)+(U-z)*(U-z)},[0,2*Math.PI]),A=0,R=0,L=x.create("transform",[function(){return O}],{type:"rotate"}),D=x.create("transform",[function(){return O},function(){return n.X(M)},function(){return n.Y(M)}],{type:"rotate"}),k=x.create("transform",[function(){return w},function(){return T}],{type:"translate"}),B=function(Z,V,U){var J=m.D(Z.X)(V),z=m.D(Z.Y)(V),X=m.D(Z.X)(U),G=m.D(Z.Y)(U),Q=m.D(Z.X)(.5*(V+U)),ie=m.D(Z.Y)(.5*(V+U)),ce=Math.sqrt(J*J+z*z),he=Math.sqrt(X*X+G*G);return(ce+4*Math.sqrt(Q*Q+ie*ie)+he)*(U-V)/6},j=function(Z){return S-B(p,N,Z)},I=Math.PI/18,q=9*I,$=null;return this.rolling=function(){var Z,V,U,J,z;S=B(n,M,A=M+C*v),R=m.root(j,N),Z=new a(n.X(A),n.Y(A)),V=new a(p.X(R),p.Y(R)),U=new a(m.D(n.X)(A),m.D(n.Y)(A)),J=new a(m.D(p.X)(R),m.D(p.Y)(R)),z=a.C.div(U,J),O=Math.atan2(z.imaginary,z.real),z.div(a.C.abs(z)),z.mult(V),w=Z.real-z.real,T=Z.imaginary-z.imaginary,O<-I&&O>-q?(O=-I,D.applyOnce(P)):O>I&&O<q?(O=I,D.applyOnce(P)):(L.applyOnce(P),k.applyOnce(P),M=A,N=R),x.update()},this.start=function(){return _>0&&($=window.setInterval(this.rolling,_)),this},this.stop=function(){return window.clearInterval($),this},this}}}),g.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/color","utils/base64","math/numerics"],function(g,E,y,b,m,l,c,a){return g.SVGRenderer=function(e,o){var s;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=e,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.display="block",this.resize(o.width,o.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],s=0;s<E.layer.numlayers;s++)this.layer[s]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[s]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("display","none"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},g.SVGRenderer.prototype=new y,g.extend(g.SVGRenderer.prototype,{_createArrowHead:function(e,o,s){var t,h,u,d,n=e.id+"Triangle";return m.exists(o)&&(n+=o),(t=this.createPrim("marker",n)).setAttributeNS(null,"stroke",m.evaluate(e.visProp.strokecolor)),t.setAttributeNS(null,"stroke-opacity",m.evaluate(e.visProp.strokeopacity)),t.setAttributeNS(null,"fill",m.evaluate(e.visProp.strokecolor)),t.setAttributeNS(null,"fill-opacity",m.evaluate(e.visProp.strokeopacity)),t.setAttributeNS(null,"stroke-width",0),t.setAttributeNS(null,"orient","auto"),t.setAttributeNS(null,"markerUnits","strokeWidth"),h=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),d=5,o==="End"?(u=0,s===2?h.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z"):s===3?h.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z"):s===4?(d=3.31,h.setAttributeNS(null,"d","M 0.00,3.31 C 3.53,3.84 7.13,4.50 10.00,6.63 C 9.33,5.52 8.67,4.42 8.00,3.31 C 8.67,2.21 9.33,1.10 10.00,0.00 C 7.13,2.13 3.53,2.79 0.00,3.31")):s===5?(d=3.28,h.setAttributeNS(null,"d","M 0.00,3.28 C 3.39,4.19 6.81,5.07 10.00,6.55 C 9.38,5.56 9.00,4.44 9.00,3.28 C 9.00,2.11 9.38,0.99 10.00,0.00 C 6.81,1.49 3.39,2.37 0.00,3.28")):s===6?(d=2.84,h.setAttributeNS(null,"d","M 0.00,2.84 C 3.39,3.59 6.79,4.35 10.00,5.68 C 9.67,4.73 9.33,3.78 9.00,2.84 C 9.33,1.89 9.67,0.95 10.00,0.00 C 6.79,1.33 3.39,2.09 0.00,2.84")):s===7?(d=5.2,h.setAttributeNS(null,"d","M 0.00,5.20 C 4.04,5.20 7.99,6.92 10.00,10.39 M 10.00,0.00 C 7.99,3.47 4.04,5.20 0.00,5.20")):h.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"),e.elementClass===b.OBJECT_CLASS_LINE&&(u=s===2?4.9:s===3?3.3:s===4||s===5||s===6?6.66:s===7?0:10)):(u=10,s===2?h.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z"):s===3?(u=3.3,h.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):s===4?(d=3.31,h.setAttributeNS(null,"d","M 10.00,3.31 C 6.47,3.84 2.87,4.50 0.00,6.63 C 0.67,5.52 1.33,4.42 2.00,3.31 C 1.33,2.21 0.67,1.10 0.00,0.00 C 2.87,2.13 6.47,2.79 10.00,3.31")):s===5?(d=3.28,h.setAttributeNS(null,"d","M 10.00,3.28 C 6.61,4.19 3.19,5.07 0.00,6.55 C 0.62,5.56 1.00,4.44 1.00,3.28 C 1.00,2.11 0.62,0.99 0.00,0.00 C 3.19,1.49 6.61,2.37 10.00,3.28")):s===6?(d=2.84,h.setAttributeNS(null,"d","M 10.00,2.84 C 6.61,3.59 3.21,4.35 0.00,5.68 C 0.33,4.73 0.67,3.78 1.00,2.84 C 0.67,1.89 0.33,0.95 0.00,0.00 C 3.21,1.33 6.61,2.09 10.00,2.84")):s===7?(d=5.2,h.setAttributeNS(null,"d","M 10.00,5.20 C 5.96,5.20 2.01,6.92 0.00,10.39 M 0.00,0.00 C 2.01,3.47 5.96,5.20 10.00,5.20")):h.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"),e.elementClass===b.OBJECT_CLASS_LINE&&(u=s===2?5.1:s===3?.02:s===4||s===5||s===6?3.33:s===7?10:.05)),s===7&&(t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke-width",1)),t.setAttributeNS(null,"refY",d),t.setAttributeNS(null,"refX",u),t.appendChild(h),t},_setArrowColor:function(e,o,s,t,h){e&&(m.isString(o)&&(h!==7?this._setAttribute(function(){e.setAttributeNS(null,"stroke",o),e.setAttributeNS(null,"fill",o),e.setAttributeNS(null,"stroke-opacity",s),e.setAttributeNS(null,"fill-opacity",s)},t.visPropOld.fillcolor):this._setAttribute(function(){e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke",o),e.setAttributeNS(null,"stroke-opacity",s)},t.visPropOld.fillcolor)),this.isIE&&t.rendNode.parentNode.insertBefore(t.rendNode,t.rendNode))},_setArrowWidth:function(e,o,s,t){var h,u;e&&(u=(h=o)*t,e.setAttributeNS(null,"viewBox","0 0 "+10*h+" "+10*h),e.setAttributeNS(null,"markerHeight",u),e.setAttributeNS(null,"markerWidth",u),e.setAttributeNS(null,"display","inherit"),this.isIE&&s.parentNode.insertBefore(s,s))},updateTicks:function(e){var o,s,t,h,u,d,n,p,f="",v=e.ticks.length,C=!0;for(o=0;o<v;o++){for(u=(t=e.ticks[o])[0],d=t[1],n=u.length,p=" M "+u[0]+" "+d[0],m.isNumber(u[0])||(C=!1),s=1;C&&s<n;++s)m.isNumber(u[s])?p+=" L "+u[s]+" "+d[s]:C=!1;C&&(f+=p)}h=e.rendNode,m.exists(h)||(h=this.createPrim("path",e.id),this.appendChildPrim(h,m.evaluate(e.visProp.layer)),e.rendNode=h),h.setAttributeNS(null,"stroke",m.evaluate(e.visProp.strokecolor)),h.setAttributeNS(null,"fill","none"),h.setAttributeNS(null,"stroke-opacity",m.evaluate(e.visProp.strokeopacity)),h.setAttributeNS(null,"stroke-width",m.evaluate(e.visProp.strokewidth)),this.updatePathPrim(h,f,e.board)},displayCopyright:function(e,o){var s,t=this.createPrim("text","licenseText");t.setAttributeNS(null,"x","20px"),t.setAttributeNS(null,"y",2+o+"px"),t.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+o+"px; fill:#356AA0;  opacity:0.3;"),s=this.container.ownerDocument.createTextNode(e),t.appendChild(s),this.appendChildPrim(t,0)},drawInternalText:function(e){var o=this.createPrim("text",e.id);return o.style.whiteSpace="nowrap",e.rendNodeText=this.container.ownerDocument.createTextNode(""),o.appendChild(e.rendNodeText),this.appendChildPrim(o,m.evaluate(e.visProp.layer)),o},updateInternalText:function(e){var o,s=e.plaintext,t=e.getAnchorX(),h=e.getAnchorY();e.rendNode.getAttributeNS(null,"class")!==e.visProp.cssclass&&(e.rendNode.setAttributeNS(null,"class",m.evaluate(e.visProp.cssclass)),e.needsSizeUpdate=!0),isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(o=e.coords.scrCoords[1],e.visPropOld.left!==t+o&&(e.rendNode.setAttributeNS(null,"x",o+"px"),t==="left"?e.rendNode.setAttributeNS(null,"text-anchor","start"):t==="right"?e.rendNode.setAttributeNS(null,"text-anchor","end"):t==="middle"&&e.rendNode.setAttributeNS(null,"text-anchor","middle"),e.visPropOld.left=t+o),o=e.coords.scrCoords[2],e.visPropOld.top!==h+o&&(e.rendNode.setAttributeNS(null,"y",o+.5*this.vOffsetText+"px"),h==="bottom"?e.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):h==="top"?e.rendNode.setAttributeNS(null,"dy","1.6ex"):h==="middle"&&e.rendNode.setAttributeNS(null,"dy","0.6ex"),e.visPropOld.top=h+o)),e.htmlStr!==s&&(e.rendNodeText.data=s,e.htmlStr=s),this.transformImage(e,e.transformations)},updateInternalTextStyle:function(e,o,s,t){this.setObjectFillColor(e,o,s)},drawImage:function(e){var o=this.createPrim("image",e.id);o.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(o,m.evaluate(e.visProp.layer)),e.rendNode=o,this.updateImage(e)},transformImage:function(e,o){var s,t=e.rendNode,h="";o.length>0&&(h+=" matrix("+[(s=this.joinTransforms(e,o))[1][1],s[2][1],s[1][2],s[2][2],s[1][0],s[2][0]].join(",")+") ",t.setAttributeNS(null,"transform",h))},updateImageURL:function(e){var o=m.evaluate(e.url);return e._src!==o&&(e.imgIsLoaded=!1,e.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",o),e._src=o,!0)},updateImageStyle:function(e,o){var s=m.evaluate(o?e.visProp.highlightcssclass:e.visProp.cssclass);e.rendNode.setAttributeNS(null,"class",s)},drawForeignObject:function(e){e.rendNode=this.appendChildPrim(this.createPrim("foreignObject",e.id),m.evaluate(e.visProp.layer)),this.appendNodesToElement(e,"foreignObject"),this.updateForeignObject(e)},updateForeignObject:function(e){e._useUserSize?e.rendNode.style.overflow="hidden":e.rendNode.style.overflow="visible",this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),e.rendNode.innerHTML=e.content,this._updateVisual(e,{stroke:!0,dash:!0},!0)},appendChildPrim:function(e,o){return m.exists(o)?o>=E.layer.numlayers&&(o=E.layer.numlayers-1):o=0,this.layer[o].appendChild(e),e},createPrim:function(e,o){var s=this.container.ownerDocument.createElementNS(this.svgNamespace,e);return s.setAttributeNS(null,"id",this.container.id+"_"+o),s.style.position="absolute",e==="path"&&(s.setAttributeNS(null,"stroke-linecap","round"),s.setAttributeNS(null,"stroke-linejoin","round"),s.setAttributeNS(null,"fill-rule","evenodd")),s},remove:function(e){m.exists(e)&&m.exists(e.parentNode)&&e.parentNode.removeChild(e)},setLayer:function(e,o){m.exists(o)?o>=E.layer.numlayers&&(o=E.layer.numlayers-1):o=0,this.layer[o].appendChild(e.rendNode)},makeArrows:function(e,o){var s,t=o.evFirst,h=o.evLast;e.visPropOld.firstarrow!==t||e.visPropOld.lastarrow!==h?(t?(s=e.rendNodeTriangleStart,m.exists(s)?this.defs.appendChild(s):(s=this._createArrowHead(e,"End",o.typeFirst),this.defs.appendChild(s),e.rendNodeTriangleStart=s,e.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+e.id+"TriangleEnd)"))):(s=e.rendNodeTriangleStart,m.exists(s)&&this.remove(s)),h?(s=e.rendNodeTriangleEnd,m.exists(s)?this.defs.appendChild(s):(s=this._createArrowHead(e,"Start",o.typeLast),this.defs.appendChild(s),e.rendNodeTriangleEnd=s,e.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+e.id+"TriangleStart)"))):(s=e.rendNodeTriangleEnd,m.exists(s)&&this.remove(s)),e.visPropOld.firstarrow=t,e.visPropOld.lastarrow=h):this.isIE&&e.visPropCalc.visible&&(t||h)&&e.rendNode.parentNode.insertBefore(e.rendNode,e.rendNode)},updateEllipsePrim:function(e,o,s,t,h){var u;u=2e5,o=Math.abs(o)<u?o:u*o/Math.abs(o),s=Math.abs(s)<u?s:u*s/Math.abs(s),t=Math.abs(t)<u?t:u*t/Math.abs(t),h=Math.abs(h)<u?h:u*h/Math.abs(h),e.setAttributeNS(null,"cx",o),e.setAttributeNS(null,"cy",s),e.setAttributeNS(null,"rx",Math.abs(t)),e.setAttributeNS(null,"ry",Math.abs(h))},updateLinePrim:function(e,o,s,t,h){var u;u=2e5,isNaN(o+s+t+h)||(o=Math.abs(o)<u?o:u*o/Math.abs(o),s=Math.abs(s)<u?s:u*s/Math.abs(s),t=Math.abs(t)<u?t:u*t/Math.abs(t),h=Math.abs(h)<u?h:u*h/Math.abs(h),e.setAttributeNS(null,"x1",o),e.setAttributeNS(null,"y1",s),e.setAttributeNS(null,"x2",t),e.setAttributeNS(null,"y2",h))},updatePathPrim:function(e,o){o===""&&(o="M 0 0"),e.setAttributeNS(null,"d",o)},updatePathStringPoint:function(e,o,s){var t="",h=e.coords.scrCoords,u=o*Math.sqrt(3)*.5,d=.5*o;return s==="x"?t=" M "+(h[1]-o)+" "+(h[2]-o)+" L "+(h[1]+o)+" "+(h[2]+o)+" M "+(h[1]+o)+" "+(h[2]-o)+" L "+(h[1]-o)+" "+(h[2]+o):s==="+"?t=" M "+(h[1]-o)+" "+h[2]+" L "+(h[1]+o)+" "+h[2]+" M "+h[1]+" "+(h[2]-o)+" L "+h[1]+" "+(h[2]+o):s==="<>"?t=" M "+(h[1]-o)+" "+h[2]+" L "+h[1]+" "+(h[2]+o)+" L "+(h[1]+o)+" "+h[2]+" L "+h[1]+" "+(h[2]-o)+" Z ":s==="^"?t=" M "+h[1]+" "+(h[2]-o)+" L "+(h[1]-u)+" "+(h[2]+d)+" L "+(h[1]+u)+" "+(h[2]+d)+" Z ":s==="v"?t=" M "+h[1]+" "+(h[2]+o)+" L "+(h[1]-u)+" "+(h[2]-d)+" L "+(h[1]+u)+" "+(h[2]-d)+" Z ":s===">"?t=" M "+(h[1]+o)+" "+h[2]+" L "+(h[1]-d)+" "+(h[2]-u)+" L "+(h[1]-d)+" "+(h[2]+u)+" Z ":s==="<"&&(t=" M "+(h[1]-o)+" "+h[2]+" L "+(h[1]+d)+" "+(h[2]-u)+" L "+(h[1]+d)+" "+(h[2]+u)+" Z "),t},updatePathStringPrim:function(e){var o,s,t,h=" M ",u=h,d=5e3,n="";if(e.numberPoints<=0)return"";if(t=Math.min(e.points.length,e.numberPoints),e.bezierDegree===1)for(o=0;o<t;o++)s=e.points[o].scrCoords,isNaN(s[1])||isNaN(s[2])?u=h:(s[1]=Math.max(Math.min(s[1],d),-5e3),s[2]=Math.max(Math.min(s[2],d),-5e3),n+=u+s[1]+" "+s[2],u=" L ");else if(e.bezierDegree===3)for(o=0;o<t;)s=e.points[o].scrCoords,isNaN(s[1])||isNaN(s[2])?u=h:(n+=u+s[1]+" "+s[2],u===" C "&&(o+=1,n+=" "+(s=e.points[o].scrCoords)[1]+" "+s[2],o+=1,n+=" "+(s=e.points[o].scrCoords)[1]+" "+s[2]),u=" C "),o+=1;return n},updatePathStringBezierPrim:function(e){var o,s,t,h,u,d,n,p=" M ",f=p,v=5e3,C="",_=m.evaluate(e.visProp.strokewidth),P=m.evaluate(e.visProp.curvetype)!=="plot";if(e.numberPoints<=0)return"";for(P&&e.board.options.curve.RDPsmoothing&&(e.points=a.RamerDouglasPeucker(e.points,.5)),n=Math.min(e.points.length,e.numberPoints),s=1;s<3;s++)for(f=p,o=0;o<n;o++)h=e.points[o].scrCoords,isNaN(h[1])||isNaN(h[2])?f=p:(h[1]=Math.max(Math.min(h[1],v),-5e3),h[2]=Math.max(Math.min(h[2],v),-5e3),f===p?C+=f+h[1]+" "+h[2]:(t=2*s,C+=[f,u+.333*(h[1]-u)+_*(t*Math.random()-s)," ",d+.333*(h[2]-d)+_*(t*Math.random()-s)," ",u+.666*(h[1]-u)+_*(t*Math.random()-s)," ",d+.666*(h[2]-d)+_*(t*Math.random()-s)," ",h[1]," ",h[2]].join("")),f=" C ",u=h[1],d=h[2]);return C},updatePolygonPrim:function(e,o){var s,t,h="",u=o.vertices.length;for(e.setAttributeNS(null,"stroke","none"),e.setAttributeNS(null,"fill-rule","evenodd"),o.elType==="polygonalchain"&&u++,s=0;s<u-1;s++){if(!o.vertices[s].isReal)return void e.setAttributeNS(null,"points","");h=h+(t=o.vertices[s].coords.scrCoords)[1]+","+t[2],s<u-2&&(h+=" ")}h.indexOf("NaN")===-1&&e.setAttributeNS(null,"points",h)},updateRectPrim:function(e,o,s,t,h){e.setAttributeNS(null,"x",o),e.setAttributeNS(null,"y",s),e.setAttributeNS(null,"width",t),e.setAttributeNS(null,"height",h)},setPropertyPrim:function(e,o,s){o!=="stroked"&&e.setAttributeNS(null,o,s)},display:function(e,o){var s;e&&e.rendNode&&(e.visPropOld.visible=o,s=e.rendNode,o?(s.setAttributeNS(null,"display","inline"),s.style.visibility="inherit"):(s.setAttributeNS(null,"display","none"),s.style.visibility="hidden"))},show:function(e){g.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(e,!0)},hide:function(e){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(e,!1)},setBuffering:function(e,o){e.rendNode.setAttribute("buffered-rendering",o)},setDashStyle:function(e){var o=m.evaluate(e.visProp.dash),s=e.rendNode;o>0?s.setAttributeNS(null,"stroke-dasharray",this.dashArray[o-1]):s.hasAttributeNS(null,"stroke-dasharray")&&s.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(e){var o,s,t,h=e.rendNode,u=m.evaluate(e.visProp.gradient);u==="linear"||u==="radial"?(o=this.createPrim(u+"Gradient",e.id+"_gradient"),s=this.createPrim("stop",e.id+"_gradient1"),t=this.createPrim("stop",e.id+"_gradient2"),o.appendChild(s),o.appendChild(t),this.defs.appendChild(o),h.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)"),e.gradNode1=s,e.gradNode2=t,e.gradNode=o):h.removeAttributeNS(null,"style")},updateGradientAngle:function(e,o){var s=1,t=Math.cos(o),h=Math.sin(o);Math.abs(t)>Math.abs(h)?s/=Math.abs(t):s/=Math.abs(h),t>=0?(e.setAttributeNS(null,"x1",0),e.setAttributeNS(null,"x2",t*s)):(e.setAttributeNS(null,"x1",-t*s),e.setAttributeNS(null,"x2",0)),h>=0?(e.setAttributeNS(null,"y1",0),e.setAttributeNS(null,"y2",h*s)):(e.setAttributeNS(null,"y1",-h*s),e.setAttributeNS(null,"y2",0))},updateGradientCircle:function(e,o,s,t,h,u,d){e.setAttributeNS(null,"cx",100*o+"%"),e.setAttributeNS(null,"cy",100*s+"%"),e.setAttributeNS(null,"r",100*t+"%"),e.setAttributeNS(null,"fx",100*h+"%"),e.setAttributeNS(null,"fy",100*u+"%"),e.setAttributeNS(null,"fr",100*d+"%")},updateGradient:function(e){var o,s,t=e.gradNode1,h=e.gradNode2,u=m.evaluate(e.visProp.gradient);m.exists(t)&&m.exists(h)&&(s=(s=m.evaluate(e.visProp.fillopacity))>0?s:0,o=m.evaluate(e.visProp.fillcolor),t.setAttributeNS(null,"style","stop-color:"+o+";stop-opacity:"+s),h.setAttributeNS(null,"style","stop-color:"+m.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+m.evaluate(e.visProp.gradientsecondopacity)),t.setAttributeNS(null,"offset",100*m.evaluate(e.visProp.gradientstartoffset)+"%"),h.setAttributeNS(null,"offset",100*m.evaluate(e.visProp.gradientendoffset)+"%"),u==="linear"?this.updateGradientAngle(e.gradNode,m.evaluate(e.visProp.gradientangle)):u==="radial"&&this.updateGradientCircle(e.gradNode,m.evaluate(e.visProp.gradientcx),m.evaluate(e.visProp.gradientcy),m.evaluate(e.visProp.gradientr),m.evaluate(e.visProp.gradientfx),m.evaluate(e.visProp.gradientfy),m.evaluate(e.visProp.gradientfr)))},setObjectTransition:function(e,o){var s,t,h,u=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(o===void 0&&(o=m.evaluate(e.visProp.transitionduration)),o!==e.visPropOld.transitionduration){for(s=e.elementClass===b.OBJECT_CLASS_TEXT&&m.evaluate(e.visProp.display)==="html"?" color "+o+"ms, opacity "+o+"ms":" fill "+o+"ms, fill-opacity "+o+"ms, stroke "+o+"ms, stroke-opacity "+o+"ms",h=u.length,t=0;t<h;++t)e[u[t]]&&(e[u[t]].style.transition=s);e.visPropOld.transitionduration=o}},_setAttribute:function(e,o){o===""?e():window.setTimeout(e,1)},setObjectFillColor:function(e,o,s,t){var h,u,d,n,p=m.evaluate(o),f=m.evaluate(s),v=m.evaluate(e.visProp.gradient);f=f>0?f:0,e.visPropOld.fillcolor===p&&e.visPropOld.fillopacity===f&&v===null||(m.exists(p)&&p!==!1&&(p.length!==9?(u=p,n=f):(d=l.rgba2rgbo(p),u=d[0],n=f*d[1]),h=t===void 0?e.rendNode:t,u!=="none"&&this._setAttribute(function(){h.setAttributeNS(null,"fill",u)},e.visPropOld.fillcolor),e.type===g.OBJECT_TYPE_IMAGE?this._setAttribute(function(){h.setAttributeNS(null,"opacity",n)},e.visPropOld.fillopacity):(u==="none"?(n=0,h.setAttributeNS(null,"pointer-events","visibleStroke")):h.setAttributeNS(null,"pointer-events","visiblePainted"),this._setAttribute(function(){h.setAttributeNS(null,"fill-opacity",n)},e.visPropOld.fillopacity)),v!=="linear"&&v!=="radial"||this.updateGradient(e)),e.visPropOld.fillcolor=p,e.visPropOld.fillopacity=f)},setObjectStrokeColor:function(e,o,s){var t,h,u,d,n=m.evaluate(o),p=m.evaluate(s);p=p>0?p:0,e.visPropOld.strokecolor===n&&e.visPropOld.strokeopacity===p||(m.exists(n)&&n!==!1&&(n.length!==9?(t=n,u=p):(h=l.rgba2rgbo(n),t=h[0],u=p*h[1]),d=e.rendNode,e.elementClass===b.OBJECT_CLASS_TEXT?m.evaluate(e.visProp.display)==="html"?this._setAttribute(function(){d.style.color=t,d.style.opacity=u},e.visPropOld.strokecolor):this._setAttribute(function(){d.setAttributeNS(null,"style","fill:"+t),d.setAttributeNS(null,"style","fill-opacity:"+u)},e.visPropOld.strokecolor):this._setAttribute(function(){d.setAttributeNS(null,"stroke",t),d.setAttributeNS(null,"stroke-opacity",u)},e.visPropOld.strokecolor),e.elementClass!==b.OBJECT_CLASS_CURVE&&e.elementClass!==b.OBJECT_CLASS_LINE||(m.evaluate(e.visProp.firstarrow)&&this._setArrowColor(e.rendNodeTriangleStart,t,u,e,e.visPropCalc.typeFirst),m.evaluate(e.visProp.lastarrow)&&this._setArrowColor(e.rendNodeTriangleEnd,t,u,e,e.visPropCalc.typeLast))),e.visPropOld.strokecolor=n,e.visPropOld.strokeopacity=p)},setObjectStrokeWidth:function(e,o){var s,t=m.evaluate(o);isNaN(t)||e.visPropOld.strokewidth===t||(s=e.rendNode,this.setPropertyPrim(s,"stroked","true"),m.exists(t)&&this.setPropertyPrim(s,"stroke-width",t+"px"),e.visPropOld.strokewidth=t)},setLineCap:function(e){var o=m.evaluate(e.visProp.linecap);o!==void 0&&o!==""&&e.visPropOld.linecap!==o&&m.exists(e.rendNode)&&(this.setPropertyPrim(e.rendNode,"stroke-linecap",o),e.visPropOld.linecap=o)},setShadow:function(e){var o=m.evaluate(e.visProp.shadow);e.visPropOld.shadow!==o&&(m.exists(e.rendNode)&&(o?e.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):e.rendNode.removeAttributeNS(null,"filter")),e.visPropOld.shadow=o)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(e,o){this.svgRoot.setAttribute("width",parseFloat(e)),this.svgRoot.setAttribute("height",parseFloat(o))},createTouchpoints:function(e){var o,s,t,h;for(this.touchpoints=[],o=0;o<e;o++)s="touchpoint1_"+o,h=this.createPrim("path",s),this.appendChildPrim(h,19),h.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(h),this.setPropertyPrim(h,"stroked","true"),this.setPropertyPrim(h,"stroke-width","1px"),h.setAttributeNS(null,"stroke","#000000"),h.setAttributeNS(null,"stroke-opacity",1),h.setAttributeNS(null,"display","none"),t="touchpoint2_"+o,h=this.createPrim("ellipse",t),this.appendChildPrim(h,19),this.updateEllipsePrim(h,0,0,0,0),this.touchpoints.push(h),this.setPropertyPrim(h,"stroked","true"),this.setPropertyPrim(h,"stroke-width","1px"),h.setAttributeNS(null,"stroke","#000000"),h.setAttributeNS(null,"stroke-opacity",1),h.setAttributeNS(null,"fill","#ffffff"),h.setAttributeNS(null,"fill-opacity",0),h.setAttributeNS(null,"display","none")},showTouchpoint:function(e){this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(this.touchpoints[2*e].setAttributeNS(null,"display","inline"),this.touchpoints[2*e+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(e){this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(this.touchpoints[2*e].setAttributeNS(null,"display","none"),this.touchpoints[2*e+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(e,o){var s,t;this.touchpoints&&e>=0&&2*e<this.touchpoints.length&&(s=o[0],t=o[1],this.touchpoints[2*e].setAttributeNS(null,"d","M "+(s-37)+" "+t+" L "+(s+37)+" "+t+" M "+s+" "+(t-37)+" L "+s+" "+(t+37)),this.updateEllipsePrim(this.touchpoints[2*e+1],o[0],o[1],25,25))},_getValuesOfDOMElements:function(e){var o=[];if(e.nodeType===1)for(e=e.firstChild;e;)e.id!==void 0&&e.value!==void 0&&o.push([e.id,e.value]),o=o.concat(this._getValuesOfDOMElements(e)),e=e.nextSibling;return o},_getDataUri:function(e,o){var s=new Image;s.onload=function(){var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(this,0,0),o(t.toDataURL("image/png")),t.remove()},s.src=e},_getImgDataURL:function(e){var o,s,t,h,u,d;if((s=(o=e.getElementsByTagName("image")).length)>0)for(t=document.createElement("canvas"),d=0;d<s;d++){o[d].setAttribute("crossorigin","anonymous"),h=t.getContext("2d"),t.width=o[d].getAttribute("width"),t.height=o[d].getAttribute("height");try{h.drawImage(o[d],0,0,t.width,t.height),u=t.toDataURL(),o[d].setAttribute("xlink:href",u)}catch(n){console.log("CORS problem! Image can not be used",n)}}return!0},dumpToDataURI:function(e){var o,s,t,h=this.svgRoot,u=window.btoa||c.encode,d=[];if(this.container.hasChildNodes()&&m.exists(this.foreignObjLayer))for(e||this.foreignObjLayer.setAttribute("display","inline");h.nextSibling;)d=d.concat(this._getValuesOfDOMElements(h.nextSibling)),this.foreignObjLayer.appendChild(h.nextSibling);if(this._getImgDataURL(h),h.setAttribute("xmlns","http://www.w3.org/2000/svg"),o=new XMLSerializer().serializeToString(h),e!==!0)for(t=d.length,s=0;s<t;s++)o=o.replace('id="'+d[s][0]+'"','id="'+d[s][0]+'" value="'+d[s][1]+'"');if((o.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g)||[]).length>1&&(o=o.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")),o=o.replace(/&nbsp;/g," "),m.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes()){for(;this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);this.foreignObjLayer.setAttribute("display","none")}return"data:image/svg+xml;base64,"+u(unescape(encodeURIComponent(o)))},dumpToCanvas:function(e,o,s,t){var h,u,d,n;return(d=this.container.ownerDocument.getElementById(e)).width=d.width,n=d.getContext("2d"),o!==void 0&&s!==void 0&&(d.style.width=parseFloat(o)+"px",d.style.height=parseFloat(s)+"px",d.setAttribute("width",parseFloat(o)),d.setAttribute("height",parseFloat(s))),u=new Image,h=this.dumpToDataURI(t),u.src=h,"Promise"in window?new Promise(function(p,f){try{u.onload=function(){n.drawImage(u,0,0,o,s),p()}}catch(v){f(v)}}):(u.onload=function(){window.setTimeout(function(){try{n.drawImage(u,0,0,o,s)}catch{console.log("screenshots not longer supported on IE")}},200)},this)},screenshot:function(e,o,s){var t,h,u,d,n,p,f,v,C,_,P,x=this.container.ownerDocument,S=this.container.parentNode,O=e.attr.screenshot,w=!1;return this.type==="no"||(f=O.scale*this.container.getBoundingClientRect().width,v=O.scale*this.container.getBoundingClientRect().height,o===void 0||o===""?(w=!0,(d=new Image).style.width=f+"px",d.style.height=v+"px"):(w=!1,d=x.getElementById(o)),w&&((t=x.createElement("div")).style.cssText=O.css,t.style.width=f+"px",t.style.height=v+"px",t.style.zIndex=this.container.style.zIndex+120,t.style.position="absolute",t.style.top=this.container.offsetTop+"px",t.style.left=this.container.offsetLeft+"px"),h=x.createElement("canvas"),u=Math.random().toString(36).substr(2,5),h.setAttribute("id",u),h.setAttribute("width",f),h.setAttribute("height",v),h.style.width=f+"px",h.style.height=f+"px",h.style.display="none",S.appendChild(h),w&&(n=x.createElement("span"),p=x.createTextNode("✖"),n.style.cssText=O.cssButton,n.appendChild(p),n.onclick=function(){t.parentNode.removeChild(t)},t.appendChild(d),t.appendChild(n),S.insertBefore(t,this.container.nextSibling)),C=x.getElementById(this.container.id+"_navigationbar"),m.exists(C)&&(_=C.style.display,C.style.display="none"),P=function(){d.src=h.toDataURL("image/png"),S.removeChild(h)},"Promise"in window?this.dumpToCanvas(u,f,v,s).then(P):(this.dumpToCanvas(u,f,v,s),window.setTimeout(P,200)),m.exists(C)&&(C.style.display=_)),this}}),g.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(g,E,y,b,m,l,c){return g.VMLRenderer=function(a){this.type="vml",this.container=a,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,b.exists(g.vmlStylesheet)||(a.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),g.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),g.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{a.ownerDocument.namespaces.jxgvml||a.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(e){return a.ownerDocument.createElement("<jxgvml:"+e+' class="jxgvml">')}}catch{this.createNode=function(o){return a.ownerDocument.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},g.VMLRenderer.prototype=new E,g.extend(g.VMLRenderer.prototype,{_setAttr:function(a,e,o,s){try{this.container.ownerDocument.documentMode===8?a[e]=o:a.setAttribute(e,o,s)}catch{g.debug("_setAttr: "+e+" "+o+`<br>
`)}},updateTicks:function(a){var e,o,s,t,h,u=this.resolution,d=[];for(o=a.ticks.length,e=0;e<o;e++)t=(s=a.ticks[e])[0],h=s[1],b.isNumber(t[0])&&b.isNumber(t[1])&&d.push(" m "+Math.round(u*t[0])+", "+Math.round(u*h[0])+" l "+Math.round(u*t[1])+", "+Math.round(u*h[1])+" ");b.exists(a.rendNode)||(a.rendNode=this.createPrim("path",a.id),this.appendChildPrim(a.rendNode,b.evaluate(a.visProp.layer))),this._setAttr(a.rendNode,"stroked","true"),this._setAttr(a.rendNode,"strokecolor",b.evaluate(a.visProp.strokecolor),1),this._setAttr(a.rendNode,"strokeweight",b.evaluate(a.visProp.strokewidth)),this._setAttr(a.rendNodeStroke,"opacity",100*b.evaluate(a.visProp.strokeopacity)+"%"),this.updatePathPrim(a.rendNode,d,a.board)},displayCopyright:function(a,e){var o,s;(o=this.createNode("textbox")).style.position="absolute",this._setAttr(o,"id",this.container.id+"_licenseText"),o.style.left=20,o.style.top=2,o.style.fontSize=e,o.style.color="#356AA0",o.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(o,"opacity","30%"),o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",s=this.container.ownerDocument.createTextNode(a),o.appendChild(s),this.appendChildPrim(o,0)},drawInternalText:function(a){var e;return(e=this.createNode("textbox")).style.position="absolute",a.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(a.rendNodeText),this.appendChildPrim(e,9),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",e},updateInternalText:function(a){var e,o,s,t,h,u,d=a.plaintext,n=this.joinTransforms(a,a.transformations),p=[0,0],f=a.rendNode,v=[],C=a.getAnchorX(),_=a.getAnchorY();if(!isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])){for(C==="right"?p[0]=1:C==="middle"&&(p[0]=.5),_==="bottom"?p[1]=1:_==="middle"&&(p[1]=.5),v[0]=l.matVecMult(n,[1,a.coords.scrCoords[1]-p[0]*a.size[0],a.coords.scrCoords[2]+(1-p[1])*a.size[1]+this.vOffsetText]),v[0][1]/=v[0][0],v[0][2]/=v[0][0],v[1]=l.matVecMult(n,[1,a.coords.scrCoords[1]+(1-p[0])*a.size[0],a.coords.scrCoords[2]+(1-p[1])*a.size[1]+this.vOffsetText]),v[1][1]/=v[1][0],v[1][2]/=v[1][0],v[2]=l.matVecMult(n,[1,a.coords.scrCoords[1]+(1-p[0])*a.size[0],a.coords.scrCoords[2]-p[1]*a.size[1]+this.vOffsetText]),v[2][1]/=v[2][0],v[2][2]/=v[2][0],v[3]=l.matVecMult(n,[1,a.coords.scrCoords[1]-p[0]*a.size[0],a.coords.scrCoords[2]-p[1]*a.size[1]+this.vOffsetText]),v[3][1]/=v[3][0],v[3][2]/=v[3][0],o=v[0][1],t=v[0][1],s=v[0][2],h=v[0][2],u=1;u<4;u++)o=Math.max(o,v[u][1]),t=Math.min(t,v[u][1]),s=Math.max(s,v[u][2]),h=Math.min(h,v[u][2]);e=p[0]===1?Math.floor(a.board.canvasWidth-o):Math.floor(t),a.visPropOld.left!==C+e&&(p[0]===1?(a.rendNode.style.right=e+"px",a.rendNode.style.left="auto"):(a.rendNode.style.left=e+"px",a.rendNode.style.right="auto"),a.visPropOld.left=C+e),e=p[1]===1?Math.floor(a.board.canvasHeight-s):Math.floor(h),a.visPropOld.top!==_+e&&(p[1]===1?(a.rendNode.style.bottom=e+"px",a.rendNode.style.top="auto"):(a.rendNode.style.top=e+"px",a.rendNode.style.bottom="auto"),a.visPropOld.top=_+e)}a.htmlStr!==d&&(a.rendNodeText.data=d,a.htmlStr=d),f.filters.item(0).M11=n[1][1],f.filters.item(0).M12=n[1][2],f.filters.item(0).M21=n[2][1],f.filters.item(0).M22=n[2][2],f.filters.item(0).enabled=!0},drawImage:function(a){var e;(e=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(e,"id",this.container.id+"_"+a.id),this.container.appendChild(e),this.appendChildPrim(e,b.evaluate(a.visProp.layer)),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",a.rendNode=e,this.updateImage(a)},transformImage:function(a,e){var o,s,t,h,u,d,n=a.rendNode,p=[];if(e.length>0){for(o=this.joinTransforms(a,e),p[0]=l.matVecMult(o,a.coords.scrCoords),p[0][1]/=p[0][0],p[0][2]/=p[0][0],p[1]=l.matVecMult(o,[1,a.coords.scrCoords[1]+a.size[0],a.coords.scrCoords[2]]),p[1][1]/=p[1][0],p[1][2]/=p[1][0],p[2]=l.matVecMult(o,[1,a.coords.scrCoords[1]+a.size[0],a.coords.scrCoords[2]-a.size[1]]),p[2][1]/=p[2][0],p[2][2]/=p[2][0],p[3]=l.matVecMult(o,[1,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1]]),p[3][1]/=p[3][0],p[3][2]/=p[3][0],s=p[0][1],h=p[0][1],t=p[0][2],u=p[0][2],d=1;d<4;d++)s=Math.max(s,p[d][1]),h=Math.min(h,p[d][1]),t=Math.max(t,p[d][2]),u=Math.min(u,p[d][2]);n.style.left=Math.floor(h)+"px",n.style.top=Math.floor(u)+"px",n.filters.item(0).M11=o[1][1],n.filters.item(0).M12=o[1][2],n.filters.item(0).M21=o[2][1],n.filters.item(0).M22=o[2][2],n.filters.item(0).enabled=!0}},updateImageURL:function(a){var e=b.evaluate(a.url);this._setAttr(a.rendNode,"src",e)},appendChildPrim:function(a,e){return b.exists(e)||(e=0),a.style.zIndex=e,this.container.appendChild(a),a},appendNodesToElement:function(a,e){e!=="shape"&&e!=="path"&&e!=="polygon"||(a.rendNodePath=this.getElementById(a.id+"_path")),a.rendNodeFill=this.getElementById(a.id+"_fill"),a.rendNodeStroke=this.getElementById(a.id+"_stroke"),a.rendNodeShadow=this.getElementById(a.id+"_shadow"),a.rendNode=this.getElementById(a.id)},createPrim:function(a,e){var o,s,t=this.createNode("fill"),h=this.createNode("stroke"),u=this.createNode("shadow");return this._setAttr(t,"id",this.container.id+"_"+e+"_fill"),this._setAttr(h,"id",this.container.id+"_"+e+"_stroke"),this._setAttr(u,"id",this.container.id+"_"+e+"_shadow"),a==="circle"||a==="ellipse"?((o=this.createNode("oval")).appendChild(t),o.appendChild(h),o.appendChild(u)):a==="polygon"||a==="path"||a==="shape"||a==="line"?((o=this.createNode("shape")).appendChild(t),o.appendChild(h),o.appendChild(u),s=this.createNode("path"),this._setAttr(s,"id",this.container.id+"_"+e+"_path"),o.appendChild(s)):((o=this.createNode(a)).appendChild(t),o.appendChild(h),o.appendChild(u)),o.style.position="absolute",o.style.left="0px",o.style.top="0px",this._setAttr(o,"id",this.container.id+"_"+e),o},remove:function(a){b.exists(a)&&a.removeNode(!0)},makeArrows:function(a){var e,o=b.evaluate(a.visProp.firstarrow),s=b.evaluate(a.visProp.lastarrow);a.visPropOld.firstarrow===o&&a.visPropOld.lastarrow===s||(o?(e=a.rendNodeStroke,this._setAttr(e,"startarrow","block"),this._setAttr(e,"startarrowlength","long")):(e=a.rendNodeStroke,b.exists(e)&&this._setAttr(e,"startarrow","none")),s?(e=a.rendNodeStroke,this._setAttr(e,"id",this.container.id+"_"+a.id+"stroke"),this._setAttr(e,"endarrow","block"),this._setAttr(e,"endarrowlength","long")):(e=a.rendNodeStroke,b.exists(e)&&this._setAttr(e,"endarrow","none")),a.visPropOld.firstarrow=o,a.visPropOld.lastarrow=s)},updateEllipsePrim:function(a,e,o,s,t){a.style.left=Math.floor(e-s)+"px",a.style.top=Math.floor(o-t)+"px",a.style.width=Math.floor(2*Math.abs(s))+"px",a.style.height=Math.floor(2*Math.abs(t))+"px"},updateLinePrim:function(a,e,o,s,t,h){var u,d=this.resolution;isNaN(e+o+s+t)||(u=["m ",Math.floor(d*e),", ",Math.floor(d*o)," l ",Math.floor(d*s),", ",Math.floor(d*t)],this.updatePathPrim(a,u,h))},updatePathPrim:function(a,e,o){var s=o.canvasWidth,t=o.canvasHeight;e.length<=0&&(e=["m 0,0"]),a.style.width=s,a.style.height=t,this._setAttr(a,"coordsize",[Math.floor(this.resolution*s),Math.floor(this.resolution*t)].join(",")),this._setAttr(a,"path",e.join(""))},updatePathStringPoint:function(a,e,o){var s=[],t=Math.round,h=a.coords.scrCoords,u=e*Math.sqrt(3)*.5,d=.5*e,n=this.resolution;return o==="x"?s.push([" m ",t(n*(h[1]-e)),", ",t(n*(h[2]-e))," l ",t(n*(h[1]+e)),", ",t(n*(h[2]+e))," m ",t(n*(h[1]+e)),", ",t(n*(h[2]-e))," l ",t(n*(h[1]-e)),", ",t(n*(h[2]+e))].join("")):o==="+"?s.push([" m ",t(n*(h[1]-e)),", ",t(n*h[2])," l ",t(n*(h[1]+e)),", ",t(n*h[2])," m ",t(n*h[1]),", ",t(n*(h[2]-e))," l ",t(n*h[1]),", ",t(n*(h[2]+e))].join("")):o==="<>"?s.push([" m ",t(n*(h[1]-e)),", ",t(n*h[2])," l ",t(n*h[1]),", ",t(n*(h[2]+e))," l ",t(n*(h[1]+e)),", ",t(n*h[2])," l ",t(n*h[1]),", ",t(n*(h[2]-e))," x e "].join("")):o==="^"?s.push([" m ",t(n*h[1]),", ",t(n*(h[2]-e))," l ",t(n*(h[1]-u)),", ",t(n*(h[2]+d))," l ",t(n*(h[1]+u)),", ",t(n*(h[2]+d))," x e "].join("")):o==="v"?s.push([" m ",t(n*h[1]),", ",t(n*(h[2]+e))," l ",t(n*(h[1]-u)),", ",t(n*(h[2]-d))," l ",t(n*(h[1]+u)),", ",t(n*(h[2]-d))," x e "].join("")):o===">"?s.push([" m ",t(n*(h[1]+e)),", ",t(n*h[2])," l ",t(n*(h[1]-d)),", ",t(n*(h[2]-u))," l ",t(n*(h[1]-d)),", ",t(n*(h[2]+u))," l ",t(n*(h[1]+e)),", ",t(n*h[2])].join("")):o==="<"&&s.push([" m ",t(n*(h[1]-e)),", ",t(n*h[2])," l ",t(n*(h[1]+d)),", ",t(n*(h[2]-u))," l ",t(n*(h[1]+d)),", ",t(n*(h[2]+u))," x e "].join("")),s},updatePathStringPrim:function(a){var e,o,s=[],t=this.resolution,h=Math.round,u=" m ",d=u,n=Math.min(a.numberPoints,8192);if(a.numberPoints<=0)return"";if(n=Math.min(n,a.points.length),a.bezierDegree===1)for(e=0;e<n;e++)o=a.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?d=u:(o[1]>2e4?o[1]=2e4:o[1]<-2e4&&(o[1]=-2e4),o[2]>2e4?o[2]=2e4:o[2]<-2e4&&(o[2]=-2e4),s.push([d,h(t*o[1]),", ",h(t*o[2])].join("")),d=" l ");else if(a.bezierDegree===3)for(e=0;e<n;)o=a.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?d=u:(s.push([d,h(t*o[1]),", ",h(t*o[2])].join("")),d===" c "&&(e+=1,o=a.points[e].scrCoords,s.push([" ",h(t*o[1]),", ",h(t*o[2])].join("")),e+=1,o=a.points[e].scrCoords,s.push([" ",h(t*o[1]),", ",h(t*o[2])].join(""))),d=" c "),e+=1;return s.push(" e"),s},updatePathStringBezierPrim:function(a){var e,o,s,t,h,u,d=[],n=b.evaluate(a.visProp.strokewidth),p=this.resolution,f=Math.round,v=" m ",C=v,_=b.evaluate(a.visProp.curvetype)!=="plot",P=Math.min(a.numberPoints,8192);if(a.numberPoints<=0)return"";for(_&&a.board.options.curve.RDPsmoothing&&(a.points=c.RamerDouglasPeucker(a.points,1)),P=Math.min(P,a.points.length),o=1;o<3;o++)for(C=v,e=0;e<P;e++)t=a.points[e].scrCoords,isNaN(t[1])||isNaN(t[2])?C=v:(t[1]>2e4?t[1]=2e4:t[1]<-2e4&&(t[1]=-2e4),t[2]>2e4?t[2]=2e4:t[2]<-2e4&&(t[2]=-2e4),C===v?d.push([C,f(p*t[1])," ",f(p*t[2])].join("")):(s=2*o,d.push([C,f(p*(h+.333*(t[1]-h)+n*(s*Math.random()-o)))," ",f(p*(u+.333*(t[2]-u)+n*(s*Math.random()-o)))," ",f(p*(h+.666*(t[1]-h)+n*(s*Math.random()-o)))," ",f(p*(u+.666*(t[2]-u)+n*(s*Math.random()-o)))," ",f(p*t[1])," ",f(p*t[2])].join(""))),C=" c ",h=t[1],u=t[2]);return d.push(" e"),d},updatePolygonPrim:function(a,e){var o,s,t=e.vertices.length,h=this.resolution,u=[];if(this._setAttr(a,"stroked","false"),s=e.vertices[0].coords.scrCoords,!isNaN(s[1]+s[2])){for(u.push(["m ",Math.floor(h*s[1]),",",Math.floor(h*s[2])," l "].join("")),o=1;o<t-1;o++){if(!e.vertices[o].isReal)return void this.updatePathPrim(a,"",e.board);if(s=e.vertices[o].coords.scrCoords,isNaN(s[1]+s[2]))return;u.push(Math.floor(h*s[1])+","+Math.floor(h*s[2])),o<t-2&&u.push(", ")}u.push(" x e"),this.updatePathPrim(a,u,e.board)}},updateRectPrim:function(a,e,o,s,t){a.style.left=Math.floor(e)+"px",a.style.top=Math.floor(o)+"px",s>=0&&(a.style.width=s+"px"),t>=0&&(a.style.height=t+"px")},setPropertyPrim:function(a,e,o){var s,t="";switch(e){case"stroke":t="strokecolor";break;case"stroke-width":t="strokeweight";break;case"stroke-dasharray":t="dashstyle"}t!==""&&(s=b.evaluate(o),this._setAttr(a,t,s))},display:function(a,e){a&&a.rendNode&&(a.visPropOld.visible=e,a.rendNode.style.visibility=e?"inherit":"hidden")},show:function(a){g.deprecated("Board.renderer.show()","Board.renderer.display()"),a&&a.rendNode&&(a.rendNode.style.visibility="inherit")},hide:function(a){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),a&&a.rendNode&&(a.rendNode.style.visibility="hidden")},setDashStyle:function(a,e){var o;e.dash>=0&&(o=a.rendNodeStroke,this._setAttr(o,"dashstyle",this.dashArray[e.dash]))},setGradient:function(a){var e=a.rendNodeFill,o=b.evaluate(a.visProp.gradient);o==="linear"?(this._setAttr(e,"type","gradient"),this._setAttr(e,"color2",b.evaluate(a.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",b.evaluate(a.visProp.gradientsecondopacity)),this._setAttr(e,"angle",b.evaluate(a.visProp.gradientangle))):o==="radial"?(this._setAttr(e,"type","gradientradial"),this._setAttr(e,"color2",b.evaluate(a.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",b.evaluate(a.visProp.gradientsecondopacity)),this._setAttr(e,"focusposition",100*b.evaluate(a.visProp.gradientpositionx)+"%,"+100*b.evaluate(a.visProp.gradientpositiony)+"%"),this._setAttr(e,"focussize","0,0")):this._setAttr(e,"type","solid")},setObjectFillColor:function(a,e,o){var s,t,h,u=b.evaluate(e),d=b.evaluate(o),n=a.rendNode;d=d>0?d:0,a.visPropOld.fillcolor===u&&a.visPropOld.fillopacity===d||(b.exists(u)&&u!==!1&&(u.length!==9?(s=u,h=d):(s=(t=m.rgba2rgbo(u))[0],h=d*t[1]),s==="none"||s===!1?this._setAttr(a.rendNode,"filled","false"):(this._setAttr(a.rendNode,"filled","true"),this._setAttr(a.rendNode,"fillcolor",s),b.exists(h)&&a.rendNodeFill&&this._setAttr(a.rendNodeFill,"opacity",100*h+"%")),a.type===y.OBJECT_TYPE_IMAGE&&n.filters.length>1&&(n.filters.item(1).opacity=Math.round(100*h),n.filters.item(1).enabled=!0)),a.visPropOld.fillcolor=u,a.visPropOld.fillopacity=d)},setObjectStrokeColor:function(a,e,o){var s,t,h,u,d=b.evaluate(e),n=b.evaluate(o),p=a.rendNode;n=n>0?n:0,a.visPropOld.strokecolor===d&&a.visPropOld.strokeopacity===n||(b.exists(d)&&d!==!1&&(d.length!==9?(s=d,h=n):(s=(t=e.rgba2rgbo(d))[0],h=n*t[1]),a.elementClass===y.OBJECT_CLASS_TEXT?(p.filters.length>1&&(p.filters.item(1).opacity=Math.round(100*h),p.filters.item(1).enabled=!0),p.style.color=s):(s!==!1&&(this._setAttr(p,"stroked","true"),this._setAttr(p,"strokecolor",s)),u=a.rendNodeStroke,b.exists(h)&&a.type!==y.OBJECT_TYPE_IMAGE&&this._setAttr(u,"opacity",100*h+"%"))),a.visPropOld.strokecolor=d,a.visPropOld.strokeopacity=n)},setObjectStrokeWidth:function(a,e){var o,s=b.evaluate(e);isNaN(s)||a.visPropOld.strokewidth===s||(o=a.rendNode,this.setPropertyPrim(o,"stroked","true"),b.exists(s)&&(this.setPropertyPrim(o,"stroke-width",s),s===0&&b.exists(a.rendNodeStroke)&&this._setAttr(o,"stroked","false")),a.visPropOld.strokewidth=s)},setShadow:function(a){var e=a.rendNodeShadow,o=b.evaluate(a.visProp.shadow);e&&a.visPropOld.shadow!==o&&(o?(this._setAttr(e,"On","True"),this._setAttr(e,"Offset","3pt,3pt"),this._setAttr(e,"Opacity","60%"),this._setAttr(e,"Color","#aaaaaa")):this._setAttr(e,"On","False"),a.visPropOld.shadow=o)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),g.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(g,E,y,b,m,l,c,a,e,o,s){return g.CanvasRenderer=function(t,h){if(this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=l.genUUID(),this.canvasNamespace=null,b.isBrowser)this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',h.width,'px" height="',h.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.canvasRoot.style.display="block",this.context=this.canvasRoot.getContext("2d");else if(b.isNode())try{this.canvasId=module.require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")}catch{console.log("Warning: 'canvas' not found. You might need to call 'npm install canvas'")}this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},g.CanvasRenderer.prototype=new E,g.extend(g.CanvasRenderer.prototype,{_drawPolygon:function(t,h,u){var d,n=t.length,p=this.context;if(n>0){if(u&&(p.lineWidth=0),p.beginPath(),p.moveTo(t[0][0],t[0][1]),h===1)for(d=1;d<n;d++)p.lineTo(t[d][0],t[d][1]);else for(d=1;d<n;d+=3)p.bezierCurveTo(t[d][0],t[d][1],t[d+1][0],t[d+1][1],t[d+2][0],t[d+2][1]);u?(p.lineTo(t[0][0],t[0][1]),p.closePath(),p.fill("evenodd")):p.stroke()}},_fill:function(t){var h=this.context;h.save(),this._setColor(t,"fill")&&h.fill("evenodd"),h.restore()},_rotatePoint:function(t,h,u){return[h*Math.cos(t)-u*Math.sin(t),h*Math.sin(t)+u*Math.cos(t)]},_rotateShape:function(t,h){var u,d=[],n=t.length;if(n<=0)return t;for(u=0;u<n;u++)d.push(this._rotatePoint(h,t[u][0],t[u][1]));return d},updateGradientAngle:function(t,h){var u,d,n,p,f,v,C,_,P,x,S,O,w=1,T=Math.cos(-h),M=Math.sin(-h),N=t.getBoundingBox();return Math.abs(T)>Math.abs(M)?w/=Math.abs(T):w/=Math.abs(M),T>=0?(n=0,p=T*w):(n=-T*w,p=0),M>=0?(f=0,v=M*w):(f=-M*w,v=0),u=new a(y.COORDS_BY_USER,[N[0],N[1]],t.board),S=(d=new a(y.COORDS_BY_USER,[N[2],N[3]],t.board)).scrCoords[1]-u.scrCoords[1],O=d.scrCoords[2]-u.scrCoords[2],C=u.scrCoords[1]+S*n,P=u.scrCoords[2]+O*f,_=u.scrCoords[1]+S*p,x=u.scrCoords[2]+O*v,this.context.createLinearGradient(C,P,_,x)},updateGradientCircle:function(t,h,u,d,n,p,f){var v,C,_,P,x,S,O,w,T,M,N=t.getBoundingBox();return v=new a(y.COORDS_BY_USER,[N[0],N[1]],t.board),T=(C=new a(y.COORDS_BY_USER,[N[2],N[3]],t.board)).scrCoords[1]-v.scrCoords[1],M=v.scrCoords[2]-C.scrCoords[2],_=v.scrCoords[1]+T*h,P=C.scrCoords[2]+M*u,S=v.scrCoords[1]+T*n,O=C.scrCoords[2]+M*p,x=d*(T+M)*.5,w=f*(T+M)*.5,this.context.createRadialGradient(S,O,w,_,P,x)},updateGradient:function(t){var h,u,d,n=m.evaluate(t.visProp.gradient);return u=(u=m.evaluate(t.visProp.fillopacity))>0?u:0,h=m.evaluate(t.visProp.fillcolor),n==="linear"?d=this.updateGradientAngle(t,m.evaluate(t.visProp.gradientangle)):n==="radial"&&(d=this.updateGradientCircle(t,m.evaluate(t.visProp.gradientcx),m.evaluate(t.visProp.gradientcy),m.evaluate(t.visProp.gradientr),m.evaluate(t.visProp.gradientfx),m.evaluate(t.visProp.gradientfy),m.evaluate(t.visProp.gradientfr))),d.addColorStop(m.evaluate(t.visProp.gradientstartoffset),h),d.addColorStop(m.evaluate(t.visProp.gradientendoffset),m.evaluate(t.visProp.gradientsecondcolor)),d},_setColor:function(t,h,u){var d,n,p,f,v,C,_,P,x=!0,S=t.visProp;return h=h||"stroke",u=u||h,d=this._getHighlighted(t),(P=m.evaluate(t.visProp.gradient))==="linear"||P==="radial"?(this.context[u+"Style"]=this.updateGradient(t),x):((p=m.evaluate(S[d+h+"color"]))!=="none"&&p!==!1?(C=(C=m.evaluate(S[d+h+"opacity"]))>0?C:0,p.length!==9?(v=p,_=C):(v=(f=c.rgba2rgbo(p))[0],_=C*f[1]),this.context.globalAlpha=_,this.context[u+"Style"]=v):x=!1,n=parseFloat(m.evaluate(S[d+"strokewidth"])),h!=="stroke"||isNaN(n)||(n===0?this.context.globalAlpha=0:this.context.lineWidth=n),h==="stroke"&&S.linecap!==void 0&&S.linecap!==""&&(this.context.lineCap=S.linecap),x)},_stroke:function(t){var h=this.context,u=m.evaluate(t.visProp.dash);h.save(),u>0?h.setLineDash&&h.setLineDash(this.dashArray[u]):this.context.lineDashArray=[],this._setColor(t,"stroke")&&h.stroke(),h.restore()},_translateShape:function(t,h,u){var d,n=[],p=t.length;if(p<=0)return t;for(d=0;d<p;d++)n.push([t[d][0]+h,t[d][1]+u]);return n},drawPoint:function(t){var h=m.evaluate(t.visProp.face),u=m.evaluate(t.visProp.size),d=t.coords.scrCoords,n=u*Math.sqrt(3)*.5,p=.5*u,f=parseFloat(m.evaluate(t.visProp.strokewidth))/2,v=this.context;if(t.visPropCalc.visible)switch(h){case"cross":case"x":v.beginPath(),v.moveTo(d[1]-u,d[2]-u),v.lineTo(d[1]+u,d[2]+u),v.moveTo(d[1]+u,d[2]-u),v.lineTo(d[1]-u,d[2]+u),v.lineCap="round",v.lineJoin="round",v.closePath(),this._stroke(t);break;case"circle":case"o":v.beginPath(),v.arc(d[1],d[2],u+1+f,0,2*Math.PI,!1),v.closePath(),this._fill(t),this._stroke(t);break;case"square":case"[]":if(u<=0)break;v.save(),this._setColor(t,"stroke","fill")&&v.fillRect(d[1]-u-f,d[2]-u-f,2*u+3*f,2*u+3*f),v.restore(),v.save(),this._setColor(t,"fill"),v.fillRect(d[1]-u+f,d[2]-u+f,2*u-f,2*u-f),v.restore();break;case"plus":case"+":v.beginPath(),v.moveTo(d[1]-u,d[2]),v.lineTo(d[1]+u,d[2]),v.moveTo(d[1],d[2]-u),v.lineTo(d[1],d[2]+u),v.lineCap="round",v.lineJoin="round",v.closePath(),this._stroke(t);break;case"diamond":case"<>":v.beginPath(),v.moveTo(d[1]-u,d[2]),v.lineTo(d[1],d[2]+u),v.lineTo(d[1]+u,d[2]),v.lineTo(d[1],d[2]-u),v.closePath(),this._fill(t),this._stroke(t);break;case"triangleup":case"a":case"^":v.beginPath(),v.moveTo(d[1],d[2]-u),v.lineTo(d[1]-n,d[2]+p),v.lineTo(d[1]+n,d[2]+p),v.closePath(),this._fill(t),this._stroke(t);break;case"triangledown":case"v":v.beginPath(),v.moveTo(d[1],d[2]+u),v.lineTo(d[1]-n,d[2]-p),v.lineTo(d[1]+n,d[2]-p),v.closePath(),this._fill(t),this._stroke(t);break;case"triangleleft":case"<":v.beginPath(),v.moveTo(d[1]-u,d[2]),v.lineTo(d[1]+p,d[2]-n),v.lineTo(d[1]+p,d[2]+n),v.closePath(),this._fill(t),this._stroke(t);break;case"triangleright":case">":v.beginPath(),v.moveTo(d[1]+u,d[2]),v.lineTo(d[1]-p,d[2]-n),v.lineTo(d[1]-p,d[2]+n),v.closePath(),this._fill(t),this._stroke(t)}},updatePoint:function(t){this.drawPoint(t)},drawArrows:function(t,h,u,d,n){var p,f,v,C,_,P,x,S,O,w,T,M,N,A,R,L,D,k,B,j,I=this.context,q=1,$=1,Z=1,V=n.evFirst,U=n.evLast;if(m.evaluate(t.visProp.strokecolor)!=="none"&&(V||U)){if(t.elementClass===y.OBJECT_CLASS_LINE)p=h.scrCoords[1],f=h.scrCoords[2],v=u.scrCoords[1],C=u.scrCoords[2],B=j=Math.atan2(C-f,v-p);else{if(p=t.points[0].scrCoords[1],f=t.points[0].scrCoords[2],(k=t.points.length-1)<1)return;v=t.points[t.points.length-1].scrCoords[1],C=t.points[t.points.length-1].scrCoords[2],A=t.points[1].scrCoords[1]-t.points[0].scrCoords[1],R=t.points[1].scrCoords[2]-t.points[0].scrCoords[2],L=t.points[k].scrCoords[1]-t.points[k-1].scrCoords[1],D=t.points[k].scrCoords[2]-t.points[k-1].scrCoords[2],V&&(B=Math.atan2(R,A)),U&&(j=Math.atan2(D,L))}if(_=m.evaluate(t.visProp[d+"strokewidth"]),V)if(P=_*n.sizeFirst,O=q=n.typeFirst,q===2)S=[[P,.5*-P],[0,0],[P,.5*P],[.5*P,0]];else if(q===3)S=[[P/3,.5*-P],[0,.5*-P],[0,.5*P],[P/3,.5*P]];else if(q===4)for(P/=10,$=3,N=(S=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,M=0;M<N;M++)S[M][0]*=-P,S[M][1]*=P,S[M][0]+=10*P,S[M][1]-=3.31*P;else if(q===5)for(P/=10,$=3,N=(S=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,M=0;M<N;M++)S[M][0]*=-P,S[M][1]*=P,S[M][0]+=10*P,S[M][1]-=3.28*P;else if(q===6)for(P/=10,$=3,N=(S=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,M=0;M<N;M++)S[M][0]*=-P,S[M][1]*=P,S[M][0]+=10*P,S[M][1]-=2.84*P;else if(q===7)for(P=_,$=3,N=(S=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,M=0;M<N;M++)S[M][0]*=-P,S[M][1]*=P,S[M][0]+=10*P,S[M][1]-=5.2*P;else S=[[P,.5*-P],[0,0],[P,.5*P]];if(U)if(P=_*n.sizeLast,w=q=n.typeLast,q===2)x=[[-P,.5*-P],[0,0],[-P,.5*P],[.5*-P,0]];else if(q===3)x=[[-P/3,.5*-P],[0,.5*-P],[0,.5*P],[-P/3,.5*P]];else if(q===4)for(P/=10,Z=3,N=(x=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,M=0;M<N;M++)x[M][0]*=P,x[M][1]*=P,x[M][0]-=10*P,x[M][1]-=3.31*P;else if(q===5)for(P/=10,Z=3,N=(x=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,M=0;M<N;M++)x[M][0]*=P,x[M][1]*=P,x[M][0]-=10*P,x[M][1]-=3.28*P;else if(q===6)for(P/=10,Z=3,N=(x=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,M=0;M<N;M++)x[M][0]*=P,x[M][1]*=P,x[M][0]-=10*P,x[M][1]-=2.84*P;else if(q===7)for(P=_,Z=3,N=(x=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,M=0;M<N;M++)x[M][0]*=P,x[M][1]*=P,x[M][0]-=10*P,x[M][1]-=5.2*P;else x=[[-P,.5*-P],[0,0],[-P,.5*P]];I.save(),this._setColor(t,"stroke","fill")&&(this._setColor(t,"stroke"),V&&(T=O!==7,this._drawPolygon(this._translateShape(this._rotateShape(S,B),p,f),$,T)),U&&(T=w!==7,this._drawPolygon(this._translateShape(this._rotateShape(x,j),v,C),Z,T))),I.restore()}},drawLine:function(t){var h,u,d,n,p,f=new a(y.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),v=new a(y.COORDS_BY_USER,t.point2.coords.usrCoords,t.board),C=null;t.visPropCalc.visible&&(d=this._getHighlighted(t),n=m.evaluate(t.visProp[d+"strokewidth"]),((p=this.getArrowHeadData(t,n,d)).evFirst||p.evLast)&&(C=-4),o.calcStraight(t,f,v,C),this.handleTouchpoints(t,f,v,p),h=new a(y.COORDS_BY_USER,f.usrCoords,t.board),u=new a(y.COORDS_BY_USER,v.usrCoords,t.board),this.getPositionArrowHead(t,f,v,p),this.context.beginPath(),this.context.moveTo(f.scrCoords[1],f.scrCoords[2]),this.context.lineTo(v.scrCoords[1],v.scrCoords[2]),this._stroke(t),(p.evFirst||p.evLast)&&this.drawArrows(t,h,u,d,p))},updateLine:function(t){this.drawLine(t)},drawTicks:function(){},updateTicks:function(t){var h,u,d,n,p,f,v=t.ticks.length,C=this.context;for(C.beginPath(),h=0;h<v;h++)for(d=(u=t.ticks[h])[0],n=u[1],p=d.length,C.moveTo(d[0],n[0]),f=1;f<p;++f)C.lineTo(d[f],n[f]);C.lineCap="round",this._stroke(t)},drawCurve:function(t){var h,u,d;m.evaluate(t.visProp.handdrawing)?this.updatePathStringBezierPrim(t):this.updatePathStringPrim(t),t.numberPoints>1&&(h=this._getHighlighted(t),u=m.evaluate(t.visProp[h+"strokewidth"]),((d=this.getArrowHeadData(t,u,h)).evFirst||d.evLast)&&this.drawArrows(t,null,null,h,d))},updateCurve:function(t){this.drawCurve(t)},drawEllipse:function(t){var h=t.center.coords.scrCoords[1],u=t.center.coords.scrCoords[2],d=t.board.unitX,n=t.board.unitY,p=2*t.Radius(),f=2*t.Radius(),v=p*d,C=f*n,_=h-v/2,P=u-C/2,x=v/2*.5522848,S=C/2*.5522848,O=_+v,w=P+C,T=_+v/2,M=P+C/2,N=this.context;p>0&&f>0&&!isNaN(h+u)&&(N.beginPath(),N.moveTo(_,M),N.bezierCurveTo(_,M-S,T-x,P,T,P),N.bezierCurveTo(T+x,P,O,M-S,O,M),N.bezierCurveTo(O,M+S,T+x,w,T,w),N.bezierCurveTo(T-x,w,_,M+S,_,M),N.closePath(),this._fill(t),this._stroke(t))},updateEllipse:function(t){return this.drawEllipse(t)},displayCopyright:function(t,h){var u=this.context;u.save(),u.font=h+"px Arial",u.fillStyle="#aaa",u.lineWidth=.5,u.fillText(t,10,2+h),u.restore()},drawInternalText:function(t){var h=m.evaluate(t.visProp.fontsize),u=m.evaluate(t.visProp.fontunit),d=t.getAnchorX(),n=t.getAnchorY(),p=this.context;return p.save(),this._setColor(t,"stroke","fill")&&!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])&&(p.font=(h>0?h:0)+u+" Arial",this.transformImage(t,t.transformations),d==="left"?p.textAlign="left":d==="right"?p.textAlign="right":d==="middle"&&(p.textAlign="center"),n==="bottom"?p.textBaseline="bottom":n==="top"?p.textBaseline="top":n==="middle"&&(p.textBaseline="middle"),p.fillText(t.plaintext,t.coords.scrCoords[1],t.coords.scrCoords[2])),p.restore(),null},updateInternalText:function(t){this.drawInternalText(t)},setObjectStrokeColor:function(t,h,u){var d,n,p,f,v=m.evaluate(h),C=m.evaluate(u);C=C>0?C:0,t.visPropOld.strokecolor===v&&t.visPropOld.strokeopacity===C||(m.exists(v)&&v!==!1&&(v.length!==9?(d=v,p=C):(d=(n=c.rgba2rgbo(v))[0],p=C*n[1]),f=t.rendNode,t.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(t.visProp.display)==="html"&&(f.style.color=d,f.style.opacity=p)),t.visPropOld.strokecolor=v,t.visPropOld.strokeopacity=C)},drawImage:function(t){t.rendNode=new Image,t._src="",this.updateImage(t)},updateImage:function(t){var h=this.context,u=m.evaluate(t.visProp.fillopacity),d=m.bind(function(){t.imgIsLoaded=!0,t.size[0]<=0||t.size[1]<=0||(h.save(),h.globalAlpha=u,this.transformImage(t,t.transformations),h.drawImage(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),h.restore())},this);this.updateImageURL(t)?t.rendNode.onload=d:t.imgIsLoaded&&d()},transformImage:function(t,h){var u,d=h.length,n=this.context;d>0&&(u=this.joinTransforms(t,h),Math.abs(s.det(u))>=e.eps&&n.transform(u[1][1],u[2][1],u[1][2],u[2][2],u[1][0],u[2][0]))},updateImageURL:function(t){var h;return h=m.evaluate(t.url),t._src!==h&&(t.imgIsLoaded=!1,t.rendNode.src=h,t._src=h,!0)},remove:function(t){m.exists(t)&&m.exists(t.parentNode)&&t.parentNode.removeChild(t)},updatePathStringPrim:function(t){var h,u,d,n,p,f="M",v=f,C=5e3,_=this.context;if(!(t.numberPoints<=0)){if(p=Math.min(t.points.length,t.numberPoints),_.beginPath(),t.bezierDegree===1)for(h=0;h<p;h++)u=t.points[h].scrCoords,isNaN(u[1])||isNaN(u[2])?v=f:(u[1]>C?u[1]=C:u[1]<-5e3&&(u[1]=-5e3),u[2]>C?u[2]=C:u[2]<-5e3&&(u[2]=-5e3),v===f?_.moveTo(u[1],u[2]):_.lineTo(u[1],u[2]),v="L");else if(t.bezierDegree===3)for(h=0;h<p;)u=t.points[h].scrCoords,isNaN(u[1])||isNaN(u[2])?v=f:(v===f?_.moveTo(u[1],u[2]):(h+=1,d=t.points[h].scrCoords,h+=1,n=t.points[h].scrCoords,_.bezierCurveTo(u[1],u[2],d[1],d[2],n[1],n[2])),v="C"),h+=1;_.lineCap="round",this._fill(t),this._stroke(t)}},updatePathStringBezierPrim:function(t){var h,u,d,n,p,f,v,C="M",_=C,P=5e3,x=m.evaluate(t.visProp.strokewidth),S=m.evaluate(t.visProp.curvetype)!=="plot",O=this.context;if(!(t.numberPoints<=0)){for(S&&t.board.options.curve.RDPsmoothing&&(t.points=s.RamerDouglasPeucker(t.points,.5)),v=Math.min(t.points.length,t.numberPoints),O.beginPath(),u=1;u<3;u++)for(_=C,h=0;h<v;h++)n=t.points[h].scrCoords,isNaN(n[1])||isNaN(n[2])?_=C:(n[1]>P?n[1]=P:n[1]<-5e3&&(n[1]=-5e3),n[2]>P?n[2]=P:n[2]<-5e3&&(n[2]=-5e3),_===C?O.moveTo(n[1],n[2]):(d=2*u,O.bezierCurveTo(p+.333*(n[1]-p)+x*(d*Math.random()-u),f+.333*(n[2]-f)+x*(d*Math.random()-u),p+.666*(n[1]-p)+x*(d*Math.random()-u),f+.666*(n[2]-f)+x*(d*Math.random()-u),n[1],n[2])),_="C",p=n[1],f=n[2]);O.lineCap="round",this._fill(t),this._stroke(t)}},updatePolygonPrim:function(t,h){var u,d,n,p=h.vertices.length,f=this.context,v=!0;if(!(p<=0)&&h.visPropCalc.visible){for(h.elType==="polygonalchain"&&p++,f.beginPath(),d=0;!h.vertices[d].isReal&&d<p-1;)d++,v=!1;for(u=h.vertices[d].coords.scrCoords,f.moveTo(u[1],u[2]),n=d;n<p-1;n++)h.vertices[n].isReal||(v=!1),u=h.vertices[n].coords.scrCoords,f.lineTo(u[1],u[2]);f.closePath(),v&&this._fill(h)}},display:function(t,h){t&&t.rendNode&&(t.visPropOld.visible=h,t.rendNode.style.visibility=h?"inherit":"hidden")},show:function(t){g.deprecated("Board.renderer.show()","Board.renderer.display()"),m.exists(t.rendNode)&&(t.rendNode.style.visibility="inherit")},hide:function(t){g.deprecated("Board.renderer.hide()","Board.renderer.display()"),m.exists(t.rendNode)&&(t.rendNode.style.visibility="hidden")},setGradient:function(t){var h;h=(h=m.evaluate(t.visProp.fillopacity))>0?h:0},setShadow:function(t){t.visPropOld.shadow!==t.visProp.shadow&&(t.visPropOld.shadow=t.visProp.shadow)},highlight:function(t){return t.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(t.visProp.display)==="html"?this.updateTextStyle(t,!0):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},noHighlight:function(t){return t.elementClass===y.OBJECT_CLASS_TEXT&&m.evaluate(t.visProp.display)==="html"?this.updateTextStyle(t,!1):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(t){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),t&&t.attr.showcopyright&&this.displayCopyright(g.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(t,h){this.container?(this.canvasRoot.style.width=parseFloat(t)+"px",this.canvasRoot.style.height=parseFloat(h)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(t)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(h)+"px")):(this.canvasRoot.width=2*parseFloat(t),this.canvasRoot.height=2*parseFloat(h)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),g.CanvasRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(g,E){return g.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},g.extend(g.NoRenderer.prototype,{drawPoint:function(y){},updatePoint:function(y){},changePointStyle:function(y){},drawLine:function(y){},updateLine:function(y){},drawTicks:function(y){},updateTicks:function(y){},drawCurve:function(y){},updateCurve:function(y){},drawEllipse:function(y){},updateEllipse:function(y){},drawPolygon:function(y){},updatePolygon:function(y){},displayCopyright:function(y,b){},drawInternalText:function(y){},updateInternalText:function(y){},drawText:function(y){},updateText:function(y){},updateTextStyle:function(y,b){},updateInternalTextStyle:function(y,b,m){},drawImage:function(y){},updateImage:function(y){},transformImage:function(y,b){},updateImageURL:function(y){},appendChildPrim:function(y,b){},appendNodesToElement:function(y,b){},createPrim:function(y,b){return null},remove:function(y){},makeArrows:function(y){},updateEllipsePrim:function(y,b,m,l,c){},updateLinePrim:function(y,b,m,l,c,a){},updatePathPrim:function(y,b,m){},updatePathStringPoint:function(y,b,m){},updatePathStringPrim:function(y){},updatePathStringBezierPrim:function(y){},updatePolygonPrim:function(y,b){},updateRectPrim:function(y,b,m,l,c){},setPropertyPrim:function(y,b,m){},display:function(y,b){y&&(y.visPropOld.visible=b)},show:function(y){},hide:function(y){},setBuffering:function(y,b){},setDashStyle:function(y){},setDraft:function(y){},removeDraft:function(y){},setGradient:function(y){},updateGradient:function(y){},setObjectTransition:function(y,b){},setObjectFillColor:function(y,b,m){},setObjectStrokeColor:function(y,b,m){},setObjectStrokeWidth:function(y,b){},setShadow:function(y){},highlight:function(y){},noHighlight:function(y){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(y){},getElementById:function(y){return null},resize:function(y,b){},removeToInsertLater:function(){return function(){}}}),g.NoRenderer.prototype=new E,g.NoRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(g,E,y,b,m,l,c,a,e,o){return g.JSXGraph={rendererType:(l.board.renderer="no",E.supportsVML()&&(l.board.renderer="vml",document.onmousemove=function(){var s;return document.body&&(s=document.body.scrollLeft,s+=document.body.scrollTop),s}),E.supportsCanvas()&&(l.board.renderer="canvas"),E.supportsSVG()&&(l.board.renderer="svg"),E.isNode()&&E.supportsCanvas()&&(l.board.renderer="canvas"),(E.isNode()||l.renderer==="no")&&(l.text.display="internal",l.infobox.display="internal"),l.board.renderer),initRenderer:function(s,t,h,u){var d;if(y.exists(h)&&h!==!1||typeof document!="object"||(h=document),typeof h=="object"&&s!==null)for(d=h.getElementById(s);d.firstChild;)d.removeChild(d.firstChild);else d=s;return u!==void 0&&u!=="auto"||(u=this.rendererType),u==="svg"?new c(d,t):u==="vml"?new a(d):u==="canvas"?new e(d,t):new o},_setAttributes:function(s){var t=y.copyAttributes(s,l,"board");return t.zoom=y.copyAttributes(t,l,"board","zoom"),t.pan=y.copyAttributes(t,l,"board","pan"),t.drag=y.copyAttributes(t,l,"board","drag"),t.keyboard=y.copyAttributes(t,l,"board","keyboard"),t.selection=y.copyAttributes(t,l,"board","selection"),t.navbar=y.copyAttributes(t.navbar,l,"navbar"),t.screenshot=y.copyAttributes(t,l,"board","screenshot"),t.resize=y.copyAttributes(t,l,"board","resize"),t.fullscreen=y.copyAttributes(t,l,"board","fullscreen"),t.movetarget=s.moveTarget||s.movetarget||l.board.moveTarget,t},_fillBoard:function(s,t,h){s.initInfobox(),s.maxboundingbox=t.maxboundingbox,s.resizeContainer(h.width,h.height,!0,!0),s._createSelectionPolygon(t),s.renderer.drawZoomBar(s,t.navbar),g.boards[s.id]=s},_setARIA:function(s,t){var h,u,d,n,p,f,v=t.document||document;typeof v=="object"&&(h=(u=v.getElementById(s)).ownerDocument,n=u.parentNode,p=s+"_ARIAlabel",f=s+"_ARIAdescription",(d=h.createElement("div")).innerHTML=t.title,d.setAttribute("id",p),d.style.display="none",n.insertBefore(d,u),(d=h.createElement("div")).innerHTML=t.description,d.setAttribute("id",f),d.style.display="none",n.insertBefore(d,u),u.setAttribute("aria-labelledby",p),u.setAttribute("aria-describedby",f))},_removeARIANodes:function(s){var t,h,u;typeof(u=s.document||document)=="object"&&(h=s.containerObj.getAttribute("aria-labelledby"),(t=u.getElementById(h))&&t.parentNode&&t.parentNode.removeChild(t),h=s.containerObj.getAttribute("aria-describedby"),(t=u.getElementById(h))&&t.parentNode&&t.parentNode.removeChild(t))},initBoard:function(s,t){var h,u,d,n,p,f,v,C,_,P,x,S,O,w,T=0,M=0;return t=t||{},P=this._setAttributes(t),C=E.getDimensions(s,P.document),P.unitx||P.unity?(h=y.def(P.originx,150),u=y.def(P.originy,150),d=y.def(P.unitx,50),n=y.def(P.unity,50)):((_=P.boundingbox)[0]<P.maxboundingbox[0]&&(_[0]=P.maxboundingbox[0]),_[1]>P.maxboundingbox[1]&&(_[1]=P.maxboundingbox[1]),_[2]>P.maxboundingbox[2]&&(_[2]=P.maxboundingbox[2]),_[3]<P.maxboundingbox[3]&&(_[3]=P.maxboundingbox[3]),f=parseInt(C.width,10),v=parseInt(C.height,10),y.exists(_)&&P.keepaspectratio?(d=f/(_[2]-_[0]),n=v/(_[1]-_[3]),Math.abs(d)<Math.abs(n)?M=.5*(v/(n=Math.abs(d)*n/Math.abs(n))-(_[1]-_[3])):T=.5*(f/(d=Math.abs(n)*d/Math.abs(d))-(_[2]-_[0]))):(d=f/(_[2]-_[0]),n=v/(_[1]-_[3])),h=-d*(_[0]-T),u=n*(_[1]+M)),p=this.initRenderer(s,C,P.document,P.renderer),this._setARIA(s,P),(w=new b(s,p,P.id,[h,u],P.zoomfactor*P.zoomx,P.zoomfactor*P.zoomy,d,n,C.width,C.height,P)).keepaspectratio=P.keepaspectratio,this._fillBoard(w,P,C),w.suspendUpdate(),P.axis&&(x=typeof P.axis=="object"?P.axis:{},S=y.deepCopy(l.board.defaultAxes.x,x),O=y.deepCopy(l.board.defaultAxes.y,x),P.defaultaxes.x&&(S=y.deepCopy(S,P.defaultaxes.x)),P.defaultaxes.y&&(O=y.deepCopy(O,P.defaultaxes.y)),w.defaultAxes={},w.defaultAxes.x=w.create("axis",[[0,0],[1,0]],S),w.defaultAxes.y=w.create("axis",[[0,0],[0,1]],O)),P.grid&&w.create("grid",[],typeof P.grid=="object"?P.grid:{}),w.unsuspendUpdate(),w},loadBoardFromFile:function(s,t,h,u,d){var n,p,f,v,C;return u=u||{},n=this._setAttributes(u),v=E.getDimensions(s,n.document),p=this.initRenderer(s,v,n.document,n.renderer),this._setARIA(s,n),f=new b(s,p,"",[150,150],1,1,50,50,v.width,v.height,n),this._fillBoard(f,n,v),C=n.encoding||"iso-8859-1",m.parseFileContent(t,f,h,!0,C,d),f},loadBoardFromString:function(s,t,h,u,d){var n,p,f,v;return u=u||{},n=this._setAttributes(u),v=E.getDimensions(s,n.document),p=this.initRenderer(s,v,n.document),this._setARIA(s,n),f=new b(s,p,"",[150,150],1,1,50,50,v.width,v.height,n),this._fillBoard(f,n,v),m.parseString(t,f,h,!0,d),f},freeBoard:function(s){var t;for(t in typeof s=="string"&&(s=g.boards[s]),this._removeARIANodes(s),s.removeEventHandlers(),s.suspendUpdate(),s.objects)s.objects.hasOwnProperty(t)&&s.objects[t].remove();for(;s.containerObj.firstChild;)s.containerObj.removeChild(s.containerObj.firstChild);for(t in s.objects)s.objects.hasOwnProperty(t)&&delete s.objects[t];delete s.renderer,s.jc.creator.clearCache(),delete s.jc,delete g.boards[s.id]},registerElement:function(s,t){g.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),g.registerElement(s,t)}},E.isBrowser&&typeof window=="object"&&typeof document=="object"&&E.addEvent(window,"load",function(){var s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N=!1,A=document.getElementsByTagName("script"),R=function(D,k,B){var j=g.JSXGraph.initBoard(d,{boundingbox:B,keepaspectratio:!0,grid:O,axis:S,showReload:!0});if(k.toLowerCase().indexOf("script")>-1)j.construct(D);else try{j.jc.parse(D)}catch(I){g.debug(I)}return j},L=function(D,k,B,j){return function(){var I;g.JSXGraph.freeBoard(D),(I=R(k,B,j)).reload=L(I,k,B,j)}};for(t=0;t<A.length;t++)if(s=A[t].getAttribute("type",!1),y.exists(s)&&(s.toLowerCase()==="text/jessiescript"||s.toLowerCase()==="jessiescript"||s.toLowerCase()==="text/jessiecode"||s.toLowerCase()==="jessiecode")){if(P=A[t].getAttribute("class",!1)||"",f=A[t].getAttribute("width",!1)||"",v=A[t].getAttribute("height",!1)||"",C=A[t].getAttribute("maxwidth",!1)||"100%",_=A[t].getAttribute("aspectratio",!1)||"1/1",x=A[t].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",d=A[t].getAttribute("container",!1),T=A[t].getAttribute("src",!1),(x=x.split(",")).length!==4)x=[-5,5,5,-5];else for(h=0;h<x.length;h++)x[h]=parseFloat(x[h]);if(S=y.str2Bool(A[t].getAttribute("axis",!1)||"false"),O=y.str2Bool(A[t].getAttribute("grid",!1)||"false"),y.exists(d))u=document.getElementById(d);else{d="jessiescript_autgen_jxg_"+t,(u=document.createElement("div")).setAttribute("id",d),p=f!==""?"width:"+f+";":"",p+=v!==""?"height:"+v+";":"",p+=C!==""?"max-width:"+C+";":"",p+=_!==""?"aspect-ratio:"+_+";":"",u.setAttribute("style",p),u.setAttribute("class","jxgbox "+P);try{document.body.insertBefore(u,A[t])}catch{typeof jQuery=="object"&&jQuery(u).insertBefore(A[t])}}w="",y.exists(T)?(N=!0,(M=new XMLHttpRequest).open("GET",T),M.overrideMimeType("text/plain; charset=x-user-defined"),M.addEventListener("load",function(){if(!(this.status<400))throw new Error(`
JSXGraph: failed to load file`,T,":",this.responseText);w=this.responseText+`
`+w,(n=R(w,s,x)).reload=L(n,w,s,x)}),M.addEventListener("error",function(D){throw new Error(`
JSXGraph: failed to load file`,T,":",D)}),M.send()):N=!1,document.getElementById(d)?(w=(w=A[t].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),A[t].innerHTML=w,N||((n=R(w,s,x)).reload=L(n,w,s,x))):g.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),g.JSXGraph}),define("base/point",["jxg","options","math/math","math/geometry","base/constants","base/element","utils/type","base/coordselement"],function(g,E,y,b,m,l,c,a){return g.Point=function(e,o,s){this.constructor(e,s,m.OBJECT_TYPE_POINT,m.OBJECT_CLASS_POINT),this.element=this.board.select(s.anchor),this.coordsConstructor(o),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createGradient(),this.createLabel()},g.Point.prototype=new l,c.copyPrototypeMethods(g.Point,a,"coordsConstructor"),g.extend(g.Point.prototype,{hasPoint:function(e,o){var s,t,h,u=this.coords.scrCoords,d=c.evaluate(this.visProp.sizeunit);return c.isObject(c.evaluate(this.visProp.precision))?(h=this.board._inputDevice,t=c.evaluate(this.visProp.precision[h])):t=this.board.options.precision.hasPoint,s=parseFloat(c.evaluate(this.visProp.size)),d==="user"&&(s*=Math.sqrt(this.board.unitX*this.board.unitY)),(s+=.5*parseFloat(c.evaluate(this.visProp.strokewidth)))<t&&(s=t),Math.abs(u[1]-e)<s+2&&Math.abs(u[2]-o)<s+2},update:function(e){return this.needsUpdate?(this.updateCoords(e),c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(e){var o,s;if(this.transformations.length===0||this.baseElement===null)return this;for(this===this.baseElement?(o=this.transformations[0].apply(this.baseElement,"self"),this.coords.setCoordinates(m.COORDS_BY_USER,o)):o=this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(m.COORDS_BY_USER,o),s=1;s<this.transformations.length;s++)this.coords.setCoordinates(m.COORDS_BY_USER,this.transformations[s].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(e,o,s,t){var h;e=this.board.select(e),o=this.board.select(o),h=b.intersectionFunction(this.board,e,o,s,t,c.evaluate(this.visProp.alwaysintersect)),this.addConstraint([h]);try{e.addChild(this),o.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof e+"' and '"+typeof o+"'.")}this.type=m.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[e.id,o.id,s,t],this.generatePolynomial=function(){var u=e.generatePolynomial(this),d=o.generatePolynomial(this);return u.length===0||d.length===0?[]:[u[0],d[0]]},this.prepareUpdate().update()},setStyle:function(e){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][e],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][e],this.board.renderer.changePointStyle(this),this},normalizeFace:function(e){return g.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),E.normalizePointFace(e)},face:function(e){g.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:e})},size:function(e){g.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:e})},isOn:function(e,o){var s,t;return o=o||y.eps,c.isPoint(e)?this.Dist(e)<o:e.elementClass===m.OBJECT_CLASS_LINE?(e.elType!=="segment"||c.evaluate(this.visProp.alwaysintersect)||(s=g.Math.Geometry.projectCoordsToSegment(this.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords))[1]>=0&&s[1]<=1)&&b.distPointLine(this.coords.usrCoords,e.stdform)<o:e.elementClass===m.OBJECT_CLASS_CIRCLE?c.evaluate(e.visProp.hasinnerpoints)?this.Dist(e.center)<e.Radius()+o:Math.abs(this.Dist(e.center)-e.Radius())<o:e.elementClass===m.OBJECT_CLASS_CURVE?(t=b.projectPointToCurve(this,e,this.board)[0],b.distance(this.coords.usrCoords,t.usrCoords,3)<o):e.type===m.OBJECT_TYPE_POLYGON?!(!c.evaluate(e.visProp.hasinnerpoints)||!e.pnpoly(this.coords.usrCoords[1],this.coords.usrCoords[2],g.COORDS_BY_USER))||(s=b.projectCoordsToPolygon(this.coords.usrCoords,e),b.distance(this.coords.usrCoords,s,3)<o):e.type===m.OBJECT_TYPE_TURTLE&&(t=b.projectPointToTurtle(this,e,this.board),b.distance(this.coords.usrCoords,t.usrCoords,3)<o)},cloneToBackground:function(){var e={};return e.id=this.id+"T"+this.numTraces,this.numTraces+=1,e.coords=this.coords,e.visProp=c.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.elementClass=m.OBJECT_CLASS_POINT,e.board=this.board,c.clearVisPropOld(e),e.visPropCalc={visible:c.evaluate(e.visProp.visible)},this.board.renderer.drawPoint(e),this.traces[e.id]=e.rendNode,this}}),g.createPoint=function(e,o,s){var t,h;if(h=c.copyAttributes(s,e.options,"point"),!(t=a.create(g.Point,e,o,h)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof o[0]+"' and '"+typeof o[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return t},g.createGlider=function(e,o,s){var t,h,u=c.copyAttributes(s,e.options,"glider");return h=o.length===1?[0,0]:o.slice(0,2),(t=e.create("point",h,u)).makeGlider(o[o.length-1]),t},g.createIntersectionPoint=function(e,o,s){var t,h,u,d,n,p,f=c.copyAttributes(s,e.options,"intersection");o.push(0,0),h=e.select(o[0]),u=e.select(o[1]),n=o[2]||0,p=o[3]||0,t=e.create("point",[0,0,0],f),d=b.intersectionFunction(e,h,u,n,p,t.visProp.alwaysintersect),t.addConstraint([d]);try{h.addChild(t),u.addChild(t)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof o[0]+"' and '"+typeof o[1]+"'.")}return t.type=m.OBJECT_TYPE_INTERSECTION,t.elType="intersection",t.setParents([h.id,u.id]),t.intersectionNumbers=[n,p],t.getParents=function(){return this.parents.concat(this.intersectionNumbers)},t.generatePolynomial=function(){var v=h.generatePolynomial(t),C=u.generatePolynomial(t);return v.length===0||C.length===0?[]:[v[0],C[0]]},t},g.createOtherIntersectionPoint=function(e,o,s){var t,h,u,d;if(o.length!==3||!c.isPoint(o[2])||o[0].elementClass!==m.OBJECT_CLASS_LINE&&o[0].elementClass!==m.OBJECT_CLASS_CIRCLE||o[1].elementClass!==m.OBJECT_CLASS_LINE&&o[1].elementClass!==m.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof o[0]+"',  '"+typeof o[1]+"'and  '"+typeof o[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return h=e.select(o[0]),u=e.select(o[1]),d=e.select(o[2]),(t=e.create("point",[function(){var n=b.meet(h.stdform,u.stdform,0,h.board);return Math.abs(d.X()-n.usrCoords[1])>y.eps||Math.abs(d.Y()-n.usrCoords[2])>y.eps||Math.abs(d.Z()-n.usrCoords[0])>y.eps?n:b.meet(h.stdform,u.stdform,1,h.board)}],s)).type=m.OBJECT_TYPE_INTERSECTION,t.elType="otherintersection",t.setParents([h.id,u.id,d]),h.addChild(t),u.addChild(t),t.generatePolynomial=function(){var n=h.generatePolynomial(t),p=u.generatePolynomial(t);return n.length===0||p.length===0?[]:[n[0],p[0]]},t},g.createPolePoint=function(e,o,s){var t,h,u,d,n,p,f;if(o.length>1&&(d=o[0].type===m.OBJECT_TYPE_CONIC||o[0].elementClass===m.OBJECT_CLASS_CIRCLE,n=o[1].type===m.OBJECT_TYPE_CONIC||o[1].elementClass===m.OBJECT_CLASS_CIRCLE,p=o[0].elementClass===m.OBJECT_CLASS_LINE,f=o[1].elementClass===m.OBJECT_CLASS_LINE),o.length!==2||!(d&&f||p&&n))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof o[0]+"' and '"+typeof o[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return f?(h=e.select(o[0]),u=e.select(o[1])):(h=e.select(o[1]),u=e.select(o[0])),(t=e.create("point",[function(){var v=h.quadraticform,C=u.stdform.slice(0,3);return[g.Math.Numerics.det([C,v[1],v[2]]),g.Math.Numerics.det([v[0],C,v[2]]),g.Math.Numerics.det([v[0],v[1],C])]}],s)).elType="polepoint",t.setParents([h.id,u.id]),h.addChild(t),u.addChild(t),t},g.registerElement("point",g.createPoint),g.registerElement("glider",g.createGlider),g.registerElement("intersection",g.createIntersectionPoint),g.registerElement("otherintersection",g.createOtherIntersectionPoint),g.registerElement("polepoint",g.createPolePoint),{Point:g.Point,createPoint:g.createPoint,createGlider:g.createGlider,createIntersection:g.createIntersectionPoint,createOtherIntersection:g.createOtherIntersectionPoint,createPolePoint:g.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(g,E,y,b,m,l,c,a,e,o){return g.Line=function(s,t,h,u){this.constructor(s,u,l.OBJECT_TYPE_LINE,l.OBJECT_CLASS_LINE),this.point1=this.board.select(t),this.point2=this.board.select(h),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1._is_new?(this.addChild(this.point1),delete this.point1._is_new):this.point1.addChild(this),this.point2._is_new?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=g.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L"})},g.Line.prototype=new a,g.extend(g.Line.prototype,{hasPoint:function(s,t){var h,u,d,n,p,f,v,C,_,P=[],x=[1,s,t],S=e.evaluate(this.visProp.strokewidth);return e.isObject(e.evaluate(this.visProp.precision))?(_=this.board._inputDevice,C=e.evaluate(this.visProp.precision[_])):C=this.board.options.precision.hasPoint,C+=.5*S,P[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,P[1]=this.stdform[1]/this.board.unitX,P[2]=this.stdform[2]/-this.board.unitY,h=y.distPointLine(x,P),!(isNaN(h)||h>C)&&(!(!e.evaluate(this.visProp.straightfirst)||!e.evaluate(this.visProp.straightlast))||(d=this.point1.coords,n=this.point2.coords,u=[0,P[1],P[2]],u=E.crossProduct(u,x),(u=E.crossProduct(u,P))[1]/=u[0],u[2]/=u[0],u[0]=1,u=new c(l.COORDS_BY_SCREEN,u.slice(1),this.board).usrCoords,p=d.distance(l.COORDS_BY_USER,n),d=d.usrCoords.slice(0),n=n.usrCoords.slice(0),p<E.eps?f=0:(p===Number.POSITIVE_INFINITY&&(p=1/E.eps,Math.abs(n[0])<E.eps?(p/=y.distance([0,0,0],n),n=[1,d[1]+n[1]*p,d[2]+n[2]*p]):(p/=y.distance([0,0,0],d),d=[1,n[1]+d[1]*p,n[2]+d[2]*p])),p=n[v=1]-d[v],Math.abs(p)<E.eps&&(p=n[v=2]-d[v]),f=(u[v]-d[v])/p),!(!e.evaluate(this.visProp.straightfirst)&&f<0)&&!(!e.evaluate(this.visProp.straightlast)&&f>1)))},update:function(){var s;return this.needsUpdate?(this.constrained&&(e.isFunction(this.funps)?(s=this.funps())&&s.length&&s.length===2&&(this.point1=s[0],this.point2=s[1]):(e.isFunction(this.funp1)&&(s=this.funp1(),e.isPoint(s)?this.point1=s:s&&s.length&&s.length===2&&this.point1.setPositionDirectly(l.COORDS_BY_USER,s)),e.isFunction(this.funp2)&&(s=this.funp2(),e.isPoint(s)?this.point2=s:s&&s.length&&s.length===2&&this.point2.setPositionDirectly(l.COORDS_BY_USER,s)))),this.updateSegmentFixedLength(),this.updateStdform(),e.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var s,t,h,u,d,n,p,f;return this.hasFixedLength?(s=this.point1.Dist(this.point2),t=this.fixedLength(),h=this.fixedLengthOldCoords[0].distance(l.COORDS_BY_USER,this.point1.coords),u=this.fixedLengthOldCoords[1].distance(l.COORDS_BY_USER,this.point2.coords),(h>E.eps||u>E.eps||s!==t)&&(d=this.point1.isDraggable&&this.point1.type!==l.OBJECT_TYPE_GLIDER&&!e.evaluate(this.point1.visProp.fixed),n=this.point2.isDraggable&&this.point2.type!==l.OBJECT_TYPE_GLIDER&&!e.evaluate(this.point2.visProp.fixed),s>E.eps?h>u&&n||h<=u&&n&&!d?(this.point2.setPositionDirectly(l.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*t/s,this.point1.Y()+(this.point2.Y()-this.point1.Y())*t/s]),this.point2.fullUpdate()):(h<=u&&d||h>u&&d&&!n)&&(this.point1.setPositionDirectly(l.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*t/s,this.point2.Y()+(this.point1.Y()-this.point2.Y())*t/s]),this.point1.fullUpdate()):(p=Math.random()-.5,f=Math.random()-.5,s=Math.sqrt(p*p+f*f),n?(this.point2.setPositionDirectly(l.COORDS_BY_USER,[this.point1.X()+p*t/s,this.point1.Y()+f*t/s]),this.point2.fullUpdate()):d&&(this.point1.setPositionDirectly(l.COORDS_BY_USER,[this.point2.X()+p*t/s,this.point2.Y()+f*t/s]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(l.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(l.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var s=E.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=s[0],this.stdform[1]=s[1],this.stdform[2]=s[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&E.innerProduct(this.stdform,this.stdform,3)>=E.eps*E.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(s){var t=this.point1.symbolic.x,h=this.point1.symbolic.y,u=this.point2.symbolic.x,d=this.point2.symbolic.y,n=s.symbolic.x,p=s.symbolic.y;return[["(",h,")*(",n,")-(",h,")*(",u,")+(",p,")*(",u,")-(",t,")*(",p,")+(",t,")*(",d,")-(",n,")*(",d,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=E.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=E.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(s,t){return this.visProp.straightfirst=s,this.visProp.straightlast=t,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new c(l.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(s){e.exists(this.label)&&(this.label.relativeCoords=new c(l.COORDS_BY_SCREEN,[s[0],-s[1]],this.board))},getLabelAnchor:function(){var s,t,h=0,u=new c(l.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),d=new c(l.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),n=e.evaluate(this.visProp.straightfirst),p=e.evaluate(this.visProp.straightlast);if((n||p)&&y.calcStraight(this,u,d,0),u=u.scrCoords,d=d.scrCoords,!e.exists(this.label))return new c(l.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(e.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":u[1]<=d[1]?(s=u[1],t=u[2]):(s=d[1],t=d[2]);break;case"rt":case"lrt":case"urt":u[1]>d[1]?(s=u[1],t=u[2]):(s=d[1],t=d[2]);break;default:s=.5*(u[1]+d[1]),t=.5*(u[2]+d[2])}return(n||p)&&(e.exists(this.label)&&(h=e.evaluate(this.label.visProp.fontsize)),Math.abs(s)<E.eps?s=h:this.board.canvasWidth+E.eps>s&&s>this.board.canvasWidth-h-E.eps&&(s=this.board.canvasWidth-h),E.eps+h>t&&t>-E.eps?t=h:this.board.canvasHeight+E.eps>t&&t>this.board.canvasHeight-h-E.eps&&(t=this.board.canvasHeight-h)),new c(l.COORDS_BY_SCREEN,[s,t],this.board)},cloneToBackground:function(){var s,t,h,u={};return u.id=this.id+"T"+this.numTraces,u.elementClass=l.OBJECT_CLASS_LINE,this.numTraces++,u.point1=this.point1,u.point2=this.point2,u.stdform=this.stdform,u.board=this.board,u.visProp=e.deepCopy(this.visProp,this.visProp.traceattributes,!0),u.visProp.layer=this.board.options.layer.trace,e.clearVisPropOld(u),u.visPropCalc={visible:e.evaluate(u.visProp.visible)},t=this.getSlope(),s=this.getRise(),u.getSlope=function(){return t},u.getRise=function(){return s},h=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(u),this.board.renderer.enhancedRendering=h,this.traces[u.id]=u.rendNode,this},addTransform:function(s){var t,h=e.isArray(s)?s:[s],u=h.length;for(t=0;t<u;t++)this.point1.transformations.push(h[t]),this.point2.transformations.push(h[t]);return this},snapToGrid:function(s){var t,h,u,d,n,p,f,v;return e.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):e.exists(s)&&(f=e.evaluate(this.visProp.snapsizex),v=e.evaluate(this.visProp.snapsizey),n=(t=new c(l.COORDS_BY_SCREEN,[s.Xprev,s.Yprev],this.board)).usrCoords[1],p=t.usrCoords[2],f<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(f=(d=this.board.defaultAxes.x.defaultTicks).ticksDelta*(e.evaluate(d.visProp.minorticks)+1)),v<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(v=(d=this.board.defaultAxes.y.defaultTicks).ticksDelta*(e.evaluate(d.visProp.minorticks)+1)),f>0&&v>0&&(h=y.projectPointToLine({coords:t},this,this.board),u=m.subtract([1,Math.round(n/f)*f,Math.round(p/v)*v],h.usrCoords),this.board.create("transform",u.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var s=e.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(s),this.point2.handleSnapToPoints(s)),this},X:function(s){var t,h=this.stdform[2];return t=Math.abs(this.point1.coords.usrCoords[0])>E.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],s=2*(s-.5),(1-Math.abs(s))*t-s*h},Y:function(s){var t,h=this.stdform[1];return t=Math.abs(this.point1.coords.usrCoords[0])>E.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],s=2*(s-.5),(1-Math.abs(s))*t+s*h},Z:function(s){var t=Math.abs(this.point1.coords.usrCoords[0])>E.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return s=2*(s-.5),(1-Math.abs(s))*t},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var s=this.point1.coords.usrCoords,t=this.point2.coords.usrCoords;return[Math.min(s[1],t[1]),Math.max(s[2],t[2]),Math.max(s[1],t[1]),Math.min(s[2],t[2])]},remove:function(){this.removeAllTicks(),a.prototype.remove.call(this)}}),g.createLine=function(s,t,h){var u,d,n,p,f,v,C,_=[],P=!1,x=!1;if(t.length===2){if(e.isArray(t[0])&&t[0].length>1)v=e.copyAttributes(h,s.options,"line","point1"),n=s.create("point",t[0],v);else if(e.isString(t[0])||e.isPoint(t[0]))n=s.select(t[0]);else if(e.isFunction(t[0])&&e.isPoint(t[0]()))n=t[0](),x=!0;else if(e.isFunction(t[0])&&t[0]().length&&t[0]().length>=2)v=e.copyAttributes(h,s.options,"line","point1"),n=o.createPoint(s,t[0](),v),x=!0;else{if(!e.isObject(t[0])||!e.isTransformationOrArray(t[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);P=!0,v=e.copyAttributes(h,s.options,"line","point1"),n=s.create("point",[t[0].point1,t[1]],v)}if(P)v=e.copyAttributes(h,s.options,"line","point2"),p=s.create("point",[t[0].point2,t[1]],v);else if(e.isArray(t[1])&&t[1].length>1)v=e.copyAttributes(h,s.options,"line","point2"),p=s.create("point",t[1],v);else if(e.isString(t[1])||e.isPoint(t[1]))p=s.select(t[1]);else if(e.isFunction(t[1])&&e.isPoint(t[1]()))p=t[1](),x=!0;else{if(!(e.isFunction(t[1])&&t[1]().length&&t[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);v=e.copyAttributes(h,s.options,"line","point2"),p=o.createPoint(s,t[1](),v),x=!0}v=e.copyAttributes(h,s.options,"line"),d=new g.Line(s,n,p,v),x?(d.constrained=!0,d.funp1=t[0],d.funp2=t[1]):P||(d.isDraggable=!0),d.setParents([n.id,p.id])}else if(t.length===3){for(C=!0,f=0;f<3;f++)if(e.isNumber(t[f]))_[f]=e.createFunction(t[f]);else{if(!e.isFunction(t[f]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);_[f]=t[f],C=!1}v=e.copyAttributes(h,s.options,"line","point1"),n=C?s.create("point",[_[2]()*_[2]()+_[1]()*_[1](),_[2]()-_[1]()*_[0]()+_[2](),-_[1]()-_[2]()*_[0]()-_[1]()],v):s.create("point",[function(){return .5*(_[2]()*_[2]()+_[1]()*_[1]())},function(){return .5*(_[2]()-_[1]()*_[0]()+_[2]())},function(){return .5*(-_[1]()-_[2]()*_[0]()-_[1]())}],v),v=e.copyAttributes(h,s.options,"line","point2"),p=C?s.create("point",[_[2]()*_[2]()+_[1]()*_[1](),-_[1]()*_[0]()+_[2](),-_[2]()*_[0]()-_[1]()],v):s.create("point",[function(){return _[2]()*_[2]()+_[1]()*_[1]()},function(){return-_[1]()*_[0]()+_[2]()},function(){return-_[2]()*_[0]()-_[1]()}],v),n.prepareUpdate().update(),p.prepareUpdate().update(),v=e.copyAttributes(h,s.options,"line"),(d=new g.Line(s,n,p,v)).isDraggable=C,d.setParents([n,p])}else if(t.length===1&&e.isFunction(t[0])&&t[0]().length===2&&e.isPoint(t[0]()[0])&&e.isPoint(t[0]()[1]))u=t[0](),v=e.copyAttributes(h,s.options,"line"),(d=new g.Line(s,u[0],u[1],v)).constrained=!0,d.funps=t[0],d.setParents(u);else{if(!(t.length===1&&e.isFunction(t[0])&&t[0]().length===3&&e.isNumber(t[0]()[0])&&e.isNumber(t[0]()[1])&&e.isNumber(t[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);u=t[0],v=e.copyAttributes(h,s.options,"line","point1"),n=s.create("point",[function(){var S=u();return[.5*(S[2]*S[2]+S[1]*S[1]),.5*(S[2]-S[1]*S[0]+S[2]),.5*(-S[1]-S[2]*S[0]-S[1])]}],v),v=e.copyAttributes(h,s.options,"line","point2"),p=s.create("point",[function(){var S=u();return[S[2]*S[2]+S[1]*S[1],-S[1]*S[0]+S[2],-S[2]*S[0]-S[1]]}],v),v=e.copyAttributes(h,s.options,"line"),(d=new g.Line(s,n,p,v)).constrained=!0,d.funps=t[0],d.setParents([n,p])}return d},g.registerElement("line",g.createLine),g.createSegment=function(s,t,h){var u,d;if(h.straightFirst=!1,h.straightLast=!1,d=e.copyAttributes(h,s.options,"segment"),u=s.create("line",t.slice(0,2),d),t.length===3){if(u.hasFixedLength=!0,e.isNumber(t[2]))u.fixedLength=function(){return t[2]};else{if(!e.isFunction(t[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof t[2]+`'.
Possible third parent types: number or function`);u.fixedLength=t[2]}u.getParents=function(){return this.parents.concat(this.fixedLength())},u.fixedLengthOldCoords=[],u.fixedLengthOldCoords[0]=new c(l.COORDS_BY_USER,u.point1.coords.usrCoords.slice(1,3),s),u.fixedLengthOldCoords[1]=new c(l.COORDS_BY_USER,u.point2.coords.usrCoords.slice(1,3),s)}return u.elType="segment",u},g.registerElement("segment",g.createSegment),g.createArrow=function(s,t,h){var u,d;return h.straightFirst=!1,h.straightLast=!1,d=e.copyAttributes(h,s.options,"arrow"),(u=s.create("line",t,d)).type=l.OBJECT_TYPE_VECTOR,u.elType="arrow",u},g.registerElement("arrow",g.createArrow),g.createAxis=function(s,t,h){var u,d,n,p,f;if(!e.isArray(t[0])&&!e.isPoint(t[0])||!e.isArray(t[1])&&!e.isPoint(t[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);for(p in u=e.copyAttributes(h,s.options,"axis"),(n=s.create("line",t,u)).type=l.OBJECT_TYPE_AXIS,n.isDraggable=!1,n.point1.isDraggable=!1,n.point2.isDraggable=!1,n.ancestors)n.ancestors.hasOwnProperty(p)&&(n.ancestors[p].type=l.OBJECT_TYPE_AXISPOINT);return d=e.copyAttributes(h,s.options,"axis","ticks"),f=e.exists(d.ticksdistance)?d.ticksdistance:e.isArray(d.ticks)?d.ticks:1,n.defaultTicks=s.create("ticks",[n,f],d),n.defaultTicks.dump=!1,n.elType="axis",n.subs={ticks:n.defaultTicks},n.inherits.push(n.defaultTicks),n},g.registerElement("axis",g.createAxis),g.createTangent=function(s,t,h){var u,d,n,p,f;if(t.length===1)u=t[0],d=u.slideObject;else{if(t.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(e.isPoint(t[0]))u=t[0],d=t[1];else{if(!e.isPoint(t[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);d=t[0],u=t[1]}}if(d.elementClass===l.OBJECT_CLASS_LINE?(f=s.create("line",[d.point1,d.point2],h)).glider=u:d.elementClass===l.OBJECT_CLASS_CURVE&&d.type!==l.OBJECT_TYPE_CONIC?e.evaluate(d.visProp.curvetype)!=="plot"?(f=s.create("line",[function(){var v=d.X,C=d.Y;return-u.X()*b.D(C)(u.position)+u.Y()*b.D(v)(u.position)},function(){return b.D(d.Y)(u.position)},function(){return-b.D(d.X)(u.position)}],h),u.addChild(f),f.glider=u):(f=s.create("line",[function(){var v,C,_,P,x,S,O,w,T,M,N=Math.floor(u.position);if(d.bezierDegree===1)N===d.numberPoints-1&&N--;else{if(d.bezierDegree!==3)return 0;N=3*Math.floor(u.position*(d.numberPoints-1)/3),_=(u.position*(d.numberPoints-1)-N)/3,N>=d.numberPoints-1&&(N=d.numberPoints-4,_=1)}return N<0?1:(d.bezierDegree===1?(v=d.points[N].usrCoords,C=d.points[N+1].usrCoords):(P=d.points[N].usrCoords,x=d.points[N+1].usrCoords,S=d.points[N+2].usrCoords,O=d.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-P[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-P[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(v=u.coords.usrCoords)[1]+w,v[2]+T]),v[2]*C[1]-v[1]*C[2])},function(){var v,C,_,P,x,S,O,w,T,M,N=Math.floor(u.position);if(d.bezierDegree===1)N===d.numberPoints-1&&N--;else{if(d.bezierDegree!==3)return 0;N=3*Math.floor(u.position*(d.numberPoints-1)/3),_=(u.position*(d.numberPoints-1)-N)/3,N>=d.numberPoints-1&&(N=d.numberPoints-4,_=1)}return N<0?0:(d.bezierDegree===1?(v=d.points[N].usrCoords,C=d.points[N+1].usrCoords):(P=d.points[N].usrCoords,x=d.points[N+1].usrCoords,S=d.points[N+2].usrCoords,O=d.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-P[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-P[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(v=u.coords.usrCoords)[1]+w,v[2]+T]),C[2]-v[2])},function(){var v,C,_,P,x,S,O,w,T,M,N=Math.floor(u.position);if(d.bezierDegree===1)N===d.numberPoints-1&&N--;else{if(d.bezierDegree!==3)return 0;N=3*Math.floor(u.position*(d.numberPoints-1)/3),_=(u.position*(d.numberPoints-1)-N)/3,N>=d.numberPoints-1&&(N=d.numberPoints-4,_=1)}return N<0?0:(d.bezierDegree===1?(v=d.points[N].usrCoords,C=d.points[N+1].usrCoords):(P=d.points[N].usrCoords,x=d.points[N+1].usrCoords,S=d.points[N+2].usrCoords,O=d.points[N+3].usrCoords,w=(1-_)*(1-_)*(x[1]-P[1])+2*(1-_)*_*(S[1]-x[1])+_*_*(O[1]-S[1]),T=(1-_)*(1-_)*(x[2]-P[2])+2*(1-_)*_*(S[2]-x[2])+_*_*(O[2]-S[2]),w/=M=Math.sqrt(w*w+T*T),T/=M,C=[1,(v=u.coords.usrCoords)[1]+w,v[2]+T]),v[1]-C[1])}],h),u.addChild(f),f.glider=u):d.type===l.OBJECT_TYPE_TURTLE?(f=s.create("line",[function(){var v=Math.floor(u.position);for(n=0;n<d.objects.length;n++)if((p=d.objects[n]).type===l.OBJECT_TYPE_CURVE){if(v<p.numberPoints)break;v-=p.numberPoints}return v===p.numberPoints-1&&v--,v<0?1:p.Y(v)*p.X(v+1)-p.X(v)*p.Y(v+1)},function(){var v=Math.floor(u.position);for(n=0;n<d.objects.length;n++)if((p=d.objects[n]).type===l.OBJECT_TYPE_CURVE){if(v<p.numberPoints)break;v-=p.numberPoints}return v===p.numberPoints-1&&v--,v<0?0:p.Y(v+1)-p.Y(v)},function(){var v=Math.floor(u.position);for(n=0;n<d.objects.length;n++)if((p=d.objects[n]).type===l.OBJECT_TYPE_CURVE){if(v<p.numberPoints)break;v-=p.numberPoints}return v===p.numberPoints-1&&v--,v<0?0:p.X(v)-p.X(v+1)}],h),u.addChild(f),f.glider=u):d.elementClass!==l.OBJECT_CLASS_CIRCLE&&d.type!==l.OBJECT_TYPE_CONIC||(f=s.create("line",[function(){return E.matVecMult(d.quadraticform,u.coords.usrCoords)[0]},function(){return E.matVecMult(d.quadraticform,u.coords.usrCoords)[1]},function(){return E.matVecMult(d.quadraticform,u.coords.usrCoords)[2]}],h),u.addChild(f),f.glider=u),!e.exists(f))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return f.elType="tangent",f.type=l.OBJECT_TYPE_TANGENT,f.setParents(t),f},g.createRadicalAxis=function(s,t,h){var u,d,n;if(t.length!==2||t[0].elementClass!==l.OBJECT_CLASS_CIRCLE||t[1].elementClass!==l.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent type: [circle,circle]`);return d=s.select(t[0]),n=s.select(t[1]),(u=s.create("line",[function(){var p=d.stdform,f=n.stdform;return E.matVecMult(E.transpose([p.slice(0,3),f.slice(0,3)]),[f[3],-p[3]])}],h)).elType="radicalaxis",u.setParents([d.id,n.id]),d.addChild(u),n.addChild(u),u},g.createPolarLine=function(s,t,h){var u,d,n,p,f,v,C;if(t.length>1&&(p=t[0].type===l.OBJECT_TYPE_CONIC||t[0].elementClass===l.OBJECT_CLASS_CIRCLE,f=t[1].type===l.OBJECT_TYPE_CONIC||t[1].elementClass===l.OBJECT_CLASS_CIRCLE,v=e.isPoint(t[0]),C=e.isPoint(t[1])),t.length!==2||!(p&&C||v&&f))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof t[0]+"' and '"+typeof t[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return C?(d=s.select(t[0]),n=s.select(t[1])):(d=s.select(t[1]),n=s.select(t[0])),(u=s.create("tangent",[d,n],h)).elType="polarline",u},g.registerElement("tangent",g.createTangent),g.registerElement("polar",g.createTangent),g.registerElement("radicalaxis",g.createRadicalAxis),g.registerElement("polarline",g.createPolarLine),{Line:g.Line,createLine:g.createLine,createTangent:g.createTangent,createPolar:g.createTangent,createSegment:g.createSegment,createAxis:g.createAxis,createArrow:g.createArrow,createRadicalAxis:g.createRadicalAxis,createPolarLine:g.createPolarLine}}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(g,E,y,b,m){return g.Group=function(l,c,a,e,o){var s,t,h,u;for(this.board=l,this.objects={},s=this.board.numObjects,this.board.numObjects+=1,c!==""&&m.exists(c)?this.id=c:this.id=this.board.id+"Group"+s,this.board.groups[this.id]=this,this.type=E.OBJECT_TYPE_POINT,this.elementClass=E.OBJECT_CLASS_POINT,a!==""&&m.exists(a)?this.name=a:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=o.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],t=m.isArray(e)?e:Array.prototype.slice.call(arguments,3),h=0;h<t.length;h++)u=this.board.select(t[h]),!m.evaluate(u.visProp.fixed)&&m.exists(u.coords)&&this.addPoint(u);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},g.extend(g.Group.prototype,{ungroup:function(){var l,c,a;for(l in this.objects)this.objects.hasOwnProperty(l)&&(c=this.objects[l].point,m.isArray(c.groups)&&(a=m.indexOf(c.groups,this.id))>=0&&delete c.groups[a]);return this.objects={},this},addParents:function(l){var c,a,e;for(a=(e=m.isArray(l)?l:arguments).length,c=0;c<a;++c)m.isId(this.board,e[c])?this.parents.push(e[c]):m.exists(e[c].id)&&this.parents.push(e[c].id);this.parents=m.uniqueArray(this.parents)},setParents:function(l){return this.parents=[],this.addParents(l),this},getParents:function(){return m.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(l){var c;l!==""&&m.exists(this.objects[l])&&(c=this.objects[l].point,this.coords[c.id]={usrCoords:c.coords.usrCoords.slice(0)})},update:function(){var l,c,a,e,o,s,t,h,u,d,n=null;if(!this.needsUpdate)return this;if((l=this._update_find_drag_type()).action==="nothing")return this._updateCoordsCache(l.id),this;if(n=this.objects[l.id].point,l.action==="translation")u=[n.coords.usrCoords[1]-this.coords[l.id].usrCoords[1],n.coords.usrCoords[2]-this.coords[l.id].usrCoords[2]];else if(l.action==="rotation"||l.action==="scaling"){if(a=l.action==="rotation"?"rotationCenter":"scaleCenter",m.isPoint(this[a]))d=this[a].coords.usrCoords.slice(1);else if(this[a]==="centroid")d=this._update_centroid_center();else if(m.isArray(this[a]))d=this[a];else{if(!m.isFunction(this[a]))return this;d=this[a]()}if(l.action==="rotation")h=b.rad(this.coords[l.id].usrCoords.slice(1),d,this.objects[l.id].point),(u=this.board.create("transform",[h,d[0],d[1]],{type:"rotate"})).update();else{if(l.action!=="scaling")return this;if(o=b.distance(this.coords[l.id].usrCoords.slice(1),d),Math.abs(o)<y.eps)return this;o=b.distance(n.coords.usrCoords.slice(1),d)/o,s=this.scaleDirections[l.id].indexOf("x")>=0?o:1,t=this.scaleDirections[l.id].indexOf("y")>=0?o:1,(u=this.board.create("transform",[1,0,0,d[0]*(1-s),s,0,d[1]*(1-t),0,t],{type:"generic"})).update()}}for(c in this._update_apply_transformation(l,u),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(c))for(e in this.objects[c].descendants)this.objects[c].descendants.hasOwnProperty(e)&&(this.objects[c].descendants.needsUpdate=this.objects[c].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(c in this.board.updateElements(l),this.objects)this.objects.hasOwnProperty(c)&&this._updateCoordsCache(c);return this},_update_find_drag_type:function(){var l,c,a,e="nothing",o=[];for(l in this.objects)this.objects.hasOwnProperty(l)&&(c=this.objects[l].point).coords.distance(E.COORDS_BY_USER,this.coords[l])>y.eps&&o.push(c.id);return o.length===0?{action:e,id:"",changed:o}:(a=o[0],c=this.objects[a].point,o.length>1?e="translation":m.isInArray(this.rotationPoints,c)&&m.exists(this.rotationCenter)?e="rotation":m.isInArray(this.scalePoints,c)&&m.exists(this.scaleCenter)?e="scaling":m.isInArray(this.translationPoints,c)&&(e="translation"),{action:e,id:a,changed:o})},_update_centroid_center:function(){var l,c,a;for(a in l=[0,0],c=0,this.coords)this.coords.hasOwnProperty(a)&&(l[0]+=this.coords[a].usrCoords[1],l[1]+=this.coords[a].usrCoords[2],++c);return c>0&&(l[0]/=c,l[1]/=c),l},_update_apply_transformation:function(l,c){var a,e;for(a in this.objects)this.objects.hasOwnProperty(a)&&(m.exists(this.board.objects[a])?(e=this.objects[a].point).id!==l.id?l.action==="translation"?m.isInArray(l.changed,e.id)||e.coords.setCoordinates(E.COORDS_BY_USER,[this.coords[a].usrCoords[1]+c[0],this.coords[a].usrCoords[2]+c[1]]):l.action!=="rotation"&&l.action!=="scaling"||c.applyOnce([e]):l.action!=="rotation"&&l.action!=="scaling"||e.coords.setCoordinates(E.COORDS_BY_USER,y.matVecMult(c.matrix,this.coords[e.id].usrCoords)):delete this.objects[a])},addPoint:function(l){return this.objects[l.id]={point:this.board.select(l)},this._updateCoordsCache(l.id),this.translationPoints.push(l),l.groups.push(this.id),l.groups=m.uniqueArray(l.groups),this},addPoints:function(l){var c;for(c=0;c<l.length;c++)this.addPoint(l[c]);return this},addGroup:function(l){var c;for(c in l.objects)l.objects.hasOwnProperty(c)&&this.addPoint(l.objects[c].point);return this},removePoint:function(l){return delete this.objects[l.id],this},setRotationCenter:function(l){return this.rotationCenter=l,this},setRotationPoints:function(l){return this._setActionPoints("rotation",l)},addRotationPoint:function(l){return this._addActionPoint("rotation",l)},removeRotationPoint:function(l){return this._removeActionPoint("rotation",l)},setTranslationPoints:function(l){return this._setActionPoints("translation",l)},addTranslationPoint:function(l){return this._addActionPoint("translation",l)},removeTranslationPoint:function(l){return this._removeActionPoint("translation",l)},setScaleCenter:function(l){return this.scaleCenter=l,this},setScalePoints:function(l,c){var a,e,o;for(o=(a=m.isArray(l)?l:arguments).length,e=0;e<o;++e)this.scaleDirections[this.board.select(a[e]).id]=c||"xy";return this._setActionPoints("scale",l)},addScalePoint:function(l,c){return this._addActionPoint("scale",l),this.scaleDirections[this.board.select(l).id]=c||"xy",this},removeScalePoint:function(l){return this._removeActionPoint("scale",l)},_setActionPoints:function(l,c){var a,e,o;for(o=(a=m.isArray(c)?c:arguments).length,this[l+"Points"]=[],e=0;e<o;++e)this._addActionPoint(l,a[e]);return this},_addActionPoint:function(l,c){return this[l+"Points"].push(this.board.select(c)),this},_removeActionPoint:function(l,c){var a=this[l+"Points"].indexOf(this.board.select(c));return a>-1&&this[l+"Points"].splice(a,1),this},setProperty:function(){g.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var l;for(l in this.objects)this.objects.hasOwnProperty(l)&&this.objects[l].point.setAttribute.apply(this.objects[l].point,arguments);return this}}),g.createGroup=function(l,c,a){var e=m.copyAttributes(a,l.options,"group"),o=new g.Group(l,e.id,e.name,c,e);return o.elType="group",o.setParents(c),o},g.registerElement("group",g.createGroup),{Group:g.Group,createGroup:g.createGroup}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type"],function(g,E,y,b,m,l,c){return g.createEllipse=function(a,e,o){var s,t,h,u,d,n,p,f=[],v=c.copyAttributes(o,a.options,"conic","foci"),C=c.copyAttributes(o,a.options,"conic","center"),_=c.copyAttributes(o,a.options,"conic");for(n=0;n<2;n++)if(e[n].length>1)f[n]=a.create("point",e[n],v);else if(c.isPoint(e[n]))f[n]=a.select(e[n]);else if(c.isFunction(e[n])&&c.isPoint(e[n]()))f[n]=e[n]();else{if(!c.isString(e[n]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);f[n]=a.select(e[n])}if(c.isNumber(e[2]))d=c.createFunction(e[2],a);else if(c.isFunction(e[2])&&c.isNumber(e[2]()))d=e[2];else{if(c.isPoint(e[2]))u=a.select(e[2]);else if(e[2].length>1)u=a.create("point",e[2],v);else if(c.isFunction(e[2])&&c.isPoint(e[2]()))u=e[2]();else{if(!c.isString(e[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);u=a.select(e[2])}d=function(){return u.Dist(f[0])+u.Dist(f[1])}}for(c.exists(e[4])||(e[4]=2*Math.PI),c.exists(e[3])||(e[3]=0),h=a.create("point",[function(){return .5*(f[0].X()+f[1].X())},function(){return .5*(f[0].Y()+f[1].Y())}],C),(t=a.create("curve",[function(P){return 0},function(P){return 0},e[3],e[4]],_)).majorAxis=d,p=t.hasPoint,s=function(P,x){var S,O,w,T,M,N,A,R,L;x||(O=(S=d())*S,w=f[0].X(),T=f[0].Y(),A=w-(M=f[1].X()),R=T-(N=f[1].Y()),L=(O-w*w-T*T+M*M+N*N)/(2*S),t.quadraticform=[[L*L-M*M-N*N,L*A/S+M,L*R/S+N],[L*A/S+M,A*A/O-1,A*R/O],[L*R/S+N,A*R/O,R*R/O-1]])},t.X=function(P,x){var S=d(),O=f[1].Dist(f[0]),w=.5*(O*O-S*S)/(O*Math.cos(P)-S),T=Math.atan2(f[1].Y()-f[0].Y(),f[1].X()-f[0].X());return x||s(0,x),f[0].X()+Math.cos(T+P)*w},t.Y=function(P,x){var S=d(),O=f[1].Dist(f[0]),w=.5*(O*O-S*S)/(O*Math.cos(P)-S),T=Math.atan2(f[1].Y()-f[0].Y(),f[1].X()-f[0].X());return f[0].Y()+Math.sin(T+P)*w},t.midpoint=t.center=h,t.type=E.OBJECT_TYPE_CONIC,t.subs={center:t.center},t.inherits.push(t.center,f[0],f[1]),c.isPoint(u)&&t.inherits.push(u),t.hasPoint=function(P,x){var S,O,w,T;return c.evaluate(this.visProp.hasinnerpoints)?(S=f[0].coords,O=f[1].coords,w=this.majorAxis(),(T=new y(E.COORDS_BY_SCREEN,[P,x],this.board)).distance(E.COORDS_BY_USER,S)+T.distance(E.COORDS_BY_USER,O)<=w):p.apply(this,arguments)},h.addChild(t),n=0;n<2;n++)c.isPoint(f[n])&&f[n].addChild(t);return c.isPoint(u)&&u.addChild(t),t.setParents(e),t},g.createHyperbola=function(a,e,o){var s,t,h,u,d,n,p=[],f=c.copyAttributes(o,a.options,"conic","foci"),v=c.copyAttributes(o,a.options,"conic","center"),C=c.copyAttributes(o,a.options,"conic");for(n=0;n<2;n++)if(e[n].length>1)p[n]=a.create("point",e[n],f);else if(c.isPoint(e[n]))p[n]=a.select(e[n]);else if(c.isFunction(e[n])&&c.isPoint(e[n]()))p[n]=e[n]();else{if(!c.isString(e[n]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);p[n]=a.select(e[n])}if(c.isNumber(e[2]))d=c.createFunction(e[2],a);else if(c.isFunction(e[2])&&c.isNumber(e[2]()))d=e[2];else{if(c.isPoint(e[2]))u=a.select(e[2]);else if(e[2].length>1)u=a.create("point",e[2],f);else if(c.isFunction(e[2])&&c.isPoint(e[2]()))u=e[2]();else{if(!c.isString(e[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);u=a.select(e[2])}d=function(){return u.Dist(p[0])-u.Dist(p[1])}}for(c.exists(e[4])||(e[4]=1.0001*Math.PI),c.exists(e[3])||(e[3]=-1.0001*Math.PI),h=a.create("point",[function(){return .5*(p[0].X()+p[1].X())},function(){return .5*(p[0].Y()+p[1].Y())}],v),(t=a.create("curve",[function(_){return 0},function(_){return 0},e[3],e[4]],C)).majorAxis=d,s=function(_,P){var x,S,O,w,T,M,N,A,R;P||(S=(x=d())*x,O=p[0].X(),w=p[0].Y(),N=O-(T=p[1].X()),A=w-(M=p[1].Y()),R=(S-O*O-w*w+T*T+M*M)/(2*x),t.quadraticform=[[R*R-T*T-M*M,R*N/x+T,R*A/x+M],[R*N/x+T,N*N/S-1,N*A/S],[R*A/x+M,N*A/S,A*A/S-1]])},t.X=function(_,P){var x=d(),S=p[1].Dist(p[0]),O=.5*(S*S-x*x)/(S*Math.cos(_)+x),w=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return P||s(0,P),p[0].X()+Math.cos(w+_)*O},t.Y=function(_,P){var x=d(),S=p[1].Dist(p[0]),O=.5*(S*S-x*x)/(S*Math.cos(_)+x),w=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return p[0].Y()+Math.sin(w+_)*O},t.midpoint=t.center=h,t.subs={center:t.center},t.inherits.push(t.center,p[0],p[1]),c.isPoint(u)&&t.inherits.push(u),t.type=E.OBJECT_TYPE_CONIC,h.addChild(t),n=0;n<2;n++)c.isPoint(p[n])&&p[n].addChild(t);return c.isPoint(u)&&u.addChild(t),t.setParents(e),t},g.createParabola=function(a,e,o){var s,t,h,u,d=e[0],n=e[1],p=c.copyAttributes(o,a.options,"conic","foci"),f=c.copyAttributes(o,a.options,"conic","center"),v=c.copyAttributes(o,a.options,"conic");if(e[0].length>1)d=a.create("point",e[0],p);else if(c.isPoint(e[0]))d=a.select(e[0]);else if(c.isFunction(e[0])&&c.isPoint(e[0]()))d=e[0]();else{if(!c.isString(e[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line]`);d=a.select(e[0])}return c.isArray(n)&&n.length===2&&(u=c.copyAttributes(o,a.options,"conic","line"),n=a.create("line",n,u)),c.exists(e[3])||(e[3]=2*Math.PI),c.exists(e[2])||(e[2]=0),h=a.create("point",[function(){return l.projectPointToLine(d,n,a).usrCoords}],f),(t=a.create("curve",[function(C){return 0},function(C){return 0},e[2],e[3]],v)).midpoint=t.center=h,t.subs={center:t.center},t.inherits.push(t.center),s=function(C,_){var P,x,S,O,w,T;_||(P=n.stdform[1],x=n.stdform[2],S=n.stdform[0],O=P*P+x*x,w=d.X(),T=d.Y(),t.quadraticform=[[S*S-O*(w*w+T*T),S*P+O*w,S*x+O*T],[S*P+O*w,-x*x,P*x],[S*x+O*T,P*x,-P*P]])},t.X=function(C,_){var P,x=n.getAngle(),S=l.distPointLine(d.coords.usrCoords,n.stdform),O=n.point1.coords.usrCoords,w=n.point2.coords.usrCoords,T=d.coords.usrCoords;return O[0]===0?O=[1,w[1]+n.stdform[2],w[2]-n.stdform[1]]:w[0]===0&&(w=[1,O[1]+n.stdform[2],O[2]-n.stdform[1]]),P=((w[1]-O[1])*(T[2]-O[2])-(w[2]-O[2])*(T[1]-O[1])>=0?1:-1)*S/(1-Math.sin(C)),_||s(0,_),d.X()+Math.cos(C+x)*P},t.Y=function(C,_){var P,x=n.getAngle(),S=l.distPointLine(d.coords.usrCoords,n.stdform),O=n.point1.coords.usrCoords,w=n.point2.coords.usrCoords,T=d.coords.usrCoords;return O[0]===0?O=[1,w[1]+n.stdform[2],w[2]-n.stdform[1]]:w[0]===0&&(w=[1,O[1]+n.stdform[2],O[2]-n.stdform[1]]),P=((w[1]-O[1])*(T[2]-O[2])-(w[2]-O[2])*(T[1]-O[1])>=0?1:-1)*S/(1-Math.sin(C)),d.Y()+Math.sin(C+x)*P},t.type=E.OBJECT_TYPE_CONIC,h.addChild(t),c.isPoint(d)&&(d.addChild(t),t.inherits.push(d)),n.addChild(t),t.setParents(e),t},g.createConic=function(a,e,o){var s,t,h,u,d,n,p,f,v,C,_,P,x,S,O=[[1,0,0],[0,1,0],[0,0,1]],w=[[1,0,0],[0,1,0],[0,0,1]],T=[],M=[],N=c.copyAttributes(o,a.options,"conic","point"),A=c.copyAttributes(o,a.options,"conic","center"),R=c.copyAttributes(o,a.options,"conic");if(e.length===5)S=!0;else{if(e.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+e.length+" parameters.");S=!1}if(S)for(P=0;P<5;P++)if(e[P].length>1)T[P]=a.create("point",e[P],N);else if(c.isPoint(e[P]))T[P]=a.select(e[P]);else if(c.isFunction(e[P])&&c.isPoint(e[P]()))T[P]=e[P]();else{if(!c.isString(e[P]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof e[P]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);T[P]=a.select(e[P])}else(x=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=c.isFunction(e[2])?function(){return e[2]()}:function(){return e[2]},x[0][1]=c.isFunction(e[4])?function(){return e[4]()}:function(){return e[4]},x[0][2]=c.isFunction(e[5])?function(){return e[5]()}:function(){return e[5]},x[1][1]=c.isFunction(e[0])?function(){return e[0]()}:function(){return e[0]},x[1][2]=c.isFunction(e[3])?function(){return e[3]()}:function(){return e[3]},x[2][2]=c.isFunction(e[1])?function(){return e[1]()}:function(){return e[1]};if(d=function(L){var D,k;for(D=0;D<3;D++)for(k=D;k<3;k++)L[D][k]+=L[k][D];for(D=0;D<3;D++)for(k=0;k<D;k++)L[D][k]=L[k][D];return L},u=function(L,D){var k,B,j=[[0,0,0],[0,0,0],[0,0,0]];for(k=0;k<3;k++)for(B=0;B<3;B++)j[k][B]=L[k]*D[B];return d(j)},h=function(L,D,k){var B,j,I,q,$,Z=[[0,0,0],[0,0,0],[0,0,0]];for($=b.matVecMult(D,k),I=b.innerProduct(k,$),$=b.matVecMult(L,k),q=b.innerProduct(k,$),B=0;B<3;B++)for(j=0;j<3;j++)Z[B][j]=I*L[B][j]-q*D[B][j];return Z},t=a.create("curve",[function(L){return 0},function(L){return 0},0,2*Math.PI],R),s=function(L,D){var k,B,j,I;if(!D){if(S){for(k=0;k<5;k++)M[k]=T[k].coords.usrCoords;C=u(b.crossProduct(M[0],M[1]),b.crossProduct(M[2],M[3])),_=u(b.crossProduct(M[0],M[2]),b.crossProduct(M[1],M[3])),w=h(C,_,M[4])}else for(k=0;k<3;k++)for(B=k;B<3;B++)w[k][B]=x[k][B](),B>k&&(w[B][k]=w[k][B]);for(t.quadraticform=w,(n=m.Jacobi(w))[0][0][0]<0&&(n[0][0][0]*=-1,n[0][1][1]*=-1,n[0][2][2]*=-1),k=0;k<3;k++){for(j=0,B=0;B<3;B++)j+=n[1][B][k]*n[1][B][k];j=Math.sqrt(j)}O=n[1],v=Math.sqrt(Math.abs(n[0][0][0])),p=Math.sqrt(Math.abs(n[0][1][1])),f=Math.sqrt(Math.abs(n[0][2][2]))}return n[0][1][1]<=0&&n[0][2][2]<=0?I=b.matVecMult(O,[1/v,Math.cos(L)/p,Math.sin(L)/f]):n[0][1][1]<=0&&n[0][2][2]>0?I=b.matVecMult(O,[Math.cos(L)/v,1/p,Math.sin(L)/f]):n[0][2][2]<0&&(I=b.matVecMult(O,[Math.sin(L)/v,Math.cos(L)/p,1/f])),c.exists(I)?(I[1]/=I[0],I[2]/=I[0],I[0]=1):I=[1,NaN,NaN],I},t.X=function(L,D){return s(L,D)[1]},t.Y=function(L,D){return s(L,D)[2]},t.midpoint=a.create("point",[function(){var L=t.quadraticform;return[L[1][1]*L[2][2]-L[1][2]*L[1][2],L[1][2]*L[0][2]-L[2][2]*L[0][1],L[0][1]*L[1][2]-L[1][1]*L[0][2]]}],A),t.type=E.OBJECT_TYPE_CONIC,t.center=t.midpoint,t.subs={center:t.center},t.inherits.push(t.center),t.inherits=t.inherits.concat(T),S){for(P=0;P<5;P++)c.isPoint(T[P])&&T[P].addChild(t);t.setParents(e)}return t.addChild(t.center),t},g.registerElement("ellipse",g.createEllipse),g.registerElement("hyperbola",g.createHyperbola),g.registerElement("parabola",g.createParabola),g.registerElement("conic",g.createConic),{createEllipse:g.createEllipse,createHyperbola:g.createHyperbola,createParabola:g.createParabola,createConic:g.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(g,E,y,b,m,l,c){return g.Circle=function(a,e,o,s,t){this.constructor(a,t,b.OBJECT_TYPE_CIRCLE,b.OBJECT_CLASS_CIRCLE),this.method=e,this.midpoint=this.board.select(o),this.center=this.board.select(o),this.point2=null,this.radius=0,this.line=null,this.circle=null,this.points=[],e==="twoPoints"?(this.point2=a.select(s),this.radius=this.Radius()):e==="pointRadius"?(this.gxtterm=s,this.updateRadius=c.createFunction(s,this.board,null,!0),this.updateRadius()):e==="pointLine"?(this.line=a.select(s),this.radius=this.line.point1.coords.distance(b.COORDS_BY_USER,this.line.point2.coords)):e==="pointCircle"&&(this.circle=a.select(s),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),c.exists(this.center._is_new)?(this.addChild(this.center),delete this.center._is_new):this.center.addChild(this),e==="pointRadius"?this.notifyParents(s):e==="pointLine"?this.line.addChild(this):e==="pointCircle"?this.circle.addChild(this):e==="twoPoints"&&(c.exists(this.point2._is_new)?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this)),this.methodMap=c.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},g.Circle.prototype=new E,g.extend(g.Circle.prototype,{hasPoint:function(a,e){var o,s,t,h,u,d=this.center.coords.usrCoords,n=new y(b.COORDS_BY_SCREEN,[a,e],this.board),p=this.Radius();return c.isObject(c.evaluate(this.visProp.precision))?(s=this.board._inputDevice,o=c.evaluate(this.visProp.precision[s])):o=this.board.options.precision.hasPoint,t=d[1]-n.usrCoords[1],h=d[2]-n.usrCoords[2],u=Math.sqrt(t*t+h*h),o+=.5*c.evaluate(this.visProp.strokewidth),o/=Math.sqrt(this.board.unitX*this.board.unitY),c.evaluate(this.visProp.hasinnerpoints)?u<p+o:Math.abs(u-p)<o},generatePolynomial:function(a){var e=this.center.symbolic.x,o=this.center.symbolic.y,s=a.symbolic.x,t=a.symbolic.y,h=this.generateRadiusSquared();return h===""?[]:["(("+s+")-("+e+"))^2 + (("+t+")-("+o+"))^2 - ("+h+")"]},generateRadiusSquared:function(){var a,e,o,s,t="";return this.method==="twoPoints"?(a=this.center.symbolic.x,e=this.center.symbolic.y,t="(("+(o=this.point2.symbolic.x)+")-("+a+"))^2 + (("+(s=this.point2.symbolic.y)+")-("+e+"))^2"):this.method==="pointRadius"?c.isNumber(this.radius)&&(t=(this.radius*this.radius).toString()):this.method==="pointLine"?(o=this.line.point1.symbolic.x,s=this.line.point1.symbolic.y,t="(("+o+")-("+this.line.point2.symbolic.x+"))^2 + (("+s+")-("+this.line.point2.symbolic.y+"))^2"):this.method==="pointCircle"&&(t=this.circle.Radius()),t},update:function(){var a,e,o,s,t,h;if(this.needsUpdate)for(c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(b.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform(),o=this.center.coords.usrCoords[0],a=this.center.coords.usrCoords[1]/o,e=this.center.coords.usrCoords[2]/o,o/=o,s=this.Radius(),t=.551915024494,this.numberPoints=13,this.dataX=[a+s,a+s,a+s*t,a,a-s*t,a-s,a-s,a-s,a-s*t,a,a+s*t,a+s,a+s],this.dataY=[e,e+s*t,e+s,e+s,e+s,e+s*t,e,e-s*t,e-s,e-s,e-s,e-s*t,e],this.bezierDegree=3,h=0;h<this.numberPoints;h++)this.points[h]=new y(b.COORDS_BY_USER,[this.dataX[h],this.dataY[h]],this.board);return this},updateQuadraticform:function(){var a=this.center,e=a.X(),o=a.Y(),s=this.Radius();this.quadraticform=[[e*e+o*o-s*s,-e,-o],[-e,1,0],[-o,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=c.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(a){c.isString(a)&&l.findDependencies(this,a,this.board)},setRadius:function(a){return this.updateRadius=c.createFunction(a,this.board,null,!0),this.board.update(),this},Radius:function(a){return c.exists(a)?(this.setRadius(a),this.Radius()):this.method==="twoPoints"?c.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||c.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return g.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var a,e,o=this.Radius(),s=this.center.coords.usrCoords,t=.7071067811865476;switch(c.evaluate(this.visProp.label.position)){case"lft":a=s[1]-o,e=s[2];break;case"llft":a=s[1]-t*o,e=s[2]-t*o;break;case"rt":a=s[1]+o,e=s[2];break;case"lrt":a=s[1]+t*o,e=s[2]-t*o;break;case"urt":a=s[1]+t*o,e=s[2]+t*o;break;case"top":a=s[1],e=s[2]+o;break;case"bot":a=s[1],e=s[2]-o;break;default:a=s[1]-t*o,e=s[2]+t*o}return new y(b.COORDS_BY_USER,[a,e],this.board)},cloneToBackground:function(){var a,e=this.Radius(),o={id:this.id+"T"+this.numTraces,elementClass:b.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return e},getRadius:function(){return e},board:this.board,visProp:c.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return o.visProp.layer=this.board.options.layer.trace,this.numTraces++,c.clearVisPropOld(o),o.visPropCalc={visible:c.evaluate(o.visProp.visible)},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(o),this.board.renderer.enhancedRendering=a,this.traces[o.id]=o.rendNode,this},addTransform:function(a){var e,o=c.isArray(a)?a:[a],s=o.length;for(e=0;e<s;e++)this.center.transformations.push(o[e]),this.method==="twoPoints"&&this.point2.transformations.push(o[e]);return this},snapToGrid:function(){var a=c.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(a,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(a,!0),this},snapToPoints:function(){var a=c.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(a),this.method==="twoPoints"&&this.point2.handleSnapToPoints(a),this},X:function(a){return this.Radius()*Math.cos(2*a*Math.PI)+this.center.coords.usrCoords[1]},Y:function(a){return this.Radius()*Math.sin(2*a*Math.PI)+this.center.coords.usrCoords[2]},Z:function(a){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var a=this.Radius();return a*a*Math.PI},bounds:function(){var a=this.center.coords.usrCoords,e=this.Radius();return[a[1]-e,a[2]+e,a[1]+e,a[2]-e]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),g.createCircle=function(a,e,o){var s,t,h,u,d,n=["center","point2"];if(t=[],d=a.select(e[0]),c.isObject(d)&&d.elementClass===b.OBJECT_CLASS_CIRCLE&&c.isTransformationOrArray(e[1]))return u=c.copyAttributes(o,a.options,"circle"),(s=m.createEllipse(a,[d.center,d.center,function(){return 2*d.Radius()}],u)).addTransform(e[1]),s;for(h=0;h<e.length;h++)if(c.isPointType(a,e[h])){if((t=t.concat(c.providePoints(a,[e[h]],o,"circle",[n[h]])))[t.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else t.push(e[h]);if(u=c.copyAttributes(o,a.options,"circle"),t.length===2&&c.isPoint(t[0])&&c.isPoint(t[1]))s=new g.Circle(a,"twoPoints",t[0],t[1],u);else if((c.isNumber(t[0])||c.isFunction(t[0])||c.isString(t[0]))&&c.isPoint(t[1]))s=new g.Circle(a,"pointRadius",t[1],t[0],u);else if((c.isNumber(t[1])||c.isFunction(t[1])||c.isString(t[1]))&&c.isPoint(t[0]))s=new g.Circle(a,"pointRadius",t[0],t[1],u);else if(t[0].elementClass===b.OBJECT_CLASS_CIRCLE&&c.isPoint(t[1]))s=new g.Circle(a,"pointCircle",t[1],t[0],u);else if(t[1].elementClass===b.OBJECT_CLASS_CIRCLE&&c.isPoint(t[0]))s=new g.Circle(a,"pointCircle",t[0],t[1],u);else if(t[0].elementClass===b.OBJECT_CLASS_LINE&&c.isPoint(t[1]))s=new g.Circle(a,"pointLine",t[1],t[0],u);else if(t[1].elementClass===b.OBJECT_CLASS_LINE&&c.isPoint(t[0]))s=new g.Circle(a,"pointLine",t[0],t[1],u);else{if(!(e.length===3&&c.isPoint(t[0])&&c.isPoint(t[1])&&c.isPoint(t[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!g.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");s=g.elements.circumcircle(a,t,u)}for(s.isDraggable=!0,s.setParents(t),s.elType="circle",h=0;h<t.length;h++)c.isPoint(t[h])&&s.inherits.push(t[h]);return s},g.registerElement("circle",g.createCircle),{Circle:g.Circle,createCircle:g.createCircle}}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element"],function(g,E,y,b,m,l,c){return g.Polygon=function(a,e,o){this.constructor(a,o,E.OBJECT_TYPE_POLYGON,E.OBJECT_CLASS_AREA);var s,t,h,u,d,n=l.copyAttributes(o,a.options,"polygon","borders");for(this.withLines=o.withlines,this.attr_line=n,this.vertices=[],s=0;s<e.length;s++)this.vertices[s]=this.board.select(e[s]),this.vertices[s]._is_new&&(delete this.vertices[s]._is_new,this.vertices[s]._is_new_pol=!0);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(h=this.vertices.length-1,u=0;u<h;u++)s=(u+1)%h,n.id=n.ids&&n.ids[s],n.name=n.names&&n.names[s],n.strokecolor=l.isArray(n.colors)&&n.colors[s%n.colors.length]||n.strokecolor,n.visible=l.exists(o.borders.visible)?o.borders.visible:o.visible,n.strokecolor===!1&&(n.strokecolor="none"),(t=a.create("segment",[this.vertices[s],this.vertices[s+1]],n)).dump=!1,this.borders[s]=t,t.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),s=0;s<this.vertices.length-1;s++)d=this.board.select(this.vertices[s]),l.exists(d._is_new_pol)?(this.addChild(d),delete d._is_new_pol):d.addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=g.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},g.Polygon.prototype=new c,g.extend(g.Polygon.prototype,{pnpoly:function(a,e,o){return m.pnpoly(a,e,this.vertices,o)},hasPoint:function(a,e){var o,s;if(l.evaluate(this.visProp.hasinnerpoints)&&this.pnpoly(a,e))return!0;for(s=this.borders.length,o=0;o<s;o++)if(this.borders[o].hasPoint(a,e))return!0;return!1},updateRenderer:function(){var a,e;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(e=this.vertices.length,this.isReal=!0,a=0;a<e;++a)if(!this.vertices[a].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var a,e,o,s,t;if(this.vertices.length===0)return new y(E.COORDS_BY_USER,[1,0,0],this.board);for(o=a=this.vertices[0].X(),s=e=this.vertices[0].Y(),t=0;t<this.vertices.length;t++)this.vertices[t].X()<a&&(a=this.vertices[t].X()),this.vertices[t].X()>o&&(o=this.vertices[t].X()),this.vertices[t].Y()>e&&(e=this.vertices[t].Y()),this.vertices[t].Y()<s&&(s=this.vertices[t].Y());return new y(E.COORDS_BY_USER,[.5*(a+o),.5*(e+s)],this.board)},getLabelAnchor:g.shortcut(g.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var a,e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.vertices=this.vertices,e.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.board=this.board,l.clearVisPropOld(e),e.visPropCalc={visible:l.evaluate(e.visProp.visible)},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(e),this.board.renderer.enhancedRendering=a,this.traces[e.id]=e.rendNode,this},hideElement:function(a){var e;if(g.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!a)for(e=0;e<this.borders.length;e++)this.borders[e].hideElement();this.hasLabel&&l.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(a){var e;if(g.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!a)for(e=0;e<this.borders.length;e++)this.borders[e].showElement().updateRenderer();return l.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(m.signedPolygon(this.vertices,!0))},Perimeter:function(){var a,e=this.vertices.length,o=0;for(a=1;a<e;++a)o+=this.vertices[a].Dist(this.vertices[a-1]);return o},boundingBox:function(){var a,e,o=[0,0,0,0],s=this.vertices.length-1;if(s===0)return o;for(o[0]=this.vertices[0].X(),o[2]=o[0],o[1]=this.vertices[0].Y(),o[3]=o[1],a=1;a<s;++a)(e=this.vertices[a].X())<o[0]?o[0]=e:e>o[2]&&(o[2]=e),(e=this.vertices[a].Y())>o[1]?o[1]=e:e<o[3]&&(o[3]=e);return o},bounds:function(){return this.boundingBox()},remove:function(){var a;for(a=0;a<this.borders.length;a++)this.board.removeObject(this.borders[a]);c.prototype.remove.call(this)},findPoint:function(a){var e;if(!l.isPoint(a))return-1;for(e=0;e<this.vertices.length;e++)if(this.vertices[e].id===a.id)return e;return-1},addPoints:function(a){var e,o=Array.prototype.slice.call(arguments);return e=this.elType==="polygonalchain"?this.vertices.length-1:this.vertices.length-2,this.insertPoints.apply(this,[e].concat(o))},insertPoints:function(a,e){var o,s,t,h,u;if(arguments.length===0)return this;if(t=this.vertices.length-1,this.elType==="polygon"&&t--,a<-1||a>t)return this;for(s=arguments.length-1,o=1;o<s+1;o++)(u=l.providePoints(this.board,[arguments[o]],{},"polygon",["vertices"])[0])._is_new&&(this.addChild(u),delete u._is_new),this.vertices.splice(a+o,0,u);if(this.withLines)for(h=a+1,this.elType==="polygon"?a<0?(this.vertices[this.vertices.length-1]=this.vertices[0],this.borders[this.borders.length-1].point2=this.vertices[this.vertices.length-1]):this.borders[a].point2=this.vertices[h]:a>=0&&(a<this.borders.length?this.borders[a].point2=this.vertices[h]:h=a),o=h;o<h+s;o++)this.borders.splice(o,0,this.board.create("segment",[this.vertices[o],this.vertices[o+1]],this.attr_line));return this.inherits=[],this.inherits.push(this.vertices,this.borders),this.board.update(),this},removePoints:function(a){var e,o,s,t,h=[],u=[],d=[],n=[];for(this.elType==="polygon"&&(t=this.vertices.pop()),e=0;e<arguments.length;e++)s=arguments[e],l.isPoint(s)&&(s=this.findPoint(s)),l.isNumber(s)&&s>-1&&s<this.vertices.length&&l.indexOf(d,s)===-1&&d.push(s);if(d.length===0)return this.elType==="polygon"&&this.vertices.push(t),this;for(e=0;e<d.length;e++)this.vertices[d[e]].removeChild(this);for(d=d.sort(),h=this.vertices.slice(),u=this.borders.slice(),this.withLines&&n.push([d[d.length-1]]),e=d.length-1;e>-1;e--)h[d[e]]=-1,this.withLines&&d.length>1&&d[e]-1>d[e-1]&&(n[n.length-1][1]=d[e],n.push([d[e-1]]));for(this.withLines&&(n[n.length-1][1]=d[0]),this.vertices=[],e=0;e<h.length;e++)l.isPoint(h[e])&&this.vertices.push(h[e]);if(this.elType==="polygon"&&this.vertices.length>1&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;e<n.length;e++){for(o=n[e][1]-1;o<n[e][0]+1;o++)o<0?this.elType==="polygon"&&(this.board.removeObject(this.borders[u.length-1]),u[u.length-1]=-1):o<u.length&&(this.board.removeObject(this.borders[o]),u[o]=-1);n[e][1]!==0&&n[e][0]!==h.length-1&&(u[n[e][0]-1]=this.board.create("segment",[h[n[e][1]-1],h[n[e][0]+1]],this.attr_line))}for(this.borders=[],e=0;e<u.length;e++)u[e]!==-1&&this.borders.push(u[e]);this.elType==="polygon"&&this.vertices.length>2&&(n[0][1]===this.vertices.length-1||n[n.length-1][1]===0)&&this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.inherits=[],this.inherits.push(this.vertices,this.borders),this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var a,e=c.prototype.getAttributes.call(this);if(this.withLines)for(e.lines=e.lines||{},e.lines.ids=[],e.lines.colors=[],a=0;a<this.borders.length;a++)e.lines.ids.push(this.borders[a].id),e.lines.colors.push(this.borders[a].visProp.strokecolor);return e},snapToGrid:function(){var a,e;for(e=!!l.evaluate(this.visProp.snaptogrid),a=0;a<this.vertices.length;a++)this.vertices[a].handleSnapToGrid(e,!0)},setPositionDirectly:function(a,e,o){var s,t,h,u=new y(a,e,this.board),d=new y(a,o,this.board);for(h=this.vertices.length-1,t=0;t<h;t++)if(!this.vertices[t].draggable())return this;return s=b.subtract(u.usrCoords,d.usrCoords),this.board.create("transform",s.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(a){var e,o,s,t,h,u,d,n=g.Math.Geometry.sortVertices(this.vertices),p=g.Math.Geometry.sortVertices(a.vertices),f=n.length-1,v=p.length-1,C=[],_=function(P,x,S){return(x[1]-P[1])*(S[2]-P[2])-(x[2]-P[2])*(S[1]-P[1])>=0};for(s=0;s<v;s++)C.push(p[s]);for(s=0;s<f;s++)for(o=C.slice(0),C=[],h=o[(e=o.length)-1],t=0;t<e;t++)u=o[t],_(n[s],n[s+1],u)?(_(n[s],n[s+1],h)||((d=g.Math.Geometry.meetSegmentSegment(h,u,n[s],n[s+1]))[0][1]/=d[0][0],d[0][2]/=d[0][0],d[0][0]=1,C.push(d[0])),C.push(u)):_(n[s],n[s+1],h)&&((d=g.Math.Geometry.meetSegmentSegment(h,u,n[s],n[s+1]))[0][1]/=d[0][0],d[0][2]/=d[0][0],d[0][0]=1,C.push(d[0])),h=u;return C},intersect:function(a){return this.sutherlandHodgman(a)}}),g.createPolygon=function(a,e,o){var s,t,h,u,d,n,p=[],f=!1;if(l.copyAttributes(o,a.options,"polygon"),(u=a.select(e[0]))===null&&(u=e[0]),l.isObject(u)&&u.type===E.OBJECT_TYPE_POLYGON&&l.isTransformationOrArray(e[1]))for(f=!0,h=u.vertices.length-1,n=l.copyAttributes(o,a.options,"polygon","vertices"),t=0;t<h;t++)n.withlabel&&(n.name=u.vertices[t].name===""?"":u.vertices[t].name+"'"),p.push(a.create("point",[u.vertices[t],e[1]],n));else if((p=l.providePoints(a,e,o,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon / polygonalchain with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(d=l.copyAttributes(o,a.options,"polygon"),(s=new g.Polygon(a,p,d)).isDraggable=!0,f)for(s.prepareUpdate().update().updateVisibility().updateRenderer(),h=u.vertices.length-1,t=0;t<h;t++)p[t].prepareUpdate().update().updateVisibility().updateRenderer();return s},g.createRegularPolygon=function(a,e,o){var s,t,h,u,d,n,p,f=[];if(h=e[(d=e.length)-1],l.isNumber(h)&&(e.length!==3||h<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(l.isNumber(a.select(h))?(d--,n=!1):(h=d,n=!0),(f=l.providePoints(a,e.slice(0,d),o,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(p=l.copyAttributes(o,a.options,"regularpolygon","vertices"),t=2;t<h;t++)u=a.create("transform",[Math.PI*(2-(h-2)/h),f[t-1]],{type:"rotate"}),n?(f[t].addTransform(f[t-2],u),f[t].fullUpdate()):(l.isArray(p.ids)&&p.ids.length>=h-2&&(p.id=p.ids[t-2]),f[t]=a.create("point",[f[t-2],u],p),f[t].type=E.OBJECT_TYPE_CAS,f[t].isDraggable=!0,f[t].visProp.fixed=!1);return p=l.copyAttributes(o,a.options,"regularpolygon"),(s=a.create("polygon",f,p)).elType="regularpolygon",s},g.createPolygonalChain=function(a,e,o){var s,t;return s=l.copyAttributes(o,a.options,"polygonalchain"),(t=a.create("polygon",e,s)).elType="polygonalchain",t.vertices.pop(),a.removeObject(t.borders[t.borders.length-1]),t.borders.pop(),t},g.registerElement("polygon",g.createPolygon),g.registerElement("regularpolygon",g.createRegularPolygon),g.registerElement("polygonalchain",g.createPolygonalChain),{Polygon:g.Polygon,createPolygon:g.createPolygon,createRegularPolygon:g.createRegularPolygon}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/numerics","math/plot","math/geometry","parser/geonext","utils/type","math/qdt"],function(g,E,y,b,m,l,c,a,e,o,s){return g.Curve=function(t,h,u){this.constructor(t,u,E.OBJECT_TYPE_CURVE,E.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=o.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.ticks=[],this.qdt=null,o.exists(h[0])?this.varname=h[0]:this.varname="x",this.xterm=h[1],this.yterm=h[2],this.generateTerm(this.varname,this.xterm,this.yterm,h[3],h[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),o.isString(this.xterm)&&this.notifyParents(this.xterm),o.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=o.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},g.Curve.prototype=new b,g.extend(g.Curve.prototype,{minX:function(){return o.evaluate(this.visProp.curvetype)==="polar"?0:new y(E.COORDS_BY_SCREEN,[.1*-this.board.canvasWidth,0],this.board,!1).usrCoords[1]},maxX:function(){return o.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:new y(E.COORDS_BY_SCREEN,[1.1*this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(t){return NaN},Y:function(t){return NaN},Z:function(t){return 1},hasPoint:function(t,h,u){var d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A,R=[],L=o.evaluate(this.visProp.numberpointslow),D=(this.maxX()-this.minX())/L,k=1/0;if(o.isObject(o.evaluate(this.visProp.precision))?(w=this.board._inputDevice,O=o.evaluate(this.visProp.precision[w])):O=this.board.options.precision.hasPoint,t=(n=new y(E.COORDS_BY_SCREEN,[t,h],this.board,!1)).usrCoords[1],h=n.usrCoords[2],this.bezierDegree===1&&o.evaluate(this.visProp.hasinnerpoints)&&a.windingNumber([1,t,h],this.points,!0)!==0)return!0;if(O+=.5*o.evaluate(this.visProp.strokewidth),O*=O,T=this.board.unitX*this.board.unitX,M=this.board.unitY*this.board.unitY,A=this.minX(),this.maxX(),o.exists(this._visibleArea)&&(A=this._visibleArea[0],D=(this._visibleArea[1]-A)/L),(N=o.evaluate(this.visProp.curvetype))==="parameter"||N==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),f=m.inverse(this.transformMat),t=(v=m.matVecMult(f,[1,t,h]))[1],h=v[2]),C=0,d=A;C<L;C++){if((k=(t-(_=this.X(d,!0)))*(t-_)*T+(h-(P=this.Y(d,!0)))*(h-P)*M)<=O)return!0;d+=D}else if(N==="plot"||N==="functiongraph"){for((!o.exists(u)||u<0)&&(u=0),o.exists(this.qdt)&&o.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?p=(x=(S=this.qdt.query(new y(E.COORDS_BY_USER,[t,h],this.board))).points).length:(x=this.points,p=this.numberPoints-1),C=u;C<p;C++)if(this.bezierDegree===3?R.push(a.projectCoordsToBeziersegment([1,t,h],this,C)):S?(x[C].prev&&(R=a.projectCoordsToSegment([1,t,h],x[C].prev.usrCoords,x[C].usrCoords)),x[C].next&&x[C+1]!==x[C].next&&(R=a.projectCoordsToSegment([1,t,h],x[C].usrCoords,x[C].next.usrCoords))):R=a.projectCoordsToSegment([1,t,h],x[C].usrCoords,x[C+1].usrCoords),R[1]>=0&&R[1]<=1&&(t-R[0][1])*(t-R[0][1])*T+(h-R[0][2])*(h-R[0][2])*M<=O)return!0;return!1}return k<O},allocatePoints:function(){var t,h;if(h=this.numberPoints,this.points.length<this.numberPoints)for(t=this.points.length;t<h;t++)this.points[t]=new y(E.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(o.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=c.checkReal(this.points),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var t,h,u,d,n,p,f=this.visProp.plotversion,v=!1;if(this.updateTransformMatrix(),this.updateDataArray(),h=this.minX(),u=this.maxX(),o.exists(this.dataX))for(this.numberPoints=this.dataX.length,t=this.numberPoints,this.allocatePoints(),p=0;p<t;p++)d=p,o.exists(this.dataY)?(n=p,this.points[p].setCoordinates(E.COORDS_BY_USER,[this.dataX[p],this.dataY[p]],!1)):(n=this.X(d),this.points[p].setCoordinates(E.COORDS_BY_USER,[this.dataX[p],this.Y(n,v)],!1)),this.points[p]._t=p,v=!0;else if(o.evaluate(this.visProp.doadvancedplot)?f===1||o.evaluate(this.visProp.doadvancedplotold)?c.updateParametricCurveOld(this,h,u):f===2?c.updateParametricCurve_v2(this,h,u):f===3?c.updateParametricCurve_v3(this,h,u):f===4?c.updateParametricCurve_v4(this,h,u):c.updateParametricCurve_v2(this,h,u):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=o.evaluate(this.visProp.numberpointshigh):this.numberPoints=o.evaluate(this.visProp.numberpointslow),this.allocatePoints(),c.updateParametricCurveNaive(this,h,u,this.numberPoints)),t=this.numberPoints,o.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new s(this.board.getBoundingBox()),p=0;p<this.points.length;p++)this.qdt.insert(this.points[p]),p>0&&(this.points[p].prev=this.points[p-1]),p<t-1&&(this.points[p].next=this.points[p+1]);for(o.evaluate(this.visProp.curvetype)!=="plot"&&o.evaluate(this.visProp.rdpsmoothing)&&(this.points=l.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),t=this.numberPoints,p=0;p<t;p++)this.updateTransform(this.points[p]);return this},updateTransformMatrix:function(){var t,h,u=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],h=0;h<u;h++)(t=this.transformations[h]).update(),this.transformMat=m.matMatMult(t.matrix,this.transformMat);return this},updateTransform:function(t){var h;return this.transformations.length>0&&(h=m.matVecMult(this.transformMat,t.usrCoords),t.setCoordinates(E.COORDS_BY_USER,h,!1,!0)),t},addTransform:function(t){var h,u=o.isArray(t)?t:[t],d=u.length;for(h=0;h<d;h++)this.transformations.push(u[h]);return this},interpolationFunctionFromArray:function(t){var h="data"+t,u=this;return function(d,n){var p,f,v,C,_=u[h],P=_.length,x=[];if(isNaN(d))return NaN;if(d<0)return o.isFunction(_[0])?_[0]():_[0];if(u.bezierDegree===3){if(d>=(P-1)/3)return o.isFunction(_[_.length-1])?_[_.length-1]():_[_.length-1];for(p=3*Math.floor(d),C=1-(v=d%1),f=0;f<4;f++)o.isFunction(_[p+f])?x[f]=_[p+f]():x[f]=_[p+f];return C*C*(C*x[0]+3*v*x[1])+(3*C*x[2]+v*x[3])*v*v}if((p=d>P-2?P-2:parseInt(Math.floor(d),10))===d)return o.isFunction(_[p])?_[p]():_[p];for(f=0;f<2;f++)o.isFunction(_[p+f])?x[f]=_[p+f]():x[f]=_[p+f];return x[0]+(x[1]-x[0])*(d-p)}},generateTerm:function(t,h,u,d,n){var p,f;o.isArray(h)?(this.dataX=h,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray.apply(this,["X"]),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=o.createFunction(h,this.board,t),o.isString(h)?this.visProp.curvetype="functiongraph":(o.isFunction(h)||o.isNumber(h))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),o.isArray(u)?(this.dataY=u,this.Y=this.interpolationFunctionFromArray.apply(this,["Y"])):this.Y=o.createFunction(u,this.board,t),o.isFunction(h)&&o.isArray(u)&&(p=o.createFunction(u[0],this.board,""),f=o.createFunction(u[1],this.board,""),this.X=function(v){return h(v)*Math.cos(v)+p()},this.Y=function(v){return h(v)*Math.sin(v)+f()},this.visProp.curvetype="polar"),o.exists(d)&&(this.minX=o.createFunction(d,this.board,"")),o.exists(n)&&(this.maxX=o.createFunction(n,this.board,""))},notifyParents:function(t){var h,u,d,n=!1;for(h in d={xterm:1,yterm:1})if(d.hasOwnProperty(h)&&this.hasOwnProperty(h)&&this[h].origin)for(u in n=!0,this[h].origin.deps)this[h].origin.deps.hasOwnProperty(u)&&this[h].origin.deps[u].addChild(this);n||e.findDependencies(this,t,this.board)},getLabelAnchor:function(){var t,h,u,d=.05*this.board.canvasWidth,n=.05*this.board.canvasHeight,p=.95*this.board.canvasWidth,f=.95*this.board.canvasHeight;switch(o.evaluate(this.visProp.label.position)){case"ulft":h=d,u=n;break;case"llft":h=d,u=f;break;case"rt":h=p,u=.5*f;break;case"lrt":h=p,u=f;break;case"urt":h=p,u=n;break;case"top":h=.5*p,u=n;break;case"bot":h=.5*p,u=f;break;default:h=d,u=.5*f}return t=new y(E.COORDS_BY_SCREEN,[h,u],this.board,!1),a.projectCoordsToCurve(t.usrCoords[1],t.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var t,h={id:this.id+"T"+this.numTraces,elementClass:E.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:o.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return h.visProp.layer=this.board.options.layer.trace,h.visProp.curvetype=this.visProp.curvetype,this.numTraces++,o.clearVisPropOld(h),h.visPropCalc={visible:o.evaluate(h.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(h),this.board.renderer.enhancedRendering=t,this.traces[h.id]=h.rendNode,this},bounds:function(){var t,h,u,d=1/0,n=-1/0,p=1/0,f=-1/0,v=this.points.length;if(this.bezierDegree===3){for(t=0;t<v;t++)this.points[t].X=o.bind(function(){return this.usrCoords[1]},this.points[t]),this.points[t].Y=o.bind(function(){return this.usrCoords[2]},this.points[t]);return u=(h=l.bezier(this.points))[3](),d=l.fminbr(function(C){return h[0](C)},[0,u]),n=l.fminbr(function(C){return-h[0](C)},[0,u]),p=l.fminbr(function(C){return h[1](C)},[0,u]),f=l.fminbr(function(C){return-h[1](C)},[0,u]),d=h[0](d),n=h[0](n),p=h[1](p),[d,f=h[1](f),n,p]}for(t=0;t<v;t++)d>this.points[t].usrCoords[1]&&(d=this.points[t].usrCoords[1]),n<this.points[t].usrCoords[1]&&(n=this.points[t].usrCoords[1]),p>this.points[t].usrCoords[2]&&(p=this.points[t].usrCoords[2]),f<this.points[t].usrCoords[2]&&(f=this.points[t].usrCoords[2]);return[d,f,n,p]},getParents:function(){var t=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(t=this.parents),t},moveTo:function(t){var h,u=[];return this.points.length>0&&!o.evaluate(this.visProp.fixed)&&(h=this.points[0],u=t.length===3?[t[0]-h.usrCoords[0],t[1]-h.usrCoords[1],t[2]-h.usrCoords[2]]:[t[0]-h.usrCoords[1],t[1]-h.usrCoords[2]],this.setPosition(E.COORDS_BY_USER,u)),this},getTransformationSource:function(){var t,h;return o.exists(this._transformationSource)&&(h=this._transformationSource).elementClass===E.OBJECT_CLASS_CURVE&&(t=!0),[t,h]},pnpoly:function(t,h,u){var d,n,p,f,v,C,_=this.points,P=!1;for(u===E.COORDS_BY_USER?(f=(C=new y(E.COORDS_BY_USER,[t,h],this.board)).scrCoords[1],v=C.scrCoords[2]):(f=t,v=h),d=0,n=(p=this.points.length)-2;d<p-1;n=d++)_[d].scrCoords[2]>v!=_[n].scrCoords[2]>v&&f<(_[n].scrCoords[1]-_[d].scrCoords[1])*(v-_[d].scrCoords[2])/(_[n].scrCoords[2]-_[d].scrCoords[2])+_[d].scrCoords[1]&&(P=!P);return P}}),g.createCurve=function(t,h,u){var d,n,p=o.copyAttributes(u,t.options,"curve");return d=t.select(h[0],!0),o.isTransformationOrArray(h[1])&&o.isObject(d)&&(d.type===E.OBJECT_TYPE_CURVE||d.type===E.OBJECT_TYPE_ANGLE||d.type===E.OBJECT_TYPE_ARC||d.type===E.OBJECT_TYPE_CONIC||d.type===E.OBJECT_TYPE_SECTOR)?(d.type===E.OBJECT_TYPE_SECTOR?p=o.copyAttributes(u,t.options,"sector"):d.type===E.OBJECT_TYPE_ARC?p=o.copyAttributes(u,t.options,"arc"):d.type===E.OBJECT_TYPE_ANGLE?(o.exists(u.withLabel)||(u.withLabel=!1),p=o.copyAttributes(u,t.options,"angle")):p=o.copyAttributes(u,t.options,"curve"),p=o.copyAttributes(p,t.options,"curve"),(n=new g.Curve(t,["x",[],[]],p)).updateDataArray=function(){var f,v=d.numberPoints;for(this.bezierDegree=d.bezierDegree,this.dataX=[],this.dataY=[],f=0;f<v;f++)this.dataX.push(d.points[f].usrCoords[1]),this.dataY.push(d.points[f].usrCoords[2]);return this},n.addTransform(h[1]),d.addChild(n),n.setParents([d]),n._transformationSource=d,n):(p=o.copyAttributes(u,t.options,"curve"),new g.Curve(t,["x"].concat(h),p))},g.registerElement("curve",g.createCurve),g.createFunctiongraph=function(t,h,u){var d,n=["x","x"].concat(h);return(d=o.copyAttributes(u,t.options,"curve")).curvetype="functiongraph",new g.Curve(t,n,d)},g.registerElement("functiongraph",g.createFunctiongraph),g.registerElement("plot",g.createFunctiongraph),g.createSpline=function(t,h,u){var d,n,p;return n=function(){var f,v=[],C=[];return[function(_,P){var x,S,O;if(!P){if(v=[],C=[],h.length===2&&o.isArray(h[0])&&o.isArray(h[1])&&h[0].length===h[1].length)for(x=0;x<h[0].length;x++)o.isFunction(h[0][x])?v.push(h[0][x]()):v.push(h[0][x]),o.isFunction(h[1][x])?C.push(h[1][x]()):C.push(h[1][x]);else for(x=0;x<h.length;x++)if(o.isPoint(h[x]))v.push(h[x].X()),C.push(h[x].Y());else if(o.isArray(h[x])&&h[x].length===2)for(S=0;S<h.length;S++)o.isFunction(h[S][0])?v.push(h[S][0]()):v.push(h[S][0]),o.isFunction(h[S][1])?C.push(h[S][1]()):C.push(h[S][1]);else o.isFunction(h[x])&&h[x]().length===2&&(O=h[x](),v.push(O[0]),C.push(O[1]));f=l.splineDef(v,C)}return l.splineEval(_,v,C,f)},function(){return v[0]},function(){return v[v.length-1]}]},(u=o.copyAttributes(u,t.options,"curve")).curvetype="functiongraph",p=n(),(d=new g.Curve(t,["x","x",p[0],p[1],p[2]],u)).setParents(h),d.elType="spline",d},g.registerElement("spline",g.createSpline),g.createCardinalSpline=function(t,h,u){var d,n,p,f,v,C,_,P,x,S,O=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!o.exists(h[0])||!o.isArray(h[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+O);if(!o.exists(h[1])||!o.isNumber(h[1])&&!o.isFunction(h[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+O);if(!o.exists(h[2])||!o.isString(h[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+O);if(u=o.copyAttributes(u,t.options,"curve"),(u=o.copyAttributes(u,t.options,"cardinalspline")).curvetype="parameter",C=h[0],_=[],!u.isarrayofcoordinates&&C.length===2&&o.isArray(C[0])&&o.isArray(C[1])&&C[0].length===C[1].length)for(P=0;P<C[0].length;P++)_[P]=[],o.isFunction(C[0][P])?_[P].push(C[0][P]()):_[P].push(C[0][P]),o.isFunction(C[1][P])?_[P].push(C[1][P]()):_[P].push(C[1][P]);else for(P=0;P<C.length;P++)o.isString(C[P])?_.push(t.select(C[P])):o.isPoint(C[P])?_.push(C[P]):o.isArray(C[P])&&C[P].length===2?(_[P]=[],o.isFunction(C[P][0])?_[P].push(C[P][0]()):_[P].push(C[P][0]),o.isFunction(C[P][1])?_[P].push(C[P][1]()):_[P].push(C[P][1])):o.isFunction(C[P])&&C[P]().length===2&&_.push(h[P]());if(u.createpoints===!0)p=o.providePoints(t,_,u,"cardinalspline",["points"]);else for(p=[],n=function(w){return{X:function(){return _[w][0]},Y:function(){return _[w][1]},Dist:function(T){var M=this.X()-T.X(),N=this.Y()-T.Y();return Math.sqrt(M*M+N*N)}}},P=0;P<_.length;P++)o.isPoint(_[P])?p.push(_[P]):p.push(n(P));for(f=h[1],v=h[2],S=["x"].concat(l.CardinalSpline(p,f,v)),d=new g.Curve(t,S,u),x=p.length,d.setParents(p),P=0;P<x;P++)C=p[P],o.isPoint(C)&&(o.exists(C._is_new)?(d.addChild(C),delete C._is_new):C.addChild(d));return d.elType="cardinalspline",d},g.registerElement("cardinalspline",g.createCardinalSpline),g.createMetapostSpline=function(t,h,u){var d,n,p,f,v,C,_,P,x=`
Possible parent types: [points:array, controls:object`;if(!o.exists(h[0])||!o.isArray(h[0]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 1 'points' has to be array of points or coordinate pairs"+x);if(!o.exists(h[1])||!o.isObject(h[1]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 2 'controls' has to be a JavaScript object'"+x);if(u=o.copyAttributes(u,t.options,"curve"),(u=o.copyAttributes(u,t.options,"metapostspline")).curvetype="parameter",v=h[0],C=[],!u.isarrayofcoordinates&&v.length===2&&o.isArray(v[0])&&o.isArray(v[1])&&v[0].length===v[1].length)for(_=0;_<v[0].length;_++)C[_]=[],o.isFunction(v[0][_])?C[_].push(v[0][_]()):C[_].push(v[0][_]),o.isFunction(v[1][_])?C[_].push(v[1][_]()):C[_].push(v[1][_]);else for(_=0;_<v.length;_++)o.isString(v[_])?C.push(t.select(v[_])):o.isPoint(v[_])?C.push(v[_]):o.isArray(v[_])&&v[_].length===2?(C[_]=[],o.isFunction(v[_][0])?C[_].push(v[_][0]()):C[_].push(v[_][0]),o.isFunction(v[_][1])?C[_].push(v[_][1]()):C[_].push(v[_][1])):o.isFunction(v[_])&&v[_]().length===2&&C.push(h[_]());if(u.createpoints===!0)p=o.providePoints(t,C,u,"metapostspline",["points"]);else for(p=[],n=function(S){return{X:function(){return C[S][0]},Y:function(){return C[S][1]}}},_=0;_<C.length;_++)o.isPoint(C[_])?p.push(C[_]):p.push(n);for(f=h[1],(d=new g.Curve(t,["t",[],[],0,v.length-1],u)).updateDataArray=function(){var S,O,w=p.length,T=[];for(O=0;O<w;O++)T.push([p[O].X(),p[O].Y()]);S=g.Math.Metapost.curve(T,f),this.dataX=S[0],this.dataY=S[1]},d.bezierDegree=3,P=p.length,d.setParents(p),_=0;_<P;_++)o.isPoint(p[_])&&p[_].addChild(d);return d.elType="metapostspline",d},g.registerElement("metapostspline",g.createMetapostSpline),g.createRiemannsum=function(t,h,u){var d,n,p,f,v,C;if((C=o.copyAttributes(u,t.options,"riemannsum")).curvetype="plot",p=h[0],d=o.createFunction(h[1],t,""),!o.exists(d))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(n=o.createFunction(h[2],t,"",!1),!o.exists(n))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return f=[[0],[0]].concat(h.slice(3)),(v=t.create("curve",f,C)).sum=0,v.Value=function(){return this.sum},v.updateDataArray=function(){var _=l.riemann(p,d(),n(),this.minX(),this.maxX());this.dataX=_[0],this.dataY=_[1],this.sum=_[2]},v},g.registerElement("riemannsum",g.createRiemannsum),g.createTracecurve=function(t,h,u){var d,n,p,f;if(h.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(n=t.select(h[0]),p=t.select(h[1]),n.type!==E.OBJECT_TYPE_GLIDER||!o.isPoint(p))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof h[0]+"' and '"+typeof h[1]+`'.
Possible parent types: [glider, point]`);return(f=o.copyAttributes(u,t.options,"tracecurve")).curvetype="plot",(d=t.create("curve",[[0],[0]],f)).updateDataArray=function(){var v,C,_,P,x,S,O,w,T,M=f.numberpoints,N=n.position,A=n.slideObject,R=A.minX();for(C=(A.maxX()-R)/M,this.dataX=[],this.dataY=[],A.elementClass!==E.OBJECT_CLASS_CURVE&&M++,v=0;v<M;v++){for(P in _=R+v*C,S=A.X(_)/A.Z(_),O=A.Y(_)/A.Z(_),n.setPositionDirectly(E.COORDS_BY_USER,[S,O]),w=!1,this.board.objects)if(this.board.objects.hasOwnProperty(P)&&((x=this.board.objects[P])===n&&(w=!0),w&&x.needsRegularUpdate&&(T=x.visProp.trace,x.visProp.trace=!1,x.needsUpdate=!0,x.update(!0),x.visProp.trace=T,x===p)))break;this.dataX[v]=p.X(),this.dataY[v]=p.Y()}for(P in n.position=N,w=!1,this.board.objects)if(this.board.objects.hasOwnProperty(P)&&((x=this.board.objects[P])===n&&(w=!0),w&&x.needsRegularUpdate&&(T=x.visProp.trace,x.visProp.trace=!1,x.needsUpdate=!0,x.update(!0),x.visProp.trace=T,x===p)))break},d},g.registerElement("tracecurve",g.createTracecurve),g.createStepfunction=function(t,h,u){var d,n;if(h.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return n=o.copyAttributes(u,t.options,"stepfunction"),(d=t.create("curve",h,n)).updateDataArray=function(){var p,f=0,v=this.xterm.length;if(this.dataX=[],this.dataY=[],v!==0)for(this.dataX[f]=this.xterm[0],this.dataY[f]=this.yterm[0],++f,p=1;p<v;++p)this.dataX[f]=this.xterm[p],this.dataY[f]=this.dataY[f-1],++f,this.dataX[f]=this.xterm[p],this.dataY[f]=this.yterm[p],++f},d},g.registerElement("stepfunction",g.createStepfunction),g.createDerivative=function(t,h,u){var d,n,p,f,v;if(h.length!==1&&h[0].class!==E.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return v=o.copyAttributes(u,t.options,"curve"),n=h[0],p=l.D(n.X),f=l.D(n.Y),(d=t.create("curve",[function(C){return n.X(C)},function(C){return f(C)/p(C)},n.minX(),n.maxX()],v)).setParents(n),d},g.registerElement("derivative",g.createDerivative),g.createCurveIntersection=function(t,h,u){var d;if(h.length!==2)throw new Error(`JSXGraph: Can't create curve intersection with given parent'
Possible parent types: [array, array|function]`);return(d=t.create("curve",[[],[]],u)).updateDataArray=function(){var n=g.Math.Clip.intersection(h[0],h[1],this.board);this.dataX=n[0],this.dataY=n[1]},d},g.createCurveUnion=function(t,h,u){var d;if(h.length!==2)throw new Error(`JSXGraph: Can't create curve union with given parent'
Possible parent types: [array, array|function]`);return(d=t.create("curve",[[],[]],u)).updateDataArray=function(){var n=g.Math.Clip.union(h[0],h[1],this.board);this.dataX=n[0],this.dataY=n[1]},d},g.createCurveDifference=function(t,h,u){var d;if(h.length!==2)throw new Error(`JSXGraph: Can't create curve difference with given parent'
Possible parent types: [array, array|function]`);return(d=t.create("curve",[[],[]],u)).updateDataArray=function(){var n=g.Math.Clip.difference(h[0],h[1],this.board);this.dataX=n[0],this.dataY=n[1]},d},g.registerElement("curvedifference",g.createCurveDifference),g.registerElement("curveintersection",g.createCurveIntersection),g.registerElement("curveunion",g.createCurveUnion),g.createBoxPlot=function(t,h,u){var d,n,p,f=o.copyAttributes(u,t.options,"boxplot");if(h.length!==3)throw new Error(`JSXGraph: Can't create box plot with given parent'
Possible parent types: [array, number|function, number|function] containing quantiles, axis, width`);if(h[0].length<5)throw new Error(`JSXGraph: Can't create box plot with given parent[0]'
parent[0] has to conatin at least 5 quantiles.`);for(d=t.create("curve",[[],[]],f),p=h[0].length,d.Q=[],n=0;n<p;n++)d.Q[n]=o.createFunction(h[0][n],t,null,!0);return d.x=o.createFunction(h[1],t,null,!0),d.w=o.createFunction(h[2],t,null,!0),d.updateDataArray=function(){var v,C,_,P,x,S,O,w,T;O=o.evaluate(this.visProp.smallwidth),w=o.evaluate(this.visProp.dir),_=(T=this.x())-.5*this.w(),P=T-.5*this.w()*O,x=T+.5*this.w(),v=[T,P,S=T+.5*this.w()*O,T,T,_,_,x,x,T,NaN,_,x,NaN,T,T,P,S,T],C=[this.Q[0](),this.Q[0](),this.Q[0](),this.Q[0](),this.Q[1](),this.Q[1](),this.Q[3](),this.Q[3](),this.Q[1](),this.Q[1](),NaN,this.Q[2](),this.Q[2](),NaN,this.Q[3](),this.Q[4](),this.Q[4](),this.Q[4](),this.Q[4]()],w==="vertical"?(this.dataX=v,this.dataY=C):(this.dataX=C,this.dataY=v)},d},g.registerElement("boxplot",g.createBoxPlot),{Curve:g.Curve,createCardinalSpline:g.createCardinalSpline,createCurve:g.createCurve,createCurveDifference:g.createCurveDifference,createCurveIntersection:g.createCurveIntersection,createCurveUnion:g.createCurveUnion,createDerivative:g.createDerivative,createFunctiongraph:g.createFunctiongraph,createMetapostSpline:g.createMetapostSpline,createPlot:g.createFunctiongraph,createSpline:g.createSpline,createRiemannsum:g.createRiemannsum,createStepfunction:g.createStepfunction,createTracecurve:g.createTracecurve}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants"],function(g,E,y,b,m,l,c){return g.createArc=function(a,e,o){var s,t,h;if((h=l.providePoints(a,e,o,"arc",["center","radiusPoint","anglePoint"]))===!1||h.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return t=l.copyAttributes(o,a.options,"arc"),(s=a.create("curve",[[0],[0]],t)).elType="arc",s.setParents(h),s.type=c.OBJECT_TYPE_ARC,s.center=h[0],s.radiuspoint=h[1],s.point2=s.radiuspoint,s.anglepoint=h[2],s.point3=s.anglepoint,l.exists(s.center._is_new)?(s.addChild(s.center),delete s.center._is_new):s.center.addChild(s),l.exists(s.radiuspoint._is_new)?(s.addChild(s.radiuspoint),delete s.radiuspoint._is_new):s.radiuspoint.addChild(s),l.exists(s.anglepoint._is_new)?(s.addChild(s.anglepoint),delete s.anglepoint._is_new):s.anglepoint.addChild(s),s.useDirection=t.usedirection,s.updateDataArray=function(){var u,d,n,p,f,v=1,C=this.radiuspoint,_=this.center,P=this.anglepoint,x=l.evaluate(this.visProp.selection);d=E.rad(C,_,P),(x==="minor"&&d>Math.PI||x==="major"&&d<Math.PI)&&(v=-1),this.useDirection&&(n=h[1].coords.usrCoords,p=h[3].coords.usrCoords,f=h[2].coords.usrCoords,(n[1]-f[1])*(n[2]-p[2])-(n[2]-f[2])*(n[1]-p[1])<0?(this.radiuspoint=h[1],this.anglepoint=h[2]):(this.radiuspoint=h[2],this.anglepoint=h[1])),C=C.coords.usrCoords,_=_.coords.usrCoords,P=P.coords.usrCoords,u=E.bezierArc(C,_,P,!1,v),this.dataX=u[0],this.dataY=u[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},s.Radius=function(){return this.radiuspoint.Dist(this.center)},s.getRadius=function(){return g.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},s.Value=function(){return this.Radius()*E.rad(this.radiuspoint,this.center,this.anglepoint)},s.hasPoint=function(u,d){var n,p,f,v,C,_,P,x=this.Radius();return l.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(u,d):(l.isObject(l.evaluate(this.visProp.precision))?(P=this.board._inputDevice,_=l.evaluate(this.visProp.precision[P])):_=this.board.options.precision.hasPoint,_/=Math.min(this.board.unitX,this.board.unitY),p=new b(c.COORDS_BY_SCREEN,[u,d],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),v=y.inverse(this.transformMat),C=y.matVecMult(v,p.usrCoords),p=new b(c.COORDS_BY_USER,C,this.board)),n=this.center.coords.distance(c.COORDS_BY_USER,p),(f=Math.abs(n-x)<_)&&(f=E.coordsOnArc(this,p)),f)},s.hasPointSector=function(u,d){var n=new b(c.COORDS_BY_SCREEN,[u,d],this.board),p=this.Radius(),f=this.center.coords.distance(c.COORDS_BY_USER,n)<p;return f&&(f=E.coordsOnArc(this,n)),f},s.getTextAnchor=function(){return this.center.coords},s.getLabelAnchor=function(){var u,d,n,p,f,v=E.rad(this.radiuspoint,this.center,this.anglepoint),C=10/this.board.unitX,_=10/this.board.unitY,P=this.point2.coords.usrCoords,x=this.center.coords.usrCoords,S=P[1]-x[1],O=P[2]-x[2],w=l.evaluate(this.visProp.selection),T=this.label?this.label.visProp:this.visProp.label;return(w==="minor"&&v>Math.PI||w==="major"&&v<Math.PI)&&(v=-(2*Math.PI-v)),n=(u=new b(c.COORDS_BY_USER,[x[1]+Math.cos(.5*v)*S-Math.sin(.5*v)*O,x[2]+Math.sin(.5*v)*S+Math.cos(.5*v)*O],this.board)).usrCoords[1]-x[1],p=u.usrCoords[2]-x[2],n=n*((f=Math.sqrt(n*n+p*p))+C)/f,p=p*(f+_)/f,d=[x[1]+n,x[2]+p],T.position=E.calcLabelQuadrant(E.rad([1,0],[0,0],d)),new b(c.COORDS_BY_USER,d,this.board)},s.updateQuadraticform=m.Circle.prototype.updateQuadraticform,s.updateStdform=m.Circle.prototype.updateStdform,s.methodMap=g.deepCopy(s.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),s.prepareUpdate().update(),s},g.registerElement("arc",g.createArc),g.createSemicircle=function(a,e,o){var s,t,h,u;if((u=l.providePoints(a,e,o,"point"))===!1||u.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point]`);return h=l.copyAttributes(o,a.options,"semicircle","center"),(t=a.create("midpoint",u,h)).dump=!1,h=l.copyAttributes(o,a.options,"semicircle"),(s=a.create("arc",[t,u[1],u[0]],h)).elType="semicircle",s.setParents([u[0].id,u[1].id]),s.subs={midpoint:t},s.inherits.push(t),s.midpoint=s.center=t,s},g.registerElement("semicircle",g.createSemicircle),g.createCircumcircleArc=function(a,e,o){var s,t,h,u;if((u=l.providePoints(a,e,o,"point"))===!1||u.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);return h=l.copyAttributes(o,a.options,"circumcirclearc","center"),(t=a.create("circumcenter",u,h)).dump=!1,(h=l.copyAttributes(o,a.options,"circumcirclearc")).usedirection=!0,(s=a.create("arc",[t,u[0],u[2],u[1]],h)).elType="circumcirclearc",s.setParents([u[0].id,u[1].id,u[2].id]),s.subs={center:t},s.inherits.push(t),s.center=t,s},g.registerElement("circumcirclearc",g.createCircumcircleArc),g.createMinorArc=function(a,e,o){return o.selection="minor",g.createArc(a,e,o)},g.registerElement("minorarc",g.createMinorArc),g.createMajorArc=function(a,e,o){return o.selection="major",g.createArc(a,e,o)},g.registerElement("majorarc",g.createMajorArc),{createArc:g.createArc,createSemicircle:g.createSemicircle,createCircumcircleArc:g.createCircumcircleArc,createMinorArc:g.createMinorArc,createMajorArc:g.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type"],function(g,E,y,b,m,l,c){return g.createSector=function(a,e,o){var s,t,h,u,d,n,p="invalid";if(e[0].elementClass===l.OBJECT_CLASS_LINE&&e[1].elementClass===l.OBJECT_CLASS_LINE&&(c.isArray(e[2])||c.isNumber(e[2]))&&(c.isArray(e[3])||c.isNumber(e[3]))&&(c.isNumber(e[4])||c.isFunction(e[4])||c.isString(e[4])))p="2lines";else{if((n=c.providePoints(a,e,o,"sector",["center","radiusPoint","anglePoint"]))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");p="3points"}if(t=c.copyAttributes(o,a.options,"sector"),(s=a.create("curve",[[0],[0]],t)).type=l.OBJECT_TYPE_SECTOR,s.elType="sector",s.autoRadius=function(){var f=20/s.board.unitX,v=1/0,C=50/s.board.unitX;return c.isPoint(s.center)&&(v=.3333*s.center.Dist(s.point2)),Math.max(f,Math.min(v,C))},p==="2lines")s.Radius=function(){var f=c.evaluate(e[4]);return f==="auto"?this.autoRadius():f},s.line1=a.select(e[0]),s.line2=a.select(e[1]),s.line1.addChild(s),s.line2.addChild(s),s.setParents(e),s.point1={visProp:{}},s.point2={visProp:{}},s.point3={visProp:{}},u=E.meetLineLine(s.line1.stdform,s.line2.stdform,0,a),c.isArray(e[2])?(e[2].length===2&&(e[2]=[1].concat(e[2])),d=E.projectPointToLine({coords:{usrCoords:e[2]}},s.line1,a),d=b.subtract(d.usrCoords,u.usrCoords),s.direction1=y.innerProduct(d,[0,s.line1.stdform[2],-s.line1.stdform[1]],3)>=0?1:-1):s.direction1=e[2]>=0?1:-1,c.isArray(e[3])?(e[3].length===2&&(e[3]=[1].concat(e[3])),d=E.projectPointToLine({coords:{usrCoords:e[3]}},s.line2,a),d=b.subtract(d.usrCoords,u.usrCoords),s.direction2=y.innerProduct(d,[0,s.line2.stdform[2],-s.line2.stdform[1]],3)>=0?1:-1):s.direction2=e[3]>=0?1:-1,s.updateDataArray=function(){var f,v,C,_,P,x,S=[0,0,0];if(v=this.line1,C=this.line2,S=y.crossProduct(v.stdform,C.stdform),Math.abs(S[0])>y.eps*y.eps&&(S[1]/=S[0],S[2]/=S[0],S[0]/=S[0]),f=this.direction1*this.Radius(),_=b.add(S,[0,f*v.stdform[2],-f*v.stdform[1]]),f=this.direction2*this.Radius(),P=b.add(S,[0,f*C.stdform[2],-f*C.stdform[1]]),this.point2.coords=new m(l.COORDS_BY_USER,_,s.board),this.point1.coords=new m(l.COORDS_BY_USER,S,s.board),this.point3.coords=new m(l.COORDS_BY_USER,P,s.board),Math.abs(_[0])<y.eps||Math.abs(S[0])<y.eps||Math.abs(P[0])<y.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);x=E.bezierArc(_,S,P,!0,1),this.dataX=x[0],this.dataY=x[1],this.bezierDegree=3},s.methodMap=g.deepCopy(s.methodMap,{radius:"Radius",getRadius:"Radius",setRadius:"setRadius"});else if(p==="3points"){for(s.point1=n[0],s.point2=n[1],s.point3=n[2],h=0;h<3;h++)c.exists(n[h]._is_new)?(s.addChild(n[h]),delete n[h]._is_new):n[h].addChild(s);s.useDirection=o.usedirection,s.setParents(n),c.exists(n[3])&&(s.point4=n[3],s.point4.addChild(s)),s.methodMap=g.deepCopy(s.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"Radius",getRadius:"Radius",setRadius:"setRadius"}),s.updateDataArray=function(){var f,v,C,_,P,x=this.point2,S=this.point1,O=this.point3,w=1,T=c.evaluate(this.visProp.selection);if(!x.isReal||!S.isReal||!O.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);P=E.rad(x,S,O),(T==="minor"&&P>Math.PI||T==="major"&&P<Math.PI)&&(w=-1),this.useDirection&&c.exists(this.point4)&&(v=this.point2.coords.usrCoords,C=this.point4.coords.usrCoords,_=this.point3.coords.usrCoords,(v[1]-_[1])*(v[2]-C[2])-(v[2]-_[2])*(v[1]-C[1])>=0&&(O=this.point2,x=this.point3)),x=x.coords.usrCoords,S=S.coords.usrCoords,O=O.coords.usrCoords,f=E.bezierArc(x,S,O,!0,w),this.dataX=f[0],this.dataY=f[1],this.bezierDegree=3},s.Radius=function(){return this.point2.Dist(this.point1)},(t=c.copyAttributes(o,a.options,"sector","arc")).withLabel=!1,t.name+="_arc",s.arc=a.create("arc",[s.point1,s.point2,s.point3],t),s.addChild(s.arc)}return s.center=s.point1,s.radiuspoint=s.point2,s.anglepoint=s.point3,s.hasPointCurve=function(f,v){var C,_,P,x,S,O,w=new m(l.COORDS_BY_SCREEN,[f,v],this.board),T=this.Radius(),M=this.center.coords.distance(l.COORDS_BY_USER,w),N=c.evaluate(this.visProp.selection);return c.isObject(c.evaluate(this.visProp.precision))?(S=this.board._inputDevice,x=c.evaluate(this.visProp.precision[S])):x=this.board.options.precision.hasPoint,x/=Math.min(this.board.unitX,this.board.unitY),(O=Math.abs(M-T)<x)&&(C=E.rad(this.point2,this.center,w.usrCoords.slice(1)),_=0,P=E.rad(this.point2,this.center,this.point3),(N==="minor"&&P>Math.PI||N==="major"&&P<Math.PI)&&(_=P,P=2*Math.PI),(C<_||C>P)&&(O=!1)),O},s.hasPointSector=function(f,v){var C,_,P,x=new m(l.COORDS_BY_SCREEN,[f,v],this.board),S=this.Radius(),O=this.point1.coords.distance(l.COORDS_BY_USER,x)<S,w=c.evaluate(this.visProp.selection);return O&&(C=E.rad(this.radiuspoint,this.center,x.usrCoords.slice(1)),_=0,P=E.rad(this.radiuspoint,this.center,this.anglepoint),(w==="minor"&&P>Math.PI||w==="major"&&P<Math.PI)&&(_=P,P=2*Math.PI),(C<_||C>P)&&(O=!1)),O},s.hasPoint=function(f,v){return c.evaluate(this.visProp.highlightonsector)||c.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(f,v):this.hasPointCurve(f,v)},s.getTextAnchor=function(){return this.point1.coords},s.getLabelAnchor=function(){var f,v,C,_,P,x=E.rad(this.point2,this.point1,this.point3),S=13/this.board.unitX,O=13/this.board.unitY,w=this.point2.coords.usrCoords,T=this.point1.coords.usrCoords,M=w[1]-T[1],N=w[2]-T[2],A=c.evaluate(this.visProp.selection),R=this.label?this.label.visProp:this.visProp.label;return(A==="minor"&&x>Math.PI||A==="major"&&x<Math.PI)&&(x=-(2*Math.PI-x)),C=(f=new m(l.COORDS_BY_USER,[T[1]+Math.cos(.5*x)*M-Math.sin(.5*x)*N,T[2]+Math.sin(.5*x)*M+Math.cos(.5*x)*N],this.board)).usrCoords[1]-T[1],_=f.usrCoords[2]-T[2],C=C*((P=Math.sqrt(C*C+_*_))+S)/P,_=_*(P+O)/P,v=[T[1]+C,T[2]+_],R.position=E.calcLabelQuadrant(E.rad([1,0],[0,0],v)),new m(l.COORDS_BY_USER,v,this.board)},s.setRadius=function(f){s.Radius=function(){var v=c.evaluate(f);return v==="auto"?this.autoRadius():v}},s.getRadius=function(){return g.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},p==="3points"&&(s.setPositionDirectly=function(f,v,C){var _,P=new m(f,v,this.board),x=new m(f,C,this.board);return s.point1.draggable()&&s.point2.draggable()&&s.point3.draggable()?(_=b.subtract(P.usrCoords,x.usrCoords),this.board.create("transform",_.slice(1),{type:"translate"}).applyOnce([s.point1,s.point2,s.point3]),this):this}),s.prepareUpdate().update(),s},g.registerElement("sector",g.createSector),g.createCircumcircleSector=function(a,e,o){var s,t,h,u;if((u=c.providePoints(a,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");return(t=a.create("circumcenter",u.slice(0,3),h)).dump=!1,h=c.copyAttributes(o,a.options,"circumcirclesector"),(s=a.create("sector",[t,u[0],u[2],u[1]],h)).elType="circumcirclesector",s.setParents(u),s.center=t,s.subs={center:t},s},g.registerElement("circumcirclesector",g.createCircumcircleSector),g.createMinorSector=function(a,e,o){return o.selection="minor",g.createSector(a,e,o)},g.registerElement("minorsector",g.createMinorSector),g.createMajorSector=function(a,e,o){return o.selection="major",g.createSector(a,e,o)},g.registerElement("majorsector",g.createMajorSector),g.createAngle=function(a,e,o){var s,t,h,u,d,n,p="invalid";if(e[0].elementClass===l.OBJECT_CLASS_LINE&&e[1].elementClass===l.OBJECT_CLASS_LINE&&(c.isArray(e[2])||c.isNumber(e[2]))&&(c.isArray(e[3])||c.isNumber(e[3])))p="2lines";else{if((n=c.providePoints(a,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");p="3points"}if(h=c.copyAttributes(o,a.options,"angle"),c.exists(h.name)&&h.name!==""||(h.name=a.generateName({type:l.OBJECT_TYPE_ANGLE})),t=c.exists(h.radius)?h.radius:0,p==="2lines"?(e.push(t),(s=a.create("sector",e,h)).updateDataArraySector=s.updateDataArray,s.setAngle=function(f){},s.free=function(f){}):((s=a.create("sector",[n[1],n[0],n[2]],h)).arc.visProp.priv=!0,s.point=s.point2=s.radiuspoint=n[0],s.pointsquare=s.point3=s.anglepoint=n[2],s.Radius=function(){var f=c.evaluate(t);return f==="auto"?s.autoRadius():f},s.updateDataArraySector=function(){var f,v,C=this.point2,_=this.point1,P=this.point3,x=this.Radius(),S=_.Dist(C),O=1,w=c.evaluate(this.visProp.selection);v=E.rad(C,_,P),(w==="minor"&&v>Math.PI||w==="major"&&v<Math.PI)&&(O=-1),C=C.coords.usrCoords,_=_.coords.usrCoords,P=P.coords.usrCoords,C=[1,_[1]+(C[1]-_[1])*x/S,_[2]+(C[2]-_[2])*x/S],P=[1,_[1]+(P[1]-_[1])*x/S,_[2]+(P[2]-_[2])*x/S],f=E.bezierArc(C,_,P,!0,O),this.dataX=f[0],this.dataY=f[1],this.bezierDegree=3},s.setAngle=function(f){var v,C,_,P=this.anglepoint,x=this.radiuspoint;return P.draggable()&&(v=this.board.create("transform",[f,this.center],{type:"rotate"}),P.addTransform(x,v),v.update(),P.moveTo(y.matVecMult(v.matrix,x.coords.usrCoords)),_=c.isFunction(f)?function(){return 2*Math.PI-f()}:function(){return 2*Math.PI-f},C=this.board.create("transform",[_,this.center],{type:"rotate"}),P.coords.on("update",function(){C.update(),x.moveTo(y.matVecMult(C.matrix,P.coords.usrCoords))}),P.setParents(x)),this},s.free=function(){var f=this.anglepoint;return f.transformations.length>0&&(f.transformations.pop(),f.isDraggable=!0,f.parents=[],f.coords.off("update")),this},s.setParents(n)),c.exists(s.visProp.text)&&s.label.setText(c.evaluate(s.visProp.text)),s.elType="angle",s.type=l.OBJECT_TYPE_ANGLE,s.subs={},s.updateDataArraySquare=function(){var f,v,C,_,P,x,S,O,w=this.Radius();p==="2lines"&&this.updateDataArraySector(),f=this.point2,v=this.point1,C=this.point3,f=f.coords.usrCoords,v=v.coords.usrCoords,C=C.coords.usrCoords,_=E.distance(f,v,3),P=E.distance(C,v,3),f=[1,v[1]+(f[1]-v[1])*w/_,v[2]+(f[2]-v[2])*w/_],C=[1,v[1]+(C[1]-v[1])*w/P,v[2]+(C[2]-v[2])*w/P],x=y.crossProduct(C,v),S=[-f[1]*x[1]-f[2]*x[2],f[0]*x[1],f[0]*x[2]],x=y.crossProduct(f,v),O=[-C[1]*x[1]-C[2]*x[2],C[0]*x[1],C[0]*x[2]],(x=y.crossProduct(S,O))[1]/=x[0],x[2]/=x[0],this.dataX=[v[1],f[1],x[1],C[1],v[1]],this.dataY=[v[2],f[2],x[2],C[2],v[2]],this.bezierDegree=1},s.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},s.updateDataArray=function(){var f=c.evaluate(this.visProp.type),v=E.trueAngle(this.point2,this.point1,this.point3),C=c.evaluate(this.visProp.selection);(C==="minor"&&v>180||C==="major"&&v<180)&&(v=360-v),Math.abs(v-90)<c.evaluate(this.visProp.orthosensitivity)+y.eps&&(f=c.evaluate(this.visProp.orthotype)),f==="none"?this.updateDataArrayNone():f==="square"?this.updateDataArraySquare():f==="sector"?this.updateDataArraySector():f==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||f!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},u=c.copyAttributes(o,a.options,"angle","dot"),s.dot=a.create("point",[function(){var f,v,C,_,P,x,S,O,w;return c.exists(s.dot)&&!s.dot.visProp.visible?[0,0]:(f=s.point2.coords.usrCoords,v=s.point1.coords.usrCoords,C=s.Radius(),_=E.distance(f,v,3),P=E.rad(s.point2,s.point1,s.point3),((w=c.evaluate(s.visProp.selection))==="minor"&&P>Math.PI||w==="major"&&P<Math.PI)&&(P=-(2*Math.PI-P)),P*=.5,x=Math.cos(P),S=Math.sin(P),f=[1,v[1]+(f[1]-v[1])*C/_,v[2]+(f[2]-v[2])*C/_],O=[[1,0,0],[v[1]-.5*v[1]*x+.5*v[2]*S,.5*x,.5*-S],[v[2]-.5*v[1]*S-.5*v[2]*x,.5*S,.5*x]],y.matVecMult(O,f))}],u),s.dot.dump=!1,s.subs.dot=s.dot,p==="2lines")for(d=0;d<2;d++)a.select(e[d]).addChild(s.dot);else for(d=0;d<3;d++)a.select(n[d]).addChild(s.dot);return s.getLabelAnchor=function(){var f,v,C,_,P,x,S,O,w,T=12,M=c.evaluate(s.visProp.selection),N=this.label?this.label.visProp:this.visProp.label;return c.exists(this.label.visProp.fontSize)&&(T=c.evaluate(this.label.visProp.fontSize)),T/=this.board.unitX,v=s.point2.coords.usrCoords,C=s.point1.coords.usrCoords,_=s.Radius(),P=E.distance(v,C,3),x=E.rad(s.point2,s.point1,s.point3),(M==="minor"&&x>Math.PI||M==="major"&&x<Math.PI)&&(x=-(2*Math.PI-x)),x*=.5,S=Math.cos(x),O=Math.sin(x),v=[1,C[1]+(v[1]-C[1])*_/P,C[2]+(v[2]-C[2])*_/P],w=[[1,0,0],[C[1]-.5*C[1]*S+.5*C[2]*O,.5*S,.5*-O],[C[2]-.5*C[1]*O-.5*C[2]*S,.5*O,.5*S]],(f=y.matVecMult(w,v))[1]/=f[0],f[2]/=f[0],f[0]/=f[0],P=E.distance(f,C,3),f=[f[0],C[1]+(f[1]-C[1])*(_+T)/P,C[2]+(f[2]-C[2])*(_+T)/P],N.position=E.calcLabelQuadrant(E.rad([1,0],[0,0],f)),new m(l.COORDS_BY_USER,f,this.board)},s.Value=function(){return E.rad(this.point2,this.point1,this.point3)},s.methodMap=c.deepCopy(s.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),s},g.registerElement("angle",g.createAngle),g.createNonreflexAngle=function(a,e,o){var s;return o.selection="minor",(s=g.createAngle(a,e,o)).Value=function(){var t=E.rad(this.point2,this.point1,this.point3);return t<Math.PI?t:2*Math.PI-t},s},g.registerElement("nonreflexangle",g.createNonreflexAngle),g.createReflexAngle=function(a,e,o){var s;return o.selection="major",(s=g.createAngle(a,e,o)).Value=function(){var t=E.rad(this.point2,this.point1,this.point3);return t>=Math.PI?t:2*Math.PI-t},s},g.registerElement("reflexangle",g.createReflexAngle),{createSector:g.createSector,createCircumcircleSector:g.createCircumcircleSector,createMinorSector:g.createMinorSector,createMajorSector:g.createMajorSector,createAngle:g.createAngle,createReflexAngle:g.createReflexAngle,createNonreflexAngle:g.createNonreflexAngle}}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(g,E,y,b){return g.Transformation=function(m,l,c){this.elementClass=E.OBJECT_CLASS_OTHER,this.type=E.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=m,this.isNumericMatrix=!1,this.setMatrix(m,l,c),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bindTo",melt:"melt"}},g.Transformation.prototype={},g.extend(g.Transformation.prototype,{update:function(){return this},setMatrix:function(m,l,c){var a;for(this.isNumericMatrix=!0,a=0;a<c.length;a++)if(typeof c[a]!="number"){this.isNumericMatrix=!1;break}if(l==="translate"){if(c.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=b.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(l==="scale"){if(c.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=b.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(l==="reflect")c.length<4&&(c[0]=m.select(c[0])),c.length===2&&(c[1]=m.select(c[1])),c.length===4&&(this.evalParam=b.createEvalFunction(m,c,4)),this.update=function(){var e,o,s,t,h,u,d,n;c.length===1?d=c[0].stdform:c.length===2?d=y.crossProduct(c[1].coords.usrCoords,c[0].coords.usrCoords):c.length===4&&(d=y.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),e=d[1],o=d[2],u=(n=[-(s=d[0])*e,-s*o,e*e+o*o])[2],t=n[0]/n[2],h=n[1]/n[2],e=-d[2],o=d[1],this.matrix[1][1]=(e*e-o*o)/u,this.matrix[1][2]=2*e*o/u,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=t*(1-this.matrix[1][1])-h*this.matrix[1][2],this.matrix[2][0]=h*(1-this.matrix[2][2])-t*this.matrix[2][1]};else if(l==="rotate")c.length===3?this.evalParam=b.createEvalFunction(m,c,3):c.length>0&&c.length<=2&&(this.evalParam=b.createEvalFunction(m,c,1),c.length!==2||b.isArray(c[1])||(c[1]=m.select(c[1]))),this.update=function(){var e,o,s=this.evalParam(0),t=Math.cos(s),h=Math.sin(s);this.matrix[1][1]=t,this.matrix[1][2]=-h,this.matrix[2][1]=h,this.matrix[2][2]=t,c.length>1&&(c.length===3?(e=this.evalParam(1),o=this.evalParam(2)):b.isArray(c[1])?(e=c[1][0],o=c[1][1]):(e=c[1].X(),o=c[1].Y()),this.matrix[1][0]=e*(1-t)+o*h,this.matrix[2][0]=o*(1-t)-e*h)};else if(l==="shear"){if(c.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=b.createEvalFunction(m,c,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(l==="generic"){if(c.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=b.createEvalFunction(m,c,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(m,l){return this.update(),b.exists(l)?y.matVecMult(this.matrix,m.initialCoords.usrCoords):y.matVecMult(this.matrix,m.coords.usrCoords)},applyOnce:function(m){var l,c,a;for(b.isArray(m)||(m=[m]),c=m.length,a=0;a<c;a++)this.update(),l=y.matVecMult(this.matrix,m[a].coords.usrCoords),m[a].coords.setCoordinates(E.COORDS_BY_USER,l)},bindTo:function(m){var l,c;if(b.isArray(m))for(c=m.length,l=0;l<c;l++)m[l].transformations.push(this);else m.transformations.push(this)},setProperty:function(m){g.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(m){},melt:function(m){var l,c,a,e,o,s,t=[];for(c=m.matrix.length,a=this.matrix[0].length,l=0;l<c;l++)t[l]=[];for(this.update(),m.update(),l=0;l<c;l++)for(s=0;s<a;s++){for(o=0,e=0;e<c;e++)o+=m.matrix[l][e]*this.matrix[e][s];t[l][s]=o}return this.update=function(){var h=this.matrix.length,u=this.matrix[0].length;for(l=0;l<h;l++)for(s=0;s<u;s++)this.matrix[l][s]=t[l][s]},this},getParents:function(){var m=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(m=this.parents),m}}),g.createTransform=function(m,l,c){return new g.Transformation(m,c.type,l)},g.registerElement("transform",g.createTransform),{Transformation:g.Transformation,createTransform:g.createTransform}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/polygon"],function(g,E,y,b,m,l,c,a,e,o,s,t,h,u){return g.createOrthogonalProjection=function(d,n,p){var f,v,C,_;if(n[0]=d.select(n[0]),n[1]=d.select(n[1]),l.isPointType(d,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)v=l.providePoints(d,[n[0]],p,"point")[0],f=n[1];else{if(!l.isPointType(d,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line]`);v=l.providePoints(d,[n[1]],p,"point")[0],f=n[0]}return _=l.copyAttributes(p,d.options,"orthogonalprojection"),C=d.create("point",[function(){return y.projectPointToLine(v,f,d)}],_),l.exists(v._is_new)?(C.addChild(v),delete v._is_new):v.addChild(C),f.addChild(C),C.elType="orthogonalprojection",C.setParents([v.id,C.id]),C.update(),C.generatePolynomial=function(){var P=f.point1.symbolic.x,x=f.point1.symbolic.y,S=f.point2.symbolic.x,O=f.point2.symbolic.y,w=v.symbolic.x,T=v.symbolic.y,M=C.symbolic.x,N=C.symbolic.y;return["("+x+")*("+M+")-("+x+")*("+S+")+("+N+")*("+S+")-("+P+")*("+N+")+("+P+")*("+O+")-("+M+")*("+O+")","("+T+")*("+x+")-("+T+")*("+O+")-("+N+")*("+x+")+("+N+")*("+O+")+("+w+")*("+P+")-("+w+")*("+S+")-("+M+")*("+P+")+("+M+")*("+S+")"]},C},g.createPerpendicular=function(d,n,p){var f,v,C,_;if(n[0]=d.select(n[0]),n[1]=d.select(n[1]),l.isPointType(d,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)v=n[1],f=l.providePoints(d,[n[0]],p,"point")[0];else{if(!l.isPointType(d,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point]`);v=n[0],f=l.providePoints(d,[n[1]],p,"point")[0]}return _=l.copyAttributes(p,d.options,"perpendicular"),(C=e.createLine(d,[function(){return v.stdform[2]*f.X()-v.stdform[1]*f.Y()},function(){return-v.stdform[2]*f.Z()},function(){return v.stdform[1]*f.Z()}],_)).elType="perpendicular",C.setParents([v.id,f.id]),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),v.addChild(C),C},g.createPerpendicularPoint=function(d,n,p){var f,v,C;if(n[0]=d.select(n[0]),n[1]=d.select(n[1]),l.isPointType(d,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)v=l.providePoints(d,[n[0]],p,"point")[0],f=n[1];else{if(!l.isPointType(d,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line]`);v=l.providePoints(d,[n[1]],p,"point")[0],f=n[0]}return C=d.create("point",[function(){return y.perpendicular(f,v,d)[0]}],p),l.exists(v._is_new)?(C.addChild(v),delete v._is_new):v.addChild(C),f.addChild(C),C.elType="perpendicularpoint",C.setParents([v.id,f.id]),C.update(),C.generatePolynomial=function(){var _=f.point1.symbolic.x,P=f.point1.symbolic.y,x=f.point2.symbolic.x,S=f.point2.symbolic.y,O=v.symbolic.x,w=v.symbolic.y,T=C.symbolic.x,M=C.symbolic.y;return["("+P+")*("+T+")-("+P+")*("+x+")+("+M+")*("+x+")-("+_+")*("+M+")+("+_+")*("+S+")-("+T+")*("+S+")","("+w+")*("+P+")-("+w+")*("+S+")-("+M+")*("+P+")+("+M+")*("+S+")+("+O+")*("+_+")-("+O+")*("+x+")-("+T+")*("+_+")+("+T+")*("+x+")"]},C},g.createPerpendicularSegment=function(d,n,p){var f,v,C,_,P;if(n[0]=d.select(n[0]),n[1]=d.select(n[1]),l.isPointType(d,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)v=n[1],f=l.providePoints(d,[n[0]],p,"point")[0];else{if(!l.isPointType(d,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point]`);v=n[0],f=l.providePoints(d,[n[1]],p,"point")[0]}return P=l.copyAttributes(p,d.options,"perpendicularsegment","point"),(_=g.createPerpendicularPoint(d,[v,f],P)).dump=!1,l.exists(p.layer)||(p.layer=d.options.layer.line),P=l.copyAttributes(p,d.options,"perpendicularsegment"),(C=e.createLine(d,[function(){return y.perpendicular(v,f,d)[1]?[_,f]:[f,_]}],P)).point=_,l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),v.addChild(C),C.elType="perpendicularsegment",C.setParents([f.id,v.id]),C.subs={point:_},C.inherits.push(_),C},g.createMidpoint=function(d,n,p){var f,v,C,_,P;for(_=0;_<n.length;++_)n[_]=d.select(n[_]);if(n.length===2&&l.isPointType(d,n[0])&&l.isPointType(d,n[1]))n=l.providePoints(d,n,p,"point"),f=n[0],v=n[1];else{if(n.length!==1||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);f=n[0].point1,v=n[0].point2}return P=l.copyAttributes(p,d.options,"midpoint"),C=d.create("point",[function(){var x=f.coords.usrCoords[1]+v.coords.usrCoords[1];return isNaN(x)||Math.abs(f.coords.usrCoords[0])<E.eps||Math.abs(v.coords.usrCoords[0])<E.eps?NaN:.5*x},function(){var x=f.coords.usrCoords[2]+v.coords.usrCoords[2];return isNaN(x)||Math.abs(f.coords.usrCoords[0])<E.eps||Math.abs(v.coords.usrCoords[0])<E.eps?NaN:.5*x}],P),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),l.exists(v._is_new)?(C.addChild(v),delete v._is_new):v.addChild(C),C.elType="midpoint",C.setParents([f.id,v.id]),C.prepareUpdate().update(),C.generatePolynomial=function(){var x=f.symbolic.x,S=f.symbolic.y,O=v.symbolic.x,w=v.symbolic.y,T=C.symbolic.x,M=C.symbolic.y;return["("+S+")*("+T+")-("+S+")*("+O+")+("+M+")*("+O+")-("+x+")*("+M+")+("+x+")*("+w+")-("+T+")*("+w+")","("+x+")^2 - 2*("+x+")*("+T+")+("+S+")^2-2*("+S+")*("+M+")-("+O+")^2+2*("+O+")*("+T+")-("+w+")^2+2*("+w+")*("+M+")"]},C},g.createParallelPoint=function(d,n,p){var f,v,C,_,P;for(P=0;P<n.length;++P)n[P]=d.select(n[P]);if(n.length===3&&l.isPointType(d,n[0])&&l.isPointType(d,n[1])&&l.isPointType(d,n[2]))n=l.providePoints(d,n,p,"point"),f=n[0],v=n[1],C=n[2];else if(l.isPointType(d,n[0])&&n[1].elementClass===c.OBJECT_CLASS_LINE)C=l.providePoints(d,[n[0]],p,"point")[0],f=n[1].point1,v=n[1].point2;else{if(!l.isPointType(d,n[1])||n[0].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [line,point], [point,point,point]`);C=l.providePoints(d,[n[1]],p,"point")[0],f=n[0].point1,v=n[0].point2}return _=d.create("point",[function(){return C.coords.usrCoords[1]+v.coords.usrCoords[1]-f.coords.usrCoords[1]},function(){return C.coords.usrCoords[2]+v.coords.usrCoords[2]-f.coords.usrCoords[2]}],p),l.exists(f._is_new)?(_.addChild(f),delete f._is_new):f.addChild(_),l.exists(v._is_new)?(_.addChild(v),delete v._is_new):v.addChild(_),l.exists(C._is_new)?(_.addChild(C),delete C._is_new):C.addChild(_),_.elType="parallelpoint",_.setParents([f.id,v.id,C.id]),_.prepareUpdate().update(),_.generatePolynomial=function(){var x=f.symbolic.x,S=f.symbolic.y,O=v.symbolic.x,w=v.symbolic.y,T=C.symbolic.x,M=C.symbolic.y,N=_.symbolic.x,A=_.symbolic.y;return["("+w+")*("+N+")-("+w+")*("+T+")-("+S+")*("+N+")+("+S+")*("+T+")-("+A+")*("+O+")+("+A+")*("+x+")+("+M+")*("+O+")-("+M+")*("+x+")","("+A+")*("+x+")-("+A+")*("+T+")-("+w+")*("+x+")+("+w+")*("+T+")-("+N+")*("+S+")+("+N+")*("+M+")+("+O+")*("+S+")-("+O+")*("+M+")"]},_},g.createParallel=function(d,n,p){var f,v,C,_,P,x,S=1;for(P=0;P<n.length;++P)n[P]=d.select(n[P]);return f=null,n.length===3?(f=(n=l.providePoints(d,n,p,"point"))[2],S=0):l.isPointType(d,n[0])?(f=l.providePoints(d,[n[0]],p,"point")[0],_=function(){return n[1].stdform}):l.isPointType(d,n[1])&&(f=l.providePoints(d,[n[1]],p,"point")[0],_=function(){return n[0].stdform}),l.exists(p.layer)||(p.layer=d.options.layer.line),x=l.copyAttributes(p,d.options,"parallel","point"),(v=S===1?d.create("point",[function(){return E.crossProduct([1,0,0],_())}],x):d.create("parallelpoint",n,x)).isDraggable=!0,x=l.copyAttributes(p,d.options,"parallel"),(C=d.create("line",[f,v],x)).elType="parallel",C.subs={point:v},C.inherits.push(v),C.setParents([n[0].id,n[1].id]),n.length===3&&C.addParents(n[2].id),C.point=v,C},g.createArrowParallel=function(d,n,p){var f;try{return p.firstArrow=!1,p.lastArrow=!0,(f=g.createParallel(d,n,p).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",f}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},g.createNormal=function(d,n,p){var f,v,C,_,P,x,S,O,w;for(_=0;_<n.length;++_)n[_]=d.select(n[_]);if(n.length===1)f=n[0],v=f.slideObject;else{if(n.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(l.isPointType(d,n[0]))f=l.providePoints(d,[n[0]],p,"point")[0],v=n[1];else{if(!l.isPointType(d,n[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);v=n[0],f=l.providePoints(d,[n[1]],p,"point")[0]}}if(S=l.copyAttributes(p,d.options,"normal"),v.elementClass===c.OBJECT_CLASS_LINE)w=l.copyAttributes(p,d.options,"normal","point"),O=d.create("point",[function(){var T=E.crossProduct([1,0,0],v.stdform);return[T[0],-T[2],T[1]]}],w),O.isDraggable=!0,(C=d.create("line",[f,O],S)).point=O,C.subs={point:O},C.inherits.push(O);else if(v.elementClass===c.OBJECT_CLASS_CIRCLE)C=d.create("line",[v.midpoint,f],S);else if(v.elementClass===c.OBJECT_CLASS_CURVE)l.evaluate(v.visProp.curvetype)!=="plot"?(P=v.X,x=v.Y,C=d.create("line",[function(){return-f.X()*b.D(P)(f.position)-f.Y()*b.D(x)(f.position)},function(){return b.D(P)(f.position)},function(){return b.D(x)(f.position)}],S)):C=d.create("line",[function(){var T,M,N,A,R,L,D,k,B,j,I=Math.floor(f.position),q=f.position-I;if(v.bezierdegree===1)I===v.numberPoints-1&&(I-=1,q=1);else{if(v.bezierDegree!==3)return 0;I=3*Math.floor(f.position*(v.numberPoints-1)/3),N=(f.position*(v.numberPoints-1)-I)/3,I>=v.numberPoints-1&&(I=v.numberPoints-4,N=1)}return I<0?1:v.bezierDegree===1?(v.Y(I)+q*(v.Y(I+1)-v.Y(I)))*(v.Y(I)-v.Y(I+1))-(v.X(I)+q*(v.X(I+1)-v.X(I)))*(v.X(I+1)-v.X(I)):(A=v.points[I].usrCoords,R=v.points[I+1].usrCoords,L=v.points[I+2].usrCoords,D=v.points[I+3].usrCoords,k=(1-N)*(1-N)*(R[1]-A[1])+2*(1-N)*N*(L[1]-R[1])+N*N*(D[1]-L[1]),B=(1-N)*(1-N)*(R[2]-A[2])+2*(1-N)*N*(L[2]-R[2])+N*N*(D[2]-L[2]),k/=j=Math.sqrt(k*k+B*B),B/=j,M=[1,(T=f.coords.usrCoords)[1]-B,T[2]+k],T[2]*M[1]-T[1]*M[2])},function(){var T,M,N,A,R,L,D,k,B,j=Math.floor(f.position);if(v.bezierdegree===1)j===v.numberPoints-1&&(j-=1);else{if(v.bezierDegree!==3)return 0;j=3*Math.floor(f.position*(v.numberPoints-1)/3),M=(f.position*(v.numberPoints-1)-j)/3,j>=v.numberPoints-1&&(j=v.numberPoints-4,M=1)}return j<0?0:v.bezierDegree===1?v.X(j+1)-v.X(j):(N=v.points[j].usrCoords,A=v.points[j+1].usrCoords,R=v.points[j+2].usrCoords,L=v.points[j+3].usrCoords,D=(1-M)*(1-M)*(A[1]-N[1])+2*(1-M)*M*(R[1]-A[1])+M*M*(L[1]-R[1]),k=(1-M)*(1-M)*(A[2]-N[2])+2*(1-M)*M*(R[2]-A[2])+M*M*(L[2]-R[2]),D/=B=Math.sqrt(D*D+k*k),k/=B,[1,(T=f.coords.usrCoords)[1]-k,T[2]+D][2]-T[2])},function(){var T,M,N,A,R,L,D,k,B,j,I=Math.floor(f.position);if(v.bezierdegree===1)I===v.numberPoints-1&&(I-=1);else{if(v.bezierDegree!==3)return 0;I=3*Math.floor(f.position*(v.numberPoints-1)/3),N=(f.position*(v.numberPoints-1)-I)/3,I>=v.numberPoints-1&&(I=v.numberPoints-4,N=1)}return I<0?0:v.bezierDegree===1?v.Y(I+1)-v.Y(I):(A=v.points[I].usrCoords,R=v.points[I+1].usrCoords,L=v.points[I+2].usrCoords,D=v.points[I+3].usrCoords,k=(1-N)*(1-N)*(R[1]-A[1])+2*(1-N)*N*(L[1]-R[1])+N*N*(D[1]-L[1]),B=(1-N)*(1-N)*(R[2]-A[2])+2*(1-N)*N*(L[2]-R[2])+N*N*(D[2]-L[2]),k/=j=Math.sqrt(k*k+B*B),B/=j,M=[1,(T=f.coords.usrCoords)[1]-B,T[2]+k],T[1]-M[1])}],S);else{if(v.type!==c.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);C=d.create("line",[function(){var T,M,N=Math.floor(f.position),A=f.position-N;for(M=0;M<v.objects.length;M++)if((T=v.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1,A=1),N<0?1:(T.Y(N)+A*(T.Y(N+1)-T.Y(N)))*(T.Y(N)-T.Y(N+1))-(T.X(N)+A*(T.X(N+1)-T.X(N)))*(T.X(N+1)-T.X(N))},function(){var T,M,N=Math.floor(f.position);for(M=0;M<v.objects.length;M++)if((T=v.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1),N<0?0:T.X(N+1)-T.X(N)},function(){var T,M,N=Math.floor(f.position);for(M=0;M<v.objects.length;M++)if((T=v.objects[M]).type===c.OBJECT_TYPE_CURVE){if(N<T.numberPoints)break;N-=T.numberPoints}return N===T.numberPoints-1&&(N-=1),N<0?0:T.Y(N+1)-T.Y(N)}],S)}return C.elType="normal",C.setParents(n),l.exists(f._is_new)?(C.addChild(f),delete f._is_new):f.addChild(C),v.addChild(C),C},g.createBisector=function(d,n,p){var f,v,C,_;if(n=l.providePoints(d,n,p,"point"),l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])){for((_=l.copyAttributes(p,d.options,"bisector","point")).snapToGrid=!1,(f=d.create("point",[function(){return y.angleBisector(n[0],n[1],n[2],d)}],_)).dump=!1,C=0;C<3;C++)l.exists(n[C]._is_new)?(f.addChild(n[C]),delete n[C]._is_new):n[C].addChild(f);return l.exists(p.layer)||(p.layer=d.options.layer.line),_=l.copyAttributes(p,d.options,"bisector"),(v=e.createLine(d,[n[1],f],_)).point=f,v.elType="bisector",v.setParents(n),v.subs={point:f},v.inherits.push(f),v}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [point,point,point]`)},g.createAngularBisectorsOfTwoLines=function(d,n,p){var f,v,C,_,P=d.select(n[0]),x=d.select(n[1]);if(P.elementClass!==c.OBJECT_CLASS_LINE||x.elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [line,line]`);return l.exists(p.layer)||(p.layer=d.options.layer.line),C=l.copyAttributes(p,d.options,"bisectorlines","line1"),f=d.create("line",[function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[0]/S-x.stdform[0]/O},function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[1]/S-x.stdform[1]/O},function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[2]/S-x.stdform[2]/O}],C),l.exists(p.layer)||(p.layer=d.options.layer.line),C=l.copyAttributes(p,d.options,"bisectorlines","line2"),v=d.create("line",[function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[0]/S+x.stdform[0]/O},function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[1]/S+x.stdform[1]/O},function(){var S=Math.sqrt(P.stdform[1]*P.stdform[1]+P.stdform[2]*P.stdform[2]),O=Math.sqrt(x.stdform[1]*x.stdform[1]+x.stdform[2]*x.stdform[2]);return P.stdform[2]/S+x.stdform[2]/O}],C),_=new t({line1:f,line2:v}),f.dump=!1,v.dump=!1,_.elType="bisectorlines",_.setParents([P.id,x.id]),_.subs={line1:f,line2:v},_},g.createCircumcenter=function(d,n,p){var f,v,C,_,P;if(n=l.providePoints(d,n,p,"point"),l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])){for(C=n[0],_=n[1],P=n[2],f=a.createPoint(d,[function(){return y.circumcenter(C,_,P,d)}],p),v=0;v<3;v++)l.exists(n[v]._is_new)?(f.addChild(n[v]),delete n[v]._is_new):n[v].addChild(f);return f.elType="circumcenter",f.setParents(n),f.generatePolynomial=function(){var x=C.symbolic.x,S=C.symbolic.y,O=_.symbolic.x,w=_.symbolic.y,T=P.symbolic.x,M=P.symbolic.y,N=f.symbolic.x,A=f.symbolic.y;return[["((",N,")-(",x,"))^2+((",A,")-(",S,"))^2-((",N,")-(",O,"))^2-((",A,")-(",w,"))^2"].join(""),["((",N,")-(",x,"))^2+((",A,")-(",S,"))^2-((",N,")-(",T,"))^2-((",A,")-(",M,"))^2"].join("")]},f}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)},g.createIncenter=function(d,n,p){var f,v,C,_,P;if(!((n=l.providePoints(d,n,p,"point")).length>=3&&l.isPoint(n[0])&&l.isPoint(n[1])&&l.isPoint(n[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);for(v=n[0],C=n[1],_=n[2],f=d.create("point",[function(){var x,S,O;return x=Math.sqrt((C.X()-_.X())*(C.X()-_.X())+(C.Y()-_.Y())*(C.Y()-_.Y())),S=Math.sqrt((v.X()-_.X())*(v.X()-_.X())+(v.Y()-_.Y())*(v.Y()-_.Y())),O=Math.sqrt((C.X()-v.X())*(C.X()-v.X())+(C.Y()-v.Y())*(C.Y()-v.Y())),new m(c.COORDS_BY_USER,[(x*v.X()+S*C.X()+O*_.X())/(x+S+O),(x*v.Y()+S*C.Y()+O*_.Y())/(x+S+O)],d)}],p),P=0;P<3;P++)l.exists(n[P]._is_new)?(f.addChild(n[P]),delete n[P]._is_new):n[P].addChild(f);return f.elType="incenter",f.setParents(n),f},g.createCircumcircle=function(d,n,p){var f,v,C,_;if((n=l.providePoints(d,n,p,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);try{for(C=l.copyAttributes(p,d.options,"circumcircle","center"),(f=g.createCircumcenter(d,n,C)).dump=!1,l.exists(p.layer)||(p.layer=d.options.layer.circle),C=l.copyAttributes(p,d.options,"circumcircle"),(v=o.createCircle(d,[f,n[0]],C)).elType="circumcircle",v.setParents(n),v.subs={center:f},v.inherits.push(v),_=0;_<3;_++)l.exists(n[_]._is_new)?(v.addChild(n[_]),delete n[_]._is_new):n[_].addChild(v)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)}return v},g.createIncircle=function(d,n,p){var f,v,C,_;if((n=l.providePoints(d,n,p,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`);try{for(_=l.copyAttributes(p,d.options,"incircle","center"),(v=g.createIncenter(d,n,_)).dump=!1,l.exists(p.layer)||(p.layer=d.options.layer.circle),_=l.copyAttributes(p,d.options,"incircle"),(C=o.createCircle(d,[v,function(){var P=Math.sqrt((n[1].X()-n[2].X())*(n[1].X()-n[2].X())+(n[1].Y()-n[2].Y())*(n[1].Y()-n[2].Y())),x=Math.sqrt((n[0].X()-n[2].X())*(n[0].X()-n[2].X())+(n[0].Y()-n[2].Y())*(n[0].Y()-n[2].Y())),S=Math.sqrt((n[1].X()-n[0].X())*(n[1].X()-n[0].X())+(n[1].Y()-n[0].Y())*(n[1].Y()-n[0].Y())),O=(P+x+S)/2;return Math.sqrt((O-P)*(O-x)*(O-S)/O)}],_)).elType="incircle",C.setParents(n),f=0;f<3;f++)l.exists(n[f]._is_new)?(C.addChild(n[f]),delete n[f]._is_new):n[f].addChild(C);C.center=v,C.subs={center:C.center},C.inherits.push(v)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof n[0]+"', '"+typeof n[1]+"' and '"+typeof n[2]+`'.
Possible parent types: [point,point,point]`)}return C},g.createReflection=function(d,n,p){var f,v,C,_,P,x,S,O,w=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(x=0;x<n.length;++x)n[x]=d.select(n[x]);if(S=l.copyAttributes(p,d.options,"reflection"),l.isPoint(n[0]))v=l.providePoints(d,[n[0]],O)[0];else{if(n[0].elementClass!==c.OBJECT_CLASS_CURVE&&n[0].elementClass!==c.OBJECT_CLASS_LINE&&n[0].type!==c.OBJECT_TYPE_POLYGON&&n[0].elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);v=n[0]}if(n[1].elementClass!==c.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);if(f=n[1],P=s.createTransform(d,[f],{type:"reflect"}),l.isPoint(v))C=a.createPoint(d,[v,P],S);else if(v.elementClass===c.OBJECT_CLASS_CURVE)C=h.createCurve(d,[v,P],S);else if(v.elementClass===c.OBJECT_CLASS_LINE)C=e.createLine(d,[v,P],S);else if(v.type===c.OBJECT_TYPE_POLYGON)C=u.createPolygon(d,[v,P],S);else{if(v.elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);S.type.toLowerCase()==="euclidean"?(O=l.copyAttributes(p,d.options,"reflection","center"),(_=a.createPoint(d,[v.center,P],O)).prepareUpdate().update().updateVisibility(l.evaluate(_.visProp.visible)).updateRenderer(),C=o.createCircle(d,[_,function(){return v.Radius()}],S)):C=o.createCircle(d,[v,P],S)}return l.exists(v._is_new)&&(C.addChild(v),delete v._is_new),f.addChild(C),C.elType="reflection",C.addParents(f),C.prepareUpdate().update(),l.isPoint(C)&&(C.generatePolynomial=function(){var T=f.point1.symbolic.x,M=f.point1.symbolic.y,N=f.point2.symbolic.x,A=f.point2.symbolic.y,R=v.symbolic.x,L=v.symbolic.y,D=C.symbolic.x,k=C.symbolic.y;return[["((",k,")-(",L,"))*((",M,")-(",A,"))+((",T,")-(",N,"))*((",D,")-(",R,"))"].join(""),["((",D,")-(",T,"))^2+((",k,")-(",M,"))^2-((",R,")-(",T,"))^2-((",L,")-(",M,"))^2"].join("")]}),C},g.createMirrorElement=function(d,n,p){var f,v,C,_,P,x,S,O,w=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;for(v=0;v<n.length;++v)n[v]=d.select(n[v]);if(S=l.copyAttributes(p,d.options,"mirrorelement"),l.isPoint(n[0]))f=l.providePoints(d,[n[0]],S)[0];else{if(n[0].elementClass!==c.OBJECT_CLASS_CURVE&&n[0].elementClass!==c.OBJECT_CLASS_LINE&&n[0].type!==c.OBJECT_TYPE_POLYGON&&n[0].elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);f=n[0]}if(!l.isPoint(n[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);if(O=l.copyAttributes(p,d.options,"mirrorelement","point"),C=l.providePoints(d,[n[1]],O)[0],x=s.createTransform(d,[Math.PI,C],{type:"rotate"}),l.isPoint(f))_=a.createPoint(d,[f,x],S);else if(f.elementClass===c.OBJECT_CLASS_CURVE)_=h.createCurve(d,[f,x],S);else if(f.elementClass===c.OBJECT_CLASS_LINE)_=e.createLine(d,[f,x],S);else if(f.type===c.OBJECT_TYPE_POLYGON)_=u.createPolygon(d,[f,x],S);else{if(f.elementClass!==c.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof n[0]+"' and '"+typeof n[1]+"'."+w);S.type.toLowerCase()==="euclidean"?(O=l.copyAttributes(p,d.options,"mirrorelement","center"),(P=a.createPoint(d,[f.center,x],O)).prepareUpdate().update().updateVisibility(l.evaluate(P.visProp.visible)).updateRenderer(),_=o.createCircle(d,[P,function(){return f.Radius()}],S)):_=o.createCircle(d,[f,x],S)}return l.exists(f._is_new)&&(_.addChild(f),delete f._is_new),C.addChild(_),_.elType="mirrorelement",_.addParents(C),_.prepareUpdate().update(),_},g.createMirrorPoint=function(d,n,p){var f=g.createMirrorElement(d,n,p);return f.elType="mirrorpoint",f},g.createIntegral=function(d,n,p){var f,v,C,_,P,x,S,O,w,T,M,N,A,R,L=null;if(l.isArray(n[0])&&n[1].elementClass===c.OBJECT_CLASS_CURVE)f=n[0],v=n[1];else{if(!l.isArray(n[1])||n[0].elementClass!==c.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof n[0]+"' and '"+typeof n[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);f=n[1],v=n[0]}return(C=l.copyAttributes(p,d.options,"integral")).withLabel=!1,R=d.create("curve",[[0],[0]],C),_=f[0],P=f[1],l.isFunction(_)?(S=function(){return v.Y(x())},_=(x=_)()):(x=_,S=v.Y(_)),l.isFunction(P)?(w=function(){return v.Y(O())},P=(O=P)()):(O=P,w=v.Y(P)),C=l.copyAttributes(p,d.options,"integral","curveLeft"),T=d.create("glider",[x,S,v],C),l.isFunction(x)&&T.hideElement(),C=l.copyAttributes(p,d.options,"integral","baseLeft"),M=d.create("point",[function(){return l.evaluate(R.visProp.axis)==="y"?0:T.X()},function(){return l.evaluate(R.visProp.axis)==="y"?T.Y():0}],C),C=l.copyAttributes(p,d.options,"integral","curveRight"),N=d.create("glider",[O,w,v],C),l.isFunction(O)&&N.hideElement(),C=l.copyAttributes(p,d.options,"integral","baseRight"),A=d.create("point",[function(){return l.evaluate(R.visProp.axis)==="y"?0:N.X()},function(){return l.evaluate(R.visProp.axis)==="y"?N.Y():0}],C),(C=l.copyAttributes(p,d.options,"integral")).withlabel!==!1&&C.axis!=="y"&&(C=l.copyAttributes(p,d.options,"integral","label"),C=l.copyAttributes(C,d.options,"label"),(L=d.create("text",[function(){var D=new m(c.COORDS_BY_SCREEN,[l.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),k=this.board.getBoundingBox(),B=.1*(k[2]-k[0]),j=N.X();return j<k[0]?j=k[0]+B:j>k[2]&&(j=k[2]-B),j+D.usrCoords[1]},function(){var D=new m(c.COORDS_BY_SCREEN,[0,l.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),k=this.board.getBoundingBox(),B=.1*(k[1]-k[3]),j=N.Y();return j>k[1]?j=k[1]-B:j<k[3]&&(j=k[3]+B),j+D.usrCoords[2]},function(){var D=b.NewtonCotes([M.X(),A.X()],v.Y);return"&int; = "+l.toFixed(D,4)}],C)).dump=!1,T.addChild(L),N.addChild(L)),T.dump=!1,M.dump=!1,N.dump=!1,A.dump=!1,R.elType="integral",R.setParents([v.id,f]),R.subs={curveLeft:T,baseLeft:M,curveRight:N,baseRight:A},R.inherits.push(T,M,N,A),C.withLabel&&(R.subs.label=L,R.inherits.push(L)),R.Value=function(){return b.I([M.X(),A.X()],v.Y)},R.updateDataArray=function(){var D,k,B,j,I,q,$,Z,V;if(l.evaluate(this.visProp.axis)==="y"){for(T.Y()<N.Y()?(q=T.X(),Z=T.Y(),$=N.X(),V=N.Y()):(q=N.X(),Z=N.Y(),$=T.X(),V=T.Y()),j=Math.min(q,$),I=Math.max(q,$),D=[0,q],k=[Z,Z],B=0;B<v.numberPoints;B++)Z<=v.points[B].usrCoords[2]&&j<=v.points[B].usrCoords[1]&&v.points[B].usrCoords[2]<=V&&v.points[B].usrCoords[1]<=I&&(D.push(v.points[B].usrCoords[1]),k.push(v.points[B].usrCoords[2]));D.push($),k.push(V),D.push(0),k.push(V),D.push(0),k.push(Z)}else{for(M.X()<A.X()?(j=M.X(),I=A.X()):(j=A.X(),I=M.X()),D=[j,j],k=[0,v.Y(j)],B=0;B<v.numberPoints;B++)j<=v.points[B].usrCoords[1]&&v.points[B].usrCoords[1]<=I&&(D.push(v.points[B].usrCoords[1]),k.push(v.points[B].usrCoords[2]));D.push(I),k.push(v.Y(I)),D.push(I),k.push(0),D.push(j),k.push(0)}this.dataX=D,this.dataY=k},T.addChild(R),N.addChild(R),M.addChild(R),A.addChild(R),R.baseLeft=M,R.baseRight=A,R.curveLeft=T,R.curveRight=N,R.methodMap=g.deepCopy(R.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),R.label=L,R},g.createGrid=function(d,n,p){var f,v;return v=l.copyAttributes(p,d.options,"grid"),(f=d.create("curve",[[null],[null]],v)).elType="grid",f.type=c.OBJECT_TYPE_GRID,f.updateDataArray=function(){var C,_,P,x,S,O=l.evaluate(this.visProp.gridx),w=l.evaluate(this.visProp.gridy);for(x=l.isArray(this.visProp.topleft)?new m(l.evaluate(this.visProp.tltype)||c.COORDS_BY_USER,this.visProp.topleft,d):new m(c.COORDS_BY_SCREEN,[0,0],d),S=l.isArray(this.visProp.bottomright)?new m(l.evaluate(this.visProp.brtype)||c.COORDS_BY_USER,this.visProp.bottomright,d):new m(c.COORDS_BY_SCREEN,[d.canvasWidth,d.canvasHeight],d),d.options.grid.hasGrid=!0,f.dataX=[],f.dataY=[],C=Math.floor(x.usrCoords[2]/w)*w,_=Math.ceil(S.usrCoords[2]/w)*w,x.usrCoords[2]<S.usrCoords[2]&&(C=Math.ceil(S.usrCoords[2]/w)*w,_=Math.floor(x.usrCoords[2]/w)*w),P=C;P>_-w;P-=w)f.dataX.push(x.usrCoords[1],S.usrCoords[1],NaN),f.dataY.push(P,P,NaN);for(C=Math.ceil(x.usrCoords[1]/O)*O,_=Math.floor(S.usrCoords[1]/O)*O,x.usrCoords[1]>S.usrCoords[1]&&(C=Math.floor(S.usrCoords[1]/O)*O,_=Math.ceil(x.usrCoords[1]/O)*O),P=C;P<_+O;P+=O)f.dataX.push(P,P,NaN),f.dataY.push(x.usrCoords[2],S.usrCoords[2],NaN)},f.hasPoint=function(){return!1},d.grids.push(f),f},g.createInequality=function(d,n,p){var f,v,C;if(C=l.copyAttributes(p,d.options,"inequality"),n[0].elementClass===c.OBJECT_CLASS_LINE)(v=d.create("curve",[[],[]],C)).hasPoint=function(){return!1},v.updateDataArray=function(){var _,P,x,S=d.getBoundingBox(),O=C.inverse?-1:1,w=1.5*Math.max(S[2]-S[0],S[1]-S[3]),T={coords:{usrCoords:[1,(S[0]+S[2])/2,C.inverse?S[1]:S[3]]}},M=n[0].stdform.slice(1),N=M;x=1.5*Math.max(y.perpendicular(n[0],T,d)[0].distance(c.COORDS_BY_USER,T.coords),w),x*=O,T={coords:{usrCoords:[1,(S[0]+S[2])/2,(S[1]+S[3])/2]}},_=[1,(T=Math.abs(E.innerProduct(T.coords.usrCoords,n[0].stdform,3))>=E.eps?y.perpendicular(n[0],T,d)[0].usrCoords:T.coords.usrCoords)[1]+M[1]*w,T[2]-M[0]*w],P=[1,T[1]-N[1]*w,T[2]+N[0]*w],this.dataX=[_[1],_[1]+M[0]*x,P[1]+N[0]*x,P[1],_[1]],this.dataY=[_[2],_[2]+M[1]*x,P[2]+N[1]*x,P[2],_[2]]};else if(n[0].elementClass===c.OBJECT_CLASS_CURVE&&n[0].visProp.curvetype==="functiongraph")(v=d.create("curve",[[],[]],C)).updateDataArray=function(){var _,P,x,S,O,w,T,M,N,A=this.board.getBoundingBox(),R=[],L=n[0].minX(),D=n[0].maxX(),k=.3*(A[1]-A[3]);if(_=l.evaluate(this.visProp.inverse)?1:3,this.dataX=[],this.dataY=[],(S=n[0].points.length)!==0)for(A[1]+=k,A[3]-=k,x=-1;x<S-1;){for(O=x+1,P=S;O<S;O++)if(n[0].points[O].isReal()){P=O;break}if(P>=S)break;for(O=P,x=S-1;O<S-1;O++)if(!n[0].points[O+1].isReal()){x=O;break}for(M=n[0].points[P].usrCoords[1],N=n[0].points[x].usrCoords[1],w=A[0]<L?L:A[0],T=A[2]>D?D:A[2],w=P===0?w:Math.max(w,M),T=x===S-1?T:Math.min(T,N),T=x===S-1?D:N,(R=[]).push([1,w=P===0?L:M,A[_]]),R.push([1,w,n[0].points[P].usrCoords[2]]),O=P;O<=x;O++)R.push(n[0].points[O].usrCoords);for(R.push([1,T,n[0].points[x].usrCoords[2]]),R.push([1,T,A[_]]),R.push(R[0]),O=0;O<R.length;O++)this.dataX.push(R[O][1]),this.dataY.push(R[O][2]);x<S-1&&(this.dataX.push(NaN),this.dataY.push(NaN))}},v.hasPoint=function(){return!1};else if(f=l.createFunction(n[0]),!l.exists(f))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return v.addParents(n[0]),v},g.registerElement("arrowparallel",g.createArrowParallel),g.registerElement("bisector",g.createBisector),g.registerElement("bisectorlines",g.createAngularBisectorsOfTwoLines),g.registerElement("msector",g.createMsector),g.registerElement("circumcircle",g.createCircumcircle),g.registerElement("circumcirclemidpoint",g.createCircumcenter),g.registerElement("circumcenter",g.createCircumcenter),g.registerElement("incenter",g.createIncenter),g.registerElement("incircle",g.createIncircle),g.registerElement("integral",g.createIntegral),g.registerElement("midpoint",g.createMidpoint),g.registerElement("mirrorelement",g.createMirrorElement),g.registerElement("mirrorpoint",g.createMirrorPoint),g.registerElement("normal",g.createNormal),g.registerElement("orthogonalprojection",g.createOrthogonalProjection),g.registerElement("parallel",g.createParallel),g.registerElement("parallelpoint",g.createParallelPoint),g.registerElement("perpendicular",g.createPerpendicular),g.registerElement("perpendicularpoint",g.createPerpendicularPoint),g.registerElement("perpendicularsegment",g.createPerpendicularSegment),g.registerElement("reflection",g.createReflection),g.registerElement("grid",g.createGrid),g.registerElement("inequality",g.createInequality),{createArrowParallel:g.createArrowParallel,createBisector:g.createBisector,createAngularBisectorOfTwoLines:g.createAngularBisectorsOfTwoLines,createCircumcircle:g.createCircumcircle,createCircumcenter:g.createCircumcenter,createIncenter:g.createIncenter,createIncircle:g.createIncircle,createIntegral:g.createIntegral,createMidpoint:g.createMidpoint,createMirrorElement:g.createMirrorElement,createMirrorPoint:g.createMirrorPoint,createNormal:g.createNormal,createOrthogonalProjection:g.createOrthogonalProjection,createParallel:g.createParallel,createParallelPoint:g.createParallelPoint,createPerpendicular:g.createPerpendicular,createPerpendicularPoint:g.createPerpendicularPoint,createPerpendicularSegmen:g.createPerpendicularSegment,createReflection:g.createReflection,createGrid:g.createGrid,createInequality:g.createInequality}}),define("element/locus",["jxg","math/symbolic","utils/type"],function(g,E,y){return g.createLocus=function(b,m,l){var c,a;if(!y.isArray(m)||m.length!==1||!y.isPoint(m[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return a=m[0],(c=b.create("curve",[[null],[null]],l)).dontCallServer=!1,c.elType="locus",c.setParents([a.id]),c.updateDataArray=function(){var e,o,s;c.board.mode>0||(e=E.generatePolynomials(b,a,!0).join("|"))!==c.spe&&(c.spe=e,(o=function(t,h,u,d){var n;c.dataX=t,c.dataY=h,c.eq=u,c.ctime=d,c.generatePolynomial=(n=u,function(p){var f,v="("+p.symbolic.x+")",C="("+p.symbolic.y+")",_=[];for(f=0;f<n.length;f++)_[f]=n[f].replace(/\*\*/g,"^").replace(/x/g,v).replace(/y/g,C);return _})})((s=E.geometricLocusByGroebnerBase(b,a,o)).datax,s.datay,s.polynomial,s.exectime))},c},g.registerElement("locus",g.createLocus),{createLocus:g.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],function(g,E,y,b,m,l,c){return g.Image=function(a,e,o,s,t){this.constructor(a,o,E.OBJECT_TYPE_IMAGE,E.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this.W=l.createFunction(t[0],this.board,""),this.H=l.createFunction(t[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*a.unitX),Math.abs(this.usrSize[1]*a.unitY)],this.url=s,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=g.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},g.Image.prototype=new b,l.copyPrototypeMethods(g.Image,c,"coordsConstructor"),g.extend(g.Image.prototype,{hasPoint:function(a,e){var o,s,t,h,u,d,n,p,f,v=this.transformations.length;return l.isObject(l.evaluate(this.visProp.precision))?(h=this.board._inputDevice,u=l.evaluate(this.visProp.precision[h])):u=this.board.options.precision.hasPoint,v===0?(o=a-this.coords.scrCoords[1],s=this.coords.scrCoords[2]-e,o>=-(t=u)&&o-this.size[0]<=t&&s>=-t&&s-this.size[1]<=t):(n=[(d=(d=new y(E.COORDS_BY_SCREEN,[a,e],this.board)).usrCoords)[0]-this.span[0][0],d[1]-this.span[0][1],d[2]-this.span[0][2]],0<=(p=(f=m.innerProduct)(n,this.span[1]))&&p<=f(this.span[1],this.span[1])&&0<=(p=f(n,this.span[2]))&&p<=f(this.span[2],this.span[2]))},update:function(a){return this.needsUpdate?(this.updateCoords(a),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var a,e,o=this.transformations.length,s=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],a=0;a<o;a++)for(e=0;e<3;e++)s[e]=m.matVecMult(this.transformations[a].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(a){var e;if(l.isArray(a))for(e=0;e<a.length;e++)this.transformations.push(a[e]);else this.transformations.push(a);return this},getParents:function(){var a=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(a=this.parents),a},setSize:function(a,e){return this.W=l.createFunction(a,this.board,""),this.H=l.createFunction(e,this.board,""),this},W:function(){},H:function(){}}),g.createImage=function(a,e,o){var s,t,h=e[0],u=e[1],d=e[2];if(s=l.copyAttributes(o,a.options,"image"),!(t=c.create(g.Image,a,u,s,h,d)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return s.rotate!==0&&t.addRotation(s.rotate),t},g.registerElement("image",g.createImage),{Image:g.Image,createImage:g.createImage}}),define("element/slider",["jxg","math/math","base/constants","base/coords","utils/type","base/point"],function(g,E,y,b,m,l){return g.createSlider=function(c,a,e){var o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O,w,T,M,N,A;return w=(A=m.copyAttributes(e,c.options,"slider")).withticks,O=A.withlabel,T=A.snapwidth,A=m.copyAttributes(e,c.options,"slider","point1"),n=c.create("point",a[0],A),A=m.copyAttributes(e,c.options,"slider","point2"),p=c.create("point",a[1],A),A=m.copyAttributes(e,c.options,"slider","baseline"),(f=c.create("segment",[n,p],A)).updateStdform(),o=n.coords.usrCoords.slice(1),s=p.coords.usrCoords.slice(1),t=a[2][0],h=a[2][1],u=a[2][2],d=u-t,N=(M=m.evaluate(T))===-1?h:Math.round(h/M)*M,C=o[0]+(s[0]-o[0])*(N-t)/(u-t),_=o[1]+(s[1]-o[1])*(N-t)/(u-t),(A=m.copyAttributes(e,c.options,"slider")).withLabel=!1,(P=c.create("glider",[C,_,f],A)).setAttribute({snapwidth:T}),A=m.copyAttributes(e,c.options,"slider","highline"),x=c.create("segment",[n,P],A),P.Value=function(){var R=this._smax-this._smin,L=m.evaluate(this.visProp.snapwidth);return L===-1?this.position*R+this._smin:Math.round((this.position*R+this._smin)/L)*L},P.methodMap=m.deepCopy(P.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),P._smax=u,P._smin=t,P.setMax=function(R){return this._smax=R,this},P.setValue=function(R){var L=this._smax-this._smin;return Math.abs(L)>E.eps?this.position=(R-this._smin)/L:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},P.setMin=function(R){return this._smin=R,this},O&&(A=m.copyAttributes(e,c.options,"slider","label"),S=c.create("text",[function(){return .05*(p.X()-n.X())+p.X()},function(){return .05*(p.Y()-n.Y())+p.Y()},function(){var R,L=m.evaluate(P.visProp.digits),D=m.evaluate(P.visProp.suffixlabel),k=m.evaluate(P.visProp.unitlabel),B=m.evaluate(P.visProp.postlabel);return L===2&&m.evaluate(P.visProp.precision)!==2&&(L=m.evaluate(P.visProp.precision)),R=D!==null?D:P.name&&P.name!==""?P.name+" = ":"",R+=m.toFixed(P.Value(),L),k!==null&&(R+=k),B!==null&&(R+=B),R}],A),P.label=S,P.visProp.withlabel=!0,P.hasLabel=!0),P.point1=n,P.point2=p,P.baseline=f,P.highline=x,w&&(A=m.copyAttributes(e,c.options,"slider","ticks"),m.exists(A.generatelabeltext)||(A.generateLabelText=function(R,L,D){var k=P.point1.Dist(P.point2),B=P._smin,j=P._smax,I=this.getDistanceFromZero(L,R)*(j-B)/k+B;return k<E.eps||Math.abs(I)<E.eps?"0":this.formatLabelText(I)}),v=c.create("ticks",[P.baseline,P.point1.Dist(n)/2,function(R){var L=P.point1.Dist(P.point2),D=P.point1.coords.distance(y.COORDS_BY_USER,R);return L<E.eps?0:D/L*d+t}],A),P.ticks=v),P.remove=function(){O&&c.removeObject(S),c.removeObject(x),c.removeObject(f),c.removeObject(p),c.removeObject(n),l.Point.prototype.remove.call(P)},n.dump=!1,p.dump=!1,f.dump=!1,x.dump=!1,O&&(S.dump=!1),P.elType="slider",P.parents=a,P.subs={point1:n,point2:p,baseLine:f,highLine:x},P.inherits.push(n,p,f,x),w&&(v.dump=!1,P.subs.ticks=v,P.inherits.push(v)),P.getParents=function(){return[this.point1.coords.usrCoords.slice(1),this.point2.coords.usrCoords.slice(1),[this._smin,this.position*(this._smax-this._smin)+this._smin,this._smax]]},P.baseline.on("up",function(R){var L,D;m.evaluate(P.visProp.moveonup)&&!m.evaluate(P.visProp.fixed)&&(L=f.board.getMousePosition(R,0),D=new b(y.COORDS_BY_SCREEN,L,this.board),P.moveTo([D.usrCoords[1],D.usrCoords[2]]))}),P.prepareUpdate().update(),c.isSuspendedUpdate||(P.updateVisibility().updateRenderer(),P.baseline.updateVisibility().updateRenderer(),P.highline.updateVisibility().updateRenderer(),w&&P.ticks.updateVisibility().updateRenderer()),P},g.registerElement("slider",g.createSlider),{createSlider:g.createSlider}}),define("element/measure",["jxg","utils/type","base/element"],function(g,E,y){return g.createTapemeasure=function(b,m,l){var c,a,e,o,s,t,h,u,d,n,p;return c=m[0],a=m[1],e=E.copyAttributes(l,b.options,"tapemeasure","point1"),u=b.create("point",c,e),e=E.copyAttributes(l,b.options,"tapemeasure","point2"),d=b.create("point",a,e),u.setAttribute({ignoredSnapToPoints:[d]}),d.setAttribute({ignoredSnapToPoints:[u]}),e=E.copyAttributes(l,b.options,"tapemeasure"),o=e.withticks,s=e.withlabel,(t=e.digits)===2&&e.precision!==2&&(t=e.precision),s&&(e.withlabel=!0),h=b.create("segment",[u,d],e),s&&(n=l.name&&l.name!==""?l.name+" = ":"",h.label.setText(function(){return n+E.toFixed(u.Dist(d),t)})),o&&(e=E.copyAttributes(l,b.options,"tapemeasure","ticks"),p=b.create("ticks",[h,.1],e),h.inherits.push(p)),h.remove=function(){o&&h.removeTicks(p),b.removeObject(d),b.removeObject(u),y.prototype.remove.call(this)},h.Value=function(){return u.Dist(d)},u.dump=!1,d.dump=!1,h.elType="tapemeasure",h.getParents=function(){return[[u.X(),u.Y()],[d.X(),d.Y()]]},h.subs={point1:u,point2:d},o&&(p.dump=!1),h.methodMap=g.deepCopy(h.methodMap,{Value:"Value"}),h.prepareUpdate().update(),b.isSuspendedUpdate||(h.updateVisibility().updateRenderer(),h.point1.updateVisibility().updateRenderer(),h.point2.updateVisibility().updateRenderer()),h},g.registerElement("tapemeasure",g.createTapemeasure),{createTapemeasure:g.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(g,E){return g.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},g.extend(g.DataSource.prototype,{loadFromArray:function(y,b,m){var l,c,a;if(E.isArray(b)&&(this.columnHeaders=b,b=!1),E.isArray(m)&&(this.rowHeaders=m,m=!1),this.data=[],b&&(this.columnHeaders=[]),m&&(this.rowHeaders=[]),E.exists(y)){for(this.data=[],l=0;l<y.length;l++)for(this.data[l]=[],c=0;c<y[l].length;c++)a=y[l][c],parseFloat(a).toString()===a?this.data[l][c]=parseFloat(a):this.data[l][c]=a!=="-"?a:NaN;if(b&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),m)for(this.rowHeaders=[],l=0;l<this.data.length;l++)this.rowHeaders.push(this.data[l][0]),this.data[l]=this.data[l].slice(1)}return this},loadFromTable:function(y,b,m){var l,c,a,e,o;if(E.isArray(b)&&(this.columnHeaders=b,b=!1),E.isArray(m)&&(this.rowHeaders=m,m=!1),this.data=[],b&&(this.columnHeaders=[]),m&&(this.rowHeaders=[]),y=document.getElementById(y),E.exists(y)){for(l=y.getElementsByTagName("tr"),this.data=[],c=0;c<l.length;c++)for(e=l[c].getElementsByTagName("td"),this.data[c]=[],a=0;a<e.length;a++)o=e[a].innerHTML,parseFloat(o).toString()===o?this.data[c][a]=parseFloat(o):this.data[c][a]=o!=="-"?o:NaN;if(b&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),m)for(this.rowHeaders=[],c=0;c<this.data.length;c++)this.rowHeaders.push(this.data[c][0]),this.data[c]=this.data[c].slice(1)}return this},addColumn:function(y,b,m){throw new Error("not implemented")},addRow:function(y,b,m){throw new Error("not implemented")},getColumn:function(y){var b,m=[];if(E.isString(y)){for(b=0;b<this.columnHeaders.length;b++)if(y===this.columnHeaders[b]){y=b;break}}for(b=0;b<this.data.length;b++)this.data[b].length>y&&(m[b]=parseFloat(this.data[b][y]));return m},getRow:function(y){var b,m;if(E.isString(y)){for(m=0;m<this.rowHeaders.length;m++)if(y===this.rowHeaders[m]){y=m;break}}for(b=[],m=0;m<this.data[y].length;m++)b[m]=this.data[y][m];return b}}),g.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(g,E,y,b,m,l,c,a,e,o,s,t,h,u,d,n,p,f){return g.Chart=function(v,C,_){var P,x,S,O,w,T;if(this.constructor(v,_),!e.isArray(C)||C.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],e.isNumber(C[0]))for(x=C,P=[],S=0;S<x.length;S++)P[S]=S+1;else if(C.length===1&&e.isArray(C[0]))for(x=C[0],P=[],T=e.evaluate(x).length,S=0;S<T;S++)P[S]=S+1;else C.length===2&&(T=Math.min(C[0].length,C[1].length),P=C[0].slice(0,T),x=C[1].slice(0,T));if(e.isArray(x)&&x.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(w=_.chartstyle.replace(/ /g,"").split(","),S=0;S<w.length;S++){switch(w[S]){case"bar":O=this.drawBar(v,P,x,_);break;case"line":O=this.drawLine(v,P,x,_);break;case"fit":O=this.drawFit(v,P,x,_);break;case"spline":O=this.drawSpline(v,P,x,_);break;case"pie":O=this.drawPie(v,x,_);break;case"point":O=this.drawPoints(v,P,x,_);break;case"radar":O=this.drawRadar(v,C,_)}this.elements.push(O)}return this.id=this.board.setId(this,"Chart"),this.elements},g.Chart.prototype=new l,g.extend(g.Chart.prototype,{drawLine:function(v,C,_,P){return P.fillcolor="none",P.highlightfillcolor="none",v.create("curve",[C,_],P)},drawSpline:function(v,C,_,P){return P.fillColor="none",P.highlightfillcolor="none",v.create("spline",[C,_],P)},drawFit:function(v,C,_,P){var x=P.degree;return x=Math.max(parseInt(x,10),1)||1,P.fillcolor="none",P.highlightfillcolor="none",v.create("functiongraph",[E.regressionPolynomial(x,C,_)],P)},drawBar:function(v,C,_,P){var x,S,O,w,T,M,N,A,R,L,D=[],k=[],B=function(I,q){return function(){return C[I]()-q*O}},j={fixed:!0,withLabel:!1,visible:!1,name:""};if((R=e.copyAttributes(P,v.options,"chart"))&&R.width)O=R.width;else{if(C.length<=1)O=1;else for(O=C[1]-C[0],x=1;x<C.length-1;x++)O=C[x+1]-C[x]<O?C[x+1]-C[x]:O;O*=.8}for(L=e.copyAttributes(P,v.options,"chart","label"),x=0;x<C.length;x++)e.isFunction(C[x])?(w=B(x,-.5),T=B(x,0),M=B(x,.5)):(w=C[x]-.5*O,T=C[x],M=C[x]+.5*O),N=e.isFunction(_[x])?_[x]():_[x],N=_[x],R.dir==="horizontal"?(k[0]=v.create("point",[0,w],j),k[1]=v.create("point",[N,w],j),k[2]=v.create("point",[N,M],j),k[3]=v.create("point",[0,M],j),e.exists(R.labels)&&e.exists(R.labels[x])&&(L.anchorY="middle",(S=v.create("text",[N,T,R.labels[x]],L)).visProp.anchorx=function(I){return function(){return I.X()>=0?"left":"right"}}(S))):(k[0]=v.create("point",[w,0],j),k[1]=v.create("point",[w,N],j),k[2]=v.create("point",[M,N],j),k[3]=v.create("point",[M,0],j),e.exists(R.labels)&&e.exists(R.labels[x])&&(L.anchorX="middle",(S=v.create("text",[T,N,R.labels[x]],L)).visProp.anchory=function(I){return function(){return I.Y()>=0?"bottom":"top"}}(S))),e.isArray(R.colors)&&(A=R.colors,R.fillcolor=A[x%A.length]),D[x]=v.create("polygon",k,R),e.exists(R.labels)&&e.exists(R.labels[x])&&(D[x].text=S);return D},drawPoints:function(v,C,_,P){var x,S=[],O=P.infoboxarray;for(P.fixed=!0,P.name="",x=0;x<C.length;x++)P.infoboxtext=!!O&&O[x%O.length],S[x]=v.create("point",[C[x],_[x]],P);return S},drawPie:function(v,C,_){var P,x,S=[],O=[],w=(y.sum(C),_.colors),T=_.highlightcolors,M=_.labels,N=_.radius||4,A=N,R=_.center||[0,0],L=R[0],D=R[1],k=function($,Z,V){return function(){var U,J,z,X=0;for(J=0;J<=$;J++)X+=parseFloat(e.evaluate(C[J]));for(U=X,J=$+1;J<C.length;J++)U+=parseFloat(e.evaluate(C[J]));return z=U!==0?2*Math.PI*X/U:0,A()*Math[Z](z)+V}},B=function($,Z){var V=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],U=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];e.exists(this.label)&&(this.label.rendNode.style.fontSize=Z*e.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new m(b.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+V*$,this.point1.coords.usrCoords[2]+U*$],this.board),this.fullUpdate()},j=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),B.call(this,1.1,2))},I=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),B.call(this,.9090909,1))},q={fixed:!0,withLabel:!1,visible:!1,name:""};if(!e.isArray(M))for(M=[],P=0;P<C.length;P++)M[P]="";for(e.isFunction(N)||(A=function(){return N}),_.highlightonsector=_.highlightonsector||!1,_.straightfirst=!1,_.straightlast=!1,x=v.create("point",[L,D],q),S[0]=v.create("point",[function(){return A()+L},function(){return D}],q),P=0;P<C.length;P++)S[P+1]=v.create("point",[k(P,"cos",L),k(P,"sin",D)],q),_.name=M[P],_.withlabel=_.name!=="",_.fillcolor=w&&w[P%w.length],_.labelcolor=w&&w[P%w.length],_.highlightfillcolor=T&&T[P%T.length],O[P]=v.create("sector",[x,S[P],S[P+1]],_),_.highlightonsector&&(O[P].hasPoint=O[P].hasPointSector),_.highlightbysize&&(O[P].highlight=j,O[P].noHighlight=I);return{sectors:O,points:S,midpoint:x}},drawRadar:function(v,C,_){var P,x,S,O,w,T,M,N,A,R,L,D,k,B,j,I,q,$,Z,V,U,J,z,X,G,Q,ie,ce,he,ae,oe,H,de,ne,ge,fe,ye,Ce,ue,Pe,Ee,te,ee=C.length,Ae=function(){var pe,W,se,le,re=e.evaluate(this.visProp.label.offset).slice(0);return pe=this.point1.X(),W=this.point2.X(),se=this.point1.Y(),le=this.point2.Y(),W<pe&&(re[0]=-re[0]),le<se&&(re[1]=-re[1]),this.setLabelRelativeCoords(re),new m(b.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},Oe=function(pe,W){var se,le,re;return se=v.create("transform",[-(j[W]-k[W]),0],{type:"translate"}),le=v.create("transform",[Z/(I[W]+B[W]-(j[W]-k[W])),1],{type:"scale"}),se.melt(le),re=v.create("transform",[pe],{type:"rotate"}),se.melt(re),se};if(ee<=0)throw new Error("JSXGraph radar chart: no data");if(S=_.paramarray,!e.exists(S))throw new Error("JSXGraph radar chart: need paramArray attribute");if((O=S.length)<=1)throw new Error("JSXGraph radar chart: need more than one param in paramArray");for(P=0;P<ee;P++)if(O!==C[P].length)throw new Error("JSXGraph radar chart: use data length equal to number of params ("+C[P].length+" != "+O+")");for(w=[],T=[],x=0;x<O;x++)w[x]=C[0][x],T[x]=w[x];for(P=1;P<ee;P++)for(x=0;x<O;x++)C[P][x]>w[x]&&(w[x]=C[P][x]),C[P][x]<T[x]&&(T[x]=C[P][x]);for(M=[],N=[],P=0;P<ee;P++)M[P]="",N[P]=[];for(A=[],R=[],L=_.startshiftratio||0,D=_.endshiftratio||0,P=0;P<O;P++)A[P]=(w[P]-T[P])*L,R[P]=(w[P]-T[P])*D;if(k=_.startshiftarray||A,B=_.endshiftarray||R,j=_.startarray||T,e.exists(_.start))for(P=0;P<O;P++)j[P]=_.start;if(I=_.endarray||w,e.exists(_.end))for(P=0;P<O;P++)I[P]=_.end;if(k.length!==O)throw new Error("JSXGraph radar chart: start shifts length is not equal to number of parameters");if(B.length!==O)throw new Error("JSXGraph radar chart: end shifts length is not equal to number of parameters");if(j.length!==O)throw new Error("JSXGraph radar chart: starts length is not equal to number of parameters");if(I.length!==O)throw new Error("JSXGraph radar chart: snds length is not equal to number of parameters");for(q=_.labelarray||M,$=_.colors,_.highlightcolors,Z=_.radius||10,Ee=_.strokewidth||1,e.exists(_.highlightonsector)||(_.highlightonsector=!1),V={name:_.name,id:_.id,strokewidth:Ee,polystrokewidth:_.polystrokewidth||Ee,strokecolor:_.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:_.fillColor||"#FFFF88",fillopacity:_.fillOpacity||.4,highlightfillcolor:_.highlightFillColor||"#FF7400",highlightstrokecolor:_.highlightStrokeColor||"black",gradient:_.gradient||"none"},J=(U=_.center||[0,0])[0],z=U[1],X=v.create("point",[J,z],{name:"",fixed:!0,withlabel:!1,visible:!1}),Q=G=_.startangle||0,ie=[],ce=[],P=0;P<O;P++)for(Q+=2*Math.PI/O,ae=Z*Math.cos(Q)+J,oe=Z*Math.sin(Q)+z,ie[P]=v.create("point",[ae,oe],{name:"",fixed:!0,withlabel:!1,visible:!1}),ce[P]=v.create("line",[X,ie[P]],{name:S[P],strokeColor:V.strokecolor,strokeWidth:V.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:V.highlightstrokecolor}),ce[P].getLabelAnchor=Ae,he=Oe(Q,P),x=0;x<C.length;x++)te=C[x][P],N[x][P]=v.create("point",[te,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),N[x][P].addTransform(N[x][P],he);for(H=[],P=0;P<ee;P++)for(V.labelcolor=$&&$[P%$.length],V.strokecolor=$&&$[P%$.length],V.fillcolor=$&&$[P%$.length],H[P]=v.create("polygon",N[P],{withLines:!0,withLabel:!1,fillColor:V.fillcolor,fillOpacity:V.fillopacity,highlightFillColor:V.highlightfillcolor}),x=0;x<O;x++)H[P].borders[x].setAttribute("strokecolor:"+$[P%$.length]),H[P].borders[x].setAttribute("strokewidth:"+V.polystrokewidth);switch(_.legendposition||"none"){case"right":ne=_.legendleftoffset||2,ge=_.legendtopoffset||1,this.legend=v.create("legend",[J+Z+ne,z+Z-ge],{labels:q,colors:$});break;case"none":break;default:g.debug("Unknown legend position")}if(de=[],_.showcircles){for(fe=[],P=0;P<6;P++)fe[P]=20*P;if(fe[0]="0",(Ce=(ye=_.circlelabelarray||fe).length)<2)throw new Error("JSXGraph radar chart: too less circles in circleLabelArray");for(ue=[],he=Oe(G+Math.PI/O,0),V.fillcolor="none",V.highlightfillcolor="none",V.strokecolor=_.strokecolor||"black",V.strokewidth=_.circlestrokewidth||.5,V.layer=0,Pe=(I[0]-j[0])/(Ce-1),P=0;P<Ce;P++)ue[P]=v.create("point",[j[0]+P*Pe,0],{name:ye[P],size:0,fixed:!0,withLabel:!0,visible:!0}),ue[P].addTransform(ue[P],he),de[P]=v.create("circle",[X,ue[P]],V)}return this.rendNode=H[0].rendNode,{circles:de,lines:ce,points:N,midpoint:X,polygons:H}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){return this}}),g.createChart=function(v,C,_){var P,x,S,O,w,T,M,N,A,R,L,D,k,B,j,I,q=[],$=o.isBrowser?v.document.getElementById(C[0]):null;if(C.length===1&&e.isString(C[0])){if(e.exists($)){if(A=e.copyAttributes(_,v.options,"chart"),P=($=new c().loadFromTable(C[0],A.withheaders,A.withheaders)).data,w=$.columnHeaders,x=$.rowHeaders,R=A.width,L=A.name,D=A.strokecolor,k=A.fillcolor,B=A.highlightstrokecolor,j=A.highlightfillcolor,v.suspendUpdate(),I=P.length,N=[],A.rows&&e.isArray(A.rows)){for(S=0;S<I;S++)for(O=0;O<A.rows.length;O++)if(A.rows[O]===S||A.withheaders&&A.rows[O]===x[S]){N.push(P[S]);break}}else N=P;for(I=N.length,S=0;S<I;S++){if(M=[],A.chartstyle&&A.chartstyle.indexOf("bar")!==-1){for(T=R||.8,M.push(1-T/2+(S+.5)*T/I),O=1;O<N[S].length;O++)M.push(M[O-1]+1);A.width=T/I}L&&L.length===I?A.name=L[S]:A.withheaders&&(A.name=w[S]),D&&D.length===I?A.strokecolor=D[S]:A.strokecolor=a.hsv2rgb((S+1)/I*360,.9,.6),k&&k.length===I?A.fillcolor=k[S]:A.fillcolor=a.hsv2rgb((S+1)/I*360,.9,1),B&&B.length===I?A.highlightstrokecolor=B[S]:A.highlightstrokecolor=a.hsv2rgb((S+1)/I*360,.9,1),j&&j.length===I?A.highlightfillcolor=j[S]:A.highlightfillcolor=a.hsv2rgb((S+1)/I*360,.9,.6),A.chartstyle&&A.chartstyle.indexOf("bar")!==-1?q.push(new g.Chart(v,[M,N[S]],A)):q.push(new g.Chart(v,[N[S]],A))}v.unsuspendUpdate()}return q}return A=e.copyAttributes(_,v.options,"chart"),new g.Chart(v,C,A)},g.registerElement("chart",g.createChart),g.Legend=function(v,C,_){var P;if(this.constructor(),P=e.copyAttributes(_,v.options,"legend"),this.board=v,this.coords=new m(b.COORDS_BY_USER,C,this.board),this.myAtts={},this.label_array=P.labelarray||P.labels,this.color_array=P.colorarray||P.colors,this.lines=[],this.myAtts.strokewidth=P.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=P.legendstyle||P.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(v,P)},g.Legend.prototype=new l,g.Legend.prototype.drawVerticalLegend=function(v,C){var _,P=C.linelength||1,x=(C.rowheight||20)/this.board.unitY,S=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new m(b.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(_=0;_<this.label_array.length;_++)this.myAtts.name=this.label_array[_],this.myAtts.strokecolor=this.color_array[_%this.color_array.length],this.myAtts.highlightstrokecolor=this.color_array[_%this.color_array.length],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[_%this.color_array.length],strokeWidth:this.myAtts.strokewidth},this.lines[_]=v.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-_*x],[this.coords.usrCoords[1]+P,this.coords.usrCoords[2]-_*x]],this.myAtts),this.lines[_].getLabelAnchor=S,this.lines[_].prepareUpdate().update().updateVisibility(e.evaluate(this.lines[_].visProp.visible)).updateRenderer()},g.createLegend=function(v,C,_){var P=[0,0];if(!e.exists(C)||C.length!==2)throw new Error("JSXGraph: Legend element needs two numbers as parameters");return P=C,new g.Legend(v,P,_)},g.registerElement("legend",g.createLegend),{Chart:g.Chart,Legend:g.Legend,createChart:g.createChart,createLegend:g.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type"],function(g,E,y,b){return g.Turtle=function(m,l,c){var a,e,o;return this.constructor(m,c,E.OBJECT_TYPE_TURTLE,E.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=m,this.visProp.curveType="plot",this._attributes=b.copyAttributes(this.visProp,m.options,"turtle"),delete this._attributes.id,a=0,e=0,o=90,l.length!==0&&(l.length===3?(a=l[0],e=l[1],o=l[2]):l.length===2?b.isArray(l[0])?(a=l[0][0],e=l[0][1],o=l[1]):(a=l[0],e=l[1]):(a=l[0][0],e=l[0][1])),this.init(a,e,o),this.methodMap=b.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},g.Turtle.prototype=new y,g.extend(g.Turtle.prototype,{init:function(m,l,c){var a={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[m,l],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,a),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],a),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-c),this.board.update()},forward:function(m){if(m===0)return this;var l,c=m*Math.cos(this.dir*Math.PI/180),a=m*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((l=this.board.create("transform",[c,a],{type:"translate"})).applyOnce(this.turtle),l.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=c,this.pos[1]+=a,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(m){return this.forward(-m)},right:function(m){return this.dir-=m,this.dir%=360,this.turtleIsHidden||this.board.create("transform",[-m*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(m){return this.right(-m)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var m,l;for(m=0;m<this.objects.length;m++)(l=this.objects[m]).type===E.OBJECT_TYPE_CURVE&&(this.board.removeObject(l),this.objects.splice(m,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var m,l,c=this.objects.length;for(m=0;m<c;m++)l=this.objects[m],this.board.removeObject(l);return this.init(0,0,90),this},setPos:function(m,l){return b.isArray(m)?this.pos=m:this.pos=[m,l],this.turtleIsHidden||(this.turtle.setPositionDirectly(E.COORDS_BY_USER,[m,l]),this.turtle2.setPositionDirectly(E.COORDS_BY_USER,[m,l+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",m)),this.objects.push(this.curve),this},setPenColor:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",m)),this.objects.push(this.curve),this},setHighlightPenColor:function(m){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",m)),this.objects.push(this.curve),this},setAttribute:function(m){var l,c,a,e=this.objects.length;for(l=0;l<e;l++)(c=this.objects[l]).type===E.OBJECT_TYPE_CURVE&&c.setAttribute(m);return a=this.visProp.id,this.visProp=b.deepCopy(this.curve.visProp),this.visProp.id=a,this._attributes=b.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(m,l){return this._attributes[m.toLowerCase()]=l,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var m=this.stack.pop();return this.pos[0]=m[0],this.pos[1]=m[1],this.dir=m[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(m){var l,c,a,e,o;return b.isArray(m)?(l=this.pos[0],c=this.pos[1],a=m[0],e=m[1],o=Math.atan2(e-c,a-l),this.right(this.dir-180*o/Math.PI)):b.isNumber(m)&&this.right(this.dir-m),this},moveTo:function(m){var l,c,a;return b.isArray(m)&&(l=m[0]-this.pos[0],c=m[1]-this.pos[1],this.turtleIsHidden||((a=this.board.create("transform",[l,c],{type:"translate"})).applyOnce(this.turtle),a.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=m[0],this.pos[1]=m[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(m){return this.forward(m)},bk:function(m){return this.back(m)},lt:function(m){return this.left(m)},rt:function(m){return this.right(m)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(m,l){var c,a,e,o,s=this.objects.length;for(c=0,a=0;c<s;c++)if((e=this.objects[c]).elementClass===E.OBJECT_CLASS_CURVE){if(a<=m&&m<a+e.numberPoints)return o=m-a,e[l](o);a+=e.numberPoints}return this[l]()},X:function(m){return b.exists(m)?this.evalAt(m,"X"):this.pos[0]},Y:function(m){return b.exists(m)?this.evalAt(m,"Y"):this.pos[1]},Z:function(m){return 1},minX:function(){return 0},maxX:function(){var m,l=this.objects.length,c=0;for(m=0;m<l;m++)this.objects[m].elementClass===E.OBJECT_CLASS_CURVE&&(c+=this.objects[m].numberPoints);return c},hasPoint:function(m,l){var c,a;for(c=0;c<this.objects.length;c++)if((a=this.objects[c]).type===E.OBJECT_TYPE_CURVE&&a.hasPoint(m,l))return!0;return!1}}),g.createTurtle=function(m,l,c){var a;return l=l||[],a=b.copyAttributes(c,m.options,"turtle"),new g.Turtle(m,l,a)},g.registerElement("turtle",g.createTurtle),{Turtle:g.Turtle,createTurtle:g.createTurtle}}),define("base/ticks",["jxg","math/math","math/geometry","math/numerics","base/constants","base/element","base/coords","utils/type","base/text"],function(g,E,y,b,m,l,c,a,e){return g.Ticks=function(o,s,t){if(this.constructor(o.board,t,m.OBJECT_TYPE_TICKS,m.OBJECT_CLASS_OTHER),this.line=o,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],a.isFunction(s))throw this.ticksFunction=s,new Error("Function arguments are no longer supported.");a.isArray(s)?this.fixedTicks=s:((Math.abs(s)<E.eps||s<0)&&(s=t.defaultdistance),this.ticksFunction=this.makeTicksFunction(s),this.equidistant=!0),this.minTicksDistance=t.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},g.Ticks.prototype=new l,g.extend(g.Ticks.prototype,{makeTicksFunction:function(o){return function(){var s,t,h;return a.evaluate(this.visProp.insertticks)?((h=(t=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-t.lower)<=6*(s=Math.pow(10,Math.floor(Math.log(.6*h)/Math.LN10)))&&(s*=.5),s):o}},hasPoint:function(o,s){var t,h,u,d,n=this.ticks&&this.ticks.length||0;if(a.isObject(a.evaluate(this.visProp.precision))?(d=this.board._inputDevice,u=a.evaluate(this.visProp.precision[d])):u=this.board.options.precision.hasPoint,u+=.5*a.evaluate(this.visProp.strokewidth),!a.evaluate(this.line.visProp.scalable)||this.line.elementClass===m.OBJECT_CLASS_CURVE||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==m.OBJECT_TYPE_AXIS)return!1;for(t=0;t<n;t++)if((h=this.ticks[t])[2]&&!(this.line.stdform[1]===0&&Math.abs(h[0][0]-this.line.point1.coords.scrCoords[1])<E.eps||this.line.stdform[2]===0&&Math.abs(h[1][0]-this.line.point1.coords.scrCoords[2])<E.eps)&&(Math.abs(h[0][0]-h[0][1])>=1||Math.abs(h[1][0]-h[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(s-.5*(h[1][0]+h[1][1]))<2*u&&h[0][0]-u<o&&o<h[0][1]+u)return!0}else if(this.line.stdform[2]===0&&Math.abs(o-.5*(h[0][0]+h[0][1]))<2*u&&h[1][0]-u<s&&s<h[1][1]+u)return!0}return!1},setPositionDirectly:function(o,s,t){var h,u,d=new c(o,s,this.board),n=new c(o,t,this.board),p=this.board.getBoundingBox();return this.line.type===m.OBJECT_TYPE_AXIS&&a.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<E.eps&&Math.abs(d.usrCoords[1]*n.usrCoords[1])>E.eps?(h=n.usrCoords[1]/d.usrCoords[1],p[0]*=h,p[2]*=h,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")):Math.abs(this.line.stdform[2])<E.eps&&Math.abs(d.usrCoords[2]*n.usrCoords[2])>E.eps&&(u=n.usrCoords[2]/d.usrCoords[2],p[3]*=u,p[1]*=u,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")),this):this},calculateTicksCoordinates:function(){var o,s,t,h;if(!(this.line.elementClass===m.OBJECT_CLASS_LINE&&(this.setTicksSizeVariables(),Math.abs(this.dx)<E.eps&&Math.abs(this.dy)<E.eps)))return o=this.getZeroCoordinates(),s=this.line.elementClass===m.OBJECT_CLASS_LINE?this.getLowerAndUpperBounds(o):{lower:this.line.minX(),upper:this.line.maxX()},a.evaluate(this.visProp.type)==="polar"&&(h=this.board.getBoundingBox(),t=Math.max(Math.sqrt(h[0]*h[0]+h[1]*h[1]),Math.sqrt(h[2]*h[2]+h[3]*h[3])),s.upper=t),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(o,s):this.generateFixedTicks(o,s),this},setTicksSizeVariables:function(o){var s,t,h,u,d=.5*a.evaluate(this.visProp.majorheight),n=.5*a.evaluate(this.visProp.minorheight);a.exists(o)?(t=this.line.minX(),h=this.line.maxX(),(u=this.line.points.length)<2?(this.dxMaj=0,this.dyMaj=0):E.relDif(o,t)<E.eps?(this.dxMaj=this.line.points[0].usrCoords[2]-this.line.points[1].usrCoords[2],this.dyMaj=this.line.points[1].usrCoords[1]-this.line.points[0].usrCoords[1]):E.relDif(o,h)<E.eps?(this.dxMaj=this.line.points[u-2].usrCoords[2]-this.line.points[u-1].usrCoords[2],this.dyMaj=this.line.points[u-1].usrCoords[1]-this.line.points[u-2].usrCoords[1]):(this.dxMaj=-b.D(this.line.Y)(o),this.dyMaj=b.D(this.line.X)(o))):(this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2]),this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,s=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=d/s*this.board.unitX,this.dyMaj*=d/s*this.board.unitY,this.dxMin*=n/s*this.board.unitX,this.dyMin*=n/s*this.board.unitY,this.minStyle=a.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=a.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var o,s,t,h,u,d,n,p,f=a.evaluate(this.visProp.anchor);return this.line.elementClass===m.OBJECT_CLASS_LINE?this.line.type===m.OBJECT_TYPE_AXIS?y.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(t=this.line.point1.coords.usrCoords[0],o=this.line.point1.coords.usrCoords[1],s=this.line.point1.coords.usrCoords[2],d=this.line.point2.coords.usrCoords[0],h=this.line.point2.coords.usrCoords[1],u=this.line.point2.coords.usrCoords[2],f==="right"?this.line.point2.coords:f==="middle"?new c(m.COORDS_BY_USER,[.5*(t+d),.5*(o+h),.5*(s+u)],this.board):a.isNumber(f)?new c(m.COORDS_BY_USER,[t+(d-t)*f,o+(h-o)*f,s+(u-s)*f],this.board):this.line.point1.coords):(n=this.line.minX(),p=this.line.maxX(),f==="right"?p:f==="middle"?.5*(n+p):a.isNumber(f)?n*(1-f)+p*f:n)},getLowerAndUpperBounds:function(o,s){var t,h,u,d,n,p,f,v,C,_,P=a.evaluate(this.line.visProp.straightfirst),x=a.evaluate(this.line.visProp.straightlast),S=a.evaluate(this.visProp.includeboundaries);return this.line.elementClass===m.OBJECT_CLASS_CURVE?{lower:this.line.minX(),upper:this.line.maxX()}:(n=new c(m.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),p=new c(m.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),f=Math.abs(n.usrCoords[0])>=E.eps&&n.scrCoords[1]>=0&&n.scrCoords[1]<=this.board.canvasWidth&&n.scrCoords[2]>=0&&n.scrCoords[2]<=this.board.canvasHeight,v=Math.abs(p.usrCoords[0])>=E.eps&&p.scrCoords[1]>=0&&p.scrCoords[1]<=this.board.canvasWidth&&p.scrCoords[2]>=0&&p.scrCoords[2]<=this.board.canvasHeight,a.exists(s)||s==="tickdistance"?y.calcStraight(this.line,n,p,a.evaluate(this.line.visProp.margin)):y.calcLineDelimitingPoints(this.line,n,p),u=a.evaluate(this.line.visProp.firstarrow),d=a.evaluate(this.line.visProp.lastarrow),(u||d)&&(this.board.renderer.getPositionArrowHead(this.line,n,p,a.evaluate(this.line.visProp.strokewidth)),u&&n.setCoordinates(m.COORDS_BY_SCREEN,[n.scrCoords[1],n.scrCoords[2]]),d&&p.setCoordinates(m.COORDS_BY_SCREEN,[p.scrCoords[1],p.scrCoords[2]])),(C=this.getDistanceFromZero(o,n))<(_=this.getDistanceFromZero(o,p))?(t=C,P||!f||S||(t+=E.eps),h=_,x||!v||S||(h-=E.eps)):_<C?(t=_,x||!v||S||(t+=E.eps),h=C,P||!f||S||(h-=E.eps)):(t=0,h=0),{lower:t,upper:h})},getDistanceFromZero:function(o,s){var t,h,u,d,n;return t=this.line.point1.coords,h=this.line.point2.coords,n=o.distance(m.COORDS_BY_USER,s),u=[h.usrCoords[0]-t.usrCoords[0],h.usrCoords[1]-t.usrCoords[1],h.usrCoords[2]-t.usrCoords[2]],d=[s.usrCoords[0]-o.usrCoords[0],s.usrCoords[1]-o.usrCoords[1],s.usrCoords[2]-o.usrCoords[2]],E.innerProduct(u,d,3)<0&&(n*=-1),n},generateEquidistantTicks:function(o,s){var t,h,u=E.eps,d=this.equidistant?this.ticksFunction(1):this.ticksDelta,n=a.evaluate(this.visProp.insertticks),p=a.evaluate(this.visProp.minorticks);if(this.line.elementClass===m.OBJECT_CLASS_LINE&&(h=this.getXandYdeltas()),d*=a.evaluate(this.visProp.scale),n&&this.minTicksDistance>E.eps?(d=this.adjustTickDistance(d,o,h),d/=p+1):n||(d/=p+1),this.ticksDelta=d,!(d<E.eps)){for(t=0,a.evaluate(this.visProp.drawzero)||(t=d);t<=s.upper+u&&(t>=s.lower-u&&this.processTickPosition(o,t,d,h),t+=d,!(s.upper-t>1e4*d)););for(t=-d;t>=s.lower-u&&(t<=s.upper+u&&this.processTickPosition(o,t,d,h),!((t-=d)-s.lower>1e4*d)););}},adjustTickDistance:function(o,s,t){var h,u,d,n=1,p=a.evaluate(this.visProp.minorticks);if(this.line.elementClass===m.OBJECT_CLASS_CURVE)return o;if(this.getLowerAndUpperBounds(s,"ticksdistance"),h=s.usrCoords[1]+t.x*o,u=s.usrCoords[2]+t.y*o,d=s.distance(m.COORDS_BY_SCREEN,new c(m.COORDS_BY_USER,[h,u],this.board)),o===0)return 0;for(;d/(p+1)<this.minTicksDistance;)o*=n===1?2:5,n*=-1,h=s.usrCoords[1]+t.x*o,u=s.usrCoords[2]+t.y*o,d=s.distance(m.COORDS_BY_SCREEN,new c(m.COORDS_BY_USER,[h,u],this.board));return o},processTickPosition:function(o,s,t,h){var u,d,n,p,f,v=a.evaluate(this.visProp.ticksperlabel),C=null;this.line.elementClass===m.OBJECT_CLASS_LINE?(u=o.usrCoords[1]+s*h.x,d=o.usrCoords[2]+s*h.y):(u=this.line.X(o+s),d=this.line.Y(o+s)),n=new c(m.COORDS_BY_USER,[u,d],this.board),this.line.elementClass===m.OBJECT_CLASS_CURVE&&(C=o+s,this.setTicksSizeVariables(C)),n.major=Math.round(s/t)%(a.evaluate(this.visProp.minorticks)+1)==0,v||(v=a.evaluate(this.visProp.minorticks)+1),f=Math.round(s/t)%v==0,(p=this.createTickPath(n,n.major)).length===3&&(this.ticks.push(p),f&&a.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(n,o,C),n,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(o,s){var t,h,u,d,n,p,f,v,C=E.eps,_=a.isArray(this.visProp.labels),P=a.evaluate(this.visProp.drawlabels);for(this.line.elementClass===m.OBJECT_CLASS_LINE&&(v=this.getXandYdeltas()),u=0;u<this.fixedTicks.length;u++)this.line.elementClass===m.OBJECT_CLASS_LINE?(f=this.fixedTicks[u],n=o.usrCoords[1]+f*v.x,p=o.usrCoords[2]+f*v.y):(f=o+this.fixedTicks[u],n=this.line.X(f),p=this.line.Y(f)),t=new c(m.COORDS_BY_USER,[n,p],this.board),this.line.elementClass===m.OBJECT_CLASS_CURVE&&this.setTicksSizeVariables(f),(d=this.createTickPath(t,!0)).length===3&&f>=s.lower-C&&f<=s.upper+C&&(this.ticks.push(d),P&&(_||a.exists(this.visProp.labels[u]))?(h=_?a.evaluate(this.visProp.labels[u]):f,this.labelsData.push(this.generateLabelData(this.generateLabelText(t,o,h),t,u))):this.labelsData.push(null))},getXandYdeltas:function(){var o,s,t=this.line.point1.Dist(this.line.point2);return this.line.type===m.OBJECT_TYPE_AXIS?(o=this.line.point1.coords.usrCoords,s=this.line.point2.coords.usrCoords,(o[1]>s[1]||Math.abs(o[1]-s[1])<E.eps&&o[2]>s[2])&&(o=this.line.point2.coords.usrCoords,s=this.line.point1.coords.usrCoords)):(o=this.line.point1.coords.usrCoords,s=this.line.point2.coords.usrCoords),{x:(s[1]-o[1])/t,y:(s[2]-o[2])/t}},_isInsideCanvas:function(o,s,t){var h=this.board.canvasWidth,u=this.board.canvasHeight;return t===void 0&&(t=0),o[0]>=t&&o[0]<=h-t&&s[0]>=t&&s[0]<=u-t||o[1]>=t&&o[1]<=h-t&&s[1]>=t&&s[1]<=u-t},createTickPath:function(o,s){var t,h,u,d,n,p,f,v,C,_,P,x,S,O,w=[-2e6,-2e6],T=[-2e6,-2e6];if(t=o.scrCoords,s?(d=this.dxMaj,n=this.dyMaj,C=this.majStyle):(d=this.dxMin,n=this.dyMin,C=this.minStyle),h=[-n*t[1]-d*t[2],n,d],s&&a.evaluate(this.visProp.type)==="polar"){if(x=this.board.getBoundingBox(),O=(S=2*Math.PI)/180,t=o.usrCoords,(P=Math.sqrt(t[1]*t[1]+t[2]*t[2]))<Math.max(Math.sqrt(x[0]*x[0]+x[1]*x[1]),Math.sqrt(x[2]*x[2]+x[3]*x[3]))){for(w=[],T=[],_=0;_<=S;_+=O)w.push(this.board.origin.scrCoords[1]+P*Math.cos(_)*this.board.unitX),T.push(this.board.origin.scrCoords[2]+P*Math.sin(_)*this.board.unitY);return[w,T,s]}}else if(C==="infinite"?(u=y.meetLineBoard(h,this.board),w[0]=u[0].scrCoords[1],w[1]=u[1].scrCoords[1],T[0]=u[0].scrCoords[2],T[1]=u[1].scrCoords[2]):(v=a.evaluate(this.visProp.face)===">"?Math.PI/4:a.evaluate(this.visProp.face)==="<"?-Math.PI/4:0,p=Math.cos(v)*d-Math.sin(v)*n,f=Math.sin(v)*d+Math.cos(v)*n,w[0]=t[1]+p*a.evaluate(this.visProp.tickendings[0]),T[0]=t[2]-f*a.evaluate(this.visProp.tickendings[0]),w[1]=t[1],T[1]=t[2],v=-v,p=Math.cos(v)*d-Math.sin(v)*n,f=Math.sin(v)*d+Math.cos(v)*n,w[2]=t[1]-p*a.evaluate(this.visProp.tickendings[1]),T[2]=t[2]+f*a.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(w,T))return[w,T,s];return[]},formatLabelText:function(o){var s,t,h=a.evaluate(this.visProp.scalesymbol);return a.isNumber(o)?(((s=(Math.round(1e11*o)/1e11).toString()).length>a.evaluate(this.visProp.maxlabellength)||s.indexOf("e")!==-1)&&(t=a.evaluate(this.visProp.digits),a.evaluate(this.visProp.precision)!==3&&t===3&&(t=a.evaluate(this.visProp.precision)),s=o.toExponential(t).toString()),a.evaluate(this.visProp.beautifulscientificticklabels)&&(s=this.beautifyScientificNotationLabel(s)),s.indexOf(".")>-1&&s.indexOf("e")===-1&&(s=(s=s.replace(/0+$/,"")).replace(/\.$/,""))):s=o.toString(),h.length>0&&(s==="1"?s=h:s==="-1"?s="-"+h:s!=="0"&&(s+=h)),a.evaluate(this.visProp.useunicodeminus)&&(s=s.replace(/-/g,"−")),s},beautifyScientificNotationLabel:function(o){return o.indexOf("e")===-1?o:(parseFloat(o.substring(0,o.indexOf("e")))+o.substring(o.indexOf("e"))).replace(/e(.*)$/g,function(s,t){var h="•10";return h+=t.replace(/-/g,"⁻").replace(/\+/g,"").replace(/0/g,"⁰").replace(/1/g,"¹").replace(/2/g,"²").replace(/3/g,"³").replace(/4/g,"⁴").replace(/5/g,"⁵").replace(/6/g,"⁶").replace(/7/g,"⁷").replace(/8/g,"⁸").replace(/9/g,"⁹")})},generateLabelText:function(o,s,t){var h;if(!a.exists(t)){if(h=this.getDistanceFromZero(s,o),Math.abs(h)<E.eps)return"0";t=h/a.evaluate(this.visProp.scale)}return this.formatLabelText(t)},generateLabelData:function(o,s,t){var h,u,d,n;return n=a.evaluate(this.visProp.label.fontsize),h=[s.scrCoords[1],s.scrCoords[1]],u=[s.scrCoords[2],s.scrCoords[2]],d=n===void 0?12:n,d*=.5,this._isInsideCanvas(h,u,d)?(h=a.evaluate(this.visProp.label.offset[0]),u=a.evaluate(this.visProp.label.offset[1]),{x:s.usrCoords[1]+h/this.board.unitX,y:s.usrCoords[2]+u/this.board.unitY,t:o,i:t}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var o,s,t,h,u,d,n,p;for(t=this.labelsData.length,h=this.labels.length,o=0,s=0;o<t;o++)this.labelsData[o]!==null&&(n=this.labelsData[o],s<h?((d=this.labels[s]).setText(n.t),d.setCoords(n.x,n.y),s++):(this.labelCounter+=1,u={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},(u=a.deepCopy(u,this.visProp.label)).id=this.id+n.i+"Label"+this.labelCounter,d=e.createText(this.board,[n.x,n.y,n.t],u),this.addChild(d),d.setParents(this),d.isDraggable=!1,d.dump=!1,this.labels.push(d)),(p=a.evaluate(this.visProp.label.visible))==="inherit"&&(p=this.visPropCalc.visible),d.prepareUpdate().updateVisibility(p).updateRenderer(),d.distanceX=a.evaluate(this.visProp.label.offset[0]),d.distanceY=a.evaluate(this.visProp.label.offset[1]));for(s=t=s;s<h;s++)this.board.renderer.display(this.labels[s],!1),this.labels[s].visProp.visible=this.labels[s].visPropCalc.visible=!1;return this},hideElement:function(){var o;for(g.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),o=0;o<this.labels.length;o++)a.exists(this.labels[o])&&this.labels[o].hideElement();return this},showElement:function(){var o;for(g.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),o=0;o<this.labels.length;o++)a.exists(this.labels[o])&&this.labels[o].showElement();return this}}),g.createTicks=function(o,s,t){var h,u,d=a.copyAttributes(t,o.options,"ticks");if(u=s.length<2?d.ticksdistance:s[1],s[0].elementClass!==m.OBJECT_CLASS_LINE&&s[0].elementClass!==m.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof s[0]+"'.");return h=new g.Ticks(s[0],u,d),a.isFunction(d.generatelabelvalue)&&(h.generateLabelText=d.generatelabelvalue),a.isFunction(d.generatelabeltext)&&(h.generateLabelText=d.generatelabeltext),h.setParents(s[0]),h.isDraggable=!0,h.fullUpdate(s[0].visPropCalc.visible),h},g.createHatchmark=function(o,s,t){var h,u,d,n,p,f=[],v=a.copyAttributes(t,o.options,"hatch");if(s[0].elementClass!==m.OBJECT_CLASS_LINE&&s[0].elementClass!==m.OBJECT_CLASS_CURVE||typeof s[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof s[0]+"' and '"+typeof s[1]+" and ''"+typeof s[2]+"'.");for(d=.5*-(((h=s[1])-1)*(n=v.ticksdistance)),u=0;u<h;u++)f[u]=d+u*n;return(p=o.create("ticks",[s[0],f],v)).elType="hatch",p},g.registerElement("ticks",g.createTicks),g.registerElement("hash",g.createHatchmark),g.registerElement("hatch",g.createHatchmark),{Ticks:g.Ticks,createTicks:g.createTicks,createHashmark:g.createHatchmark,createHatchmark:g.createHatchmark}}),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],function(g,E,y,b,m,l,c,a){return g.CA=function(e,o,s){this.node=e,this.createNode=o,this.parser=s},g.extend(g.CA.prototype,{findMapNode:function(e,o){var s,t,h;if(o.value==="op_assign"&&o.children[0].value===e)return o.children[1];if(o.children){for(t=o.children.length,s=0;s<t;++s)if((h=this.findMapNode(e,o.children[s]))!==null)return h}return null},setMath:function(e){var o,s;if((e.type!="node_op"||e.value!="op_add"&&e.value!="op_sub"&&e.value!="op_mul"&&e.value!="op_div"&&e.value!="op_neg"&&e.value!="op_execfun"&&e.value!="op_exp")&&e.type!="node_var"&&e.type!="node_const"||(e.isMath=!0),e.children)for(s=e.children.length,o=0;o<s;++o)this.setMath(e.children[o])},deriveElementary:function(e,o){var s,t=e.children[0].value,h=e.children[1];switch(t){case"abs":s=this.createNode("node_op","op_div",h[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0]))]));break;case"sqrt":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(e.type,e.value,c.deepCopy(e.children[0]),c.deepCopy(e.children[1]))));break;case"sin":s=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),c.deepCopy(h));break;case"cos":s=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),c.deepCopy(h)));break;case"tan":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),c.deepCopy(h)),this.createNode("node_const",2)));break;case"cot":s=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),c.deepCopy(h)),this.createNode("node_const",2))));break;case"exp":s=this.createNode(e.type,e.value,c.deepCopy(e.children[0]),c.deepCopy(e.children[1]));break;case"pow":s=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",c.deepCopy(e.children[0]),c.deepCopy(e.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(e.children[1][0],o),this.createNode("node_op","op_div",c.deepCopy(e.children[1][1]),c.deepCopy(e.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(e.children[1][1],o),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[c.deepCopy(e.children[1][0])]))));break;case"log":case"ln":s=this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(h[0]));break;case"log2":case"lb":case"ld":s=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(h[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":s=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),c.deepCopy(h[0])),this.createNode("node_const",.43429448190325176));break;case"asin":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0])))]));break;case"acos":s=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0])))])));break;case"atan":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0]))));break;case"acot":s=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0])))));break;case"sinh":s=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[c.deepCopy(h[0])]);break;case"cosh":s=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[c.deepCopy(h[0])]);break;case"tanh":s=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[c.deepCopy(h[0])]),this.createNode("node_const",2)));break;case"asinh":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0])),this.createNode("node_const",1))]));break;case"acosh":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0])),this.createNode("node_const",1))]));break;case"atanh":s=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",c.deepCopy(h[0]),c.deepCopy(h[0]))));break;default:throw s=this.createNode("node_const",0),console.log('Derivative of "'+t+'" not yet implemented'),new Error("Error("+this.line+"): ")}return s},derivative:function(e,o){var s;switch(e.type){case"node_op":switch(e.value){case"op_execfun":s=e.children[0].value=="pow"?this.deriveElementary(e,o):e.children[1].length===0?this.createNode("node_const",0):this.createNode("node_op","op_mul",this.deriveElementary(e,o),this.derivative(e.children[1][0],o));break;case"op_div":s=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(e.children[0],o),c.deepCopy(e.children[1])),this.createNode("node_op","op_mul",c.deepCopy(e.children[0]),this.derivative(e.children[1],o))),this.createNode("node_op","op_mul",c.deepCopy(e.children[1]),c.deepCopy(e.children[1])));break;case"op_mul":s=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",c.deepCopy(e.children[0]),this.derivative(e.children[1],o)),this.createNode("node_op","op_mul",this.derivative(e.children[0],o),c.deepCopy(e.children[1])));break;case"op_neg":s=this.createNode("node_op","op_neg",this.derivative(e.children[0],o));break;case"op_add":case"op_sub":s=this.createNode("node_op",e.value,this.derivative(e.children[0],o),this.derivative(e.children[1],o));break;case"op_exp":s=this.createNode("node_op","op_mul",c.deepCopy(e),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(e.children[0],o),this.createNode("node_op","op_div",c.deepCopy(e.children[1]),c.deepCopy(e.children[0]))),this.createNode("node_op","op_mul",this.derivative(e.children[1],o),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[c.deepCopy(e.children[0])]))))}break;case"node_var":s=e.value===o?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":s=this.createNode("node_const",0)}return s},expandDerivatives:function(e,o,s){var t,h,u,d,n,p,f,v,C,_,P;if(!e)return 0;for(this.line=e.line,this.col=e.col,t=e.children.length,h=0;h<t;++h)if(e.children[h]&&e.children[h].type)e.children[h]=this.expandDerivatives(e.children[h],e,s);else if(c.isArray(e.children[h]))for(u=0;u<e.children[h].length;++u)e.children[h][u]&&e.children[h][u].type&&(e.children[h][u]=this.expandDerivatives(e.children[h][u],e,s));if(e.type==="node_op"&&e.value==="op_execfun"&&e.children[0]&&e.children[0].value==="D"){if(e.children[1][0].type=="node_var"?(v=e.children[1][0].value,_=(d=this.findMapNode(v,s)).children[0],C=e.children[1].length>=2?e.children[1][1].value:d.children[0][0],n=d.children[1]):(n=e.children[1][0],_=["x"],C=e.children[1].length>=2?e.children[1][1].value:"x"),f=n,(P=e.children[1].length>=3?e.children[1][2].value:1)>=1)for(;P>=1;)f=this.derivative(f,C),f=this.removeTrivialNodes(f),P--;p=o.type=="node_op"&&o.value=="op_assign"?this.createNode("node_op","op_map",_,f):f,this.setMath(p),e.type=p.type,e.value=p.value,e.children[0]=p.children[0],e.children[1]=p.children[1]}return e},removeTrivialNodes:function(e){var o,s,t,h,u;if(c.isArray(e))for(s=e.length,o=0;o<s;++o)e[o]=this.removeTrivialNodes(e[o]);if(e.type!="node_op"||!e.children)return e;for(s=e.children.length,o=0;o<s;++o){this.mayNotBeSimplified=!1;do e.children[o]=this.removeTrivialNodes(e.children[o]);while(this.mayNotBeSimplified)}switch(e.value){case"op_map":if(t=e.children[0],(h=e.children[1]).type=="node_var"){for(o=0;o<t.length;++o)if(t[o]==h.value){h.isMath=!0;break}}break;case"op_add":if(t=e.children[0],h=e.children[1],t.type=="node_const"&&t.value===0)return h;if(h.type=="node_const"&&h.value===0)return t;if(t.type=="node_const"&&h.type=="node_const")return t.value+=h.value,t;break;case"op_mul":if(t=e.children[0],h=e.children[1],t.type=="node_const"&&t.value==1)return h;if(h.type=="node_const"&&h.value==1||t.type=="node_const"&&t.value===0)return t;if(h.type=="node_const"&&h.value===0||h.type=="node_const"&&h.value===0)return h;if(t.type=="node_op"&&t.value=="op_neg"&&h.type=="node_op"&&h.value=="op_neg")return e.children=[t.children[0],h.children[0]],this.mayNotBeSimplified=!0,e;if(t.value=="op_neg"&&h.value!="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_mul",t.children[0],h)],this.mayNotBeSimplified=!0,e;if(t.value!="op_neg"&&h.value=="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_mul",t,h.children[0])],this.mayNotBeSimplified=!0,e;if(t.value=="op_div"&&t.children[0].type=="node_const"&&t.children[0].value==1)return e.type="node_op",e.value="op_div",e.children=[h,t.children[1]],this.mayNotBeSimplified=!0,e;if(h.value=="op_div"&&h.children[0].type=="node_const"&&h.children[0].value==1)return e.type="node_op",e.value="op_div",e.children=[t,h.children[1]],this.mayNotBeSimplified=!0,e;if(t.type!="node_const"&&h.type=="node_const")return e.children=[h,t],this.mayNotBeSimplified=!0,e;if(t.type!="node_const"&&h.type=="node_op"&&h.value=="op_neg"&&h.children[0].type=="node_const")return e.children=[h,t],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value!="op_execfun"&&(h.type=="node_var"||h.type=="node_op"&&h.value=="op_execfun"))return e.children=[h,t],this.mayNotBeSimplified=!0,e;if(t.type!="node_op"&&h.type=="node_op"&&h.value=="op_neg"&&h.children[0].type=="node_var")return e.children=[h,t],this.mayNotBeSimplified=!0,e;if(t.type!="node_const"&&h.type=="node_op"&&(h.value=="op_mul"||h.value=="op_div")&&h.children[0].type=="node_const")return u=h.children[0],h.children[0]=t,e.children=[u,h],this.mayNotBeSimplified=!0,e;if(h.type!="node_const"&&t.type=="node_op"&&t.value=="op_mul"&&t.children[0].type=="node_const")return e.children=[t.children[0],this.createNode("node_op","op_mul",t.children[1],h)],this.mayNotBeSimplified=!0,e;if(t.type=="node_const"&&h.type=="node_const")return t.value*=h.value,t;if(t.type=="node_const"&&h.type=="node_op"&&(h.value=="op_mul"||h.value=="op_div")&&h.children[0].type=="node_const")return h.children[0].value*=t.value,h;if(t.hash=this.parser.compile(t),h.hash=this.parser.compile(h),t.hash===h.hash)return e.value="op_exp",e.children[1]=this.createNode("node_const",2),e;if(t.type=="node_const"&&h.type=="node_op"&&(h.value=="op_mul"||h.value=="op_div")&&h.children[0].type=="node_const")return h.children[0].value*=t.value,h;if(h.type=="node_op"&&h.value=="op_exp"&&(t.hash||(t.hash=this.parser.compile(t)),h.children[0].hash||(h.children[0].hash=this.parser.compile(h.children[0])),t.hash===h.children[0].hash))return h.children[1]=this.createNode("node_op","op_add",h.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,h;if(t.type=="node_op"&&t.value=="op_exp"&&h.type=="node_op"&&h.value=="op_exp"&&(t.children[0].hash=this.parser.compile(t.children[0]),h.children[0].hash=this.parser.compile(h.children[0]),t.children[0].hash===h.children[0].hash))return t.children[1]=this.createNode("node_op","op_add",t.children[1],h.children[1]),this.mayNotBeSimplified=!0,t;break;case"op_sub":if(t=e.children[0],h=e.children[1],t.type=="node_const"&&t.value===0)return e.value="op_neg",e.children[0]=h,e;if(h.type=="node_const"&&h.value===0)return t;if(t.type=="node_const"&&h.type=="node_const"&&t.value==h.value)return this.createNode("node_const",0);if(t.type=="node_var"&&h.type=="node_var"&&t.value==h.value)return this.createNode("node_const",0);if(t.type=="node_const"&&h.type=="node_const")return t.value-=h.value,t;if(t.type=="node_op"&&t.value=="op_mul"&&h.type=="node_op"&&h.value=="op_mul"&&(t.children[1].hash=this.parser.compile(t.children[1]),h.children[1].hash=this.parser.compile(h.children[1]),t.children[1].hash===h.children[1].hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",t.children[0],h.children[0]),t.children[1]],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value=="op_mul"&&(t.children[1].hash=this.parser.compile(t.children[1]),h.hash=this.parser.compile(h),t.children[1].hash===h.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",t.children[0],this.createNode("node_const",1)),h],this.mayNotBeSimplified=!0,e;if(h.type=="node_op"&&h.value=="op_mul"&&(h.children[1].hash=this.parser.compile(h.children[1]),t.hash=this.parser.compile(t),h.children[1].hash===t.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),h.children[0]),t],this.mayNotBeSimplified=!0,e;break;case"op_neg":if((t=e.children[0]).type=="node_const"&&t.value===0)return t;if(t.type=="node_op"&&t.value=="op_neg")return t.children[0];break;case"op_div":if(t=e.children[0],h=e.children[1],t.type=="node_const"&&h.type=="node_const"&&t.value==h.value&&t.value!==0)return t.value=1,t;if(t.type=="node_const"&&t.value===0&&h.type=="node_const"&&h.value!==0)return t.value=0,t;if(t.type=="node_const"&&t.value===0&&(h.type=="node_op"||h.type=="node_var"))return e.type="node_const",e.value=0,e;if(t.type=="node_var"&&h.type=="node_var"&&t.value==h.value)return this.createNode("node_const",1);if(t.type=="node_const"&&t.value!==0&&h.type=="node_const"&&h.value===0)return t.value>0?t.value=1/0:t.value=-1/0,t;if(t.type=="node_op"&&t.value=="op_neg"&&h.type=="node_op"&&h.value=="op_neg")return e.children=[t.children[0],h.children[0]],this.mayNotBeSimplified=!0,e;if(t.value=="op_neg"&&h.value!="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_div",t.children[0],h)],this.mayNotBeSimplified=!0,e;if(t.value!="op_neg"&&h.value=="op_neg")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_op","op_div",t,h.children[0])],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value=="op_exp"&&(h.hash||(h.hash=this.parser.compile(h)),t.children[0].hash||(t.children[0].hash=this.parser.compile(t.children[0])),h.hash===t.children[0].hash))return t.children[1]=this.createNode("node_op","op_sub",t.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,t;if(h.type!="node_const"&&t.type=="node_op"&&t.value=="op_mul"&&t.children[0].type=="node_const")return e.value="op_mul",e.children=[t.children[0],this.createNode("node_op","op_div",t.children[1],h)],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value=="op_exp"&&h.type=="node_op"&&h.value=="op_exp"&&(t.children[0].hash=this.parser.compile(t.children[0]),h.children[0].hash=this.parser.compile(h.children[0]),t.children[0].hash===h.children[0].hash))return t.children[1]=this.createNode("node_op","op_sub",t.children[1],h.children[1]),this.mayNotBeSimplified=!0,t;break;case"op_exp":if(t=e.children[0],(h=e.children[1]).type=="node_const"&&h.value===0)return h.value=1,h;if(h.type=="node_const"&&h.value==1||t.type=="node_const"&&t.value==1||t.type=="node_const"&&t.value===0&&h.type=="node_const"&&h.value!==0)return t;if(t.type=="node_op"&&t.value=="op_exp")return e.children=[t.children[0],this.createNode("node_op","op_mul",t.children[1],h)],e}switch(e.value){case"op_add":if(t=e.children[0],h=e.children[1],t.type=="node_const"&&h.type=="node_const"&&t.value==h.value)return t.value+=h.value,t;if(t.type=="node_var"&&h.type=="node_var"&&t.value==h.value)return e.children[0]=this.createNode("node_const",2),e.value="op_mul",e;if(t.type=="node_op"&&t.value=="op_neg")return e.value="op_sub",e.children[0]=h,e.children[1]=t.children[0],this.mayNotBeSimplified=!0,e;if(h.type=="node_op"&&h.value=="op_neg")return e.value="op_sub",e.children[1]=h.children[0],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value=="op_mul"&&h.type=="node_op"&&h.value=="op_mul"&&(t.children[1].hash=this.parser.compile(t.children[1]),h.children[1].hash=this.parser.compile(h.children[1]),t.children[1].hash===h.children[1].hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",t.children[0],h.children[0]),t.children[1]],this.mayNotBeSimplified=!0,e;if(t.type=="node_op"&&t.value=="op_mul"&&(t.children[1].hash=this.parser.compile(t.children[1]),h.hash=this.parser.compile(h),t.children[1].hash===h.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",t.children[0],this.createNode("node_const",1)),h],this.mayNotBeSimplified=!0,e;if(h.type=="node_op"&&h.value=="op_mul"&&(h.children[1].hash=this.parser.compile(h.children[1]),t.hash=this.parser.compile(t),h.children[1].hash===t.hash))return e.value="op_mul",e.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),h.children[0]),t],this.mayNotBeSimplified=!0,e;break;case"op_sub":if(t=e.children[0],(h=e.children[1]).type=="node_op"&&h.value=="op_neg")return e.value="op_add",e.children[1]=h.children[0],this.mayNotBeSimplified=!0,e;break;case"op_execfun":return this.simplifyElementary(e)}return e},simplifyElementary:function(e){var o=e.children[0].value,s=e.children[1];if(s.length==0)return e;switch(o){case"sin":case"tan":if(s[0].type=="node_const"&&s[0].value===0||s[0].type=="node_var"&&s[0].value=="PI"||s[0].type=="node_op"&&s[0].value=="op_mul"&&s[0].children[0].type=="node_const"&&s[0].children[0].value%1==0&&s[0].children[1].type=="node_var"&&s[0].children[1].value=="PI")return e.type="node_const",e.value=0,e;break;case"cos":if(s[0].type=="node_const"&&s[0].value===0)return e.type="node_const",e.value=1,e;if(s[0].type=="node_var"&&s[0].value=="PI")return e.type="node_op",e.value="op_neg",e.children=[this.createNode("node_const",1)],e;break;case"exp":if(s[0].type=="node_const"&&s[0].value===0)return e.type="node_const",e.value=1,e;break;case"pow":if(s[1].type=="node_const"&&s[1].value===0)return e.type="node_const",e.value=1,e}return e}}),g.CA}),define("utils/dump",["jxg","utils/type"],function(g,E){return g.Dump={addMarkers:function(y,b,m){var l,c,a;for(l in E.isArray(b)||(b=[b]),E.isArray(m)||(m=[m]),c=Math.min(b.length,m.length),b.length=c,m.length=c,y.objects)if(y.objects.hasOwnProperty(l))for(a=0;a<c;a++)y.objects[l][b[a]]=m[a]},deleteMarkers:function(y,b){var m,l,c;for(m in E.isArray(b)||(b=[b]),l=b.length,b.length=l,y.objects)if(y.objects.hasOwnProperty(m))for(c=0;c<l;c++)delete y.objects[m][b[c]]},str:function(y){return typeof y=="string"&&y.substr(0,7)!=="function"&&(y='"'+y+'"'),y},minimizeObject:function(y,b){var m,l,c,a={},e=E.deepCopy(y),o=[];for(c=1;c<arguments.length;c++)o.push(arguments[c]);for(a=E.deepCopy(a,g.Options.elements,!0),c=o.length;c>0;c--)a=E.deepCopy(a,o[c-1],!0);for(m in a)a.hasOwnProperty(m)&&(l=m.toLowerCase(),typeof a[m]!="object"&&a[m]===e[l]&&delete e[l]);return e},prepareAttributes:function(y,b){var m,l;for(l in m=this.minimizeObject(b.getAttributes(),g.Options[b.elType]),b.subs)b.subs.hasOwnProperty(l)&&(m[l]=this.minimizeObject(b.subs[l].getAttributes(),g.Options[b.elType][l],g.Options[b.subs[l].elType]),m[l].id=b.subs[l].id,m[l].name=b.subs[l].name);return m.id=b.id,m.name=b.name,m},setBoundingBox:function(y,b,m){return y.push({obj:m,method:"setBoundingBox",params:[b.getBoundingBox(),b.keepaspectratio]}),y},dump:function(y){var b,m,l,c,a=[],e=[],o=y.objectsList.length;for(this.addMarkers(y,"dumped",!1),b=0;b<o;b++)if(l={},!(m=y.objectsList[b]).dumped&&m.dump){for(l.type=m.getType(),l.parents=m.getParents().slice(),l.type==="point"&&l.parents[0]===1&&(l.parents=l.parents.slice(1)),c=0;c<l.parents.length;c++)E.isString(l.parents[c])&&l.parents[c][0]!=="'"&&l.parents[c][0]!=='"'?l.parents[c]='"'+l.parents[c]+'"':E.isArray(l.parents[c])&&(l.parents[c]="["+l.parents[c].toString()+"]");l.attributes=this.prepareAttributes(y,m),l.type==="glider"&&m.onPolygon&&a.push({obj:m.id,prop:"onPolygon",val:!0}),e.push(l)}return this.deleteMarkers(y,"dumped"),{elements:e,props:a,methods:[]}},arrayToParamStr:function(y,b){var m,l=[];for(m=0;m<y.length;m++)l.push(b.call(this,y[m]));return l.join(", ")},toJCAN:function(y){var b,m,l;switch(typeof y){case"object":if(y){if(m=[],E.isArray(y)){for(b=0;b<y.length;b++)m.push(this.toJCAN(y[b]));return"["+m.join(",")+"]"}for(l in y)y.hasOwnProperty(l)&&m.push(l+": "+this.toJCAN(y[l]));return"<<"+m.join(", ")+">> "}return"null";case"string":return"'"+y.replace(/\\/g,"\\\\").replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return y.toString();case"null":return"null"}},toJessie:function(y){var b,m,l,c=this.dump(y),a=[];for(c.methods=this.setBoundingBox(c.methods,y,"$board"),m=c.elements,b=0;b<m.length;b++)m[b].attributes.name.length>0&&a.push("// "+m[b].attributes.name),a.push("s"+b+" = "+m[b].type+"("+m[b].parents.join(", ")+") "+this.toJCAN(m[b].attributes).replace(/\n/,"\\n")+";"),m[b].type==="axis"&&(l=m[b].attributes.id,y.objects[l].defaultTicks===null&&a.push("s"+b+".removeAllTicks();")),a.push("");for(b=0;b<c.methods.length;b++)a.push(c.methods[b].obj+"."+c.methods[b].method+"("+this.arrayToParamStr(c.methods[b].params,this.toJCAN)+");"),a.push("");for(b=0;b<c.props.length;b++)a.push(c.props[b].obj+"."+c.props[b].prop+" = "+this.toJCAN(c.props[b].val)+";"),a.push("");return a.join(`
`)},toJavaScript:function(y){var b,m,l,c=this.dump(y),a=[];for(c.methods=this.setBoundingBox(c.methods,y,"board"),m=c.elements,b=0;b<m.length;b++)a.push('board.create("'+m[b].type+'", ['+m[b].parents.join(", ")+"], "+E.toJSON(m[b].attributes)+");"),m[b].type==="axis"&&(l=m[b].attributes.id,y.objects[l].defaultTicks===null&&a.push('board.objects["'+l+'"].removeTicks(board.objects["'+l+'"].defaultTicks);'));for(b=0;b<c.methods.length;b++)a.push(c.methods[b].obj+"."+c.methods[b].method+"("+this.arrayToParamStr(c.methods[b].params,E.toJSON)+");"),a.push("");for(b=0;b<c.props.length;b++)a.push(c.props[b].obj+"."+c.props[b].prop+" = "+E.toJSON(c.props[b].val)+";"),a.push("");return a.join(`
`)}},g.Dump}),define("element/comb",["jxg","utils/type","base/point"],function(g,E,y){return g.createComb=function(b,m,l){var c,a,e,o,s;if(m.length!==2)throw s=m.map(function(t){return"'"+typeof t+"'"}),new Error("JSXGraph: Can't create comb with parent types "+s.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(E.isArray(m[0])&&m[0].length>1)o=E.copyAttributes(l,b.options,"comb","point1"),c=b.create("point",m[0],o);else if(E.isString(m[0])||E.isPoint(m[0]))c=b.select(m[0]);else if(E.isFunction(m[0])&&E.isPoint(m[0]()))c=m[0]();else{if(!(E.isFunction(m[0])&&m[0]().length&&m[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof m[0]+"' and '"+typeof m[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);o=E.copyAttributes(l,b.options,"comb","point1"),c=y.createPoint(b,m[0](),o)}if(E.isArray(m[1])&&m[1].length>1)o=E.copyAttributes(l,b.options,"comb","point2"),a=b.create("point",m[1],o);else if(E.isString(m[1])||E.isPoint(m[1]))a=b.select(m[1]);else if(E.isFunction(m[1])&&E.isPoint(m[1]()))a=m[1]();else{if(!(E.isFunction(m[1])&&m[1]().length&&m[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof m[0]+"' and '"+typeof m[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);o=E.copyAttributes(l,b.options,"comb","point2"),a=y.createPoint(b,m[1](),o)}return o=E.copyAttributes(l,b.options,"comb"),E.merge(o,E.copyAttributes(l,b.options,"comb","curve")),(e=b.create("curve",[[0],[0]],o)).updateDataArray=function(){var t,h,u,d,n,p,f,v,C,_,P=0,x=c.Dist(a),S=c,O=a;for(v=E.evaluate(e.visProp.frequency),C=-E.evaluate(e.visProp.angle),_=E.evaluate(e.visProp.width),E.evaluate(e.visProp.reverse)&&(S=a,O=c,C=-C),t=Math.cos(C),h=Math.sin(C),u=(O.X()-S.X())/x,d=(O.Y()-S.Y())/x,t*=_/Math.abs(h),h*=_/Math.abs(h),this.dataX=[],this.dataY=[];P<x;)n=S.X()+u*P,p=S.Y()+d*P,h*=f=Math.min(t,x-P)/Math.abs(t),t*=f,this.dataX.push(n),this.dataY.push(p),this.dataX.push(n+u*t+d*h),this.dataY.push(p-u*h+d*t),this.dataX.push(NaN),this.dataY.push(NaN),P+=v},e},g.registerElement("comb",g.createComb),{createComb:g.createComb}}),define("element/slopetriangle",["jxg","utils/type","base/constants","base/polygon"],function(g,E,y,b){var m=function(){b.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},l=function(){return this.tangent.getSlope()};return g.createSlopeTriangle=function(c,a,e){var o,s,t,h,u,d,n,p,f,v=!1;if(a.length===1&&a[0].type===y.OBJECT_TYPE_TANGENT)s=a[0],t=s.glider;else if(a.length===1&&a[0].type===y.OBJECT_TYPE_GLIDER)t=a[0],f=E.copyAttributes(e,c.options,"slopetriangle","tangent"),s=c.create("tangent",[t],f),v=!0;else{if(a.length!==2||a[0].elementClass!==y.OBJECT_CLASS_LINE||!E.isPoint(a[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof a[0]+"'.");s=a[0],t=a[1]}return f=E.copyAttributes(e,c.options,"slopetriangle","basepoint"),n=c.create("point",[function(){return[t.X()+1,t.Y()]}],f),f=E.copyAttributes(e,c.options,"slopetriangle","baseline"),d=c.create("line",[t,n],f),f=E.copyAttributes(e,c.options,"slopetriangle","glider"),h=c.create("glider",[t.X()+1,t.Y(),d],f),f=E.copyAttributes(e,c.options,"slopetriangle","toppoint"),u=c.create("point",[function(){return[h.X(),h.Y()+(h.X()-t.X())*s.getSlope()]}],f),(f=E.copyAttributes(e,c.options,"slopetriangle")).borders=E.copyAttributes(f.borders,c.options,"slopetriangle","borders"),(o=c.create("polygon",[t,h,u],f)).Value=l,o.tangent=s,o._isPrivateTangent=v,o.borders[2].setArrow(!1,!1),f=E.copyAttributes(e,c.options,"slopetriangle","label"),(p=c.create("text",[function(){return h.X()+.1},function(){return .5*(h.Y()+u.Y())},function(){return""}],f))._setText(function(){return E.toFixed(o.Value(),E.evaluate(p.visProp.digits))}),p.fullUpdate(),o.glider=h,o.basepoint=n,o.baseline=d,o.toppoint=u,o.label=p,o.subs={glider:h,basePoint:n,baseLine:d,topPoint:u,label:p},o.inherits.push(h,n,d,u,p),o.methodMap=g.deepCopy(o.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),o.remove=m,o},g.registerElement("slopetriangle",g.createSlopeTriangle),{createSlopeTriangle:g.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(g,E,y){var b=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};return g.createCheckbox=function(m,l,c){var a,e,o=y.copyAttributes(c,m.options,"checkbox");return e=[l[0],l[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],(a=m.create("text",e,o)).type=y.OBJECT_TYPE_CHECKBOX,a.rendNodeCheckbox=a.rendNode.childNodes[0].childNodes[0],a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[1],a.rendNodeTag=a.rendNodeCheckbox,a.rendNodeTag.disabled=!!o.disabled,a.rendNodeCheckbox.id=a.rendNode.id+"_checkbox",a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeLabel.setAttribute("for",a.rendNodeCheckbox.id),a.setText(l[2]),a.visPropOld.fontsize="0px",m.renderer.updateTextStyle(a,!1),a.rendNodeCheckbox.checked=o.checked,a._value=o.checked,a.Value=function(){return this._value},a.update=function(){return this.needsUpdate&&(g.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},E.addEvent(a.rendNodeCheckbox,"change",b,a),a},g.registerElement("checkbox",g.createCheckbox),{createCheckbox:g.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(g,E,y){var b=function(m){this._value=this.rendNodeInput.value,this.board.update()};return g.createInput=function(m,l,c){var a,e,o=y.copyAttributes(c,m.options,"input");return e=[l[0],l[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+o.maxlength+'" style="width:100%"/></span>'],(a=m.create("text",e,o)).type=y.OBJECT_TYPE_INPUT,a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[0],a.rendNodeInput=a.rendNode.childNodes[0].childNodes[1],a.rendNodeInput.value=l[2],a.rendNodeTag=a.rendNodeInput,a.rendNodeTag.disabled=!!o.disabled,a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeInput.id=a.rendNode.id+"_input",a.setText(l[3]),a._value=l[2],a.update=function(){return this.needsUpdate&&(g.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},a.Value=function(){return this._value},a.set=function(s){return this._value=s,this.rendNodeInput.value=s,this},E.addEvent(a.rendNodeInput,"input",b,a),E.addEvent(a.rendNodeInput,"mousedown",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),E.addEvent(a.rendNodeInput,"touchstart",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),E.addEvent(a.rendNodeInput,"pointerdown",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),a.visPropOld.fontsize="0px",m.renderer.updateTextStyle(a,!1),a},g.registerElement("input",g.createInput),{createInput:g.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(g,E,y){var b=function(){this._handler&&this._handler(),this.board.update()};return g.createButton=function(m,l,c){var a,e,o=y.copyAttributes(c,m.options,"button");return e=[l[0],l[1],'<button type="button" style="width:100%;"></button>'],(a=m.create("text",e,o)).type=y.OBJECT_TYPE_BUTTON,a.rendNodeButton=a.rendNode.childNodes[0],a.rendNodeButton.id=a.rendNode.id+"_button",a.rendNodeTag=a.rendNodeButton,a.rendNodeTag.disabled=!!o.disabled,a.setText(l[2]),a.visPropOld.fontsize="0px",m.renderer.updateTextStyle(a,!1),l[3]&&(y.isString(l[3])?(a._jc=new g.JessieCode,a._jc.use(m),a._handler=function(){a._jc.parse(l[3])}):a._handler=l[3]),E.addEvent(a.rendNodeButton,"click",b,a),E.addEvent(a.rendNodeButton,"mousedown",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),E.addEvent(a.rendNodeButton,"touchstart",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),E.addEvent(a.rendNodeButton,"pointerdown",function(s){y.exists(s.stopPropagation)&&s.stopPropagation()},a),a},g.registerElement("button",g.createButton),{createButton:g.createButton}}),define("base/foreignobject",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],function(g,E,y,b,m,l,c){return g.ForeignObject=function(a,e,o,s,t){this.constructor(a,o,E.OBJECT_TYPE_FOREIGNOBJECT,E.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this._useUserSize=!1,this.size=[1,1],l.exists(t)&&t.length>0&&(this._useUserSize=!0,this.W=l.createFunction(t[0],this.board,""),this.H=l.createFunction(t[1],this.board,""),this.usrSize=[this.W(),this.H()]),this.content=s,this.elType="foreignobject",this.id=this.board.setId(this,"Im"),this.board.renderer.drawForeignObject(this),this.board.finalizeAdding(this),this.methodMap=g.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},g.ForeignObject.prototype=new b,l.copyPrototypeMethods(g.ForeignObject,c,"coordsConstructor"),g.extend(g.ForeignObject.prototype,{hasPoint:function(a,e){var o,s,t,h,u,d,n,p,f,v=this.transformations.length;return l.isObject(l.evaluate(this.visProp.precision))?(h=this.board._inputDevice,u=l.evaluate(this.visProp.precision[h])):u=this.board.options.precision.hasPoint,v===0?(o=a-this.coords.scrCoords[1],s=this.coords.scrCoords[2]-e,o>=-(t=u)&&o-this.size[0]<=t&&s>=-t&&s-this.size[1]<=t):(n=[(d=(d=new y(E.COORDS_BY_SCREEN,[a,e],this.board)).usrCoords)[0]-this.span[0][0],d[1]-this.span[0][1],d[2]-this.span[0][2]],0<=(p=(f=m.innerProduct)(n,this.span[1]))&&p<=f(this.span[1],this.span[1])&&0<=(p=f(n,this.span[2]))&&p<=f(this.span[2],this.span[2]))},update:function(a){return this.needsUpdate?(this.updateCoords(a),this.updateSize(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateForeignObject")},updateSize:function(){var a=[0,0];return this._useUserSize?(this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)]):this.rendNode.hasChildNodes()&&(a=this.rendNode.childNodes[0].getBoundingClientRect(),this.size=[a.width,a.height]),this},updateSpan:function(){var a,e,o=this.transformations.length,s=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],a=0;a<o;a++)for(e=0;e<3;e++)s[e]=m.matVecMult(this.transformations[a].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(a){var e;if(l.isArray(a))for(e=0;e<a.length;e++)this.transformations.push(a[e]);else this.transformations.push(a);return this},getParents:function(){var a=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(a=this.parents),a},setSize:function(a,e){return this.W=l.createFunction(a,this.board,""),this.H=l.createFunction(e,this.board,""),this._useUserSize=!0,this},W:function(){},H:function(){}}),g.createForeignObject=function(a,e,o){var s,t,h=e[0],u=e[1],d=[];if(e.length>=2&&(d=e[2]),s=l.copyAttributes(o,a.options,"foreignobject"),!(t=c.create(g.ForeignObject,a,u,s,h,d)))throw new Error("JSXGraph: Can't create foreignObject with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [string, [x, y], [w, h]], [string, [x, y]], [element,transformation]`);return t},g.registerElement("foreignobject",g.createForeignObject),g.registerElement("fo",g.createForeignObject),{ForeignObject:g.ForeignObject,createForeignobject:g.createForeignObject}}),define("options3d",["jxg","options"],function(g,E){return g.extend(E,{axes3d:{axesPosition:"center",xAxis:{visible:!0,point2:{name:"x"}},yAxis:{visible:!0,point2:{name:"y"}},zAxis:{visible:!0,point2:{name:"z"}},xPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},yPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},zPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},xPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},yPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},zPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},xPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1}},axis3d:{highlight:!1,strokecolor:"black",strokeWidth:1,tabindex:null,point1:{visible:!1,name:""},point2:{visible:!1,name:"",label:{visible:!0}}},curve3d:{highlight:!1,tabindex:-1,strokeWidth:1,numberPointsHigh:200},mesh3d:{strokeWidth:1,strokeColor:"#9a9a9a",strokeOpacity:.6,highlight:!1,fillColor:"#9a9a9a",fillOpacity:.1,tabindex:null,visible:"inherit"},line3d:{strokeWidth:1,strokeColor:"black",fixed:!0,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",point:{visible:!1,name:""},point1:{visible:!1,name:""},point2:{visible:!1,name:""}},plane3d:{strokeWidth:0,strokeColor:"black",strokeOpacity:1,highlight:!1,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",gradientAngle:Math.PI,fillColor:"#a7a7a7",fillOpacity:.6,point:{visible:!1,name:"",fixed:!0}},point3d:{infoboxDigits:"auto",strokeWidth:0,gradient:"radial",gradientSecondColor:"#555555",fillColor:"yellow",highlightStrokeColor:"#555555"},surface3d:{highlight:!1,tabindex:-1,strokeWidth:1,stepsU:30,stepsV:30},view3d:{needsRegularUpdate:!0}}),g.Options}),define("3d/view3d",["jxg","options","base/constants","utils/type","math/math","base/element","base/composition"],function(g,E,y,b,m,l,c){return g.View3D=function(a,e,o){this.constructor(a,o,y.OBJECT_TYPE_VIEW3D,y.OBJECT_CLASS_3D),this.objects={},this.objectsList=[],this.elementsByName={},this.defaultAxes=null,this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.llftCorner=e[0],this.size=e[1],this.bbox3D=e[2],this.r=-1,this.timeoutAzimuth=null,this.id=this.board.setId(this,"V"),this.board.finalizeAdding(this),this.elType="view3d",this.methodMap=b.deepCopy(this.methodMap,{})},g.View3D.prototype=new l,g.extend(g.View3D.prototype,{create:function(a,e,o){var s=[];return a.indexOf("3d")>0&&s.push(this),this.board.create(a,s.concat(e),o)},select:function(a,e){var o,s,t,h,u=a;if(u===null)return u;if(b.isString(u)&&u!=="")b.exists(this.objects[u])?u=this.objects[u]:b.exists(this.elementsByName[u])&&(u=this.elementsByName[u]);else if(!e&&(b.isFunction(u)||b.isObject(u)&&!b.isFunction(u.setAttribute))){for(s={},h=(o=b.filterElements(this.objectsList,u)).length,t=0;t<h;t++)s[o[t].id]=o[t];u=new c(s)}else b.isObject(u)&&b.exists(u.id)&&!b.exists(this.objects[u.id])&&(u=null);return u},update:function(){var a,e,o,s,t;return b.exists(this.el_slide)&&b.exists(this.az_slide)&&this.needsUpdate?(a=this.el_slide.Value(),e=this.r,o=this.az_slide.Value(),s=e*Math.sin(a),t=[[1,0,0],[0,1,0],[0,0,1]],this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.matrix3D[1][1]=e*Math.cos(o),this.matrix3D[1][2]=-e*Math.sin(o),this.matrix3D[2][1]=s*Math.sin(o),this.matrix3D[2][2]=s*Math.cos(o),this.matrix3D[2][3]=Math.cos(a),t[1][1]=this.size[0]/(this.bbox3D[0][1]-this.bbox3D[0][0]),t[2][2]=this.size[1]/(this.bbox3D[1][1]-this.bbox3D[1][0]),t[1][0]=this.llftCorner[0]-t[1][1]*this.bbox3D[0][0],t[2][0]=this.llftCorner[1]-t[2][2]*this.bbox3D[1][0],this.matrix3D=m.matMatMult(t,this.matrix3D),this):this},updateRenderer:function(){return this.needsUpdate=!1,this},project3DTo2D:function(a,e,o){var s;return s=arguments.length===3?[1,a,e,o]:a.length===3?[1].concat(a):a,m.matVecMult(this.matrix3D,s)},project2DTo3DPlane:function(a,e,o){var s,t,h,u,d=e.slice(1),n=[1,0,0,0];o=o||[1,0,0,0],u=m.norm(d,3),h=m.innerProduct(o.slice(1),d,3)/u,(s=this.matrix3D.slice(0,3)).push([0].concat(d)),t=a.coords.usrCoords.concat([h]);try{s[2][3]===1&&(s[2][1]=s[2][2]=.001*m.eps),n=m.Numerics.Gauss(s,t)}catch{n=[0,NaN,NaN,NaN]}return n},project3DToCube:function(a){var e=this.bbox3D;return a[1]<e[0][0]&&(a[1]=e[0][0]),a[1]>e[0][1]&&(a[1]=e[0][1]),a[2]<e[1][0]&&(a[2]=e[1][0]),a[2]>e[1][1]&&(a[2]=e[1][1]),a[3]<e[2][0]&&(a[3]=e[2][0]),a[3]>e[2][1]&&(a[3]=e[2][1]),a},intersectionLineCube:function(a,e,o){var s,t,h,u;for(s=o,t=0;t<3;t++)e[t]!==0&&(h=(this.bbox3D[t][0]-a[t])/e[t],u=(this.bbox3D[t][1]-a[t])/e[t],s=o<0?Math.max(s,Math.min(h,u)):Math.min(s,Math.max(h,u)));return s},isInCube:function(a){return a[0]>this.bbox3D[0][0]-m.eps&&a[0]<this.bbox3D[0][1]+m.eps&&a[1]>this.bbox3D[1][0]-m.eps&&a[1]<this.bbox3D[1][1]+m.eps&&a[2]>this.bbox3D[2][0]-m.eps&&a[2]<this.bbox3D[2][1]+m.eps},intersectionPlanePlane:function(a,e,o){var s,t,h,u,d=[[],[]];return o=o||e.d,s=m.Geometry.meet3Planes(a.normal,a.d,e.normal,o,m.crossProduct(a.normal,e.normal),0),t=m.Geometry.meetPlanePlane(a.vec1,a.vec2,e.vec1,e.vec2),h=this.intersectionLineCube(s,t,1/0),u=m.axpy(h,t,s),this.isInCube(u)&&(d[0]=u),h=this.intersectionLineCube(s,t,-1/0),u=m.axpy(h,t,s),this.isInCube(u)&&(d[1]=u),d},getMesh:function(a,e,o){var s,t,h,u,d,n,p,f=[0,0,0],v=e[2],C=o[2],_=[],P=[];for(n=(b.evaluate(e[1])-b.evaluate(e[0]))/v,p=(b.evaluate(o[1])-b.evaluate(o[0]))/C,s=0;s<=v;s++){for(h=e[0]+n*s,t=0;t<=C;t++)u=o[0]+p*t,f=b.isFunction(a)?a(h,u):[a[0](h,u),a[1](h,u),a[2](h,u)],d=this.project3DTo2D(f),_.push(d[1]),P.push(d[2]);_.push(NaN),P.push(NaN)}for(t=0;t<=C;t++){for(u=o[0]+p*t,s=0;s<=v;s++)h=e[0]+n*s,f=b.isFunction(a)?a(h,u):[a[0](h,u),a[1](h,u),a[2](h,u)],d=this.project3DTo2D(f),_.push(d[1]),P.push(d[2]);_.push(NaN),P.push(NaN)}return[_,P]},animateAzimuth:function(){var a=this.az_slide._smin,e=this.az_slide._smax-a,o=this.az_slide.Value()+.1;this.az_slide.position=(o-a)/e,this.az_slide.position>1&&(this.az_slide.position=0),this.board.update(),this.timeoutAzimuth=setTimeout(function(){this.animateAzimuth()}.bind(this),200)},stopAzimuth:function(){clearTimeout(this.timeoutAzimuth),this.timeoutAzimuth=null}}),g.createView3D=function(a,e,o){var s,t,h,u,d,n,p=e[0],f=e[1];return t=b.copyAttributes(o,a.options,"view3d"),(s=new g.View3D(a,e,t)).defaultAxes=s.create("axes3d",e,o),h=p[0],u=p[1],d=f[0],n=f[1],s.az_slide=a.create("slider",[[h-1,u-2],[h+d+1,u-2],[0,1,2*Math.PI]],{style:6,name:"az",point1:{frozen:!0},point2:{frozen:!0}}),s.el_slide=a.create("slider",[[h-1,u],[h-1,u+n],[0,.3,Math.PI/2]],{style:6,name:"el",point1:{frozen:!0},point2:{frozen:!0}}),s.board.highlightInfobox=function(v,C,_){var P,x,S,O,w=_.board,T=null;for(x=0;x<_.parents.length&&!(T=w.objects[_.parents[x]]).is3D;x++);if(T){if(O=[1,0,0,T.coords[3]],S=s.project2DTo3DPlane(T.element2D,[1,0,0,1],O),!s.isInCube(S))return void s.board.highlightCustomInfobox("",T);(P=b.evaluate(T.visProp.infoboxdigits))==="auto"?s.board.highlightCustomInfobox("("+b.autoDigits(T.X())+" | "+b.autoDigits(T.Y())+" | "+b.autoDigits(T.Z())+")",T):s.board.highlightCustomInfobox("("+b.toFixed(T.X(),P)+" | "+b.toFixed(T.Y(),P)+" | "+b.toFixed(T.Z(),P)+")",T)}else s.board.highlightCustomInfobox("("+v+", "+C+")",_)},s.board.update(),s},g.registerElement("view3d",g.createView3D),g.View3D}),define("3d/element3d",["jxg"],function(g){return g.GeometryElement3D=function(E,y){this.elType=y,this.id=this.board.setId(this,y),this.view=E,this.element2D=null,this.is3D=!0,this.view.objects[this.id]=this,this.view.objectsList.push(this),this.name!==""&&(this.view.elementsByName[this.name]=this)},g.GeometryElement3D}),define("3d/box3d",["jxg","utils/type","math/math","math/geometry"],function(g,E,y,b){g.createAxes3D=function(m,l,c){var a,e,o,s,t,h,u,d,n,p,f,v,C,_,P,x,S,O=l[0],w=["x","y","z"],T="Axis",M=["Rear","Front"],N=[0,0,0],A=[0,0,0],R={};if(E.exists(O.bbox3D))for(a=0;a<w.length;a++)N[a]=O.bbox3D[a][0],A[a]=O.bbox3D[a][1];else for(a=0;a<w.length;a++)N[a]=l[1][a],A[a]=l[2][1];for(u=(h=E.copyAttributes(c,m.options,"axes3d")).axesposition,a=0;a<w.length;a++)P=(d=w[a])+T,u==="center"?(n=[0,0,0],(p=[0,0,0])[a]=A[a],R[P]=O.create("axis3d",[n,p],h[P.toLowerCase()])):(P+="Border",n=N.slice(),p=A.slice(),a===2?(n[1]=A[1],p[0]=N[0]):(n[a]=A[a],p[2]=N[2]),p[a]=A[a],h[P.toLowerCase()].lastArrow=!1,R[P]=O.create("axis3d",[n,p],h[P.toLowerCase()]),S={visible:!0,minorTicks:0,tickEndings:[0,1],drawLabels:!1},a===2&&(S.tickEndings=[1,0]),R[P+"Ticks"]=O.create("ticks",[R[P],1],S));for(R.O=O.create("intersection",[R[w[0]+T],R[w[1]+T]],{name:"",visible:!1,withLabel:!1}),a=0;a<w.length;a++)for(s=(a+1)%3,t=(a+2)%3,d=w[a],e=0;e<M.length;e++)(n=[0,0,0])[a]=e===0?N[a]:A[a],v=[0,0,0],(f=[0,0,0])[s]=1,v[t]=1,C=[N[s],A[s]],_=[N[t],A[t]],P=d+"Plane"+M[e],h=E.copyAttributes(c,m.options,"axes3d",P),R[P]=O.create("plane3d",[n,f,v,C,_],h),R[P].elType="axisplane3d";for(a=0;a<w.length;a++)for(d=w[a],e=0;e<M.length;e++)for(o=1;o<=2;o++)P=d+"Plane"+M[e]+w[s=(a+o)%3].toUpperCase()+"Axis",x=d+"Plane"+M[e],(n=[0,0,0])[a]=(p=[0,0,0])[a]=e===0?N[a]:A[a],n[s]=N[s],p[s]=A[s],h=E.copyAttributes(c,m.options,"axes3d",P),R[P]=O.create("axis3d",[n,p],h),R[x].addChild(R[P]),R[x].element2D.inherits.push(R[P]);return R},g.registerElement("axes3d",g.createAxes3D),g.createAxis3D=function(m,l,c){var a,e,o,s,t,h,u=l[0],d=l[1],n=l[2];return a=E.copyAttributes(c.point1,m.options,"axis3d","point1"),e=u.create("point",[(s=d[0],t=d[1],h=d[2],function(){return u.project3DTo2D(s,t,h)[1]}),function(p,f,v){return function(){return u.project3DTo2D(p,f,v)[2]}}(d[0],d[1],d[2])],a),a=E.copyAttributes(c.point2,m.options,"axis3d","point2"),o=u.create("point",[function(p,f,v){return function(){return u.project3DTo2D(p,f,v)[1]}}(n[0],n[1],n[2]),function(p,f,v){return function(){return u.project3DTo2D(p,f,v)[2]}}(n[0],n[1],n[2])],a),a=E.copyAttributes(c,m.options,"axis3d"),u.create("arrow",[e,o],a)},g.registerElement("axis3d",g.createAxis3D),g.createMesh3D=function(m,l,c){var a,e=l[0],o=l[1],s=l[2],t=l[3],h=l[4],u=l[5];return(a=e.create("curve",[[],[]],c)).updateDataArray=function(){var d,n,p,f,v=t[0],C=t[1],_=u[0],P=u[1],x=[0,0,0],S=[0,0,0],O=[0,0,0];if(this.dataX=[],this.dataY=[],E.isFunction(o))O=o().slice(1);else for(f=0;f<3;f++)O[f]=E.evaluate(o[f]);for(f=0;f<3;f++)x[f]=E.evaluate(s[f]),S[f]=E.evaluate(h[f]);for(d=g.Math.norm(x,3),n=g.Math.norm(S,3),f=0;f<3;f++)x[f]/=d,S[f]/=n;p=e.getMesh([function(w,T){return O[0]+w*x[0]+T*S[0]},function(w,T){return O[1]+w*x[1]+T*S[1]},function(w,T){return O[2]+w*x[2]+T*S[2]}],[Math.ceil(v),Math.floor(C),(Math.ceil(C)-Math.floor(v))/1],[Math.ceil(_),Math.floor(P),(Math.ceil(P)-Math.floor(_))/1]),this.dataX=p[0],this.dataY=p[1]},a},g.registerElement("mesh3d",g.createMesh3D)}),define("3d/point3d",["jxg","base/constants","math/math","math/geometry","utils/type"],function(g,E,y,b,m){g.Point3D=function(l,c,a,e){this.constructor(l.board,e,E.OBJECT_TYPE_POINT3D,E.OBJECT_CLASS_3D),this.constructor3D(l,"point3d"),this.id=this.view.board.setId(this,"P3D"),this.board.finalizeAdding(this),this.coords=[0,0,0,0],this.F=c,this.slide=a,this.X=function(){return this.coords[1]},this.Y=function(){return this.coords[2]},this.Z=function(){return this.coords[3]},this._params=null,this._c2d=null,this.methodMap=m.deepCopy(this.methodMap,{})},g.Point3D.prototype=new g.GeometryElement,m.copyPrototypeMethods(g.Point3D,g.GeometryElement3D,"constructor3D"),g.extend(g.Point3D.prototype,{updateCoords:function(){var l;if(m.isFunction(this.F))this.coords=[1].concat(m.evaluate(this.F));else for(this.coords[0]=1,l=0;l<3;l++)m.isFunction(this.F[l])&&(this.coords[l+1]=m.evaluate(this.F[l]));return this},initCoords:function(){var l;if(m.isFunction(this.F))this.coords=[1].concat(m.evaluate(this.F));else for(this.coords[0]=1,l=0;l<3;l++)this.coords[l+1]=m.evaluate(this.F[l]);return this},normalizeCoords:function(){return Math.abs(this.coords[0])>y.eps&&(this.coords[1]/=this.coords[0],this.coords[2]/=this.coords[0],this.coords[3]/=this.coords[0],this.coords[0]=1),this},setPosition:function(l,c){var a=this.coords;return this.coords.slice(),l.length===3?(a[0]=1,a[1]=l[0],a[2]=l[1],a[3]=l[2]):(a[0]=l[0],a[1]=l[1],a[2]=l[2],a[3]=l[2],this.normalizeCoords()),this},update:function(l){var c,a;return this.element2D.draggable()&&b.distance(this._c2d,this.element2D.coords.usrCoords)!==0?this.slide?this.projectCoords2Surface():(a=[1,0,0,this.coords[3]],(c=this.view.project2DTo3DPlane(this.element2D,[1,0,0,1],a))[0]!==0&&(this.coords=this.view.project3DToCube(c))):(this.updateCoords(),this.element2D.coords.setCoordinates(E.COORDS_BY_USER,this.view.project3DTo2D([1,this.X(),this.Y(),this.Z()]))),this._c2d=this.element2D.coords.usrCoords.slice(),this},updateRenderer:function(){return this.needsUpdate=!1,this},projectCoords2Surface:function(){var l,c,a,e=[0,0],o=this.slide,s=this;o!==null&&(a=function(t,h,u,d){var n=[1,o.X(u[0],u[1]),o.Y(u[0],u[1]),o.Z(u[0],u[1])],p=s.view.project3DTo2D(n);return d[0]=s.element2D.X()-p[1],d[1]=s.element2D.Y()-p[2],d[0]*d[0]+d[1]*d[1]},m.exists(this._params)&&(e=this._params.slice()),y.Nlp.FindMinimum(a,2,2,e,5,1e-6,0,200),l=[1,o.X(e[0],e[1]),o.Y(e[0],e[1]),o.Z(e[0],e[1])],c=this.view.project3DTo2D(l),this._params=e,this.coords=l,this.element2D.coords.setCoordinates(E.COORDS_BY_USER,c),this._c2d=c)},__evt__update3D:function(l){}}),g.createPoint3D=function(l,c,a){var e,o,s,t,h,u=c[0];if(s=c.length>2&&m.exists(c[c.length-1].is3D)?c.pop():null,c.length===2)o=c[1];else{if(c.length!==4)throw new Error("JSXGraph: Can't create point3d with parent types '"+typeof c[0]+"' and '"+typeof c[1]+`'.
Possible parent types: [[x,y,z]], [x,y,z]`);o=c.slice(1)}return e=m.copyAttributes(a,l.options,"point3d"),(h=new g.Point3D(u,o,s,e)).initCoords(),t=u.project3DTo2D(h.coords),e.name=h.name,h.element2D=u.create("point",t,e),h.addChild(h.element2D),h.inherits.push(h.element2D),h.element2D.setParents(h),h._c2d=h.element2D.coords.usrCoords.slice(),h},g.registerElement("point3d",g.createPoint3D)}),define("3d/curve3d",["jxg","base/constants","utils/type"],function(g,E,y){g.Curve3D=function(b,m,l,c,a,e,o){this.constructor(b.board,o,E.OBJECT_TYPE_CURVE3D,E.OBJECT_CLASS_3D),this.constructor3D(b,"surface3d"),this.id=this.view.board.setId(this,"S3D"),this.board.finalizeAdding(this),this.F=m,this.X=l,this.Y=c,this.Z=a,this.F!==null&&(this.X=function(s){return this.F(s)[0]},this.Y=function(s){return this.F(s)[1]},this.Z=function(s){return this.F(s)[2]}),this.range=e,this.methodMap=y.deepCopy(this.methodMap,{})},g.Curve3D.prototype=new g.GeometryElement,y.copyPrototypeMethods(g.Curve3D,g.GeometryElement3D,"constructor3D"),g.extend(g.Curve3D.prototype,{updateDataArray:function(){var b,m,l,c,a,e,o,s,t=y.evaluate(this.visProp.numberpointshigh),h=[0,0,0];if(o=[],s=[],y.isArray(this.X))for(t=this.X.length,e=0;e<t;e++)h=[this.X[e],this.Y[e],this.Z[e]],a=this.view.project3DTo2D(h),o.push(a[1]),s.push(a[2]);else for(m=(b=y.evaluate(this.range))[0],c=((l=b[1])-m)/(t-1),e=m;e<=l;e+=c)h=this.F!==null?this.F(e):[this.X(e),this.Y(e),this.Z(e)],a=this.view.project3DTo2D(h),o.push(a[1]),s.push(a[2]);return{X:o,Y:s}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),g.createCurve3D=function(b,m,l){var c,a,e,o,s,t,h,u=m[0];return m.length===3?(c=m[1],s=m[2],a=null,e=null,o=null):(a=m[1],e=m[2],o=m[3],s=m[4],c=null),t=y.copyAttributes(l,b.options,"curve3d"),(h=new g.Curve3D(u,c,a,e,o,s,t)).element2D=b.create("curve",[[],[]],t),h.element2D.updateDataArray=function(){var d=h.updateDataArray();this.dataX=d.X,this.dataY=d.Y},h.addChild(h.element2D),h.inherits.push(h.element2D),h.element2D.setParents(h),h.element2D.prepareUpdate().update(),b.isSuspendedUpdate||h.element2D.updateVisibility().updateRenderer(),h},g.registerElement("curve3d",g.createCurve3D)}),define("3d/linspace3d",["jxg","base/constants","utils/type","math/math","math/geometry"],function(g,E,y,b,m){g.Line3D=function(l,c,a,e,o){this.constructor(l.board,o,E.OBJECT_TYPE_LINE3D,E.OBJECT_CLASS_3D),this.constructor3D(l,"line3d"),this.id=this.view.board.setId(this,"L3D"),this.board.finalizeAdding(this),this.point=c,this.direction=a,this.range=e||[-1/0,1/0],this.point1=null,this.point2=null,this.methodMap=y.deepCopy(this.methodMap,{})},g.Line3D.prototype=new g.GeometryElement,y.copyPrototypeMethods(g.Line3D,g.GeometryElement3D,"constructor3D"),g.extend(g.Line3D.prototype,{getPointCoords:function(l){var c,a,e,o=[];if(c=[this.point.X(),this.point.Y(),this.point.Z()],y.isFunction(this.direction))o=this.direction();else for(a=1;a<4;a++)o.push(y.evaluate(this.direction[a]));return e=y.evaluate(l),Math.abs(e)===1/0&&(l=this.view.intersectionLineCube(c,o,e)),[c[0]+o[0]*e,c[1]+o[1]*e,c[2]+o[2]*e]},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),g.createLine3D=function(l,c,a){var e,o,s,t,h,u,d,n,p=c[0];return e=y.copyAttributes(a,l.options,"line3d"),s=y.providePoints3D(p,[c[1]],a,"line3d",["point"])[0],y.isPoint3D(c[2])||y.isArray(c[2])&&c.length===3?(u=s,d=y.providePoints3D(p,[c[2]],a,"line3d",["point2"])[0],t=function(){return[d.X()-s.X(),d.Y()-s.Y(),d.Z()-s.Z()]},h=[0,1],n=new g.Line3D(p,s,t,h,e)):(y.isFunction(c[2])?t=c[2]:c[2].length===3?t=[1].concat(c[2]):c[2].length===4&&(t=c[2]),h=c[3],o=y.providePoints3D(p,[[0,0,0],[0,0,0]],a,"line3d",["point1","point2"]),n=new g.Line3D(p,s,t,h,e),o[0].F=function(){return n.getPointCoords(y.evaluate(n.range[0]))},o[0].prepareUpdate().update(),u=o[0],o[1].F=function(){return n.getPointCoords(y.evaluate(n.range[1]))},o[1].prepareUpdate().update(),d=o[1]),n.element2D=p.create("segment",[u.element2D,d.element2D],e),n.addChild(n.element2D),n.inherits.push(n.element2D),n.element2D.setParents(n),u.addChild(n),d.addChild(n),n.point1=u,n.point2=d,n.update(),n.element2D.prepareUpdate().update().updateRenderer(),n},g.registerElement("line3d",g.createLine3D),g.Plane3D=function(l,c,a,e,o,s,t){this.constructor(l.board,t,E.OBJECT_TYPE_PLANE3D,E.OBJECT_CLASS_3D),this.constructor3D(l,"plane3d"),this.id=this.view.board.setId(this,"PL3D"),this.board.finalizeAdding(this),this.point=c,this.direction1=a,this.direction2=o,this.range1=e||[-1/0,1/0],this.range2=s||[-1/0,1/0],this.vec1=[0,0,0],this.vec2=[0,0,0],this.grid=null,this.normal=[0,0,0],this.d=0,this.updateNormal(),this.methodMap=y.deepCopy(this.methodMap,{})},g.Plane3D.prototype=new g.GeometryElement,y.copyPrototypeMethods(g.Plane3D,g.GeometryElement3D,"constructor3D"),g.extend(g.Plane3D.prototype,{updateNormal:function(){var l,c;for(l=0;l<3;l++)this.vec1[l]=y.evaluate(this.direction1[l]),this.vec2[l]=y.evaluate(this.direction2[l]);if(this.normal=b.crossProduct(this.vec1,this.vec2),c=b.norm(this.normal),Math.abs(c)>b.eps)for(l=0;l<3;l++)this.normal[l]/=c;return this.d=b.innerProduct(this.point.coords.slice(1),this.normal,3),this},updateDataArray:function(){var l,c,a,e,o,s,t,h,u,d,n,p,f,v,C=["xPlaneRear","yPlaneRear","zPlaneRear"],_=[],P=[0,0,0],x=[0,0,0],S=[0,0,0],O=[0,0,0],w=this.view;if(this.dataX=[],this.dataY=[],this.updateNormal(),this.elType!=="axisplane3d"&&w.defaultAxes&&y.evaluate(this.range1[0])===-1/0&&y.evaluate(this.range1[1])===1/0&&y.evaluate(this.range2[0])===-1/0&&y.evaluate(this.range2[1])===1/0){for(d=0;d<C.length;d++){if((O=w.intersectionPlanePlane(this,w.defaultAxes[C[d]]))[0].length===3&&O[1].length===3){for(u=0;u<_.length&&!(m.distance(O[0],_[u][0],3)<b.eps&&m.distance(O[1],_[u][1],3)<b.eps||m.distance(O[0],_[u][1],3)<b.eps&&m.distance(O[1],_[u][0],3)<b.eps);u++);u===_.length&&_.push(O.slice())}if((O=[0,0,0])[d]=w.bbox3D[d][1],h=b.innerProduct(O,w.defaultAxes[C[d]].normal,3),(O=w.intersectionPlanePlane(this,w.defaultAxes[C[d]],h))[0].length===3&&O[1].length===3){for(u=0;u<_.length&&!(m.distance(O[0],_[u][0],3)<b.eps&&m.distance(O[1],_[u][1],3)<b.eps||m.distance(O[0],_[u][1],3)<b.eps&&m.distance(O[1],_[u][0],3)<b.eps);u++);u===_.length&&_.push(O.slice())}}f=0,u=0;do{for((O=_[f][u]).length===3&&(o=w.project3DTo2D(O),this.dataX.push(o[1]),this.dataY.push(o[2])),u=(u+1)%2,O=_[f][u],v=f,d=0;d<_.length;d++){if(d!==f&&m.distance(O,_[d][0])<b.eps){f=d,u=0;break}if(d!==f&&m.distance(O,_[d][1])<b.eps){f=d,u=1;break}}if(f===v){console.log("Error: update plane3d: did not find next",f);break}}while(f!==0);o=w.project3DTo2D(_[0][0]),this.dataX.push(o[1]),this.dataY.push(o[2])}else{for(l=y.evaluate(this.range1[0]),c=y.evaluate(this.range1[1]),a=y.evaluate(this.range2[0]),e=y.evaluate(this.range2[1]),S=this.point.coords.slice(1),P=this.vec1.slice(),x=this.vec2.slice(),s=b.norm(P,3),t=b.norm(x,3),u=0;u<3;u++)P[u]/=s,x[u]/=t;for(d=0;d<4;d++){switch(d){case 0:n=l,p=a;break;case 1:n=c,p=a;break;case 2:n=c,p=e;break;case 3:n=l,p=e}for(u=0;u<3;u++)O[u]=S[u]+n*P[u]+p*x[u];o=w.project3DTo2D(O),this.dataX.push(o[1]),this.dataY.push(o[2])}this.dataX.push(this.dataX[0]),this.dataY.push(this.dataY[0])}return{X:this.dataX,Y:this.dataY}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),g.createPlane3D=function(l,c,a){var e,o,s,t,h=c[0],u=c[2],d=c[3],n=c[4]||[-1/0,1/0],p=c[5]||[-1/0,1/0];return o=y.providePoints3D(h,[c[1]],a,"plane3d",["point"])[0],e=y.copyAttributes(a,l.options,"plane3d"),s=new g.Plane3D(h,o,u,n,d,p,e),o.addChild(s),s.element2D=h.create("curve",[[],[]],e),s.element2D.updateDataArray=function(){var f=s.updateDataArray();this.dataX=f.X,this.dataY=f.Y},s.addChild(s.element2D),s.inherits.push(s.element2D),s.element2D.setParents(s),e=y.copyAttributes(a.mesh3d,l.options,"mesh3d"),Math.abs(s.range1[0])!==1/0&&Math.abs(s.range1[1])!==1/0&&Math.abs(s.range2[0])!==1/0&&Math.abs(s.range2[1])!==1/0&&(t=h.create("mesh3d",[function(){return o.coords},u,n,d,p],e),s.grid=t,s.addChild(t),s.inherits.push(t),t.setParents(s)),s.element2D.prepareUpdate().update(),l.isSuspendedUpdate||s.element2D.updateVisibility().updateRenderer(),s},g.registerElement("plane3d",g.createPlane3D)}),define("3d/surface3d",["jxg","base/constants","utils/type"],function(g,E,y){g.Surface3D=function(b,m,l,c,a,e,o,s){this.constructor(b.board,s,E.OBJECT_TYPE_SURFACE3D,E.OBJECT_CLASS_3D),this.constructor3D(b,"surface3d"),this.id=this.view.board.setId(this,"S3D"),this.board.finalizeAdding(this),this.F=m,this.X=l,this.Y=c,this.Z=a,this.F!==null&&(this.X=function(t,h){return this.F(t,h)[0]},this.Y=function(t,h){return this.F(t,h)[1]},this.Z=function(t,h){return this.F(t,h)[2]}),this.range_u=e,this.range_v=o,this.methodMap=y.deepCopy(this.methodMap,{})},g.Surface3D.prototype=new g.GeometryElement,y.copyPrototypeMethods(g.Surface3D,g.GeometryElement3D,"constructor3D"),g.extend(g.Surface3D.prototype,{updateDataArray:function(){var b,m,l=y.evaluate(this.visProp.stepsu),c=y.evaluate(this.visProp.stepsv),a=y.evaluate(this.range_u),e=y.evaluate(this.range_v);return b=this.F!==null?this.F:[this.X,this.Y,this.Z],{X:(m=this.view.getMesh(b,a.concat([l]),e.concat([c])))[0],Y:m[1]}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),g.createParametricSurface3D=function(b,m,l){var c,a,e,o,s,t,h,u,d=m[0];return m.length===4?(c=m[1],s=m[2],t=m[3],a=null,e=null,o=null):(a=m[1],e=m[2],o=m[3],s=m[4],t=m[5],c=null),h=y.copyAttributes(l,b.options,"surface3d"),(u=new g.Surface3D(d,c,a,e,o,s,t,h)).element2D=d.create("curve",[[],[]],h),u.element2D.updateDataArray=function(){var n=u.updateDataArray();this.dataX=n.X,this.dataY=n.Y},u.addChild(u.element2D),u.inherits.push(u.element2D),u.element2D.setParents(u),u.element2D.prepareUpdate().update(),b.isSuspendedUpdate||u.element2D.updateVisibility().updateRenderer(),u},g.registerElement("parametricsurface3d",g.createParametricSurface3D),g.createFunctiongraph3D=function(b,m,l){var c=m[0],a=m[1],e=m[2],o=m[3];return c.create("parametricsurface3d",[function(s,t){return s},function(s,t){return t},a,e,o],l)},g.registerElement("functiongraph3d",g.createFunctiongraph3D)}),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/probfuncs","math/ia","math/extrapolate","math/qdt","math/numerics","math/nlp","math/plot","math/metapost","math/statistics","math/symbolic","math/geometry","math/clip","math/poly","math/complex","renderer/abstract","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/coordselement","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button","base/foreignobject","options3d","3d/view3d","3d/element3d","3d/box3d","3d/point3d","3d/curve3d","3d/linspace3d","3d/surface3d"],function(g,E){return E.isBrowser?window.JXG=g:E.isNode()?module.exports=g:E.isWebWorker()&&(self.JXG=g),g}),require("../build/core.deps.js")})})(jsxgraphcore$2,jsxgraphcoreExports);const jsxgraphcore=jsxgraphcoreExports,jsxgraphcore$1=_mergeNamespaces({__proto__:null,default:jsxgraphcore},[jsxgraphcoreExports]);export{jsxgraphcore$1 as j};
